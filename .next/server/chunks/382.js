exports.id=382,exports.ids=[382],exports.modules={1605:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.addAdminServicesToServer=er.registerAdminService=void 0;let en=[];function ei(et,er){en.push({getServiceDefinition:et,getHandlers:er})}function es(et){for(let{getServiceDefinition:er,getHandlers:ei}of en)et.addService(er(),ei())}er.registerAdminService=ei,er.addAdminServicesToServer=es},77257:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.BackoffTimeout=void 0;let en=1e3,ei=1.6,es=12e4,ea=.2;function eo(et,er){return Math.random()*(er-et)+et}class eu{constructor(et,er){this.callback=et,this.initialDelay=en,this.multiplier=ei,this.maxDelay=es,this.jitter=ea,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,er&&(er.initialDelay&&(this.initialDelay=er.initialDelay),er.multiplier&&(this.multiplier=er.multiplier),er.jitter&&(this.jitter=er.jitter),er.maxDelay&&(this.maxDelay=er.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(et){var er,en;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},et),this.hasRef||null===(en=(er=this.timerId).unref)||void 0===en||en.call(er)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let et=Math.min(this.nextDelay*this.multiplier,this.maxDelay),er=et*this.jitter;this.nextDelay=et+eo(-er,er)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let et=new Date,er=this.startTime;er.setMilliseconds(er.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),et<er?this.runTimer(er.getTime()-et.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var et,er;this.hasRef=!0,null===(er=(et=this.timerId).ref)||void 0===er||er.call(et)}unref(){var et,er;this.hasRef=!1,null===(er=(et=this.timerId).unref)||void 0===er||er.call(et)}getEndTime(){return this.endTime}}er.BackoffTimeout=eu},68612:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.CallCredentials=void 0;let ei=en(32908);function es(et){return"getRequestHeaders"in et&&"function"==typeof et.getRequestHeaders}class ea{static createFromMetadataGenerator(et){return new eu(et)}static createFromGoogleCredential(et){return ea.createFromMetadataGenerator((er,en)=>{let ea;(ea=es(et)?et.getRequestHeaders(er.service_url):new Promise((en,ei)=>{et.getRequestMetadata(er.service_url,(et,er)=>{if(et){ei(et);return}if(!er){ei(Error("Headers not set by metadata plugin"));return}en(er)})})).then(et=>{let er=new ei.Metadata;for(let en of Object.keys(et))er.add(en,et[en]);en(null,er)},et=>{en(et)})})}static createEmpty(){return new ec}}er.CallCredentials=ea;class eo extends ea{constructor(et){super(),this.creds=et}async generateMetadata(et){let er=new ei.Metadata,en=await Promise.all(this.creds.map(er=>er.generateMetadata(et)));for(let et of en)er.merge(et);return er}compose(et){return new eo(this.creds.concat([et]))}_equals(et){return this===et||et instanceof eo&&this.creds.every((er,en)=>er._equals(et.creds[en]))}}class eu extends ea{constructor(et){super(),this.metadataGenerator=et}generateMetadata(et){return new Promise((er,en)=>{this.metadataGenerator(et,(et,ei)=>{void 0!==ei?er(ei):en(et)})})}compose(et){return new eo([this,et])}_equals(et){return this===et||et instanceof eu&&this.metadataGenerator===et.metadataGenerator}}class ec extends ea{generateMetadata(et){return Promise.resolve(new ei.Metadata)}compose(et){return et}_equals(et){return et instanceof ec}}},88577:(et,er)=>{"use strict";function en(et){return void 0!==et.onReceiveMetadata&&1===et.onReceiveMetadata.length}Object.defineProperty(er,"__esModule",{value:!0}),er.InterceptingListenerImpl=er.isInterceptingListener=void 0,er.isInterceptingListener=en;class ei{constructor(et,er){this.listener=et,this.nextListener=er,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(et){this.processingMetadata=!0,this.listener.onReceiveMetadata(et,et=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(et),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(et){this.processingMessage=!0,this.listener.onReceiveMessage(et,et=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=et,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(et),this.processPendingStatus())})}onReceiveStatus(et){this.listener.onReceiveStatus(et,et=>{this.processingMetadata||this.processingMessage?this.pendingStatus=et:this.nextListener.onReceiveStatus(et)})}}er.InterceptingListenerImpl=ei},60060:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.getNextCallNumber=void 0;let en=0;function ei(){return en++}er.getNextCallNumber=ei},12953:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ClientDuplexStreamImpl=er.ClientWritableStreamImpl=er.ClientReadableStreamImpl=er.ClientUnaryCallImpl=er.callErrorFromStatus=void 0;let ei=en(82361),es=en(12781),ea=en(69238);function eo(et,er){let en=`${et.code} ${ea.Status[et.code]}: ${et.details}`,ei=Error(en),es=`${ei.stack}
for call at
${er}`;return Object.assign(Error(en),et,{stack:es})}er.callErrorFromStatus=eo;class eu extends ei.EventEmitter{constructor(){super()}cancel(){var et;null===(et=this.call)||void 0===et||et.cancelWithStatus(ea.Status.CANCELLED,"Cancelled on client")}getPeer(){var et,er;return null!==(er=null===(et=this.call)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:"unknown"}}er.ClientUnaryCallImpl=eu;class ec extends es.Readable{constructor(et){super({objectMode:!0}),this.deserialize=et}cancel(){var et;null===(et=this.call)||void 0===et||et.cancelWithStatus(ea.Status.CANCELLED,"Cancelled on client")}getPeer(){var et,er;return null!==(er=null===(et=this.call)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:"unknown"}_read(et){var er;null===(er=this.call)||void 0===er||er.startRead()}}er.ClientReadableStreamImpl=ec;class eh extends es.Writable{constructor(et){super({objectMode:!0}),this.serialize=et}cancel(){var et;null===(et=this.call)||void 0===et||et.cancelWithStatus(ea.Status.CANCELLED,"Cancelled on client")}getPeer(){var et,er;return null!==(er=null===(et=this.call)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:"unknown"}_write(et,er,en){var ei;let es={callback:en},ea=Number(er);Number.isNaN(ea)||(es.flags=ea),null===(ei=this.call)||void 0===ei||ei.sendMessageWithContext(es,et)}_final(et){var er;null===(er=this.call)||void 0===er||er.halfClose(),et()}}er.ClientWritableStreamImpl=eh;class ed extends es.Duplex{constructor(et,er){super({objectMode:!0}),this.serialize=et,this.deserialize=er}cancel(){var et;null===(et=this.call)||void 0===et||et.cancelWithStatus(ea.Status.CANCELLED,"Cancelled on client")}getPeer(){var et,er;return null!==(er=null===(et=this.call)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:"unknown"}_read(et){var er;null===(er=this.call)||void 0===er||er.startRead()}_write(et,er,en){var ei;let es={callback:en},ea=Number(er);Number.isNaN(ea)||(es.flags=ea),null===(ei=this.call)||void 0===ei||ei.sendMessageWithContext(es,et)}_final(et){var er;null===(er=this.call)||void 0===er||er.halfClose(),et()}}er.ClientDuplexStreamImpl=ed},77021:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ChannelCredentials=void 0;let ei=en(24404),es=en(68612),ea=en(66801);function eo(et,er){if(et&&!(et instanceof Buffer))throw TypeError(`${er}, if provided, must be a Buffer.`)}class eu{constructor(et){this.callCredentials=et||es.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(et,er,en,es){var eu;if(eo(et,"Root certificate"),eo(er,"Private key"),eo(en,"Certificate chain"),er&&!en)throw Error("Private key must be given with accompanying certificate chain");if(!er&&en)throw Error("Certificate chain must be given with accompanying private key");let ec=(0,ei.createSecureContext)({ca:null!==(eu=null!=et?et:(0,ea.getDefaultRootsData)())&&void 0!==eu?eu:void 0,key:null!=er?er:void 0,cert:null!=en?en:void 0,ciphers:ea.CIPHER_SUITES});return new eh(ec,null!=es?es:{})}static createFromSecureContext(et,er){return new eh(et,null!=er?er:{})}static createInsecure(){return new ec}}er.ChannelCredentials=eu;class ec extends eu{constructor(et){super(et)}compose(et){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(et){return et instanceof ec}}class eh extends eu{constructor(et,er){super(),this.secureContext=et,this.verifyOptions=er,this.connectionOptions={secureContext:et},(null==er?void 0:er.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=er.checkServerIdentity)}compose(et){let er=this.callCredentials.compose(et);return new ed(this,er)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(et){return this===et||et instanceof eh&&this.secureContext===et.secureContext&&this.verifyOptions.checkServerIdentity===et.verifyOptions.checkServerIdentity}}class ed extends eu{constructor(et,er){super(er),this.channelCredentials=et}compose(et){let er=this.callCredentials.compose(et);return new ed(this.channelCredentials,er)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(et){return this===et||et instanceof ed&&this.channelCredentials._equals(et.channelCredentials)&&this.callCredentials._equals(et.callCredentials)}}},70332:(et,er)=>{"use strict";function en(et,er){let en=Object.keys(et).sort(),ei=Object.keys(er).sort();if(en.length!==ei.length)return!1;for(let es=0;es<en.length;es+=1)if(en[es]!==ei[es]||et[en[es]]!==er[ei[es]])return!1;return!0}Object.defineProperty(er,"__esModule",{value:!0}),er.channelOptionsEqual=er.recognizedOptions=void 0,er.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},er.channelOptionsEqual=en},49914:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ChannelImplementation=void 0;let ei=en(77021),es=en(35233);class ea{constructor(et,er,en){if("string"!=typeof et)throw TypeError("Channel target must be a string");if(!(er instanceof ei.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(en&&"object"!=typeof en)throw TypeError("Channel options must be an object");this.internalChannel=new es.InternalChannel(et,er,en)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(et){return this.internalChannel.getConnectivityState(et)}watchConnectivityState(et,er,en){this.internalChannel.watchConnectivityState(et,er,en)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(et,er,en,ei,es){if("string"!=typeof et)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof er||er instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(et,er,en,ei,es)}}er.ChannelImplementation=ea},83316:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=er.getChannelzServiceDefinition=er.getChannelzHandlers=er.unregisterChannelzRef=er.registerChannelzSocket=er.registerChannelzServer=er.registerChannelzSubchannel=er.registerChannelzChannel=er.ChannelzCallTracker=er.ChannelzChildrenTracker=er.ChannelzTrace=void 0;let ei=en(41808),es=en(91360),ea=en(69238),eo=en(72782),eu=en(1605),ec=en(47697);function eh(et){return{channel_id:et.id,name:et.name}}function ed(et){return{subchannel_id:et.id,name:et.name}}function ep(et){return{server_id:et.id}}function ef(et){return{socket_id:et.id,name:et.name}}let em=32;class eg{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(et,er,en){let ei=new Date;this.events.push({description:er,severity:et,timestamp:ei,childChannel:(null==en?void 0:en.kind)==="channel"?en:void 0,childSubchannel:(null==en?void 0:en.kind)==="subchannel"?en:void 0}),this.events.length>=2*em&&(this.events=this.events.slice(em)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:eM(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(et=>({description:et.description,severity:et.severity,timestamp:eM(et.timestamp),channel_ref:et.childChannel?eh(et.childChannel):null,subchannel_ref:et.childSubchannel?ed(et.childSubchannel):null}))}}}er.ChannelzTrace=eg;class ey{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(et){var er,en,ei;switch(et.kind){case"channel":{let en=null!==(er=this.channelChildren.get(et.id))&&void 0!==er?er:{ref:et,count:0};en.count+=1,this.channelChildren.set(et.id,en);break}case"subchannel":{let er=null!==(en=this.subchannelChildren.get(et.id))&&void 0!==en?en:{ref:et,count:0};er.count+=1,this.subchannelChildren.set(et.id,er);break}case"socket":{let er=null!==(ei=this.socketChildren.get(et.id))&&void 0!==ei?ei:{ref:et,count:0};er.count+=1,this.socketChildren.set(et.id,er)}}}unrefChild(et){switch(et.kind){case"channel":{let er=this.channelChildren.get(et.id);void 0!==er&&(er.count-=1,0===er.count?this.channelChildren.delete(et.id):this.channelChildren.set(et.id,er));break}case"subchannel":{let er=this.subchannelChildren.get(et.id);void 0!==er&&(er.count-=1,0===er.count?this.subchannelChildren.delete(et.id):this.subchannelChildren.set(et.id,er));break}case"socket":{let er=this.socketChildren.get(et.id);void 0!==er&&(er.count-=1,0===er.count?this.socketChildren.delete(et.id):this.socketChildren.set(et.id,er))}}}getChildLists(){let et=[];for(let{ref:er}of this.channelChildren.values())et.push(er);let er=[];for(let{ref:et}of this.subchannelChildren.values())er.push(et);let en=[];for(let{ref:et}of this.socketChildren.values())en.push(et);return{channels:et,subchannels:er,sockets:en}}}er.ChannelzChildrenTracker=ey;class ev{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}er.ChannelzCallTracker=ev;let eb=1;function eS(){return eb++}let eT=[],ew=[],eE=[],eC=[];function e_(et,er,en){let ei=eS(),es={id:ei,name:et,kind:"channel"};return en&&(eT[ei]={ref:es,getInfo:er}),es}function eI(et,er,en){let ei=eS(),es={id:ei,name:et,kind:"subchannel"};return en&&(ew[ei]={ref:es,getInfo:er}),es}function ek(et,er){let en=eS(),ei={id:en,kind:"server"};return er&&(eE[en]={ref:ei,getInfo:et}),ei}function ex(et,er,en){let ei=eS(),es={id:ei,name:et,kind:"socket"};return en&&(eC[ei]={ref:es,getInfo:er}),es}function eA(et){switch(et.kind){case"channel":delete eT[et.id];return;case"subchannel":delete ew[et.id];return;case"server":delete eE[et.id];return;case"socket":delete eC[et.id];return}}function eR(et){let er=Number.parseInt(et,16);return[er/256|0,er%256]}function eD(et){if(""===et)return[];let er=et.split(":").map(et=>eR(et)),en=[];return en.concat(...er)}function eO(et){if((0,ei.isIPv4)(et))return Buffer.from(Uint8Array.from(et.split(".").map(et=>Number.parseInt(et))));if(!(0,ei.isIPv6)(et))return null;{let er,en;let ei=et.indexOf("::");-1===ei?(er=et,en=""):(er=et.substring(0,ei),en=et.substring(ei+2));let es=Buffer.from(eD(er)),ea=Buffer.from(eD(en)),eo=Buffer.alloc(16-es.length-ea.length,0);return Buffer.concat([es,eo,ea])}}function eN(et){switch(et){case es.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case es.ConnectivityState.IDLE:return{state:"IDLE"};case es.ConnectivityState.READY:return{state:"READY"};case es.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case es.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function eM(et){if(!et)return null;let er=et.getTime();return{seconds:er/1e3|0,nanos:er%1e3*1e6}}function eP(et){let er=et.getInfo();return{ref:eh(et.ref),data:{target:er.target,state:eN(er.state),calls_started:er.callTracker.callsStarted,calls_succeeded:er.callTracker.callsSucceeded,calls_failed:er.callTracker.callsFailed,last_call_started_timestamp:eM(er.callTracker.lastCallStartedTimestamp),trace:er.trace.getTraceMessage()},channel_ref:er.children.channels.map(et=>eh(et)),subchannel_ref:er.children.subchannels.map(et=>ed(et))}}function eL(et,er){let en=Number.parseInt(et.request.channel_id),ei=eT[en];if(void 0===ei){er({code:ea.Status.NOT_FOUND,details:"No channel data found for id "+en});return}er(null,{channel:eP(ei)})}function eF(et,er){let en=Number.parseInt(et.request.max_results),ei=[],es=Number.parseInt(et.request.start_channel_id);for(;es<eT.length;es++){let et=eT[es];if(void 0!==et&&(ei.push(eP(et)),ei.length>=en))break}er(null,{channel:ei,end:es>=eE.length})}function eB(et){let er=et.getInfo();return{ref:ep(et.ref),data:{calls_started:er.callTracker.callsStarted,calls_succeeded:er.callTracker.callsSucceeded,calls_failed:er.callTracker.callsFailed,last_call_started_timestamp:eM(er.callTracker.lastCallStartedTimestamp),trace:er.trace.getTraceMessage()},listen_socket:er.listenerChildren.sockets.map(et=>ef(et))}}function ej(et,er){let en=Number.parseInt(et.request.server_id),ei=eE[en];if(void 0===ei){er({code:ea.Status.NOT_FOUND,details:"No server data found for id "+en});return}er(null,{server:eB(ei)})}function eU(et,er){let en=Number.parseInt(et.request.max_results),ei=[],es=Number.parseInt(et.request.start_server_id);for(;es<eE.length;es++){let et=eE[es];if(void 0!==et&&(ei.push(eB(et)),ei.length>=en))break}er(null,{server:ei,end:es>=eE.length})}function eV(et,er){let en=Number.parseInt(et.request.subchannel_id),ei=ew[en];if(void 0===ei){er({code:ea.Status.NOT_FOUND,details:"No subchannel data found for id "+en});return}let es=ei.getInfo(),eo={ref:ed(ei.ref),data:{target:es.target,state:eN(es.state),calls_started:es.callTracker.callsStarted,calls_succeeded:es.callTracker.callsSucceeded,calls_failed:es.callTracker.callsFailed,last_call_started_timestamp:eM(es.callTracker.lastCallStartedTimestamp),trace:es.trace.getTraceMessage()},socket_ref:es.children.sockets.map(et=>ef(et))};er(null,{subchannel:eo})}function ez(et){var er;return(0,eo.isTcpSubchannelAddress)(et)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(er=eO(et.host))&&void 0!==er?er:void 0,port:et.port}}:{address:"uds_address",uds_address:{filename:et.path}}}function e$(et,er){var en,ei,es,eo,eu;let ec=Number.parseInt(et.request.socket_id),eh=eC[ec];if(void 0===eh){er({code:ea.Status.NOT_FOUND,details:"No socket data found for id "+ec});return}let ed=eh.getInfo(),ep=ed.security?{model:"tls",tls:{cipher_suite:ed.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(en=ed.security.cipherSuiteStandardName)&&void 0!==en?en:void 0,other_name:null!==(ei=ed.security.cipherSuiteOtherName)&&void 0!==ei?ei:void 0,local_certificate:null!==(es=ed.security.localCertificate)&&void 0!==es?es:void 0,remote_certificate:null!==(eo=ed.security.remoteCertificate)&&void 0!==eo?eo:void 0}}:null,em={ref:ef(eh.ref),local:ed.localAddress?ez(ed.localAddress):null,remote:ed.remoteAddress?ez(ed.remoteAddress):null,remote_name:null!==(eu=ed.remoteName)&&void 0!==eu?eu:void 0,security:ep,data:{keep_alives_sent:ed.keepAlivesSent,streams_started:ed.streamsStarted,streams_succeeded:ed.streamsSucceeded,streams_failed:ed.streamsFailed,last_local_stream_created_timestamp:eM(ed.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:eM(ed.lastRemoteStreamCreatedTimestamp),messages_received:ed.messagesReceived,messages_sent:ed.messagesSent,last_message_received_timestamp:eM(ed.lastMessageReceivedTimestamp),last_message_sent_timestamp:eM(ed.lastMessageSentTimestamp),local_flow_control_window:ed.localFlowControlWindow?{value:ed.localFlowControlWindow}:null,remote_flow_control_window:ed.remoteFlowControlWindow?{value:ed.remoteFlowControlWindow}:null}};er(null,{socket:em})}function eG(et,er){let en=Number.parseInt(et.request.server_id),ei=eE[en];if(void 0===ei){er({code:ea.Status.NOT_FOUND,details:"No server data found for id "+en});return}let es=Number.parseInt(et.request.start_socket_id),eo=Number.parseInt(et.request.max_results),eu=ei.getInfo(),ec=eu.sessionChildren.sockets.sort((et,er)=>et.id-er.id),eh=[],ed=0;for(;ed<ec.length&&(!(ec[ed].id>=es)||(eh.push(ef(ec[ed])),!(eh.length>=eo)));ed++);er(null,{socket_ref:eh,end:ed>=ec.length})}function eK(){return{GetChannel:eL,GetTopChannels:eF,GetServer:ej,GetServers:eU,GetSubchannel:eV,GetSocket:e$,GetServerSockets:eG}}er.registerChannelzChannel=e_,er.registerChannelzSubchannel=eI,er.registerChannelzServer=ek,er.registerChannelzSocket=ex,er.unregisterChannelzRef=eA,er.getChannelzHandlers=eK;let eH=null;function eW(){if(eH)return eH;let et=en(18196).J_,er=et("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]}),ei=(0,ec.loadPackageDefinition)(er);return eH=ei.grpc.channelz.v1.Channelz.service}function eQ(){(0,eu.registerAdminService)(eW,eK)}er.getChannelzServiceDefinition=eW,er.setup=eQ},72158:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.getInterceptingCall=er.InterceptingCall=er.RequesterBuilder=er.ListenerBuilder=er.InterceptorConfigurationError=void 0;let ei=en(32908),es=en(88577),ea=en(69238),eo=en(9006);class eu extends Error{constructor(et){super(et),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,eu)}}er.InterceptorConfigurationError=eu;class ec{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(et){return this.metadata=et,this}withOnReceiveMessage(et){return this.message=et,this}withOnReceiveStatus(et){return this.status=et,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}er.ListenerBuilder=ec;class eh{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(et){return this.start=et,this}withSendMessage(et){return this.message=et,this}withHalfClose(et){return this.halfClose=et,this}withCancel(et){return this.cancel=et,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}er.RequesterBuilder=eh;let ed={onReceiveMetadata:(et,er)=>{er(et)},onReceiveMessage:(et,er)=>{er(et)},onReceiveStatus:(et,er)=>{er(et)}},ep={start:(et,er,en)=>{en(et,er)},sendMessage:(et,er)=>{er(et)},halfClose:et=>{et()},cancel:et=>{et()}};class ef{constructor(et,er){var en,ei,es,ea;this.nextCall=et,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,er?this.requester={start:null!==(en=er.start)&&void 0!==en?en:ep.start,sendMessage:null!==(ei=er.sendMessage)&&void 0!==ei?ei:ep.sendMessage,halfClose:null!==(es=er.halfClose)&&void 0!==es?es:ep.halfClose,cancel:null!==(ea=er.cancel)&&void 0!==ea?ea:ep.cancel}:this.requester=ep}cancelWithStatus(et,er){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(et,er)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(et,er){var en,ei,ea,eo,eu,ec;let eh={onReceiveMetadata:null!==(ei=null===(en=null==er?void 0:er.onReceiveMetadata)||void 0===en?void 0:en.bind(er))&&void 0!==ei?ei:et=>{},onReceiveMessage:null!==(eo=null===(ea=null==er?void 0:er.onReceiveMessage)||void 0===ea?void 0:ea.bind(er))&&void 0!==eo?eo:et=>{},onReceiveStatus:null!==(ec=null===(eu=null==er?void 0:er.onReceiveStatus)||void 0===eu?void 0:eu.bind(er))&&void 0!==ec?ec:et=>{}};this.processingMetadata=!0,this.requester.start(et,eh,(et,er)=>{var en,ei,ea;let eo;if(this.processingMetadata=!1,(0,es.isInterceptingListener)(er))eo=er;else{let et={onReceiveMetadata:null!==(en=er.onReceiveMetadata)&&void 0!==en?en:ed.onReceiveMetadata,onReceiveMessage:null!==(ei=er.onReceiveMessage)&&void 0!==ei?ei:ed.onReceiveMessage,onReceiveStatus:null!==(ea=er.onReceiveStatus)&&void 0!==ea?ea:ed.onReceiveStatus};eo=new es.InterceptingListenerImpl(et,eh)}this.nextCall.start(et,eo),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(et,er){this.processingMessage=!0,this.requester.sendMessage(er,en=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=et,this.pendingMessage=er):(this.nextCall.sendMessageWithContext(et,en),this.processPendingHalfClose())})}sendMessage(et){this.sendMessageWithContext({},et)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function em(et,er,en){var ei,es;let ea=null!==(ei=en.deadline)&&void 0!==ei?ei:1/0,eo=en.host,eu=null!==(es=en.parent)&&void 0!==es?es:null,ec=en.propagate_flags,eh=en.credentials,ed=et.createCall(er,ea,eo,eu,ec);return eh&&ed.setCredentials(eh),ed}er.InterceptingCall=ef;class eg{constructor(et,er){this.call=et,this.methodDefinition=er}cancelWithStatus(et,er){this.call.cancelWithStatus(et,er)}getPeer(){return this.call.getPeer()}sendMessageWithContext(et,er){let en;try{en=this.methodDefinition.requestSerialize(er)}catch(et){this.call.cancelWithStatus(ea.Status.INTERNAL,`Request message serialization failure: ${(0,eo.getErrorMessage)(et)}`);return}this.call.sendMessageWithContext(et,en)}sendMessage(et){this.sendMessageWithContext({},et)}start(et,er){let en=null;this.call.start(et,{onReceiveMetadata:et=>{var en;null===(en=null==er?void 0:er.onReceiveMetadata)||void 0===en||en.call(er,et)},onReceiveMessage:et=>{var es;let eu;try{eu=this.methodDefinition.responseDeserialize(et)}catch(et){en={code:ea.Status.INTERNAL,details:`Response message parsing error: ${(0,eo.getErrorMessage)(et)}`,metadata:new ei.Metadata},this.call.cancelWithStatus(en.code,en.details);return}null===(es=null==er?void 0:er.onReceiveMessage)||void 0===es||es.call(er,eu)},onReceiveStatus:et=>{var ei,es;en?null===(ei=null==er?void 0:er.onReceiveStatus)||void 0===ei||ei.call(er,en):null===(es=null==er?void 0:er.onReceiveStatus)||void 0===es||es.call(er,et)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class ey extends eg{constructor(et,er){super(et,er)}start(et,er){var en,ei;let es=!1,ea={onReceiveMetadata:null!==(ei=null===(en=null==er?void 0:er.onReceiveMetadata)||void 0===en?void 0:en.bind(er))&&void 0!==ei?ei:et=>{},onReceiveMessage:et=>{var en;es=!0,null===(en=null==er?void 0:er.onReceiveMessage)||void 0===en||en.call(er,et)},onReceiveStatus:et=>{var en,ei;es||null===(en=null==er?void 0:er.onReceiveMessage)||void 0===en||en.call(er,null),null===(ei=null==er?void 0:er.onReceiveStatus)||void 0===ei||ei.call(er,et)}};super.start(et,ea),this.call.startRead()}}class ev extends eg{}function eb(et,er,en){let ei=em(et,en.path,er);return en.responseStream?new ev(ei,en):new ey(ei,en)}function eS(et,er,en,ei){if(et.clientInterceptors.length>0&&et.clientInterceptorProviders.length>0)throw new eu("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(et.callInterceptors.length>0&&et.callInterceptorProviders.length>0)throw new eu("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let es=[];es=et.callInterceptors.length>0||et.callInterceptorProviders.length>0?[].concat(et.callInterceptors,et.callInterceptorProviders.map(et=>et(er))).filter(et=>et):[].concat(et.clientInterceptors,et.clientInterceptorProviders.map(et=>et(er))).filter(et=>et);let ea=Object.assign({},en,{method_definition:er}),eo=es.reduceRight((et,er)=>en=>er(en,et),et=>eb(ei,et,er));return eo(ea)}er.getInterceptingCall=eS},47307:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Client=void 0;let ei=en(12953),es=en(49914),ea=en(91360),eo=en(69238),eu=en(32908),ec=en(72158),eh=Symbol(),ed=Symbol(),ep=Symbol(),ef=Symbol();function em(et){return"function"==typeof et}function eg(et){return et.stack.split("\n").slice(1).join("\n")}class ey{constructor(et,er,en={}){var ei,ea;if(en=Object.assign({},en),this[ed]=null!==(ei=en.interceptors)&&void 0!==ei?ei:[],delete en.interceptors,this[ep]=null!==(ea=en.interceptor_providers)&&void 0!==ea?ea:[],delete en.interceptor_providers,this[ed].length>0&&this[ep].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[ef]=en.callInvocationTransformer,delete en.callInvocationTransformer,en.channelOverride)this[eh]=en.channelOverride;else if(en.channelFactoryOverride){let ei=en.channelFactoryOverride;delete en.channelFactoryOverride,this[eh]=ei(et,er,en)}else this[eh]=new es.ChannelImplementation(et,er,en)}close(){this[eh].close()}getChannel(){return this[eh]}waitForReady(et,er){let en=ei=>{let es;if(ei){er(Error("Failed to connect before the deadline"));return}try{es=this[eh].getConnectivityState(!0)}catch(et){er(Error("The channel has been closed"));return}if(es===ea.ConnectivityState.READY)er();else try{this[eh].watchConnectivityState(es,et,en)}catch(et){er(Error("The channel has been closed"))}};setImmediate(en)}checkOptionalUnaryResponseArguments(et,er,en){if(em(et))return{metadata:new eu.Metadata,options:{},callback:et};if(em(er))return et instanceof eu.Metadata?{metadata:et,options:{},callback:er}:{metadata:new eu.Metadata,options:et,callback:er};if(!(et instanceof eu.Metadata&&er instanceof Object&&em(en)))throw Error("Incorrect arguments passed");return{metadata:et,options:er,callback:en}}makeUnaryRequest(et,er,en,es,ea,eu,em){var ey,ev;let eb=this.checkOptionalUnaryResponseArguments(ea,eu,em),eS={path:et,requestStream:!1,responseStream:!1,requestSerialize:er,responseDeserialize:en},eT={argument:es,metadata:eb.metadata,call:new ei.ClientUnaryCallImpl,channel:this[eh],methodDefinition:eS,callOptions:eb.options,callback:eb.callback};this[ef]&&(eT=this[ef](eT));let ew=eT.call,eE={clientInterceptors:this[ed],clientInterceptorProviders:this[ep],callInterceptors:null!==(ey=eT.callOptions.interceptors)&&void 0!==ey?ey:[],callInterceptorProviders:null!==(ev=eT.callOptions.interceptor_providers)&&void 0!==ev?ev:[]},eC=(0,ec.getInterceptingCall)(eE,eT.methodDefinition,eT.callOptions,eT.channel);ew.call=eC;let e_=null,eI=!1,ek=Error();return eC.start(eT.metadata,{onReceiveMetadata:et=>{ew.emit("metadata",et)},onReceiveMessage(et){null!==e_&&eC.cancelWithStatus(eo.Status.INTERNAL,"Too many responses received"),e_=et},onReceiveStatus(et){if(!eI){if(eI=!0,et.code===eo.Status.OK){if(null===e_){let er=eg(ek);eT.callback((0,ei.callErrorFromStatus)({code:eo.Status.INTERNAL,details:"No message received",metadata:et.metadata},er))}else eT.callback(null,e_)}else{let er=eg(ek);eT.callback((0,ei.callErrorFromStatus)(et,er))}ek=null,ew.emit("status",et)}}}),eC.sendMessage(es),eC.halfClose(),ew}makeClientStreamRequest(et,er,en,es,ea,eu){var em,ey;let ev=this.checkOptionalUnaryResponseArguments(es,ea,eu),eb={path:et,requestStream:!0,responseStream:!1,requestSerialize:er,responseDeserialize:en},eS={metadata:ev.metadata,call:new ei.ClientWritableStreamImpl(er),channel:this[eh],methodDefinition:eb,callOptions:ev.options,callback:ev.callback};this[ef]&&(eS=this[ef](eS));let eT=eS.call,ew={clientInterceptors:this[ed],clientInterceptorProviders:this[ep],callInterceptors:null!==(em=eS.callOptions.interceptors)&&void 0!==em?em:[],callInterceptorProviders:null!==(ey=eS.callOptions.interceptor_providers)&&void 0!==ey?ey:[]},eE=(0,ec.getInterceptingCall)(ew,eS.methodDefinition,eS.callOptions,eS.channel);eT.call=eE;let eC=null,e_=!1,eI=Error();return eE.start(eS.metadata,{onReceiveMetadata:et=>{eT.emit("metadata",et)},onReceiveMessage(et){null!==eC&&eE.cancelWithStatus(eo.Status.INTERNAL,"Too many responses received"),eC=et},onReceiveStatus(et){if(!e_){if(e_=!0,et.code===eo.Status.OK){if(null===eC){let er=eg(eI);eS.callback((0,ei.callErrorFromStatus)({code:eo.Status.INTERNAL,details:"No message received",metadata:et.metadata},er))}else eS.callback(null,eC)}else{let er=eg(eI);eS.callback((0,ei.callErrorFromStatus)(et,er))}eI=null,eT.emit("status",et)}}}),eT}checkMetadataAndOptions(et,er){let en,ei;return et instanceof eu.Metadata?(en=et,ei=er||{}):(ei=et||{},en=new eu.Metadata),{metadata:en,options:ei}}makeServerStreamRequest(et,er,en,es,ea,eu){var em,ey;let ev=this.checkMetadataAndOptions(ea,eu),eb={path:et,requestStream:!1,responseStream:!0,requestSerialize:er,responseDeserialize:en},eS={argument:es,metadata:ev.metadata,call:new ei.ClientReadableStreamImpl(en),channel:this[eh],methodDefinition:eb,callOptions:ev.options};this[ef]&&(eS=this[ef](eS));let eT=eS.call,ew={clientInterceptors:this[ed],clientInterceptorProviders:this[ep],callInterceptors:null!==(em=eS.callOptions.interceptors)&&void 0!==em?em:[],callInterceptorProviders:null!==(ey=eS.callOptions.interceptor_providers)&&void 0!==ey?ey:[]},eE=(0,ec.getInterceptingCall)(ew,eS.methodDefinition,eS.callOptions,eS.channel);eT.call=eE;let eC=!1,e_=Error();return eE.start(eS.metadata,{onReceiveMetadata(et){eT.emit("metadata",et)},onReceiveMessage(et){eT.push(et)},onReceiveStatus(et){if(!eC){if(eC=!0,eT.push(null),et.code!==eo.Status.OK){let er=eg(e_);eT.emit("error",(0,ei.callErrorFromStatus)(et,er))}e_=null,eT.emit("status",et)}}}),eE.sendMessage(es),eE.halfClose(),eT}makeBidiStreamRequest(et,er,en,es,ea){var eu,em;let ey=this.checkMetadataAndOptions(es,ea),ev={path:et,requestStream:!0,responseStream:!0,requestSerialize:er,responseDeserialize:en},eb={metadata:ey.metadata,call:new ei.ClientDuplexStreamImpl(er,en),channel:this[eh],methodDefinition:ev,callOptions:ey.options};this[ef]&&(eb=this[ef](eb));let eS=eb.call,eT={clientInterceptors:this[ed],clientInterceptorProviders:this[ep],callInterceptors:null!==(eu=eb.callOptions.interceptors)&&void 0!==eu?eu:[],callInterceptorProviders:null!==(em=eb.callOptions.interceptor_providers)&&void 0!==em?em:[]},ew=(0,ec.getInterceptingCall)(eT,eb.methodDefinition,eb.callOptions,eb.channel);eS.call=ew;let eE=!1,eC=Error();return ew.start(eb.metadata,{onReceiveMetadata(et){eS.emit("metadata",et)},onReceiveMessage(et){eS.push(et)},onReceiveStatus(et){if(!eE){if(eE=!0,eS.push(null),et.code!==eo.Status.OK){let er=eg(eC);eS.emit("error",(0,ei.callErrorFromStatus)(et,er))}eC=null,eS.emit("status",et)}}}),eS}}er.Client=ey},56702:(et,er)=>{"use strict";var en;Object.defineProperty(er,"__esModule",{value:!0}),er.CompressionAlgorithms=void 0,function(et){et[et.identity=0]="identity",et[et.deflate=1]="deflate",et[et.gzip=2]="gzip"}(en||(er.CompressionAlgorithms=en={}))},69718:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.CompressionFilterFactory=er.CompressionFilter=void 0;let ei=en(59796),es=en(56702),ea=en(69238),eo=en(81818),eu=en(68200),ec=et=>"number"==typeof et&&"string"==typeof es.CompressionAlgorithms[et];class eh{async writeMessage(et,er){let en=et;er&&(en=await this.compressMessage(en));let ei=Buffer.allocUnsafe(en.length+5);return ei.writeUInt8(er?1:0,0),ei.writeUInt32BE(en.length,1),en.copy(ei,5),ei}async readMessage(et){let er=1===et.readUInt8(0),en=et.slice(5);return er&&(en=await this.decompressMessage(en)),en}}class ed extends eh{async compressMessage(et){return et}async writeMessage(et,er){let en=Buffer.allocUnsafe(et.length+5);return en.writeUInt8(0,0),en.writeUInt32BE(et.length,1),et.copy(en,5),en}decompressMessage(et){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class ep extends eh{constructor(et){super(),this.maxRecvMessageLength=et}compressMessage(et){return new Promise((er,en)=>{ei.deflate(et,(et,ei)=>{et?en(et):er(ei)})})}decompressMessage(et){return new Promise((er,en)=>{let es=0,eo=[],eu=ei.createInflate();eu.on("data",et=>{eo.push(et),es+=et.byteLength,-1!==this.maxRecvMessageLength&&es>this.maxRecvMessageLength&&(eu.destroy(),en({code:ea.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),eu.on("end",()=>{er(Buffer.concat(eo))}),eu.write(et),eu.end()})}}class ef extends eh{constructor(et){super(),this.maxRecvMessageLength=et}compressMessage(et){return new Promise((er,en)=>{ei.gzip(et,(et,ei)=>{et?en(et):er(ei)})})}decompressMessage(et){return new Promise((er,en)=>{let es=0,eo=[],eu=ei.createGunzip();eu.on("data",et=>{eo.push(et),es+=et.byteLength,-1!==this.maxRecvMessageLength&&es>this.maxRecvMessageLength&&(eu.destroy(),en({code:ea.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),eu.on("end",()=>{er(Buffer.concat(eo))}),eu.write(et),eu.end()})}}class em extends eh{constructor(et){super(),this.compressionName=et}compressMessage(et){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(et){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function eg(et,er){switch(et){case"identity":return new ed;case"deflate":return new ep(er);case"gzip":return new ef(er);default:return new em(et)}}class ey extends eo.BaseFilter{constructor(et,er){var en,ei;super(),this.sharedFilterConfig=er,this.sendCompression=new ed,this.receiveCompression=new ed,this.currentCompressionAlgorithm="identity";let eo=et["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!==(en=et["grpc.max_receive_message_length"])&&void 0!==en?en:ea.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==eo){if(ec(eo)){let et=es.CompressionAlgorithms[eo],en=null===(ei=er.serverSupportedEncodingHeader)||void 0===ei?void 0:ei.split(",");(!en||en.includes(et))&&(this.currentCompressionAlgorithm=et,this.sendCompression=eg(this.currentCompressionAlgorithm,-1))}else eu.log(ea.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${eo}`)}}async sendMetadata(et){let er=await et;return er.set("grpc-accept-encoding","identity,deflate,gzip"),er.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?er.remove("grpc-encoding"):er.set("grpc-encoding",this.currentCompressionAlgorithm),er}receiveMetadata(et){let er=et.get("grpc-encoding");if(er.length>0){let et=er[0];"string"==typeof et&&(this.receiveCompression=eg(et,this.maxReceiveMessageLength))}et.remove("grpc-encoding");let en=et.get("grpc-accept-encoding")[0];if(en){this.sharedFilterConfig.serverSupportedEncodingHeader=en;let et=en.split(",");et.includes(this.currentCompressionAlgorithm)||(this.sendCompression=new ed,this.currentCompressionAlgorithm="identity")}return et.remove("grpc-accept-encoding"),et}async sendMessage(et){var er;let en;let ei=await et;return en=!(this.sendCompression instanceof ed)&&((null!==(er=ei.flags)&&void 0!==er?er:0)&2)==0,{message:await this.sendCompression.writeMessage(ei.message,en),flags:ei.flags}}async receiveMessage(et){return this.receiveCompression.readMessage(await et)}}er.CompressionFilter=ey;class ev{constructor(et,er){this.options=er,this.sharedFilterConfig={}}createFilter(){return new ey(this.options,this.sharedFilterConfig)}}er.CompressionFilterFactory=ev},91360:(et,er)=>{"use strict";var en;Object.defineProperty(er,"__esModule",{value:!0}),er.ConnectivityState=void 0,function(et){et[et.IDLE=0]="IDLE",et[et.CONNECTING=1]="CONNECTING",et[et.READY=2]="READY",et[et.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",et[et.SHUTDOWN=4]="SHUTDOWN"}(en||(er.ConnectivityState=en={}))},69238:(et,er)=>{"use strict";var en,ei,es;Object.defineProperty(er,"__esModule",{value:!0}),er.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=er.DEFAULT_MAX_SEND_MESSAGE_LENGTH=er.Propagate=er.LogVerbosity=er.Status=void 0,function(et){et[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(en||(er.Status=en={})),function(et){et[et.DEBUG=0]="DEBUG",et[et.INFO=1]="INFO",et[et.ERROR=2]="ERROR",et[et.NONE=3]="NONE"}(ei||(er.LogVerbosity=ei={})),function(et){et[et.DEADLINE=1]="DEADLINE",et[et.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",et[et.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",et[et.CANCELLATION=8]="CANCELLATION",et[et.DEFAULTS=65535]="DEFAULTS"}(es||(er.Propagate=es={})),er.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,er.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},6614:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.restrictControlPlaneStatusCode=void 0;let ei=en(69238),es=[ei.Status.OK,ei.Status.INVALID_ARGUMENT,ei.Status.NOT_FOUND,ei.Status.ALREADY_EXISTS,ei.Status.FAILED_PRECONDITION,ei.Status.ABORTED,ei.Status.OUT_OF_RANGE,ei.Status.DATA_LOSS];function ea(et,er){return es.includes(et)?{code:ei.Status.INTERNAL,details:`Invalid status from control plane: ${et} ${ei.Status[et]} ${er}`}:{code:et,details:er}}er.restrictControlPlaneStatusCode=ea},50823:(et,er)=>{"use strict";function en(...et){let er=1/0;for(let en of et){let et=en instanceof Date?en.getTime():en;et<er&&(er=et)}return er}Object.defineProperty(er,"__esModule",{value:!0}),er.deadlineToString=er.getRelativeTimeout=er.getDeadlineTimeoutString=er.minDeadline=void 0,er.minDeadline=en;let ei=[["m",1],["S",1e3],["M",6e4],["H",36e5]];function es(et){let er=new Date().getTime();et instanceof Date&&(et=et.getTime());let en=Math.max(et-er,0);for(let[et,er]of ei){let ei=en/er;if(ei<1e8)return String(Math.ceil(ei))+et}throw Error("Deadline is too far in the future")}er.getDeadlineTimeoutString=es;let ea=2147483647;function eo(et){let er=et instanceof Date?et.getTime():et,en=new Date().getTime(),ei=er-en;return ei<0?0:ei>ea?1/0:ei}function eu(et){if(et instanceof Date)return et.toISOString();{let er=new Date(et);return Number.isNaN(er.getTime())?""+et:er.toISOString()}}er.getRelativeTimeout=eo,er.deadlineToString=eu},89589:(et,er)=>{"use strict";function en(et){return{seconds:et/1e3|0,nanos:et%1e3*1e6|0}}function ei(et){return 1e3*et.seconds+et.nanos/1e6|0}function es(et){return"number"==typeof et.seconds&&"number"==typeof et.nanos}Object.defineProperty(er,"__esModule",{value:!0}),er.isDuration=er.durationToMs=er.msToDuration=void 0,er.msToDuration=en,er.durationToMs=ei,er.isDuration=es},9006:(et,er)=>{"use strict";function en(et){return et instanceof Error?et.message:String(et)}function ei(et){return"object"==typeof et&&null!==et&&"code"in et&&"number"==typeof et.code?et.code:null}Object.defineProperty(er,"__esModule",{value:!0}),er.getErrorCode=er.getErrorMessage=void 0,er.getErrorMessage=en,er.getErrorCode=ei},86868:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.OutlierDetectionLoadBalancingConfig=er.BaseSubchannelWrapper=er.registerAdminService=er.FilterStackFactory=er.BaseFilter=er.PickResultType=er.QueuePicker=er.UnavailablePicker=er.ChildLoadBalancerHandler=er.subchannelAddressToString=er.validateLoadBalancingConfig=er.getFirstUsableConfig=er.registerLoadBalancerType=er.createChildChannelControlHelper=er.BackoffTimeout=er.durationToMs=er.uriToString=er.createResolver=er.registerResolver=er.log=er.trace=void 0;var ei=en(68200);Object.defineProperty(er,"trace",{enumerable:!0,get:function(){return ei.trace}}),Object.defineProperty(er,"log",{enumerable:!0,get:function(){return ei.log}});var es=en(14755);Object.defineProperty(er,"registerResolver",{enumerable:!0,get:function(){return es.registerResolver}}),Object.defineProperty(er,"createResolver",{enumerable:!0,get:function(){return es.createResolver}});var ea=en(14717);Object.defineProperty(er,"uriToString",{enumerable:!0,get:function(){return ea.uriToString}});var eo=en(89589);Object.defineProperty(er,"durationToMs",{enumerable:!0,get:function(){return eo.durationToMs}});var eu=en(77257);Object.defineProperty(er,"BackoffTimeout",{enumerable:!0,get:function(){return eu.BackoffTimeout}});var ec=en(77203);Object.defineProperty(er,"createChildChannelControlHelper",{enumerable:!0,get:function(){return ec.createChildChannelControlHelper}}),Object.defineProperty(er,"registerLoadBalancerType",{enumerable:!0,get:function(){return ec.registerLoadBalancerType}}),Object.defineProperty(er,"getFirstUsableConfig",{enumerable:!0,get:function(){return ec.getFirstUsableConfig}}),Object.defineProperty(er,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return ec.validateLoadBalancingConfig}});var eh=en(72782);Object.defineProperty(er,"subchannelAddressToString",{enumerable:!0,get:function(){return eh.subchannelAddressToString}});var ed=en(38390);Object.defineProperty(er,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return ed.ChildLoadBalancerHandler}});var ep=en(32939);Object.defineProperty(er,"UnavailablePicker",{enumerable:!0,get:function(){return ep.UnavailablePicker}}),Object.defineProperty(er,"QueuePicker",{enumerable:!0,get:function(){return ep.QueuePicker}}),Object.defineProperty(er,"PickResultType",{enumerable:!0,get:function(){return ep.PickResultType}});var ef=en(81818);Object.defineProperty(er,"BaseFilter",{enumerable:!0,get:function(){return ef.BaseFilter}});var em=en(4213);Object.defineProperty(er,"FilterStackFactory",{enumerable:!0,get:function(){return em.FilterStackFactory}});var eg=en(1605);Object.defineProperty(er,"registerAdminService",{enumerable:!0,get:function(){return eg.registerAdminService}});var ey=en(69609);Object.defineProperty(er,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return ey.BaseSubchannelWrapper}});var ev=en(35683);Object.defineProperty(er,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return ev.OutlierDetectionLoadBalancingConfig}})},4213:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.FilterStackFactory=er.FilterStack=void 0;class en{constructor(et){this.filters=et}sendMetadata(et){let er=et;for(let et=0;et<this.filters.length;et++)er=this.filters[et].sendMetadata(er);return er}receiveMetadata(et){let er=et;for(let et=this.filters.length-1;et>=0;et--)er=this.filters[et].receiveMetadata(er);return er}sendMessage(et){let er=et;for(let et=0;et<this.filters.length;et++)er=this.filters[et].sendMessage(er);return er}receiveMessage(et){let er=et;for(let et=this.filters.length-1;et>=0;et--)er=this.filters[et].receiveMessage(er);return er}receiveTrailers(et){let er=et;for(let et=this.filters.length-1;et>=0;et--)er=this.filters[et].receiveTrailers(er);return er}push(et){this.filters.unshift(...et)}getFilters(){return this.filters}}er.FilterStack=en;class ei{constructor(et){this.factories=et}push(et){this.factories.unshift(...et)}clone(){return new ei([...this.factories])}createFilter(){return new en(this.factories.map(et=>et.createFilter()))}}er.FilterStackFactory=ei},81818:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.BaseFilter=void 0;class en{async sendMetadata(et){return et}receiveMetadata(et){return et}async sendMessage(et){return et}async receiveMessage(et){return et}receiveTrailers(et){return et}}er.BaseFilter=en},18304:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.getProxiedConnection=er.mapProxyName=void 0;let ei=en(68200),es=en(69238),ea=en(14755),eo=en(13685),eu=en(24404),ec=en(68200),eh=en(72782),ed=en(14717),ep=en(57310),ef=en(84988),em="proxy";function eg(et){ec.trace(es.LogVerbosity.DEBUG,em,et)}function ey(){let et,er="",en="";if(process.env.grpc_proxy)en="grpc_proxy",er=process.env.grpc_proxy;else if(process.env.https_proxy)en="https_proxy",er=process.env.https_proxy;else{if(!process.env.http_proxy)return{};en="http_proxy",er=process.env.http_proxy}try{et=new ep.URL(er)}catch(et){return(0,ei.log)(es.LogVerbosity.ERROR,`cannot parse value of "${en}" env var`),{}}if("http:"!==et.protocol)return(0,ei.log)(es.LogVerbosity.ERROR,`"${et.protocol}" scheme not supported in proxy URI`),{};let ea=null;et.username&&(et.password?((0,ei.log)(es.LogVerbosity.INFO,"userinfo found in proxy URI"),ea=`${et.username}:${et.password}`):ea=et.username);let eo=et.hostname,eu=et.port;""===eu&&(eu="80");let ec={address:`${eo}:${eu}`};return ea&&(ec.creds=ea),eg("Proxy server "+ec.address+" set by environment variable "+en),ec}function ev(){let et=process.env.no_grpc_proxy,er="no_grpc_proxy";return(et||(et=process.env.no_proxy,er="no_proxy"),et)?(eg("No proxy server list set by environment variable "+er),et.split(",")):[]}function eb(et,er){var en;let ei={target:et,extraOptions:{}};if((null!==(en=er["grpc.enable_http_proxy"])&&void 0!==en?en:1)===0||"unix"===et.scheme)return ei;let es=ey();if(!es.address)return ei;let ea=(0,ed.splitHostPort)(et.path);if(!ea)return ei;let eo=ea.host;for(let er of ev())if(er===eo)return eg("Not using proxy for target in no_proxy list: "+(0,ed.uriToString)(et)),ei;let eu={"grpc.http_connect_target":(0,ed.uriToString)(et)};return es.creds&&(eu["grpc.http_connect_creds"]=es.creds),{target:{scheme:"dns",path:es.address},extraOptions:eu}}function eS(et,er,en){var ec;if(!("grpc.http_connect_target"in er))return Promise.resolve({});let ep=er["grpc.http_connect_target"],em=(0,ed.parseUri)(ep);if(null===em)return Promise.resolve({});let ey=(0,ed.splitHostPort)(em.path);if(null===ey)return Promise.resolve({});let ev=`${ey.host}:${null!==(ec=ey.port)&&void 0!==ec?ec:ef.DEFAULT_PORT}`,eb={method:"CONNECT",path:ev},eS={Host:ev};(0,eh.isTcpSubchannelAddress)(et)?(eb.host=et.host,eb.port=et.port):eb.socketPath=et.path,"grpc.http_connect_creds"in er&&(eS["Proxy-Authorization"]="Basic "+Buffer.from(er["grpc.http_connect_creds"]).toString("base64")),eb.headers=eS;let eT=(0,eh.subchannelAddressToString)(et);return eg("Using proxy "+eT+" to connect to "+eb.path),new Promise((et,er)=>{let ec=eo.request(eb);ec.once("connect",(eo,eh,ep)=>{var ef;if(ec.removeAllListeners(),eh.removeAllListeners(),200===eo.statusCode){if(eg("Successfully connected to "+eb.path+" through proxy "+eT),"secureContext"in en){let ei=(0,ea.getDefaultAuthority)(em),es=(0,ed.splitHostPort)(ei),eo=null!==(ef=null==es?void 0:es.host)&&void 0!==ef?ef:ei,ec=eu.connect(Object.assign({host:eo,servername:eo,socket:eh},en),()=>{eg("Successfully established a TLS connection to "+eb.path+" through proxy "+eT),et({socket:ec,realTarget:em})});ec.on("error",et=>{eg("Failed to establish a TLS connection to "+eb.path+" through proxy "+eT+" with error "+et.message),er()})}else eg("Successfully established a plaintext connection to "+eb.path+" through proxy "+eT),et({socket:eh,realTarget:em})}else(0,ei.log)(es.LogVerbosity.ERROR,"Failed to connect to "+eb.path+" through proxy "+eT+" with status "+eo.statusCode),er()}),ec.once("error",et=>{ec.removeAllListeners(),(0,ei.log)(es.LogVerbosity.ERROR,"Failed to connect to proxy "+eT+" with error "+et.message),er()}),ec.end()})}er.mapProxyName=eb,er.getProxiedConnection=eS},16063:(et,er,en)=>{"use strict";e_={value:!0},e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=e_=er.Rz=e_=e_=e_=e_=e_=e_=er.SF=er.K9=void 0;let ei=en(68612);e_={enumerable:!0,get:function(){return ei.CallCredentials}};let es=en(49914);e_={enumerable:!0,get:function(){return es.ChannelImplementation}};let ea=en(56702);e_={enumerable:!0,get:function(){return ea.CompressionAlgorithms}};let eo=en(91360);e_={enumerable:!0,get:function(){return eo.ConnectivityState}};let eu=en(77021);e_={enumerable:!0,get:function(){return eu.ChannelCredentials}};let ec=en(47307);e_={enumerable:!0,get:function(){return ec.Client}};let eh=en(69238);e_={enumerable:!0,get:function(){return eh.LogVerbosity}},e_={enumerable:!0,get:function(){return eh.Status}},e_={enumerable:!0,get:function(){return eh.Propagate}};let ed=en(68200),ep=en(47697);Object.defineProperty(er,"Rz",{enumerable:!0,get:function(){return ep.loadPackageDefinition}}),e_={enumerable:!0,get:function(){return ep.makeClientConstructor}},e_={enumerable:!0,get:function(){return ep.makeClientConstructor}};let ef=en(32908);Object.defineProperty(er,"SF",{enumerable:!0,get:function(){return ef.Metadata}});let em=en(92903);e_={enumerable:!0,get:function(){return em.Server}};let eg=en(62501);e_={enumerable:!0,get:function(){return eg.ServerCredentials}};let ey=en(9929);e_={enumerable:!0,get:function(){return ey.StatusBuilder}},er.K9={combineChannelCredentials:(et,...er)=>er.reduce((et,er)=>et.compose(er),et),combineCallCredentials:(et,...er)=>er.reduce((et,er)=>et.compose(er),et),createInsecure:eu.ChannelCredentials.createInsecure,createSsl:eu.ChannelCredentials.createSsl,createFromSecureContext:eu.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:ei.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:ei.CallCredentials.createFromGoogleCredential,createEmpty:ei.CallCredentials.createEmpty};let ev=et=>et.close();e_=ev;let eb=(et,er,en)=>et.waitForReady(er,en);e_=eb;let eS=(et,er)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};e_=eS;let eT=(et,er,en)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};e_=eT;let ew=et=>{ed.setLogger(et)};e_=ew;let eE=et=>{ed.setLoggerVerbosity(et)};e_=eE;let eC=et=>ec.Client.prototype.getChannel.call(et);e_=eC;var e_,eI=en(72158);e_={enumerable:!0,get:function(){return eI.ListenerBuilder}},e_={enumerable:!0,get:function(){return eI.RequesterBuilder}},e_={enumerable:!0,get:function(){return eI.InterceptingCall}},e_={enumerable:!0,get:function(){return eI.InterceptorConfigurationError}};var ek=en(83316);e_={enumerable:!0,get:function(){return ek.getChannelzServiceDefinition}},e_={enumerable:!0,get:function(){return ek.getChannelzHandlers}};var ex=en(1605);e_={enumerable:!0,get:function(){return ex.addAdminServicesToServer}};let eA=en(86868);e_=eA;let eR=en(84988),eD=en(50864),eO=en(96633),eN=en(72190),eM=en(19580),eP=en(35683),eL=en(83316);(()=>{eR.setup(),eD.setup(),eO.setup(),eN.setup(),eM.setup(),eP.setup(),eL.setup()})()},35233:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.InternalChannel=void 0;let ei=en(77021),es=en(61839),ea=en(88364),eo=en(32939),eu=en(69238),ec=en(4213),eh=en(69718),ed=en(14755),ep=en(68200),ef=en(18304),em=en(14717),eg=en(91360),ey=en(83316),ev=en(80439),eb=en(50823),eS=en(65700),eT=en(60060),ew=en(6614),eE=en(97564),eC=en(69609),e_=2147483647,eI=1e3,ek=18e5,ex=new Map,eA=16777216,eR=1048576;class eD extends eC.BaseSubchannelWrapper{constructor(et,er){super(et),this.channel=er,this.refCount=0,this.subchannelStateListener=(et,en,ei,es)=>{er.throttleKeepalive(es)},et.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class eO{constructor(et,er,en){var ev,eb,eS,eT,eC,eO,eN,eM;if(this.credentials=er,this.options=en,this.connectivityState=eg.ConnectivityState.IDLE,this.currentPicker=new eo.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new ey.ChannelzCallTracker,this.childrenTracker=new ey.ChannelzChildrenTracker,"string"!=typeof et)throw TypeError("Channel target must be a string");if(!(er instanceof ei.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(en&&"object"!=typeof en)throw TypeError("Channel options must be an object");this.originalTarget=et;let eP=(0,em.parseUri)(et);if(null===eP)throw Error(`Could not parse target name "${et}"`);let eL=(0,ed.mapUriDefaultScheme)(eP);if(null===eL)throw Error(`Could not find a default scheme for target name "${et}"`);this.callRefTimer=setInterval(()=>{},e_),null===(eb=(ev=this.callRefTimer).unref)||void 0===eb||eb.call(ev),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new ey.ChannelzTrace,this.channelzRef=(0,ey.registerChannelzChannel)(et,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,ed.getDefaultAuthority)(eL);let eF=(0,ef.mapProxyName)(eL,en);this.target=eF.target,this.options=Object.assign({},this.options,eF.extraOptions),this.subchannelPool=(0,ea.getSubchannelPool)((null!==(eS=en["grpc.use_local_subchannel_pool"])&&void 0!==eS?eS:0)===0),this.retryBufferTracker=new eE.MessageBufferTracker(null!==(eT=en["grpc.retry_buffer_size"])&&void 0!==eT?eT:eA,null!==(eC=en["grpc.per_rpc_retry_buffer_size"])&&void 0!==eC?eC:eR),this.keepaliveTime=null!==(eO=en["grpc.keepalive_time_ms"])&&void 0!==eO?eO:-1,this.idleTimeoutMs=Math.max(null!==(eN=en["grpc.client_idle_timeout_ms"])&&void 0!==eN?eN:ek,eI);let eB={createSubchannel:(et,er)=>{let en=this.subchannelPool.getOrCreateSubchannel(this.target,et,Object.assign({},this.options,er),this.credentials);en.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",en.getChannelzRef());let ei=new eD(en,this);return this.wrappedSubchannels.add(ei),ei},updateState:(et,er)=>{this.currentPicker=er;let en=this.pickQueue.slice();for(let et of(this.pickQueue=[],en.length>0&&this.callRefTimerUnref(),en))et.doPick();this.updateState(et)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:et=>{this.channelzEnabled&&this.childrenTracker.refChild(et)},removeChannelzChild:et=>{this.channelzEnabled&&this.childrenTracker.unrefChild(et)}};this.resolvingLoadBalancer=new es.ResolvingLoadBalancer(this.target,eB,en,(et,er)=>{et.retryThrottling?ex.set(this.getTarget(),new eE.RetryThrottler(et.retryThrottling.maxTokens,et.retryThrottling.tokenRatio,ex.get(this.getTarget()))):ex.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=er,this.currentResolutionError=null,process.nextTick(()=>{let et=this.configSelectionQueue;for(let er of(this.configSelectionQueue=[],et.length>0&&this.callRefTimerUnref(),et))er.getConfig()})},et=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+et.code+' and details "'+et.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,ew.restrictControlPlaneStatusCode)(et.code,et.details)),{metadata:et.metadata}));let er=this.configSelectionQueue;for(let en of(this.configSelectionQueue=[],er.length>0&&this.callRefTimerUnref(),er))en.reportResolverError(et)}),this.filterStackFactory=new ec.FilterStackFactory([new eh.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(en,void 0,2));let ej=Error();(0,ep.trace)(eu.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(eM=ej.stack)||void 0===eM?void 0:eM.substring(ej.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(et,er){(0,ep.trace)(null!=er?er:eu.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,em.uriToString)(this.target)+" "+et)}callRefTimerRef(){var et,er,en,ei;(null===(er=(et=this.callRefTimer).hasRef)||void 0===er?void 0:er.call(et))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(ei=(en=this.callRefTimer).ref)||void 0===ei||ei.call(en))}callRefTimerUnref(){var et,er;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(er=(et=this.callRefTimer).unref)||void 0===er||er.call(et))}removeConnectivityStateWatcher(et){let er=this.connectivityStateWatchers.findIndex(er=>er===et);er>=0&&this.connectivityStateWatchers.splice(er,1)}updateState(et){(0,ep.trace)(eu.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,em.uriToString)(this.target)+" "+eg.ConnectivityState[this.connectivityState]+" -> "+eg.ConnectivityState[et]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+eg.ConnectivityState[et]),this.connectivityState=et;let er=this.connectivityStateWatchers.slice();for(let en of er)et!==en.currentState&&(en.timer&&clearTimeout(en.timer),this.removeConnectivityStateWatcher(en),en.callback());et!==eg.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(et){if(et>this.keepaliveTime)for(let er of(this.keepaliveTime=et,this.wrappedSubchannels))er.throttleKeepalive(et)}removeWrappedSubchannel(et){this.wrappedSubchannels.delete(et)}doPick(et,er){return this.currentPicker.pick({metadata:et,extraPickInfo:er})}queueCallForPick(et){this.pickQueue.push(et),this.callRefTimerRef()}getConfig(et,er){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(et,er)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(et){this.configSelectionQueue.push(et),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(eg.ConnectivityState.IDLE),this.currentPicker=new eo.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(et){var er,en;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let et=new Date,er=et.valueOf()-this.lastActivityTimestamp.valueOf();er>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-er)},et),null===(en=(er=this.idleTimer).unref)||void 0===en||en.call(er)}maybeStartIdleTimer(){this.connectivityState===eg.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(et){this.channelzEnabled&&(et.code===eu.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(et,er,en,ei,es){let ea=(0,eT.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+ea+'] method="'+er+'"'),new ev.LoadBalancingCall(this,et,er,en,ei,es,ea)}createRetryingCall(et,er,en,ei,es){let ea=(0,eT.getNextCallNumber)();return this.trace("createRetryingCall ["+ea+'] method="'+er+'"'),new eE.RetryingCall(this,et,er,en,ei,es,ea,this.retryBufferTracker,ex.get(this.getTarget()))}createInnerCall(et,er,en,ei,es){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(et,er,en,ei,es):this.createRetryingCall(et,er,en,ei,es)}createResolvingCall(et,er,en,ei,es){let ea=(0,eT.getNextCallNumber)();this.trace("createResolvingCall ["+ea+'] method="'+et+'", deadline='+(0,eb.deadlineToString)(er));let eo={deadline:er,flags:null!=es?es:eu.Propagate.DEFAULTS,host:null!=en?en:this.defaultAuthority,parentCall:ei},ec=new eS.ResolvingCall(this,et,eo,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),ea);return this.onCallStart(),ec.addStatusWatcher(et=>{this.onCallEnd(et)}),ec}close(){this.resolvingLoadBalancer.destroy(),this.updateState(eg.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,ey.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,em.uriToString)(this.target)}getConnectivityState(et){let er=this.connectivityState;return et&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),er}watchConnectivityState(et,er,en){if(this.connectivityState===eg.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let ei=null;if(er!==1/0){let et=er instanceof Date?er:new Date(er),ea=new Date;if(er===-1/0||et<=ea){process.nextTick(en,Error("Deadline passed without connectivity state change"));return}ei=setTimeout(()=>{this.removeConnectivityStateWatcher(es),en(Error("Deadline passed without connectivity state change"))},et.getTime()-ea.getTime())}let es={currentState:et,callback:en,timer:ei};this.connectivityStateWatchers.push(es)}getChannelzRef(){return this.channelzRef}createCall(et,er,en,ei,es){if("string"!=typeof et)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof er||er instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===eg.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(et,er,en,ei,es)}}er.InternalChannel=eO},38390:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ChildLoadBalancerHandler=void 0;let ei=en(77203),es=en(91360),ea="child_load_balancer_helper";class eo{constructor(et){this.channelControlHelper=et,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(et){this.parent=et,this.child=null}createSubchannel(et,er){return this.parent.channelControlHelper.createSubchannel(et,er)}updateState(et,er){var en;if(this.calledByPendingChild()){if(et===es.ConnectivityState.CONNECTING)return;null===(en=this.parent.currentChild)||void 0===en||en.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(et,er)}requestReresolution(){var et;let er=null!==(et=this.parent.pendingChild)&&void 0!==et?et:this.parent.currentChild;this.child===er&&this.parent.channelControlHelper.requestReresolution()}setChild(et){this.child=et}addChannelzChild(et){this.parent.channelControlHelper.addChannelzChild(et)}removeChannelzChild(et){this.parent.channelControlHelper.removeChannelzChild(et)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(et,er){return et.getLoadBalancerName()!==er.getLoadBalancerName()}updateAddressList(et,er,en){let es;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,er)){let et=new this.ChildPolicyHelper(this),en=(0,ei.createLoadBalancer)(er,et);et.setChild(en),null===this.currentChild?(this.currentChild=en,es=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=en,es=this.pendingChild)}else es=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=er,es.updateAddressList(et,er,en)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return ea}}er.ChildLoadBalancerHandler=eo},35683:(et,er,en)=>{"use strict";var ei;Object.defineProperty(er,"__esModule",{value:!0}),er.setup=er.OutlierDetectionLoadBalancer=er.OutlierDetectionLoadBalancingConfig=void 0;let es=en(91360),ea=en(69238),eo=en(89589),eu=en(86868),ec=en(77203),eh=en(38390),ed=en(32939),ep=en(72782),ef=en(69609),em=en(68200),eg="outlier_detection";function ey(et){em.trace(ea.LogVerbosity.DEBUG,eg,et)}let ev="outlier_detection",eb=(null!==(ei=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==ei?ei:"true")==="true",eS={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},eT={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function ew(et,er,en,ei){if(er in et&&typeof et[er]!==en){let es=ei?`${ei}.${er}`:er;throw Error(`outlier detection config ${es} parse error: expected ${en}, got ${typeof et[er]}`)}}function eE(et,er,en){let ei=en?`${en}.${er}`:er;if(er in et){if(!(0,eo.isDuration)(et[er]))throw Error(`outlier detection config ${ei} parse error: expected Duration, got ${typeof et[er]}`);if(!(et[er].seconds>=0&&et[er].seconds<=315576e6&&et[er].nanos>=0&&et[er].nanos<=999999999))throw Error(`outlier detection config ${ei} parse error: values out of range for non-negative Duaration`)}}function eC(et,er,en){let ei=en?`${en}.${er}`:er;if(ew(et,er,"number",en),er in et&&!(et[er]>=0&&et[er]<=100))throw Error(`outlier detection config ${ei} parse error: value out of range for percentage (0-100)`)}class e_{constructor(et,er,en,ei,es,ea,eo){if(this.childPolicy=eo,eo.length>0&&"pick_first"===eo[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=et?et:1e4,this.baseEjectionTimeMs=null!=er?er:3e4,this.maxEjectionTimeMs=null!=en?en:3e5,this.maxEjectionPercent=null!=ei?ei:10,this.successRateEjection=es?Object.assign(Object.assign({},eS),es):null,this.failurePercentageEjection=ea?Object.assign(Object.assign({},eT),ea):null}getLoadBalancerName(){return ev}toJsonObject(){return{interval:(0,eo.msToDuration)(this.intervalMs),base_ejection_time:(0,eo.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,eo.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(et=>et.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(et){return new e_(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,et)}static createFromJson(et){var er;if(eE(et,"interval"),eE(et,"base_ejection_time"),eE(et,"max_ejection_time"),eC(et,"max_ejection_percent"),"success_rate_ejection"in et){if("object"!=typeof et.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");ew(et.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),eC(et.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),ew(et.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),ew(et.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in et){if("object"!=typeof et.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");eC(et.failure_percentage_ejection,"threshold","failure_percentage_ejection"),eC(et.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),ew(et.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),ew(et.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new e_(et.interval?(0,eo.durationToMs)(et.interval):null,et.base_ejection_time?(0,eo.durationToMs)(et.base_ejection_time):null,et.max_ejection_time?(0,eo.durationToMs)(et.max_ejection_time):null,null!==(er=et.max_ejection_percent)&&void 0!==er?er:null,et.success_rate_ejection,et.failure_percentage_ejection,et.child_policy.map(ec.validateLoadBalancingConfig))}}er.OutlierDetectionLoadBalancingConfig=e_;class eI extends ef.BaseSubchannelWrapper{constructor(et,er){super(et),this.mapEntry=er,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=et.getConnectivityState(),et.addConnectivityStateListener((et,er,en,ei)=>{if(this.childSubchannelState=en,!this.ejected)for(let et of this.stateListeners)et(this,er,en,ei)})}getConnectivityState(){return this.ejected?es.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(et){this.stateListeners.push(et)}removeConnectivityStateListener(et){let er=this.stateListeners.indexOf(et);er>-1&&this.stateListeners.splice(er,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let et=this.mapEntry.subchannelWrappers.indexOf(this);et>=0&&this.mapEntry.subchannelWrappers.splice(et,1)}}eject(){for(let et of(this.ejected=!0,this.stateListeners))et(this,this.childSubchannelState,es.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let et of(this.ejected=!1,this.stateListeners))et(this,es.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function ek(){return{success:0,failure:0}}class ex{constructor(){this.activeBucket=ek(),this.inactiveBucket=ek()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=ek()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class eA{constructor(et,er){this.wrappedPicker=et,this.countCalls=er}pick(et){let er=this.wrappedPicker.pick(et);if(er.pickResultType!==ed.PickResultType.COMPLETE)return er;{let et=er.subchannel,en=et.getMapEntry();if(!en)return Object.assign(Object.assign({},er),{subchannel:et.getWrappedSubchannel()});{let ei=er.onCallEnded;return this.countCalls&&(ei=et=>{var ei;et===ea.Status.OK?en.counter.addSuccess():en.counter.addFailure(),null===(ei=er.onCallEnded)||void 0===ei||ei.call(er,et)}),Object.assign(Object.assign({},er),{subchannel:et.getWrappedSubchannel(),onCallEnded:ei})}}}}class eR{constructor(et){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new eh.ChildLoadBalancerHandler((0,eu.createChildChannelControlHelper)(et,{createSubchannel:(er,en)=>{let ei=et.createSubchannel(er,en),es=this.addressMap.get((0,ep.subchannelAddressToString)(er)),ea=new eI(ei,es);return(null==es?void 0:es.currentEjectionTimestamp)!==null&&ea.eject(),null==es||es.subchannelWrappers.push(ea),ea},updateState:(er,en)=>{er===es.ConnectivityState.READY?et.updateState(er,new eA(en,this.isCountingEnabled())):et.updateState(er,en)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let et=0;for(let er of this.addressMap.values())null!==er.currentEjectionTimestamp&&(et+=1);return 100*et/this.addressMap.size}runSuccessRateCheck(et){if(!this.latestConfig)return;let er=this.latestConfig.getSuccessRateEjectionConfig();if(!er)return;ey("Running success rate check");let en=er.request_volume,ei=0,es=[];for(let[et,er]of this.addressMap){let ea=er.counter.getLastSuccesses(),eo=er.counter.getLastFailures();ey("Stats for "+et+": successes="+ea+" failures="+eo+" targetRequestVolume="+en),ea+eo>=en&&(ei+=1,es.push(ea/(ea+eo)))}if(ey("Found "+ei+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+es+"]"),ei<er.minimum_hosts)return;let ea=es.reduce((et,er)=>et+er)/es.length,eo=0;for(let et of es){let er=et-ea;eo+=er*er}let eu=eo/es.length,ec=Math.sqrt(eu),eh=ea-ec*(er.stdev_factor/1e3);for(let[ei,es]of(ey("stdev="+ec+" ejectionThreshold="+eh),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let ea=es.counter.getLastSuccesses(),eo=es.counter.getLastFailures();if(ea+eo<en)continue;let eu=ea/(ea+eo);if(ey("Checking candidate "+ei+" successRate="+eu),eu<eh){let en=100*Math.random();ey("Candidate "+ei+" randomNumber="+en+" enforcement_percentage="+er.enforcement_percentage),en<er.enforcement_percentage&&(ey("Ejecting candidate "+ei),this.eject(es,et))}}}runFailurePercentageCheck(et){if(!this.latestConfig)return;let er=this.latestConfig.getFailurePercentageEjectionConfig();if(!er)return;ey("Running failure percentage check. threshold="+er.threshold+" request volume threshold="+er.request_volume);let en=0;for(let et of this.addressMap.values()){let ei=et.counter.getLastSuccesses(),es=et.counter.getLastFailures();ei+es>=er.request_volume&&(en+=1)}if(!(en<er.minimum_hosts))for(let[en,ei]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let es=ei.counter.getLastSuccesses(),ea=ei.counter.getLastFailures();if(ey("Candidate successes="+es+" failures="+ea),es+ea<er.request_volume)continue;let eo=100*ea/(ea+es);if(eo>er.threshold){let es=100*Math.random();ey("Candidate "+en+" randomNumber="+es+" enforcement_percentage="+er.enforcement_percentage),es<er.enforcement_percentage&&(ey("Ejecting candidate "+en),this.eject(ei,et))}}}eject(et,er){for(let er of(et.currentEjectionTimestamp=new Date,et.ejectionTimeMultiplier+=1,et.subchannelWrappers))er.eject()}uneject(et){for(let er of(et.currentEjectionTimestamp=null,et.subchannelWrappers))er.uneject()}switchAllBuckets(){for(let et of this.addressMap.values())et.counter.switchBuckets()}startTimer(et){var er,en;this.ejectionTimer=setTimeout(()=>this.runChecks(),et),null===(en=(er=this.ejectionTimer).unref)||void 0===en||en.call(er)}runChecks(){let et=new Date;if(ey("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[er,en]of(this.timerStartTime=et,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(et),this.runFailurePercentageCheck(et),this.addressMap.entries()))if(null===en.currentEjectionTimestamp)en.ejectionTimeMultiplier>0&&(en.ejectionTimeMultiplier-=1);else{let et=this.latestConfig.getBaseEjectionTimeMs(),ei=this.latestConfig.getMaxEjectionTimeMs(),es=new Date(en.currentEjectionTimestamp.getTime());es.setMilliseconds(es.getMilliseconds()+Math.min(et*en.ejectionTimeMultiplier,Math.max(et,ei))),es<new Date&&(ey("Unejecting "+er),this.uneject(en))}}updateAddressList(et,er,en){if(!(er instanceof e_))return;let ei=new Set;for(let er of et)ei.add((0,ep.subchannelAddressToString)(er));for(let et of ei)this.addressMap.has(et)||(ey("Adding map entry for "+et),this.addressMap.set(et,{counter:new ex,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let et of this.addressMap.keys())ei.has(et)||(ey("Removing map entry for "+et),this.addressMap.delete(et));let es=(0,ec.getFirstUsableConfig)(er.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(et,es,en),er.getSuccessRateEjectionConfig()||er.getFailurePercentageEjectionConfig()){if(this.timerStartTime){ey("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let et=er.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(et)}else ey("Starting new timer"),this.timerStartTime=new Date,this.startTimer(er.getIntervalMs()),this.switchAllBuckets()}else for(let et of(ey("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(et),et.ejectionTimeMultiplier=0;this.latestConfig=er}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return ev}}function eD(){eb&&(0,eu.registerLoadBalancerType)(ev,eR,e_)}er.OutlierDetectionLoadBalancer=eR,er.setup=eD},72190:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=er.PickFirstLoadBalancer=er.shuffled=er.PickFirstLoadBalancingConfig=void 0;let ei=en(77203),es=en(91360),ea=en(32939),eo=en(68200),eu=en(69238),ec="pick_first";function eh(et){eo.trace(eu.LogVerbosity.DEBUG,ec,et)}let ed="pick_first",ep=250;class ef{constructor(et){this.shuffleAddressList=et}getLoadBalancerName(){return ed}toJsonObject(){return{[ed]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(et){if("shuffleAddressList"in et&&"boolean"!=typeof et.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new ef(!0===et.shuffleAddressList)}}er.PickFirstLoadBalancingConfig=ef;class em{constructor(et){this.subchannel=et}pick(et){return{pickResultType:ea.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function eg(et){let er=et.slice();for(let et=er.length-1;et>1;et--){let en=Math.floor(Math.random()*(et+1)),ei=er[et];er[et]=er[en],er[en]=ei}return er}er.shuffled=eg;class ey{constructor(et){this.channelControlHelper=et,this.children=[],this.currentState=es.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(et,er,en,ei,es)=>{this.onSubchannelStateUpdate(et,er,en,es)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(et=>et.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(es.ConnectivityState.READY,new em(this.currentPick)):0===this.children.length?this.updateState(es.ConnectivityState.IDLE,new ea.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(es.ConnectivityState.TRANSIENT_FAILURE,new ea.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(es.ConnectivityState.CONNECTING,new ea.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:et}of(this.stickyTransientFailureMode=!0,this.children))et.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let et=this.currentPick;this.currentPick=null,et.unref(),et.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(et.getChannelzRef())}}onSubchannelStateUpdate(et,er,en,ei){var ea;if(null===(ea=this.currentPick)||void 0===ea?void 0:ea.realSubchannelEquals(et)){en!==es.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[er,ea]of this.children.entries())if(et.realSubchannelEquals(ea.subchannel)){en===es.ConnectivityState.READY&&this.pickSubchannel(ea.subchannel),en===es.ConnectivityState.TRANSIENT_FAILURE&&(ea.hasReportedTransientFailure=!0,ei&&(this.lastError=ei),this.maybeEnterStickyTransientFailureMode(),er===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(er+1)),ea.subchannel.startConnecting();return}}startNextSubchannelConnecting(et){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[er,en]of this.children.entries())if(er>=et){let et=en.subchannel.getConnectivityState();if(et===es.ConnectivityState.IDLE||et===es.ConnectivityState.CONNECTING){this.startConnecting(er);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(et){var er,en;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=et,this.children[et].subchannel.getConnectivityState()===es.ConnectivityState.IDLE&&(eh("Start connecting to subchannel with address "+this.children[et].subchannel.getAddress()),process.nextTick(()=>{var er;null===(er=this.children[et])||void 0===er||er.subchannel.startConnecting()})),this.connectionDelayTimeout=null===(en=(er=setTimeout(()=>{this.startNextSubchannelConnecting(et+1)},ep)).unref)||void 0===en?void 0:en.call(er)}pickSubchannel(et){this.currentPick&&et.realSubchannelEquals(this.currentPick)||(eh("Pick subchannel with address "+et.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=et,et.ref(),this.channelControlHelper.addChannelzChild(et.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(et,er){eh(es.ConnectivityState[this.currentState]+" -> "+es.ConnectivityState[et]),this.currentState=et,this.channelControlHelper.updateState(et,er)}resetSubchannelList(){for(let et of this.children)this.currentPick&&et.subchannel.realSubchannelEquals(this.currentPick)||et.subchannel.removeConnectivityStateListener(this.subchannelStateListener),et.subchannel.unref(),this.channelControlHelper.removeChannelzChild(et.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(et){let er=et.map(et=>({subchannel:this.channelControlHelper.createSubchannel(et,{}),hasReportedTransientFailure:!1}));for(let{subchannel:et}of er)et.ref(),this.channelControlHelper.addChannelzChild(et.getChannelzRef());for(let{subchannel:et}of(this.resetSubchannelList(),this.children=er,this.children))if(et.addConnectivityStateListener(this.subchannelStateListener),et.getConnectivityState()===es.ConnectivityState.READY){this.pickSubchannel(et);return}for(let et of this.children)et.subchannel.getConnectivityState()===es.ConnectivityState.TRANSIENT_FAILURE&&(et.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(et,er){er instanceof ef&&(er.getShuffleAddressList()&&(et=eg(et)),this.latestAddressList=et,this.connectToAddressList(et))}exitIdle(){this.currentState===es.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return ed}}function ev(){(0,ei.registerLoadBalancerType)(ed,ey,ef),(0,ei.registerDefaultLoadBalancerType)(ed)}er.PickFirstLoadBalancer=ey,er.setup=ev},19580:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=er.RoundRobinLoadBalancer=void 0;let ei=en(77203),es=en(91360),ea=en(32939),eo=en(72782),eu=en(68200),ec=en(69238),eh="round_robin";function ed(et){eu.trace(ec.LogVerbosity.DEBUG,eh,et)}let ep="round_robin";class ef{getLoadBalancerName(){return ep}constructor(){}toJsonObject(){return{[ep]:{}}}static createFromJson(et){return new ef}}class em{constructor(et,er=0){this.subchannelList=et,this.nextIndex=er}pick(et){let er=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:ea.PickResultType.COMPLETE,subchannel:er,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class eg{constructor(et){this.channelControlHelper=et,this.subchannels=[],this.currentState=es.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(et,er,en,ei,ea)=>{this.calculateAndUpdateState(),(en===es.ConnectivityState.TRANSIENT_FAILURE||en===es.ConnectivityState.IDLE)&&(ea&&(this.lastError=ea),this.channelControlHelper.requestReresolution(),et.startConnecting())}}countSubchannelsWithState(et){return this.subchannels.filter(er=>er.getConnectivityState()===et).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(es.ConnectivityState.READY)>0){let et=this.subchannels.filter(et=>et.getConnectivityState()===es.ConnectivityState.READY),er=0;null!==this.currentReadyPicker&&(er=et.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(er=0),this.updateState(es.ConnectivityState.READY,new em(et,er))}else this.countSubchannelsWithState(es.ConnectivityState.CONNECTING)>0?this.updateState(es.ConnectivityState.CONNECTING,new ea.QueuePicker(this)):this.countSubchannelsWithState(es.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(es.ConnectivityState.TRANSIENT_FAILURE,new ea.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(es.ConnectivityState.IDLE,new ea.QueuePicker(this))}updateState(et,er){ed(es.ConnectivityState[this.currentState]+" -> "+es.ConnectivityState[et]),et===es.ConnectivityState.READY?this.currentReadyPicker=er:this.currentReadyPicker=null,this.currentState=et,this.channelControlHelper.updateState(et,er)}resetSubchannelList(){for(let et of this.subchannels)et.removeConnectivityStateListener(this.subchannelStateListener),et.unref(),this.channelControlHelper.removeChannelzChild(et.getChannelzRef());this.subchannels=[]}updateAddressList(et,er){for(let er of(this.resetSubchannelList(),ed("Connect to address list "+et.map(et=>(0,eo.subchannelAddressToString)(et))),this.subchannels=et.map(et=>this.channelControlHelper.createSubchannel(et,{})),this.subchannels)){er.ref(),er.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(er.getChannelzRef());let et=er.getConnectivityState();(et===es.ConnectivityState.IDLE||et===es.ConnectivityState.TRANSIENT_FAILURE)&&er.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let et of this.subchannels)et.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return ep}}function ey(){(0,ei.registerLoadBalancerType)(ep,eg,ef)}er.RoundRobinLoadBalancer=eg,er.setup=ey},77203:(et,er)=>{"use strict";function en(et,er){var en,ei,es,ea,eo,eu,ec,eh,ed,ep;return{createSubchannel:null!==(ei=null===(en=er.createSubchannel)||void 0===en?void 0:en.bind(er))&&void 0!==ei?ei:et.createSubchannel.bind(et),updateState:null!==(ea=null===(es=er.updateState)||void 0===es?void 0:es.bind(er))&&void 0!==ea?ea:et.updateState.bind(et),requestReresolution:null!==(eu=null===(eo=er.requestReresolution)||void 0===eo?void 0:eo.bind(er))&&void 0!==eu?eu:et.requestReresolution.bind(et),addChannelzChild:null!==(eh=null===(ec=er.addChannelzChild)||void 0===ec?void 0:ec.bind(er))&&void 0!==eh?eh:et.addChannelzChild.bind(et),removeChannelzChild:null!==(ep=null===(ed=er.removeChannelzChild)||void 0===ed?void 0:ed.bind(er))&&void 0!==ep?ep:et.removeChannelzChild.bind(et)}}Object.defineProperty(er,"__esModule",{value:!0}),er.validateLoadBalancingConfig=er.getFirstUsableConfig=er.isLoadBalancerNameRegistered=er.createLoadBalancer=er.registerDefaultLoadBalancerType=er.registerLoadBalancerType=er.createChildChannelControlHelper=void 0,er.createChildChannelControlHelper=en;let ei={},es=null;function ea(et,er,en){ei[et]={LoadBalancer:er,LoadBalancingConfig:en}}function eo(et){es=et}function eu(et,er){let en=et.getLoadBalancerName();return en in ei?new ei[en].LoadBalancer(er):null}function ec(et){return et in ei}function eh(et,er=!1){for(let er of et)if(er.getLoadBalancerName() in ei)return er;return er&&es?new ei[es].LoadBalancingConfig:null}function ed(et){if(!(null!==et&&"object"==typeof et))throw Error("Load balancing config must be an object");let er=Object.keys(et);if(1!==er.length)throw Error("Provided load balancing config has multiple conflicting entries");let en=er[0];if(en in ei)return ei[en].LoadBalancingConfig.createFromJson(et[en]);throw Error(`Unrecognized load balancing config name ${en}`)}er.registerLoadBalancerType=ea,er.registerDefaultLoadBalancerType=eo,er.createLoadBalancer=eu,er.isLoadBalancerNameRegistered=ec,er.getFirstUsableConfig=eh,er.validateLoadBalancingConfig=ed},80439:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.LoadBalancingCall=void 0;let ei=en(91360),es=en(69238),ea=en(50823),eo=en(32908),eu=en(32939),ec=en(14717),eh=en(68200),ed=en(6614),ep=en(85158),ef="load_balancing_call";class em{constructor(et,er,en,ei,es,ea,eo){var eu,eh;this.channel=et,this.callConfig=er,this.methodName=en,this.host=ei,this.credentials=es,this.deadline=ea,this.callNumber=eo,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let ed=this.methodName.split("/"),ep="";ed.length>=2&&(ep=ed[1]);let ef=null!==(eh=null===(eu=(0,ec.splitHostPort)(this.host))||void 0===eu?void 0:eu.host)&&void 0!==eh?eh:"localhost";this.serviceUrl=`https://${ef}/${ep}`}trace(et){eh.trace(es.LogVerbosity.DEBUG,ef,"["+this.callNumber+"] "+et)}outputStatus(et,er){var en,ei;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+et.code+' details="'+et.details+'"');let es=Object.assign(Object.assign({},et),{progress:er});null===(en=this.listener)||void 0===en||en.onReceiveStatus(es),null===(ei=this.onCallEnded)||void 0===ei||ei.call(this,es.code)}}doPick(){var et,er;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let en=this.channel.doPick(this.metadata,this.callConfig.pickInformation),ec=en.subchannel?"("+en.subchannel.getChannelzRef().id+") "+en.subchannel.getAddress():""+en.subchannel;switch(this.trace("Pick result: "+eu.PickResultType[en.pickResultType]+" subchannel: "+ec+" status: "+(null===(et=en.status)||void 0===et?void 0:et.code)+" "+(null===(er=en.status)||void 0===er?void 0:er.details)),en.pickResultType){case eu.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(et=>{var er,eu,eh;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let ed=this.metadata.clone();if(ed.merge(et),ed.get("authorization").length>1&&this.outputStatus({code:es.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new eo.Metadata},"PROCESSED"),en.subchannel.getConnectivityState()!==ei.ConnectivityState.READY){this.trace("Picked subchannel "+ec+" has state "+ei.ConnectivityState[en.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&ed.set("grpc-timeout",(0,ea.getDeadlineTimeoutString)(this.deadline));try{this.child=en.subchannel.getRealSubchannel().createCall(ed,this.host,this.methodName,{onReceiveMetadata:et=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(et)},onReceiveMessage:et=>{this.trace("Received message"),this.listener.onReceiveMessage(et)},onReceiveStatus:et=>{this.trace("Received status"),et.rstCode===ep.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(et,"REFUSED"):this.outputStatus(et,"PROCESSED")}})}catch(et){this.trace("Failed to start call on picked subchannel "+ec+" with error "+et.message),this.outputStatus({code:es.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+et.message,metadata:new eo.Metadata},"NOT_STARTED");return}null===(eu=(er=this.callConfig).onCommitted)||void 0===eu||eu.call(er),null===(eh=en.onCallStarted)||void 0===eh||eh.call(en),this.onCallEnded=en.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},et=>{let{code:er,details:en}=(0,ed.restrictControlPlaneStatusCode)("number"==typeof et.code?et.code:es.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${et.message}`);this.outputStatus({code:er,details:en,metadata:new eo.Metadata},"PROCESSED")});break;case eu.PickResultType.DROP:let{code:eh,details:ef}=(0,ed.restrictControlPlaneStatusCode)(en.status.code,en.status.details);setImmediate(()=>{this.outputStatus({code:eh,details:ef,metadata:en.status.metadata},"DROP")});break;case eu.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:et,details:er}=(0,ed.restrictControlPlaneStatusCode)(en.status.code,en.status.details);setImmediate(()=>{this.outputStatus({code:et,details:er,metadata:en.status.metadata},"PROCESSED")})}break;case eu.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(et,er){var en;this.trace("cancelWithStatus code: "+et+' details: "'+er+'"'),null===(en=this.child)||void 0===en||en.cancelWithStatus(et,er),this.outputStatus({code:et,details:er,metadata:new eo.Metadata},"PROCESSED")}getPeer(){var et,er;return null!==(er=null===(et=this.child)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:this.channel.getTarget()}start(et,er){this.trace("start called"),this.listener=er,this.metadata=et,this.doPick()}sendMessageWithContext(et,er){this.trace("write() called with message of length "+er.length),this.child?this.child.sendMessageWithContext(et,er):this.pendingMessage={context:et,message:er}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(et){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}er.LoadBalancingCall=em},68200:(et,er,en)=>{"use strict";var ei,es,ea,eo;Object.defineProperty(er,"__esModule",{value:!0}),er.isTracerEnabled=er.trace=er.log=er.setLoggerVerbosity=er.setLogger=er.getLogger=void 0;let eu=en(69238),ec=en(77282),eh=en(81513).i8,ed={error:(et,...er)=>{console.error("E "+et,...er)},info:(et,...er)=>{console.error("I "+et,...er)},debug:(et,...er)=>{console.error("D "+et,...er)}},ep=ed,ef=eu.LogVerbosity.ERROR,em=null!==(es=null!==(ei=process.env.GRPC_NODE_VERBOSITY)&&void 0!==ei?ei:process.env.GRPC_VERBOSITY)&&void 0!==es?es:"";switch(em.toUpperCase()){case"DEBUG":ef=eu.LogVerbosity.DEBUG;break;case"INFO":ef=eu.LogVerbosity.INFO;break;case"ERROR":ef=eu.LogVerbosity.ERROR;break;case"NONE":ef=eu.LogVerbosity.NONE}let eg=()=>ep;er.getLogger=eg;let ey=et=>{ep=et};er.setLogger=ey;let ev=et=>{ef=et};er.setLoggerVerbosity=ev;let eb=(et,...er)=>{let en;if(et>=ef){switch(et){case eu.LogVerbosity.DEBUG:en=ep.debug;break;case eu.LogVerbosity.INFO:en=ep.info;break;case eu.LogVerbosity.ERROR:en=ep.error}en||(en=ep.error),en&&en.bind(ep)(...er)}};er.log=eb;let eS=null!==(eo=null!==(ea=process.env.GRPC_NODE_TRACE)&&void 0!==ea?ea:process.env.GRPC_TRACE)&&void 0!==eo?eo:"",eT=new Set,ew=new Set;for(let et of eS.split(","))et.startsWith("-")?ew.add(et.substring(1)):eT.add(et);let eE=eT.has("all");function eC(et,en,ei){e_(en)&&(0,er.log)(et,new Date().toISOString()+" | v"+eh+" "+ec.pid+" | "+en+" | "+ei)}function e_(et){return!ew.has(et)&&(eE||eT.has(et))}er.trace=eC,er.isTracerEnabled=e_},47697:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.loadPackageDefinition=er.makeClientConstructor=void 0;let ei=en(47307),es={unary:ei.Client.prototype.makeUnaryRequest,server_stream:ei.Client.prototype.makeServerStreamRequest,client_stream:ei.Client.prototype.makeClientStreamRequest,bidi:ei.Client.prototype.makeBidiStreamRequest};function ea(et){return["__proto__","prototype","constructor"].includes(et)}function eo(et,er,en){en||(en={});class eo extends ei.Client{}return Object.keys(et).forEach(er=>{let en;if(ea(er))return;let ei=et[er];if("string"==typeof er&&"$"===er.charAt(0))throw Error("Method names cannot start with $");en=ei.requestStream?ei.responseStream?"bidi":"client_stream":ei.responseStream?"server_stream":"unary";let ec=ei.requestSerialize,eh=ei.responseDeserialize,ed=eu(es[en],ei.path,ec,eh);eo.prototype[er]=ed,Object.assign(eo.prototype[er],ei),ei.originalName&&!ea(ei.originalName)&&(eo.prototype[ei.originalName]=eo.prototype[er])}),eo.service=et,eo.serviceName=er,eo}function eu(et,er,en,ei){return function(...es){return et.call(this,er,en,ei,...es)}}function ec(et){return"format"in et}function eh(et){let er={};for(let en in et)if(Object.prototype.hasOwnProperty.call(et,en)){let ei=et[en],es=en.split(".");if(es.some(et=>ea(et)))continue;let eu=es[es.length-1],eh=er;for(let et of es.slice(0,-1))eh[et]||(eh[et]={}),eh=eh[et];ec(ei)?eh[eu]=ei:eh[eu]=eo(ei,eu,{})}return er}er.makeClientConstructor=eo,er.loadPackageDefinition=eh},32908:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Metadata=void 0;let ei=en(68200),es=en(69238),ea=en(9006),eo=/^[0-9a-z_.-]+$/,eu=/^[ -~]*$/;function ec(et){return eo.test(et)}function eh(et){return eu.test(et)}function ed(et){return et.endsWith("-bin")}function ep(et){return!et.startsWith("grpc-")}function ef(et){return et.toLowerCase()}function em(et,er){if(!ec(et))throw Error('Metadata key "'+et+'" contains illegal characters');if(null!=er){if(ed(et)){if(!Buffer.isBuffer(er))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(er))throw Error("keys that don't end with '-bin' must have String values");if(!eh(er))throw Error('Metadata string value "'+er+'" contains illegal characters')}}}class eg{constructor(et={}){this.internalRepr=new Map,this.options=et}set(et,er){em(et=ef(et),er),this.internalRepr.set(et,[er])}add(et,er){em(et=ef(et),er);let en=this.internalRepr.get(et);void 0===en?this.internalRepr.set(et,[er]):en.push(er)}remove(et){et=ef(et),this.internalRepr.delete(et)}get(et){return et=ef(et),this.internalRepr.get(et)||[]}getMap(){let et={};for(let[er,en]of this.internalRepr)if(en.length>0){let ei=en[0];et[er]=Buffer.isBuffer(ei)?Buffer.from(ei):ei}return et}clone(){let et=new eg(this.options),er=et.internalRepr;for(let[et,en]of this.internalRepr){let ei=en.map(et=>Buffer.isBuffer(et)?Buffer.from(et):et);er.set(et,ei)}return et}merge(et){for(let[er,en]of et.internalRepr){let et=(this.internalRepr.get(er)||[]).concat(en);this.internalRepr.set(er,et)}}setOptions(et){this.options=et}getOptions(){return this.options}toHttp2Headers(){let et={};for(let[er,en]of this.internalRepr)et[er]=en.map(ey);return et}toJSON(){let et={};for(let[er,en]of this.internalRepr)et[er]=en;return et}static fromHttp2Headers(et){let er=new eg;for(let en of Object.keys(et)){if(":"===en.charAt(0))continue;let eo=et[en];try{ed(en)?Array.isArray(eo)?eo.forEach(et=>{er.add(en,Buffer.from(et,"base64"))}):void 0!==eo&&(ep(en)?eo.split(",").forEach(et=>{er.add(en,Buffer.from(et.trim(),"base64"))}):er.add(en,Buffer.from(eo,"base64"))):Array.isArray(eo)?eo.forEach(et=>{er.add(en,et)}):void 0!==eo&&er.add(en,eo)}catch(er){let et=`Failed to add metadata entry ${en}: ${eo}. ${(0,ea.getErrorMessage)(er)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,ei.log)(es.LogVerbosity.ERROR,et)}}return er}}er.Metadata=eg;let ey=et=>Buffer.isBuffer(et)?et.toString("base64"):et},32939:(et,er,en)=>{"use strict";var ei;Object.defineProperty(er,"__esModule",{value:!0}),er.QueuePicker=er.UnavailablePicker=er.PickResultType=void 0;let es=en(32908),ea=en(69238);!function(et){et[et.COMPLETE=0]="COMPLETE",et[et.QUEUE=1]="QUEUE",et[et.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",et[et.DROP=3]="DROP"}(ei||(er.PickResultType=ei={}));class eo{constructor(et){this.status=Object.assign({code:ea.Status.UNAVAILABLE,details:"No connection established",metadata:new es.Metadata},et)}pick(et){return{pickResultType:ei.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}er.UnavailablePicker=eo;class eu{constructor(et){this.loadBalancer=et,this.calledExitIdle=!1}pick(et){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:ei.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}er.QueuePicker=eu},84988:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=er.DEFAULT_PORT=void 0;let ei=en(14755),es=en(9523),ea=en(73837),eo=en(45914),eu=en(69238),ec=en(32908),eh=en(68200),ed=en(69238),ep=en(14717),ef=en(41808),em=en(77257),eg="dns_resolver";function ey(et){eh.trace(ed.LogVerbosity.DEBUG,eg,et)}er.DEFAULT_PORT=443;let ev=3e4,eb=ea.promisify(es.resolveTxt),eS=ea.promisify(es.lookup);function eT(...et){let er=[];for(let en=0;en<Math.max.apply(null,et.map(et=>et.length));en++)for(let ei of et)en<ei.length&&er.push(ei[en]);return er}class ew{constructor(et,en,ei){var es,ea,eo;this.target=et,this.listener=en,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,ey("Resolver constructed for target "+(0,ep.uriToString)(et));let eh=(0,ep.splitHostPort)(et.path);null===eh?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,ef.isIPv4)(eh.host)||(0,ef.isIPv6)(eh.host)?(this.ipResult=[{host:eh.host,port:null!==(es=eh.port)&&void 0!==es?es:er.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=eh.host,this.port=null!==(ea=eh.port)&&void 0!==ea?ea:er.DEFAULT_PORT),this.percentage=100*Math.random(),1===ei["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:eu.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,ep.uriToString)(this.target)}`,metadata:new ec.Metadata};let ed={initialDelay:ei["grpc.initial_reconnect_backoff_ms"],maxDelay:ei["grpc.max_reconnect_backoff_ms"]};this.backoff=new em.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},ed),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(eo=ei["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==eo?eo:ev,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(ey("Returning IP address for target "+(0,ep.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)ey("Failed to parse DNS address "+(0,ep.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:eu.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,ep.uriToString)(this.target)}`,metadata:new ec.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;ey("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let et=this.dnsHostname;this.pendingLookupPromise=eS(et,{all:!0}),this.pendingLookupPromise.then(et=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let er=et.filter(et=>4===et.family),en=et.filter(et=>6===et.family);this.latestLookupResult=eT(en,er).map(et=>({host:et.address,port:+this.port}));let ei="["+this.latestLookupResult.map(et=>et.host+":"+et.port).join(",")+"]";if(ey("Resolved addresses for target "+(0,ep.uriToString)(this.target)+": "+ei),0===this.latestLookupResult.length){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},et=>{null!==this.pendingLookupPromise&&(ey("Resolution error for target "+(0,ep.uriToString)(this.target)+": "+et.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=eb(et),this.pendingTxtPromise.then(et=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,eo.extractAndSelectServiceConfig)(et,this.percentage)}catch(et){this.latestServiceConfigError={code:eu.Status.UNAVAILABLE,details:`Parsing service config failed with error ${et.message}`,metadata:new ec.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},et=>{}))}}startNextResolutionTimer(){var et,er;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(er=(et=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)||void 0===er?void 0:er.call(et),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?ey('resolution update delayed by "min time between resolutions" rate limit'):ey("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(et){return et.path}}function eE(){(0,ei.registerResolver)("dns",ew),(0,ei.registerDefaultScheme)("dns")}er.setup=eE},96633:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=void 0;let ei=en(41808),es=en(69238),ea=en(32908),eo=en(14755),eu=en(14717),ec=en(68200),eh="ip_resolver";function ed(et){ec.trace(es.LogVerbosity.DEBUG,eh,et)}let ep="ipv4",ef="ipv6",em=443;class eg{constructor(et,er,en){var eo;this.listener=er,this.addresses=[],this.error=null,this.hasReturnedResult=!1,ed("Resolver constructed for target "+(0,eu.uriToString)(et));let ec=[];if(!(et.scheme===ep||et.scheme===ef)){this.error={code:es.Status.UNAVAILABLE,details:`Unrecognized scheme ${et.scheme} in IP resolver`,metadata:new ea.Metadata};return}let eh=et.path.split(",");for(let er of eh){let en=(0,eu.splitHostPort)(er);if(null===en||et.scheme===ep&&!(0,ei.isIPv4)(en.host)||et.scheme===ef&&!(0,ei.isIPv6)(en.host)){this.error={code:es.Status.UNAVAILABLE,details:`Failed to parse ${et.scheme} address ${er}`,metadata:new ea.Metadata};return}ec.push({host:en.host,port:null!==(eo=en.port)&&void 0!==eo?eo:em})}this.addresses=ec,ed("Parsed "+et.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(et){return et.path.split(",")[0]}}function ey(){(0,eo.registerResolver)(ep,eg),(0,eo.registerResolver)(ef,eg)}er.setup=ey},50864:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.setup=void 0;let ei=en(14755);class es{constructor(et,er,en){let ei;this.listener=er,this.addresses=[],this.hasReturnedResult=!1,ei=""===et.authority?"/"+et.path:et.path,this.addresses=[{path:ei}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(et){return"localhost"}}function ea(){(0,ei.registerResolver)("unix",es)}er.setup=ea},14755:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.mapUriDefaultScheme=er.getDefaultAuthority=er.createResolver=er.registerDefaultScheme=er.registerResolver=void 0;let ei=en(14717),es={},ea=null;function eo(et,er){es[et]=er}function eu(et){ea=et}function ec(et,er,en){if(void 0!==et.scheme&&et.scheme in es)return new es[et.scheme](et,er,en);throw Error(`No resolver could be created for target ${(0,ei.uriToString)(et)}`)}function eh(et){if(void 0!==et.scheme&&et.scheme in es)return es[et.scheme].getDefaultAuthority(et);throw Error(`Invalid target ${(0,ei.uriToString)(et)}`)}function ed(et){return void 0!==et.scheme&&et.scheme in es?et:null!==ea?{scheme:ea,authority:void 0,path:(0,ei.uriToString)(et)}:null}er.registerResolver=eo,er.registerDefaultScheme=eu,er.createResolver=ec,er.getDefaultAuthority=eh,er.mapUriDefaultScheme=ed},65700:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ResolvingCall=void 0;let ei=en(69238),es=en(50823),ea=en(32908),eo=en(68200),eu=en(6614),ec="resolving_call";class eh{constructor(et,er,en,ea,eo,eu){this.channel=et,this.method=er,this.filterStackFactory=ea,this.credentials=eo,this.callNumber=eu,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=en.deadline,this.host=en.host,en.parentCall&&(en.flags&ei.Propagate.CANCELLATION&&en.parentCall.on("cancelled",()=>{this.cancelWithStatus(ei.Status.CANCELLED,"Cancelled by parent call")}),en.flags&ei.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+en.parentCall.getDeadline()),this.deadline=(0,es.minDeadline)(this.deadline,en.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(et){eo.trace(ei.LogVerbosity.DEBUG,ec,"["+this.callNumber+"] "+et)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,es.deadlineToString)(this.deadline));let et=(0,es.getRelativeTimeout)(this.deadline);if(et!==1/0){this.trace("Deadline will be reached in "+et+"ms");let er=()=>{this.cancelWithStatus(ei.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};et<=0?process.nextTick(er):this.deadlineTimer=setTimeout(er,et)}}outputStatus(et){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let er=this.filterStack.receiveTrailers(et);this.trace("ended with status: code="+er.code+' details="'+er.details+'"'),this.statusWatchers.forEach(et=>et(er)),process.nextTick(()=>{var et;null===(et=this.listener)||void 0===et||et.onReceiveStatus(er)})}}sendMessageOnChild(et,er){if(!this.child)throw Error("sendMessageonChild called with child not populated");let en=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:er,flags:et.flags})).then(er=>{this.writeFilterPending=!1,en.sendMessageWithContext(et,er.message),this.pendingHalfClose&&en.halfClose()},et=>{this.cancelWithStatus(et.code,et.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let et=this.channel.getConfig(this.method,this.metadata);if("NONE"===et.type){this.channel.queueCallForConfig(this);return}if("ERROR"===et.type){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(et.error);return}let er=et.config;if(er.status!==ei.Status.OK){let{code:et,details:en}=(0,eu.restrictControlPlaneStatusCode)(er.status,"Failed to route call to method "+this.method);this.outputStatus({code:et,details:en,metadata:new ea.Metadata});return}if(er.methodConfig.timeout){let et=new Date;et.setSeconds(et.getSeconds()+er.methodConfig.timeout.seconds),et.setMilliseconds(et.getMilliseconds()+er.methodConfig.timeout.nanos/1e6),this.deadline=(0,es.minDeadline)(this.deadline,et),this.runDeadlineTimer()}this.filterStackFactory.push(er.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(et=>{this.child=this.channel.createInnerCall(er,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(et,{onReceiveMetadata:et=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(et))},onReceiveMessage:et=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(et).then(et=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(et),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},et=>{this.cancelWithStatus(et.code,et.details)})},onReceiveStatus:et=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=et:this.outputStatus(et)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},et=>{this.outputStatus(et)})}reportResolverError(et){var er;(null===(er=this.metadata)||void 0===er?void 0:er.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(et)}cancelWithStatus(et,er){var en;this.trace("cancelWithStatus code: "+et+' details: "'+er+'"'),null===(en=this.child)||void 0===en||en.cancelWithStatus(et,er),this.outputStatus({code:et,details:er,metadata:new ea.Metadata})}getPeer(){var et,er;return null!==(er=null===(et=this.child)||void 0===et?void 0:et.getPeer())&&void 0!==er?er:this.channel.getTarget()}start(et,er){this.trace("start called"),this.metadata=et.clone(),this.listener=er,this.getConfig()}sendMessageWithContext(et,er){this.trace("write() called with message of length "+er.length),this.child?this.sendMessageOnChild(et,er):this.pendingMessage={context:et,message:er}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(et){this.credentials=this.credentials.compose(et)}addStatusWatcher(et){this.statusWatchers.push(et)}getCallNumber(){return this.callNumber}}er.ResolvingCall=eh},61839:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ResolvingLoadBalancer=void 0;let ei=en(77203),es=en(45914),ea=en(91360),eo=en(14755),eu=en(32939),ec=en(77257),eh=en(69238),ed=en(32908),ep=en(68200),ef=en(69238),em=en(14717),eg=en(38390),ey="resolving_load_balancer";function ev(et){ep.trace(ef.LogVerbosity.DEBUG,ey,et)}let eb=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function eS(et,er,en,ei){for(let es of en.name)switch(ei){case"EMPTY":if(!es.service&&!es.method)return!0;break;case"SERVICE":if(es.service===et&&!es.method)return!0;break;case"SERVICE_AND_METHOD":if(es.service===et&&es.method===er)return!0}return!1}function eT(et,er,en,ei){for(let es of en)if(eS(et,er,es,ei))return es;return null}function ew(et){return function(er,en){var ei,es;let ea=er.split("/").filter(et=>et.length>0),eo=null!==(ei=ea[0])&&void 0!==ei?ei:"",eu=null!==(es=ea[1])&&void 0!==es?es:"";if(et&&et.methodConfig)for(let er of eb){let en=eT(eo,eu,et.methodConfig,er);if(en)return{methodConfig:en,pickInformation:{},status:eh.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:eh.Status.OK,dynamicFilterFactories:[]}}}class eE{constructor(et,er,en,ep,ef){this.target=et,this.channelControlHelper=er,this.onSuccessfulResolution=ep,this.onFailedResolution=ef,this.latestChildState=ea.ConnectivityState.IDLE,this.latestChildPicker=new eu.QueuePicker(this),this.currentState=ea.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,en["grpc.service_config"]?this.defaultServiceConfig=(0,es.validateServiceConfig)(JSON.parse(en["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(ea.ConnectivityState.IDLE,new eu.QueuePicker(this)),this.childLoadBalancer=new eg.ChildLoadBalancerHandler({createSubchannel:er.createSubchannel.bind(er),requestReresolution:()=>{this.backoffTimeout.isRunning()?(ev("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(et,er)=>{this.latestChildState=et,this.latestChildPicker=er,this.updateState(et,er)},addChannelzChild:er.addChannelzChild.bind(er),removeChannelzChild:er.removeChannelzChild.bind(er)}),this.innerResolver=(0,eo.createResolver)(et,{onSuccessfulResolution:(et,er,en,es,ea)=>{var eo;this.backoffTimeout.stop(),this.backoffTimeout.reset();let eu=null;null===er?null===en?(this.previousServiceConfig=null,eu=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(en):eu=this.previousServiceConfig:(eu=er,this.previousServiceConfig=er);let ec=null!==(eo=null==eu?void 0:eu.loadBalancingConfig)&&void 0!==eo?eo:[],ep=(0,ei.getFirstUsableConfig)(ec,!0);if(null===ep){this.handleResolutionFailure({code:eh.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new ed.Metadata});return}this.childLoadBalancer.updateAddressList(et,ep,ea);let ef=null!=eu?eu:this.defaultServiceConfig;this.onSuccessfulResolution(ef,null!=es?es:ew(ef))},onError:et=>{this.handleResolutionFailure(et)}},en);let em={initialDelay:en["grpc.initial_reconnect_backoff_ms"],maxDelay:en["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new ec.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},em),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===ea.ConnectivityState.IDLE&&this.updateState(ea.ConnectivityState.CONNECTING,new eu.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(et,er){ev((0,em.uriToString)(this.target)+" "+ea.ConnectivityState[this.currentState]+" -> "+ea.ConnectivityState[et]),et===ea.ConnectivityState.IDLE&&(er=new eu.QueuePicker(this)),this.currentState=et,this.channelControlHelper.updateState(et,er)}handleResolutionFailure(et){this.latestChildState===ea.ConnectivityState.IDLE&&(this.updateState(ea.ConnectivityState.TRANSIENT_FAILURE,new eu.UnavailablePicker(et)),this.onFailedResolution(et))}exitIdle(){(this.currentState===ea.ConnectivityState.IDLE||this.currentState===ea.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(et,er){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=ea.ConnectivityState.IDLE,this.latestChildPicker=new eu.QueuePicker(this),this.currentState=ea.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}er.ResolvingLoadBalancer=eE},97564:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.RetryingCall=er.MessageBufferTracker=er.RetryThrottler=void 0;let ei=en(69238),es=en(32908),ea=en(68200),eo="retrying_call";class eu{constructor(et,er,en){this.maxTokens=et,this.tokenRatio=er,en?this.tokens=en.tokens*(et/en.maxTokens):this.tokens=et}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}er.RetryThrottler=eu;class ec{constructor(et,er){this.totalLimit=et,this.limitPerCall=er,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(et,er){var en;let ei=null!==(en=this.allocatedPerCall.get(er))&&void 0!==en?en:0;return!(this.limitPerCall-ei<et)&&!(this.totalLimit-this.totalAllocated<et)&&(this.allocatedPerCall.set(er,ei+et),this.totalAllocated+=et,!0)}free(et,er){var en;if(this.totalAllocated<et)throw Error(`Invalid buffer allocation state: call ${er} freed ${et} > total allocated ${this.totalAllocated}`);this.totalAllocated-=et;let ei=null!==(en=this.allocatedPerCall.get(er))&&void 0!==en?en:0;if(ei<et)throw Error(`Invalid buffer allocation state: call ${er} freed ${et} > allocated for call ${ei}`);this.allocatedPerCall.set(er,ei-et)}freeAll(et){var er;let en=null!==(er=this.allocatedPerCall.get(et))&&void 0!==er?er:0;if(this.totalAllocated<en)throw Error(`Invalid buffer allocation state: call ${et} allocated ${en} > total allocated ${this.totalAllocated}`);this.totalAllocated-=en,this.allocatedPerCall.delete(et)}}er.MessageBufferTracker=ec;let eh="grpc-previous-rpc-attempts";class ed{constructor(et,er,en,ei,es,ea,eo,eu,ec){if(this.channel=et,this.callConfig=er,this.methodName=en,this.host=ei,this.credentials=es,this.deadline=ea,this.callNumber=eo,this.bufferTracker=eu,this.retryThrottler=ec,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,er.methodConfig.retryPolicy){this.state="RETRY";let et=er.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(et.initialBackoff.substring(0,et.initialBackoff.length-1))}else er.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(et){ea.trace(ei.LogVerbosity.DEBUG,eo,"["+this.callNumber+"] "+et)}reportStatus(et){this.trace("ended with status: code="+et.code+' details="'+et.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var er;null===(er=this.listener)||void 0===er||er.onReceiveStatus({code:et.code,details:et.details,metadata:et.metadata})})}cancelWithStatus(et,er){for(let{call:en}of(this.trace("cancelWithStatus code: "+et+' details: "'+er+'"'),this.reportStatus({code:et,details:er,metadata:new es.Metadata}),this.underlyingCalls))en.cancelWithStatus(et,er)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(et){var er;return null!==(er=this.writeBuffer[et-this.writeBufferOffset])&&void 0!==er?er:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let et=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let er=this.writeBufferOffset;er<et;er++){let et=this.getBufferEntry(er);et.allocated&&this.bufferTracker.free(et.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(et-this.writeBufferOffset),this.writeBufferOffset=et}commitCall(et){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[et].state){this.trace("Committing call ["+this.underlyingCalls[et].call.getCallNumber()+"] at index "+et),this.state="COMMITTED",this.committedCallIndex=et;for(let er=0;er<this.underlyingCalls.length;er++)er!==et&&"COMPLETED"!==this.underlyingCalls[er].state&&(this.underlyingCalls[er].state="COMPLETED",this.underlyingCalls[er].call.cancelWithStatus(ei.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let et=-1,er=-1;for(let[en,ei]of this.underlyingCalls.entries())"ACTIVE"===ei.state&&ei.nextMessageToSend>et&&(et=ei.nextMessageToSend,er=en);-1===er?this.state="TRANSPARENT_ONLY":this.commitCall(er)}isStatusCodeInList(et,er){return et.some(et=>et===er||et.toString().toLowerCase()===ei.Status[er].toLowerCase())}getNextRetryBackoffMs(){var et;let er=null===(et=this.callConfig)||void 0===et?void 0:et.methodConfig.retryPolicy;if(!er)return 0;let en=Math.random()*this.nextRetryBackoffSec*1e3,ei=Number(er.maxBackoff.substring(0,er.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*er.backoffMultiplier,ei),en}maybeRetryCall(et,er){let en;if("RETRY"!==this.state){er(!1);return}let ei=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(ei.maxAttempts,5)){er(!1);return}if(null===et)en=this.getNextRetryBackoffMs();else if(et<0){this.state="TRANSPARENT_ONLY",er(!1);return}else en=et,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var et,en;if("RETRY"!==this.state){er(!1);return}(null===(en=null===(et=this.retryThrottler)||void 0===et?void 0:et.canRetryCall())||void 0===en||en)&&(er(!0),this.attempts+=1,this.startNewAttempt())},en)}countActiveCalls(){let et=0;for(let er of this.underlyingCalls)(null==er?void 0:er.state)==="ACTIVE"&&(et+=1);return et}handleProcessedStatus(et,er,en){var ei,es,ea;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(er),this.reportStatus(et);break;case"HEDGING":if(this.isStatusCodeInList(null!==(ei=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==ei?ei:[],et.code)){let ei;if(null===(es=this.retryThrottler)||void 0===es||es.addCallFailed(),null===en)ei=0;else if(en<0){this.state="TRANSPARENT_ONLY",this.commitCall(er),this.reportStatus(et);return}else ei=en;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(er),this.reportStatus(et))},ei)}else this.commitCall(er),this.reportStatus(et);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,et.code)?(null===(ea=this.retryThrottler)||void 0===ea||ea.addCallFailed(),this.maybeRetryCall(en,en=>{en||(this.commitCall(er),this.reportStatus(et))})):(this.commitCall(er),this.reportStatus(et))}}getPushback(et){let er=et.get("grpc-retry-pushback-ms");if(0===er.length)return null;try{return parseInt(er[0])}catch(et){return -1}}handleChildStatus(et,er){var en;if("COMPLETED"===this.underlyingCalls[er].state)return;if(this.trace("state="+this.state+" handling status with progress "+et.progress+" from child ["+this.underlyingCalls[er].call.getCallNumber()+"] in state "+this.underlyingCalls[er].state),this.underlyingCalls[er].state="COMPLETED",et.code===ei.Status.OK){null===(en=this.retryThrottler)||void 0===en||en.addCallSucceeded(),this.commitCall(er),this.reportStatus(et);return}if("COMMITTED"===this.state){this.reportStatus(et);return}let es=this.getPushback(et.metadata);switch(et.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(et,er,es):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(er),this.reportStatus(et);break;case"PROCESSED":this.handleProcessedStatus(et,er,es)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let et=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(et.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var et,er,en;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let ei=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(ei.maxAttempts,5))return;let es=null!==(et=ei.hedgingDelay)&&void 0!==et?et:"0s",ea=Number(es.substring(0,es.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*ea),null===(en=(er=this.hedgingTimer).unref)||void 0===en||en.call(er)}startNewAttempt(){let et=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+et.getCallNumber()+"] for attempt "+this.attempts);let er=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:et,nextMessageToSend:0});let en=this.attempts-1,ei=this.initialMetadata.clone();en>0&&ei.set(eh,`${en}`);let es=!1;et.start(ei,{onReceiveMetadata:ei=>{this.trace("Received metadata from child ["+et.getCallNumber()+"]"),this.commitCall(er),es=!0,en>0&&ei.set(eh,`${en}`),"ACTIVE"===this.underlyingCalls[er].state&&this.listener.onReceiveMetadata(ei)},onReceiveMessage:en=>{this.trace("Received message from child ["+et.getCallNumber()+"]"),this.commitCall(er),"ACTIVE"===this.underlyingCalls[er].state&&this.listener.onReceiveMessage(en)},onReceiveStatus:ei=>{this.trace("Received status from child ["+et.getCallNumber()+"]"),!es&&en>0&&ei.metadata.set(eh,`${en}`),this.handleChildStatus(ei,er)}}),this.sendNextChildMessage(er),this.readStarted&&et.startRead()}start(et,er){this.trace("start called"),this.listener=er,this.initialMetadata=et,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(et){var er,en;let ei=this.underlyingCalls[et],es=ei.nextMessageToSend;null===(en=(er=this.getBufferEntry(es)).callback)||void 0===en||en.call(er),this.clearSentMessages(),ei.nextMessageToSend+=1,this.sendNextChildMessage(et)}sendNextChildMessage(et){let er=this.underlyingCalls[et];if("COMPLETED"!==er.state&&this.getBufferEntry(er.nextMessageToSend)){let en=this.getBufferEntry(er.nextMessageToSend);switch(en.entryType){case"MESSAGE":er.call.sendMessageWithContext({callback:er=>{this.handleChildWriteCompleted(et)}},en.message.message);break;case"HALF_CLOSE":er.nextMessageToSend+=1,er.call.halfClose()}}}sendMessageWithContext(et,er){var en;this.trace("write() called with message of length "+er.length);let ei={message:er,flags:et.flags},es=this.getNextBufferIndex(),ea={entryType:"MESSAGE",message:ei,allocated:this.bufferTracker.allocate(er.length,this.callNumber)};if(this.writeBuffer.push(ea),ea.allocated)for(let[ei,ea]of(null===(en=et.callback)||void 0===en||en.call(et),this.underlyingCalls.entries()))"ACTIVE"===ea.state&&ea.nextMessageToSend===es&&ea.call.sendMessageWithContext({callback:et=>{this.handleChildWriteCompleted(ei)}},er);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let en=this.underlyingCalls[this.committedCallIndex];ea.callback=et.callback,"ACTIVE"===en.state&&en.nextMessageToSend===es&&en.call.sendMessageWithContext({callback:et=>{this.handleChildWriteCompleted(this.committedCallIndex)}},er)}}startRead(){for(let et of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==et?void 0:et.state)==="ACTIVE"&&et.call.startRead()}halfClose(){this.trace("halfClose called");let et=this.getNextBufferIndex();for(let er of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==er?void 0:er.state)==="ACTIVE"&&er.nextMessageToSend===et&&(er.nextMessageToSend+=1,er.call.halfClose())}setCredentials(et){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}er.RetryingCall=ed},17574:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Http2ServerCallStream=er.ServerDuplexStreamImpl=er.ServerWritableStreamImpl=er.ServerReadableStreamImpl=er.ServerUnaryCallImpl=void 0;let ei=en(82361),es=en(85158),ea=en(12781),eo=en(59796),eu=en(69238),ec=en(32908),eh=en(80272),ed=en(68200),ep=en(9006),ef="server_call";function em(et){ed.trace(eu.LogVerbosity.DEBUG,ef,et)}let eg="grpc-accept-encoding",ey="grpc-encoding",ev="grpc-message",eb="grpc-status",eS="grpc-timeout",eT=/(\d{1,8})\s*([HMSmun])/,ew={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},eE={[eg]:"identity,deflate,gzip",[ey]:"identity"},eC={[es.constants.HTTP2_HEADER_STATUS]:es.constants.HTTP_STATUS_OK,[es.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},e_={waitForTrailers:!0};class eI extends ei.EventEmitter{constructor(et,er,en){super(),this.call=et,this.metadata=er,this.request=en,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(et){this.call.sendMetadata(et)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}er.ServerUnaryCallImpl=eI;class ek extends ea.Readable{constructor(et,er,en,ei){super({objectMode:!0}),this.call=et,this.metadata=er,this.deserialize=en,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,ei)}_read(et){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(et){this.call.sendMetadata(et)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}er.ServerReadableStreamImpl=ek;class ex extends ea.Writable{constructor(et,er,en,ei){super({objectMode:!0}),this.call=et,this.metadata=er,this.serialize=en,this.request=ei,this.cancelled=!1,this.trailingMetadata=new ec.Metadata,this.call.setupSurfaceCall(this),this.on("error",et=>{this.call.sendError(et),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(et){this.call.sendMetadata(et)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(et,er,en){try{let er=this.call.serializeMessage(et);if(!this.call.write(er)){this.call.once("drain",en);return}}catch(et){this.emit("error",{details:(0,ep.getErrorMessage)(et),code:eu.Status.INTERNAL})}en()}_final(et){this.call.sendStatus({code:eu.Status.OK,details:"OK",metadata:this.trailingMetadata}),et(null)}end(et){return et&&(this.trailingMetadata=et),super.end()}}er.ServerWritableStreamImpl=ex;class eA extends ea.Duplex{constructor(et,er,en,ei,es){super({objectMode:!0}),this.call=et,this.metadata=er,this.serialize=en,this.deserialize=ei,this.cancelled=!1,this.trailingMetadata=new ec.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,es),this.on("error",et=>{this.call.sendError(et),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(et){this.call.sendMetadata(et)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(et){return et&&(this.trailingMetadata=et),super.end()}}er.ServerDuplexStreamImpl=eA,eA.prototype._read=ek.prototype._read,eA.prototype._write=ex.prototype._write,eA.prototype._final=ex.prototype._final;class eR extends ei.EventEmitter{constructor(et,er,en){super(),this.stream=et,this.handler=er,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=eu.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=eu.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",et=>{}),this.stream.once("close",()=>{var et;em("Request to method "+(null===(et=this.handler)||void 0===et?void 0:et.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:eu.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in en&&(this.maxSendMessageSize=en["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in en&&(this.maxReceiveMessageSize=en["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(et,er){let en=et.subarray(5);if("identity"===er)return en;if("deflate"!==er&&"gzip"!==er)return Promise.reject({code:eu.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${er}"`});{let et;return et="deflate"===er?eo.createInflate():eo.createGunzip(),new Promise((er,ei)=>{let es=0,ea=[];et.on("data",er=>{ea.push(er),es+=er.byteLength,-1!==this.maxReceiveMessageSize&&es>this.maxReceiveMessageSize&&(et.destroy(),ei({code:eu.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),et.on("end",()=>{er(Buffer.concat(ea))}),et.write(en),et.end()})}}sendMetadata(et){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let er=et?et.toHttp2Headers():null,en=Object.assign(Object.assign(Object.assign({},eC),eE),er);this.stream.respond(en,e_)}receiveMetadata(et){let er=ec.Metadata.fromHttp2Headers(et);ed.isTracerEnabled(ef)&&em("Request to "+this.handler.path+" received headers "+JSON.stringify(er.toJSON()));let en=er.get(eS);if(en.length>0){let et=en[0].toString().match(eT);if(null===et){let et=Error("Invalid deadline");return et.code=eu.Status.OUT_OF_RANGE,this.sendError(et),er}let ei=+et[1]*ew[et[2]]|0,es=new Date;this.deadline=es.setMilliseconds(es.getMilliseconds()+ei),this.deadlineTimer=setTimeout(eD,ei,this),er.remove(eS)}return er.remove(es.constants.HTTP2_HEADER_ACCEPT_ENCODING),er.remove(es.constants.HTTP2_HEADER_TE),er.remove(es.constants.HTTP2_HEADER_CONTENT_TYPE),er.remove("grpc-accept-encoding"),er}receiveUnaryMessage(et){return new Promise((er,en)=>{let{stream:ei}=this,es=0,ea=this,eo=[],ec=this.maxReceiveMessageSize;function eh(et){if(es+=et.byteLength,-1!==ec&&es>ec){ei.removeListener("data",eh),ei.removeListener("end",ed),ei.removeListener("error",ed),en({code:eu.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${es} vs. ${ec})`});return}eo.push(et)}function ed(ec){if(ei.removeListener("data",eh),ei.removeListener("end",ed),ei.removeListener("error",ed),void 0!==ec){en({code:eu.Status.INTERNAL,details:ec.message});return}if(0===es){en({code:eu.Status.INTERNAL,details:"received empty unary message"});return}ea.emit("receiveMessage");let ep=Buffer.concat(eo,es),ef=1===ep.readUInt8(0),em=ef?et:"identity",eg=ea.getDecompressedMessage(ep,em);if(Buffer.isBuffer(eg)){er(ea.deserializeMessageWithInternalError(eg));return}eg.then(et=>er(ea.deserializeMessageWithInternalError(et)),er=>en(er.code?er:{code:eu.Status.INTERNAL,details:`Received "grpc-encoding" header "${et}" but ${et} decompression failed`}))}this.stream.on("data",eh),this.stream.on("end",ed),this.stream.on("error",ed)})}async deserializeMessageWithInternalError(et){try{return this.deserializeMessage(et)}catch(et){throw{details:(0,ep.getErrorMessage)(et),code:eu.Status.INTERNAL}}}serializeMessage(et){let er=this.handler.serialize(et),en=er.byteLength,ei=Buffer.allocUnsafe(en+5);return ei.writeUInt8(0,0),ei.writeUInt32BE(en,1),er.copy(ei,5),ei}deserializeMessage(et){return this.handler.deserialize(et)}async sendUnaryMessage(et,er,en,ei){if(!this.checkCancelled()){if(void 0===en&&(en=null),et){!Object.prototype.hasOwnProperty.call(et,"metadata")&&en&&(et.metadata=en),this.sendError(et);return}try{let et=this.serializeMessage(er);this.write(et),this.sendStatus({code:eu.Status.OK,details:"OK",metadata:en})}catch(et){this.sendError({details:(0,ep.getErrorMessage)(et),code:eu.Status.INTERNAL})}}}sendStatus(et){var er,en;if(this.emit("callEnd",et.code),this.emit("streamEnd",et.code===eu.Status.OK),!this.checkCancelled()){if(em("Request to method "+(null===(er=this.handler)||void 0===er?void 0:er.path)+" ended with status code: "+eu.Status[et.code]+" details: "+et.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var er;let en=Object.assign({[eb]:et.code,[ev]:encodeURI(et.details)},null===(er=et.metadata)||void 0===er?void 0:er.toHttp2Headers());this.stream.sendTrailers(en),this.statusSent=!0}),this.stream.end());else{let er=Object.assign(Object.assign({[eb]:et.code,[ev]:encodeURI(et.details)},eC),null===(en=et.metadata)||void 0===en?void 0:en.toHttp2Headers());this.stream.respond(er,{endStream:!0}),this.statusSent=!0}}}sendError(et){let er={code:eu.Status.UNKNOWN,details:"message"in et?et.message:"Unknown Error",metadata:"metadata"in et&&void 0!==et.metadata?et.metadata:null};"code"in et&&"number"==typeof et.code&&Number.isInteger(et.code)&&(er.code=et.code,"details"in et&&"string"==typeof et.details&&(er.details=et.details)),this.sendStatus(er)}write(et){if(!this.checkCancelled()){if(-1!==this.maxSendMessageSize&&et.length>this.maxSendMessageSize){this.sendError({code:eu.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${et.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(et)}}resume(){this.stream.resume()}setupSurfaceCall(et){this.once("cancelled",er=>{et.cancelled=!0,et.emit("cancelled",er)}),this.once("callEnd",er=>et.emit("callEnd",er))}setupReadable(et,er){let en=new eh.StreamDecoder(this.maxReceiveMessageSize),ei=!1,es=!1,ea=!1,eo=async()=>{ea||!ei||es||(ea=!0,await this.pushOrBufferMessage(et,null))};this.stream.on("data",async ei=>{let ea;try{ea=en.write(ei)}catch(et){this.sendError({code:eu.Status.RESOURCE_EXHAUSTED,details:et.message});return}for(let en of(es=!0,this.stream.pause(),ea)){let ei;this.emit("receiveMessage");let es=1===en.readUInt8(0),ea=es?er:"identity";try{ei=await this.getDecompressedMessage(en,ea)}catch(et){this.sendError(et);return}if(!ei)return;await this.pushOrBufferMessage(et,ei)}es=!1,this.stream.resume(),await eo()}),this.stream.once("end",async()=>{ei=!0,await eo()})}consumeUnpushedMessages(et){for(this.canPush=!0;this.messagesToPush.length>0;){let er=this.messagesToPush.shift(),en=et.push(er);if(null===er||!1===en){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(et,er){this.isPushPending?this.bufferedMessages.push(er):await this.pushMessage(et,er)}async pushMessage(et,er){if(null===er){em("Received end of stream"),this.canPush?et.push(null):this.messagesToPush.push(null);return}em("Received message of length "+er.length),this.isPushPending=!0;try{let en=await this.deserializeMessage(er);this.canPush?et.push(en)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(en)}catch(en){this.bufferedMessages.length=0;let er=(0,ep.getErrorCode)(en);(null===er||er<eu.Status.OK||er>eu.Status.UNAUTHENTICATED)&&(er=eu.Status.INTERNAL),et.emit("error",{details:(0,ep.getErrorMessage)(en),code:er})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(et,this.bufferedMessages.shift())}getPeer(){var et;let er=null===(et=this.stream.session)||void 0===et?void 0:et.socket;return null!=er&&er.remoteAddress?er.remotePort?`${er.remoteAddress}:${er.remotePort}`:er.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function eD(et){let er=Error("Deadline exceeded");er.code=eu.Status.DEADLINE_EXCEEDED,et.sendError(er),et.cancelled=!0,et.emit("cancelled","deadline")}er.Http2ServerCallStream=eR},62501:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.ServerCredentials=void 0;let ei=en(66801);class es{static createInsecure(){return new ea}static createSsl(et,er,en=!1){if(null!==et&&!Buffer.isBuffer(et))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(er))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof en)throw TypeError("checkClientCertificate must be a boolean");let es=[],ea=[];for(let et=0;et<er.length;et++){let en=er[et];if(null===en||"object"!=typeof en)throw TypeError(`keyCertPair[${et}] must be an object`);if(!Buffer.isBuffer(en.private_key))throw TypeError(`keyCertPair[${et}].private_key must be a Buffer`);if(!Buffer.isBuffer(en.cert_chain))throw TypeError(`keyCertPair[${et}].cert_chain must be a Buffer`);es.push(en.cert_chain),ea.push(en.private_key)}return new eo({ca:et||(0,ei.getDefaultRootsData)()||void 0,cert:es,key:ea,requestCert:en,ciphers:ei.CIPHER_SUITES})}}er.ServerCredentials=es;class ea extends es{_isSecure(){return!1}_getSettings(){return null}}class eo extends es{constructor(et){super(),this.options=et}_isSecure(){return!0}_getSettings(){return this.options}}},92903:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Server=void 0;let ei=en(85158),es=en(69238),ea=en(17574),eo=en(62501),eu=en(14755),ec=en(68200),eh=en(72782),ed=en(14717),ep=en(83316),ef=2147483647,em=2147483647,eg=2e4,{HTTP2_HEADER_PATH:ey}=ei.constants,ev="server";function eb(){}function eS(et){return{code:es.Status.UNIMPLEMENTED,details:`The server does not implement the method ${et}`}}function eT(et,er){let en=eS(er);switch(et){case"unary":return(et,er)=>{er(en,null)};case"clientStream":return(et,er)=>{er(en,null)};case"serverStream":return et=>{et.emit("error",en)};case"bidi":return et=>{et.emit("error",en)};default:throw Error(`Invalid handlerType ${et}`)}}class ew{constructor(et){var er,en,ei,es;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new ep.ChannelzTrace,this.callTracker=new ep.ChannelzCallTracker,this.listenerChildrenTracker=new ep.ChannelzChildrenTracker,this.sessionChildrenTracker=new ep.ChannelzChildrenTracker,this.options=null!=et?et:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,ep.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(er=this.options["grpc.max_connection_age_ms"])&&void 0!==er?er:ef,this.maxConnectionAgeGraceMs=null!==(en=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==en?en:ef,this.keepaliveTimeMs=null!==(ei=this.options["grpc.keepalive_time_ms"])&&void 0!==ei?ei:em,this.keepaliveTimeoutMs=null!==(es=this.options["grpc.keepalive_timeout_ms"])&&void 0!==es?es:eg,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(et){return()=>{var er,en,ei;let es;let ea=this.sessions.get(et),eo=et.socket,eu=eo.remoteAddress?(0,eh.stringToSubchannelAddress)(eo.remoteAddress,eo.remotePort):null,ec=eo.localAddress?(0,eh.stringToSubchannelAddress)(eo.localAddress,eo.localPort):null;if(et.encrypted){let et=eo,en=et.getCipher(),ei=et.getCertificate(),ea=et.getPeerCertificate();es={cipherSuiteStandardName:null!==(er=en.standardName)&&void 0!==er?er:null,cipherSuiteOtherName:en.standardName?null:en.name,localCertificate:ei&&"raw"in ei?ei.raw:null,remoteCertificate:ea&&"raw"in ea?ea.raw:null}}else es=null;let ed={remoteAddress:eu,localAddress:ec,security:es,remoteName:null,streamsStarted:ea.streamTracker.callsStarted,streamsSucceeded:ea.streamTracker.callsSucceeded,streamsFailed:ea.streamTracker.callsFailed,messagesSent:ea.messagesSent,messagesReceived:ea.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:ea.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:ea.lastMessageSentTimestamp,lastMessageReceivedTimestamp:ea.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(en=et.state.localWindowSize)&&void 0!==en?en:null,remoteFlowControlWindow:null!==(ei=et.state.remoteWindowSize)&&void 0!==ei?ei:null};return ed}}trace(et){ec.trace(es.LogVerbosity.DEBUG,ev,"("+this.channelzRef.id+") "+et)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(et,er){if(null===et||"object"!=typeof et||null===er||"object"!=typeof er)throw Error("addService() requires two objects as arguments");let en=Object.keys(et);if(0===en.length)throw Error("Cannot add an empty service to a server");en.forEach(en=>{let ei,es;let ea=et[en];ei=ea.requestStream?ea.responseStream?"bidi":"clientStream":ea.responseStream?"serverStream":"unary";let eo=er[en];void 0===eo&&"string"==typeof ea.originalName&&(eo=er[ea.originalName]),es=void 0!==eo?eo.bind(er):eT(ei,en);let eu=this.register(ea.path,es,ea.responseSerialize,ea.requestDeserialize,ei);if(!1===eu)throw Error(`Method handler for ${ea.path} already provided.`)})}removeService(et){if(null===et||"object"!=typeof et)throw Error("removeService() requires object as argument");let er=Object.keys(et);er.forEach(er=>{let en=et[er];this.unregister(en.path)})}bind(et,er){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(et,er,en){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof et)throw TypeError("port must be a string");if(null===er||!(er instanceof eo.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof en)throw TypeError("callback must be a function");let ea=(0,ed.parseUri)(et);if(null===ea)throw Error(`Could not parse port "${et}"`);let ef=(0,eu.mapUriDefaultScheme)(ea);if(null===ef)throw Error(`Could not get a default scheme for port "${et}"`);let em={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?em.maxSessionMemory=this.options["grpc-node.max_session_memory"]:em.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(em.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let eg=(et,er)=>{process.nextTick(()=>en(et,er))},ey=()=>{let et;if(er._isSecure()){let en=Object.assign(em,er._getSettings());en.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(et=ei.createSecureServer(en)).on("secureConnection",et=>{et.on("error",et=>{this.trace("An incoming TLS connection closed with error: "+et.message)})})}else et=ei.createServer(em);return et.setTimeout(0,eb),this._setupHandlers(et),et},ev=(et,er,en)=>0===et.length?Promise.resolve({port:er,count:en}):Promise.all(et.map(et=>{let en;this.trace("Attempting to bind "+(0,eh.subchannelAddressToString)(et)),en=(0,eh.isTcpSubchannelAddress)(et)?{host:et.host,port:er}:et;let ei=ey();return new Promise((es,ea)=>{let eo=er=>{this.trace("Failed to bind "+(0,eh.subchannelAddressToString)(et)+" with error "+er.message),es(er)};ei.once("error",eo),ei.listen(en,()=>{let et;if(this.shutdown){ei.close(),es(Error("bindAsync failed because server is shutdown"));return}let en=ei.address();et="string"==typeof en?{path:en}:{host:en.address,port:en.port};let ea=(0,ep.registerChannelzSocket)((0,eh.subchannelAddressToString)(et),()=>({localAddress:et,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(ea),this.http2ServerList.push({server:ei,channelzRef:ea}),this.trace("Successfully bound "+(0,eh.subchannelAddressToString)(et)),es("port"in et?et.port:er),ei.removeListener("error",eo)})})})).then(et=>{let ei=0;for(let en of et)if("number"==typeof en&&(ei+=1,en!==er))throw Error("Invalid state: multiple port numbers added from single address");return{port:er,count:ei+en}}),eS=et=>{if(0===et.length)return Promise.resolve({port:0,count:0});let er=et[0],en=ey();return new Promise((ei,es)=>{let ea=en=>{this.trace("Failed to bind "+(0,eh.subchannelAddressToString)(er)+" with error "+en.message),ei(eS(et.slice(1)))};en.once("error",ea),en.listen(er,()=>{if(this.shutdown){en.close(),ei({port:0,count:0});return}let er=en.address(),es={host:er.address,port:er.port},eo=(0,ep.registerChannelzSocket)((0,eh.subchannelAddressToString)(es),()=>({localAddress:es,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(eo),this.http2ServerList.push({server:en,channelzRef:eo}),this.trace("Successfully bound "+(0,eh.subchannelAddressToString)(es)),ei(ev(et.slice(1),er.port,1)),en.removeListener("error",ea)})})},eT={onSuccessfulResolution:(er,en,ei)=>{let ea;if(eT.onSuccessfulResolution=()=>{},this.shutdown&&eg(Error("bindAsync failed because server is shutdown"),0),0===er.length){eg(Error(`No addresses resolved for port ${et}`),0);return}(ea=(0,eh.isTcpSubchannelAddress)(er[0])?0===er[0].port?eS(er):ev(er,er[0].port,0):ev(er,1,0)).then(et=>{if(0===et.count){let et=`No address added out of total ${er.length} resolved`;ec.log(es.LogVerbosity.ERROR,et),eg(Error(et),0)}else et.count<er.length&&ec.log(es.LogVerbosity.INFO,`WARNING Only ${et.count} addresses added out of total ${er.length} resolved`),eg(null,et.port)},et=>{let en=`No address added out of total ${er.length} resolved`;ec.log(es.LogVerbosity.ERROR,en),eg(Error(en),0)})},onError:et=>{eg(Error(et.details),0)}},ew=(0,eu.createResolver)(ef,eT,this.options);ew.updateResolution()}forceShutdown(){for(let{server:et,channelzRef:er}of this.http2ServerList)et.listening&&et.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(er),(0,ep.unregisterChannelzRef)(er))});this.started=!1,this.shutdown=!0,this.sessions.forEach((et,er)=>{er.destroy(ei.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,ep.unregisterChannelzRef)(this.channelzRef)}register(et,er,en,ei,es){return!this.handlers.has(et)&&(this.handlers.set(et,{func:er,serialize:en,deserialize:ei,type:es,path:et}),!0)}unregister(et){return this.handlers.delete(et)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:et})=>!0!==et.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(et){let er=er=>{this.channelzEnabled&&(0,ep.unregisterChannelzRef)(this.channelzRef),et(er)},en=0;function ei(){0==--en&&er()}for(let{server:et,channelzRef:er}of(this.started=!1,this.shutdown=!0,this.http2ServerList))et.listening&&(en++,et.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(er),(0,ep.unregisterChannelzRef)(er)),ei()}));this.sessions.forEach((et,er)=>{er.closed||(en+=1,er.close(ei))}),0===en&&er()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(et,er){let en=er[ei.constants.HTTP2_HEADER_CONTENT_TYPE];return!!("string"==typeof en&&en.startsWith("application/grpc"))||(et.respond({[ei.constants.HTTP2_HEADER_STATUS]:ei.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(et){this.trace("Received call to method "+et+" at address "+this.serverAddressString);let er=this.handlers.get(et);return void 0===er?(this.trace("No handler registered for method "+et+". Sending UNIMPLEMENTED status."),null):er}_respondWithError(et,er,en=null){let ei=new ea.Http2ServerCallStream(er,null,this.options);void 0===et.code&&(et.code=es.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==en||en.streamTracker.addCallFailed()),ei.sendError(et)}_channelzHandler(et,er){let en=this.sessions.get(et.session);if(this.callTracker.addCallStarted(),null==en||en.streamTracker.addCallStarted(),!this._verifyContentType(et,er)){this.callTracker.addCallFailed(),null==en||en.streamTracker.addCallFailed();return}let ei=er[ey],eo=this._retrieveHandler(ei);if(!eo){this._respondWithError(eS(ei),et,en);return}let eu=new ea.Http2ServerCallStream(et,eo,this.options);eu.once("callEnd",et=>{et===es.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),en&&(eu.once("streamEnd",et=>{et?en.streamTracker.addCallSucceeded():en.streamTracker.addCallFailed()}),eu.on("sendMessage",()=>{en.messagesSent+=1,en.lastMessageSentTimestamp=new Date}),eu.on("receiveMessage",()=>{en.messagesReceived+=1,en.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(eu,eo,er)||(this.callTracker.addCallFailed(),null==en||en.streamTracker.addCallFailed(),eu.sendError({code:es.Status.INTERNAL,details:`Unknown handler type: ${eo.type}`}))}_streamHandler(et,er){if(!0!==this._verifyContentType(et,er))return;let en=er[ey],ei=this._retrieveHandler(en);if(!ei){this._respondWithError(eS(en),et,null);return}let eo=new ea.Http2ServerCallStream(et,ei,this.options);this._runHandlerForCall(eo,ei,er)||eo.sendError({code:es.Status.INTERNAL,details:`Unknown handler type: ${ei.type}`})}_runHandlerForCall(et,er,en){var ei;let es=et.receiveMetadata(en),ea=null!==(ei=es.get("grpc-encoding")[0])&&void 0!==ei?ei:"identity";es.remove("grpc-encoding");let{type:eo}=er;if("unary"===eo)eE(et,er,es,ea);else if("clientStream"===eo)eC(et,er,es,ea);else if("serverStream"===eo)e_(et,er,es,ea);else{if("bidi"!==eo)return!1;eI(et,er,es,ea)}return!0}_setupHandlers(et){if(null===et)return;let er=et.address(),en="null";er&&(en="string"==typeof er?er:er.address+":"+er.port),this.serverAddressString=en;let es=this.channelzEnabled?this._channelzHandler:this._streamHandler;et.on("stream",es.bind(this)),et.on("session",et=>{var er,en,es,ea,eo;if(!this.started){et.destroy();return}let eu=(0,ep.registerChannelzSocket)(null!==(er=et.socket.remoteAddress)&&void 0!==er?er:"unknown",this.getChannelzSessionInfoGetter(et),this.channelzEnabled),ec={ref:eu,streamTracker:new ep.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(et,ec);let eh=et.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+eh),this.sessionChildrenTracker.refChild(eu));let ed=null,em=null,eg=!1;if(this.maxConnectionAgeMs!==ef){let er=this.maxConnectionAgeMs/10,ea=Math.random()*er*2-er;ed=null===(es=(en=setTimeout(()=>{var er,en;eg=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+eh);try{et.goaway(ei.constants.NGHTTP2_NO_ERROR,2147483647,Buffer.from("max_age"))}catch(er){et.destroy();return}et.close(),this.maxConnectionAgeGraceMs!==ef&&(em=null===(en=(er=setTimeout(()=>{et.destroy()},this.maxConnectionAgeGraceMs)).unref)||void 0===en?void 0:en.call(er))},this.maxConnectionAgeMs+ea)).unref)||void 0===es?void 0:es.call(en)}let ey=null===(eo=(ea=setInterval(()=>{var er,en;let ei=null===(en=(er=setTimeout(()=>{eg=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+eh),et.close()},this.keepaliveTimeoutMs)).unref)||void 0===en?void 0:en.call(er);try{et.ping((et,er,en)=>{clearTimeout(ei)})}catch(er){et.destroy()}},this.keepaliveTimeMs)).unref)||void 0===eo?void 0:eo.call(ea);et.on("close",()=>{this.channelzEnabled&&(eg||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+eh),this.sessionChildrenTracker.unrefChild(eu),(0,ep.unregisterChannelzRef)(eu)),ed&&clearTimeout(ed),em&&clearTimeout(em),ey&&clearTimeout(ey),this.sessions.delete(et)})})}}async function eE(et,er,en,ei){try{let es=await et.receiveUnaryMessage(ei);if(void 0===es||et.cancelled)return;let eo=new ea.ServerUnaryCallImpl(et,en,es);er.func(eo,(er,en,ei,es)=>{et.sendUnaryMessage(er,en,ei,es)})}catch(er){et.sendError(er)}}function eC(et,er,en,ei){let es=new ea.ServerReadableStreamImpl(et,en,er.deserialize,ei);function eo(er,en,ei,ea){es.destroy(),et.sendUnaryMessage(er,en,ei,ea)}et.cancelled||(es.on("error",eo),er.func(es,eo))}async function e_(et,er,en,ei){try{let es=await et.receiveUnaryMessage(ei);if(void 0===es||et.cancelled)return;let eo=new ea.ServerWritableStreamImpl(et,en,er.serialize,es);er.func(eo)}catch(er){et.sendError(er)}}function eI(et,er,en,ei){let es=new ea.ServerDuplexStreamImpl(et,en,er.serialize,er.deserialize,ei);et.cancelled||er.func(es)}er.Server=ew},45914:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.extractAndSelectServiceConfig=er.validateServiceConfig=er.validateRetryThrottling=void 0;let ei=en(22037),es=en(69238),ea=en(77203),eo=/^\d+(\.\d{1,9})?s$/,eu="node";function ec(et){if("service"in et&&""!==et.service){if("string"!=typeof et.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof et.service}`);if(!("method"in et)||""===et.method)return{service:et.service};if("string"!=typeof et.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof et.service}`);return{service:et.service,method:et.method}}if("method"in et&&void 0!==et.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function eh(et){if(!("maxAttempts"in et)||!Number.isInteger(et.maxAttempts)||et.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in et)||"string"!=typeof et.initialBackoff||!eo.test(et.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in et)||"string"!=typeof et.maxBackoff||!eo.test(et.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in et)||"number"!=typeof et.backoffMultiplier||et.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in et&&Array.isArray(et.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===et.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let er of et.retryableStatusCodes)if("number"==typeof er){if(!Object.values(es.Status).includes(er))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof er){if(!Object.values(es.Status).includes(er.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:et.maxAttempts,initialBackoff:et.initialBackoff,maxBackoff:et.maxBackoff,backoffMultiplier:et.backoffMultiplier,retryableStatusCodes:et.retryableStatusCodes}}function ed(et){if(!("maxAttempts"in et)||!Number.isInteger(et.maxAttempts)||et.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in et&&("string"!=typeof et.hedgingDelay||!eo.test(et.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in et&&Array.isArray(et.nonFatalStatusCodes))for(let er of et.nonFatalStatusCodes)if("number"==typeof er){if(!Object.values(es.Status).includes(er))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof er){if(!Object.values(es.Status).includes(er.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let er={maxAttempts:et.maxAttempts};return et.hedgingDelay&&(er.hedgingDelay=et.hedgingDelay),et.nonFatalStatusCodes&&(er.nonFatalStatusCodes=et.nonFatalStatusCodes),er}function ep(et){var er;let en={name:[]};if(!("name"in et)||!Array.isArray(et.name))throw Error("Invalid method config: invalid name array");for(let er of et.name)en.name.push(ec(er));if("waitForReady"in et){if("boolean"!=typeof et.waitForReady)throw Error("Invalid method config: invalid waitForReady");en.waitForReady=et.waitForReady}if("timeout"in et){if("object"==typeof et.timeout){if(!("seconds"in et.timeout)||"number"!=typeof et.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in et.timeout)||"number"!=typeof et.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");en.timeout=et.timeout}else if("string"==typeof et.timeout&&eo.test(et.timeout)){let ei=et.timeout.substring(0,et.timeout.length-1).split(".");en.timeout={seconds:0|ei[0],nanos:(null!==(er=ei[1])&&void 0!==er?er:0)|0}}else throw Error("Invalid method config: invalid timeout")}if("maxRequestBytes"in et){if("number"!=typeof et.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");en.maxRequestBytes=et.maxRequestBytes}if("maxResponseBytes"in et){if("number"!=typeof et.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");en.maxResponseBytes=et.maxResponseBytes}if("retryPolicy"in et){if("hedgingPolicy"in et)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");en.retryPolicy=eh(et.retryPolicy)}else"hedgingPolicy"in et&&(en.hedgingPolicy=ed(et.hedgingPolicy));return en}function ef(et){if(!("maxTokens"in et)||"number"!=typeof et.maxTokens||et.maxTokens<=0||et.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in et)||"number"!=typeof et.tokenRatio||et.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+et.maxTokens.toFixed(3),tokenRatio:+et.tokenRatio.toFixed(3)}}function em(et){let er={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in et){if("string"==typeof et.loadBalancingPolicy)er.loadBalancingPolicy=et.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy")}if("loadBalancingConfig"in et){if(Array.isArray(et.loadBalancingConfig))for(let en of et.loadBalancingConfig)er.loadBalancingConfig.push((0,ea.validateLoadBalancingConfig)(en));else throw Error("Invalid service config: invalid loadBalancingConfig")}if("methodConfig"in et&&Array.isArray(et.methodConfig))for(let en of et.methodConfig)er.methodConfig.push(ep(en));"retryThrottling"in et&&(er.retryThrottling=ef(et.retryThrottling));let en=[];for(let et of er.methodConfig)for(let er of et.name){for(let et of en)if(er.service===et.service&&er.method===et.method)throw Error(`Invalid service config: duplicate name ${er.service}/${er.method}`);en.push(er)}return er}function eg(et){if(!("serviceConfig"in et))throw Error("Invalid service config choice: missing service config");let er={serviceConfig:em(et.serviceConfig)};if("clientLanguage"in et){if(Array.isArray(et.clientLanguage))for(let en of(er.clientLanguage=[],et.clientLanguage))if("string"==typeof en)er.clientLanguage.push(en);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage")}if("clientHostname"in et){if(Array.isArray(et.clientHostname))for(let en of(er.clientHostname=[],et.clientHostname))if("string"==typeof en)er.clientHostname.push(en);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname")}if("percentage"in et){if("number"==typeof et.percentage&&0<=et.percentage&&et.percentage<=100)er.percentage=et.percentage;else throw Error("Invalid service config choice: invalid percentage")}let en=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let er in et)if(!en.includes(er))throw Error(`Invalid service config choice: unexpected field ${er}`);return er}function ey(et,er){if(!Array.isArray(et))throw Error("Invalid service config list");for(let en of et){let et=eg(en);if("number"!=typeof et.percentage||!(er>et.percentage)){if(Array.isArray(et.clientHostname)){let er=!1;for(let en of et.clientHostname)en===ei.hostname()&&(er=!0);if(!er)continue}if(Array.isArray(et.clientLanguage)){let er=!1;for(let en of et.clientLanguage)en===eu&&(er=!0);if(!er)continue}return et.serviceConfig}}throw Error("No matching service config found")}function ev(et,er){for(let en of et)if(en.length>0&&en[0].startsWith("grpc_config=")){let et=en.join("").substring(12),ei=JSON.parse(et);return ey(ei,er)}return null}er.validateRetryThrottling=ef,er.validateServiceConfig=em,er.extractAndSelectServiceConfig=ev},9929:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.StatusBuilder=void 0;class en{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(et){return this.code=et,this}withDetails(et){return this.details=et,this}withMetadata(et){return this.metadata=et,this}build(){let et={};return null!==this.code&&(et.code=this.code),null!==this.details&&(et.details=this.details),null!==this.metadata&&(et.metadata=this.metadata),et}}er.StatusBuilder=en},80272:(et,er)=>{"use strict";var en;Object.defineProperty(er,"__esModule",{value:!0}),er.StreamDecoder=void 0,function(et){et[et.NO_DATA=0]="NO_DATA",et[et.READING_SIZE=1]="READING_SIZE",et[et.READING_MESSAGE=2]="READING_MESSAGE"}(en||(en={}));class ei{constructor(et){this.maxReadMessageLength=et,this.readState=en.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(et){let er,ei=0,es=[];for(;ei<et.length;)switch(this.readState){case en.NO_DATA:this.readCompressFlag=et.slice(ei,ei+1),ei+=1,this.readState=en.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case en.READING_SIZE:if(er=Math.min(et.length-ei,this.readSizeRemaining),et.copy(this.readPartialSize,4-this.readSizeRemaining,ei,ei+er),this.readSizeRemaining-=er,ei+=er,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=en.READING_MESSAGE;else{let et=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=en.NO_DATA,es.push(et)}}break;case en.READING_MESSAGE:if(er=Math.min(et.length-ei,this.readMessageRemaining),this.readPartialMessage.push(et.slice(ei,ei+er)),this.readMessageRemaining-=er,ei+=er,0===this.readMessageRemaining){let et=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),er=Buffer.concat(et,this.readMessageSize+5);this.readState=en.NO_DATA,es.push(er)}break;default:throw Error("Unexpected read state")}return es}}er.StreamDecoder=ei},72782:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.stringToSubchannelAddress=er.subchannelAddressToString=er.subchannelAddressEqual=er.isTcpSubchannelAddress=void 0;let ei=en(41808);function es(et){return"port"in et}function ea(et,er){return!et&&!er||!!et&&!!er&&(es(et)?es(er)&&et.host===er.host&&et.port===er.port:!es(er)&&et.path===er.path)}function eo(et){return es(et)?et.host+":"+et.port:et.path}er.isTcpSubchannelAddress=es,er.subchannelAddressEqual=ea,er.subchannelAddressToString=eo;let eu=443;function ec(et,er){return(0,ei.isIP)(et)?{host:et,port:null!=er?er:eu}:{path:et}}er.stringToSubchannelAddress=ec},32210:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Http2SubchannelCall=void 0;let ei=en(85158),es=en(22037),ea=en(69238),eo=en(32908),eu=en(80272),ec=en(68200),eh=en(69238),ed="subchannel_call";function ep(et){for(let[er,en]of Object.entries(es.constants.errno))if(en===et)return er;return"Unknown system error "+et}class ef{constructor(et,er,en,es,ec){var eh;this.http2Stream=et,this.callEventTracker=er,this.listener=en,this.transport=es,this.callId=ec,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=ea.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let ed=null!==(eh=es.getOptions()["grpc.max_receive_message_length"])&&void 0!==eh?eh:ea.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new eu.StreamDecoder(ed),et.on("response",(et,er)=>{let en="";for(let er of Object.keys(et))en+="		"+er+": "+et[er]+"\n";switch(this.trace("Received server headers:\n"+en),et[":status"]){case 400:this.mappedStatusCode=ea.Status.INTERNAL;break;case 401:this.mappedStatusCode=ea.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=ea.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=ea.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=ea.Status.UNAVAILABLE;break;default:this.mappedStatusCode=ea.Status.UNKNOWN}if(er&ei.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(et);else{let er;try{er=eo.Metadata.fromHttp2Headers(et)}catch(et){this.endCall({code:ea.Status.UNKNOWN,details:et.message,metadata:new eo.Metadata});return}this.listener.onReceiveMetadata(er)}}),et.on("trailers",et=>{this.handleTrailers(et)}),et.on("data",et=>{let er;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+et.length);try{er=this.decoder.write(et)}catch(et){this.cancelWithStatus(ea.Status.RESOURCE_EXHAUSTED,et.message);return}for(let et of er)this.trace("parsed message of length "+et.length),this.callEventTracker.addMessageReceived(),this.tryPush(et)}}),et.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),et.on("close",()=>{process.nextTick(()=>{var er;let en;if(this.trace("HTTP/2 stream closed with code "+et.rstCode),(null===(er=this.finalStatus)||void 0===er?void 0:er.code)===ea.Status.OK)return;let es="";switch(et.rstCode){case ei.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;en=ea.Status.INTERNAL,es=`Received RST_STREAM with code ${et.rstCode}`;break;case ei.constants.NGHTTP2_REFUSED_STREAM:en=ea.Status.UNAVAILABLE,es="Stream refused by server";break;case ei.constants.NGHTTP2_CANCEL:en=ea.Status.CANCELLED,es="Call cancelled";break;case ei.constants.NGHTTP2_ENHANCE_YOUR_CALM:en=ea.Status.RESOURCE_EXHAUSTED,es="Bandwidth exhausted or memory limit exceeded";break;case ei.constants.NGHTTP2_INADEQUATE_SECURITY:en=ea.Status.PERMISSION_DENIED,es="Protocol not secure enough";break;case ei.constants.NGHTTP2_INTERNAL_ERROR:en=ea.Status.INTERNAL,null===this.internalError?es=`Received RST_STREAM with code ${et.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(en=ea.Status.UNAVAILABLE,es=this.internalError.message):es=`Received RST_STREAM with code ${et.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:en=ea.Status.INTERNAL,es=`Received RST_STREAM with code ${et.rstCode}`}this.endCall({code:en,details:es,metadata:new eo.Metadata,rstCode:et.rstCode})})}),et.on("error",et=>{"ERR_HTTP2_STREAM_ERROR"!==et.code&&(this.trace("Node error event: message="+et.message+" code="+et.code+" errno="+ep(et.errno)+" syscall="+et.syscall),this.internalError=et),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:ea.Status.UNAVAILABLE,details:"Connection dropped",metadata:new eo.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(et){ec.trace(eh.LogVerbosity.DEBUG,ed,"["+this.callId+"] "+et)}endCall(et){(null===this.finalStatus||this.finalStatus.code===ea.Status.OK)&&(this.finalStatus=et,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===ea.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(et){this.trace("pushing to reader message of length "+(et instanceof Buffer?et.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(et),this.maybeOutputStatus())})}tryPush(et){this.canPush?(this.http2Stream.pause(),this.push(et)):(this.trace("unpushedReadMessages.push message of length "+et.length),this.unpushedReadMessages.push(et))}handleTrailers(et){let er;this.callEventTracker.onStreamEnd(!0);let en="";for(let er of Object.keys(et))en+="		"+er+": "+et[er]+"\n";this.trace("Received server trailers:\n"+en);try{er=eo.Metadata.fromHttp2Headers(et)}catch(et){er=new eo.Metadata}let ei=er.getMap(),es=this.mappedStatusCode;if(es===ea.Status.UNKNOWN&&"string"==typeof ei["grpc-status"]){let et=Number(ei["grpc-status"]);et in ea.Status&&(es=et,this.trace("received status code "+et+" from server")),er.remove("grpc-status")}let eu="";if("string"==typeof ei["grpc-message"]){try{eu=decodeURI(ei["grpc-message"])}catch(et){eu=ei["grpc-message"]}er.remove("grpc-message"),this.trace('received status details string "'+eu+'" from server')}let ec={code:es,details:eu,metadata:er};this.endCall(ec)}destroyHttp2Stream(){var et;if(!this.http2Stream.destroyed){let er;er=(null===(et=this.finalStatus)||void 0===et?void 0:et.code)===ea.Status.OK?ei.constants.NGHTTP2_NO_ERROR:ei.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+er),this.http2Stream.close(er)}}cancelWithStatus(et,er){this.trace("cancelWithStatus code: "+et+' details: "'+er+'"'),this.endCall({code:et,details:er,metadata:new eo.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==ea.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let et=this.unpushedReadMessages.shift();this.push(et);return}this.http2Stream.resume()}sendMessageWithContext(et,er){this.trace("write() called with message of length "+er.length);let en=er=>{process.nextTick(()=>{var en;let ei=ea.Status.UNAVAILABLE;(null==er?void 0:er.code)==="ERR_STREAM_WRITE_AFTER_END"&&(ei=ea.Status.INTERNAL),er&&this.cancelWithStatus(ei,`Write error: ${er.message}`),null===(en=et.callback)||void 0===en||en.call(et)})};this.trace("sending data chunk of length "+er.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(er,en)}catch(et){this.endCall({code:ea.Status.UNAVAILABLE,details:`Write failed with error ${et.message}`,metadata:new eo.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}er.Http2SubchannelCall=ef},69609:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.BaseSubchannelWrapper=void 0;class en{constructor(et){this.child=et}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(et){this.child.addConnectivityStateListener(et)}removeConnectivityStateListener(et){this.child.removeConnectivityStateListener(et)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(et){this.child.throttleKeepalive(et)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(et){return this.getRealSubchannel()===et.getRealSubchannel()}}er.BaseSubchannelWrapper=en},88364:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.getSubchannelPool=er.SubchannelPool=void 0;let ei=en(70332),es=en(53904),ea=en(72782),eo=en(14717),eu=en(16559),ec=1e4;class eh{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let et=!0;for(let er in this.pool){let en=this.pool[er],ei=en.filter(et=>!et.subchannel.unrefIfOneRef());ei.length>0&&(et=!1),this.pool[er]=ei}et&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var et,er;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},ec),null===(er=(et=this.cleanupTimer).unref)||void 0===er||er.call(et))}getOrCreateSubchannel(et,er,en,ec){this.ensureCleanupTask();let eh=(0,eo.uriToString)(et);if(eh in this.pool){let et=this.pool[eh];for(let es of et)if((0,ea.subchannelAddressEqual)(er,es.subchannelAddress)&&(0,ei.channelOptionsEqual)(en,es.channelArguments)&&ec._equals(es.channelCredentials))return es.subchannel}let ed=new es.Subchannel(et,er,en,ec,new eu.Http2SubchannelConnector(et));return eh in this.pool||(this.pool[eh]=[]),this.pool[eh].push({subchannelAddress:er,channelArguments:en,channelCredentials:ec,subchannel:ed}),ed.ref(),ed}}er.SubchannelPool=eh;let ed=new eh;function ep(et){return et?ed:new eh}er.getSubchannelPool=ep},53904:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Subchannel=void 0;let ei=en(91360),es=en(77257),ea=en(68200),eo=en(69238),eu=en(14717),ec=en(72782),eh=en(83316),ed="subchannel",ep=2147483647;class ef{constructor(et,er,en,ea,eo){var eu;this.channelTarget=et,this.subchannelAddress=er,this.options=en,this.credentials=ea,this.connector=eo,this.connectivityState=ei.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new eh.ChannelzCallTracker,this.childrenTracker=new eh.ChannelzChildrenTracker,this.streamTracker=new eh.ChannelzCallTracker;let ed={initialDelay:en["grpc.initial_reconnect_backoff_ms"],maxDelay:en["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new es.BackoffTimeout(()=>{this.handleBackoffTimer()},ed),this.backoffTimeout.unref(),this.subchannelAddressString=(0,ec.subchannelAddressToString)(er),this.keepaliveTime=null!==(eu=en["grpc.keepalive_time_ms"])&&void 0!==eu?eu:-1,0===en["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new eh.ChannelzTrace,this.channelzRef=(0,eh.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(en,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(et){ea.trace(eo.LogVerbosity.DEBUG,ed,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}refTrace(et){ea.trace(eo.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([ei.ConnectivityState.TRANSIENT_FAILURE],ei.ConnectivityState.CONNECTING):this.transitionToState([ei.ConnectivityState.TRANSIENT_FAILURE],ei.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let et=this.options;if(et["grpc.keepalive_time_ms"]){let er=Math.min(this.keepaliveTime,ep);et=Object.assign(Object.assign({},et),{"grpc.keepalive_time_ms":er})}this.connector.connect(this.subchannelAddress,this.credentials,et).then(et=>{this.transitionToState([ei.ConnectivityState.CONNECTING],ei.ConnectivityState.READY)?(this.transport=et,this.channelzEnabled&&this.childrenTracker.refChild(et.getChannelzRef()),et.addDisconnectListener(et=>{this.transitionToState([ei.ConnectivityState.READY],ei.ConnectivityState.IDLE),et&&this.keepaliveTime>0&&(this.keepaliveTime*=2,ea.log(eo.LogVerbosity.ERROR,`Connection to ${(0,eu.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):et.shutdown()},et=>{this.transitionToState([ei.ConnectivityState.CONNECTING],ei.ConnectivityState.TRANSIENT_FAILURE,`${et}`)})}transitionToState(et,er,en){var es,ea;if(-1===et.indexOf(this.connectivityState))return!1;this.trace(ei.ConnectivityState[this.connectivityState]+" -> "+ei.ConnectivityState[er]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+ei.ConnectivityState[er]);let eo=this.connectivityState;switch(this.connectivityState=er,er){case ei.ConnectivityState.READY:this.stopBackoff();break;case ei.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case ei.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(es=this.transport)||void 0===es||es.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case ei.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(ea=this.transport)||void 0===ea||ea.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${er}`)}for(let et of this.stateListeners)et(this,eo,er,this.keepaliveTime,en);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,eh.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([ei.ConnectivityState.CONNECTING,ei.ConnectivityState.READY],ei.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(et,er,en,ei){let es;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),es={onCallEnd:et=>{et.code===eo.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):es={},this.transport.createCall(et,er,en,ei,es)}startConnecting(){process.nextTick(()=>{this.transitionToState([ei.ConnectivityState.IDLE],ei.ConnectivityState.CONNECTING)||this.connectivityState!==ei.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(et){this.stateListeners.add(et)}removeConnectivityStateListener(et){this.stateListeners.delete(et)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([ei.ConnectivityState.TRANSIENT_FAILURE],ei.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(et){return et.getRealSubchannel()===this}throttleKeepalive(et){et>this.keepaliveTime&&(this.keepaliveTime=et)}}er.Subchannel=ef},66801:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.getDefaultRootsData=er.CIPHER_SUITES=void 0;let ei=en(57147);er.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let es=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,ea=null;function eo(){return es?(null===ea&&(ea=ei.readFileSync(es)),ea):null}er.getDefaultRootsData=eo},16559:(et,er,en)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.Http2SubchannelConnector=void 0;let ei=en(85158),es=en(24404),ea=en(83316),eo=en(69238),eu=en(18304),ec=en(68200),eh=en(14755),ed=en(72782),ep=en(14717),ef=en(41808),em=en(32210),eg=en(60060),ey="transport",ev="transport_flowctrl",eb=en(81513).i8,{HTTP2_HEADER_AUTHORITY:eS,HTTP2_HEADER_CONTENT_TYPE:eT,HTTP2_HEADER_METHOD:ew,HTTP2_HEADER_PATH:eE,HTTP2_HEADER_TE:eC,HTTP2_HEADER_USER_AGENT:e_}=ei.constants,eI=2e4,ek=Buffer.from("too_many_pings","ascii");class ex{constructor(et,er,en,es){this.session=et,this.options=en,this.remoteName=es,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=eI,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new ea.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,ed.subchannelAddressToString)(er),0===en["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,ea.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[en["grpc.primary_user_agent"],`grpc-node-js/${eb}`,en["grpc.secondary_user_agent"]].filter(et=>et).join(" "),"grpc.keepalive_time_ms"in en&&(this.keepaliveTimeMs=en["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in en&&(this.keepaliveTimeoutMs=en["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in en?this.keepaliveWithoutCalls=1===en["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,et.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),et.once("goaway",(et,er,en)=>{let es=!1;et===ei.constants.NGHTTP2_ENHANCE_YOUR_CALM&&en&&en.equals(ek)&&(es=!0),this.trace("connection closed by GOAWAY with code "+et+" and data "+(null==en?void 0:en.toString())),this.reportDisconnectToOwner(es)}),et.once("error",et=>{this.trace("connection closed with error "+et.message)}),ec.isTracerEnabled(ey)&&(et.on("remoteSettings",er=>{this.trace("new settings received"+(this.session!==et?" on the old connection":"")+": "+JSON.stringify(er))}),et.on("localSettings",er=>{this.trace("local settings acknowledged by remote"+(this.session!==et?" on the old connection":"")+": "+JSON.stringify(er))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var et,er,en;let ei;let es=this.session.socket,ea=es.remoteAddress?(0,ed.stringToSubchannelAddress)(es.remoteAddress,es.remotePort):null,eo=es.localAddress?(0,ed.stringToSubchannelAddress)(es.localAddress,es.localPort):null;if(this.session.encrypted){let er=es,en=er.getCipher(),ea=er.getCertificate(),eo=er.getPeerCertificate();ei={cipherSuiteStandardName:null!==(et=en.standardName)&&void 0!==et?et:null,cipherSuiteOtherName:en.standardName?null:en.name,localCertificate:ea&&"raw"in ea?ea.raw:null,remoteCertificate:eo&&"raw"in eo?eo.raw:null}}else ei=null;let eu={remoteAddress:ea,localAddress:eo,security:ei,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(er=this.session.state.localWindowSize)&&void 0!==er?er:null,remoteFlowControlWindow:null!==(en=this.session.state.remoteWindowSize)&&void 0!==en?en:null};return eu}trace(et){ec.trace(eo.LogVerbosity.DEBUG,ey,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}keepaliveTrace(et){ec.trace(eo.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}flowControlTrace(et){ec.trace(eo.LogVerbosity.DEBUG,ev,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}internalsTrace(et){ec.trace(eo.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+et)}reportDisconnectToOwner(et){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(er=>er(et)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let et of this.activeCalls)et.onDisconnect()})}addDisconnectListener(et){this.disconnectListeners.push(et)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var et,er;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null===(er=(et=this.keepaliveTimeoutId).unref)||void 0===er||er.call(et));try{this.session.ping((et,er,en)=>{et&&(this.keepaliveTrace("Ping failed with error "+et.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(et){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var et,er;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null===(er=(et=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)||void 0===er?void 0:er.call(et)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(et){this.activeCalls.delete(et),0===this.activeCalls.size&&this.session.unref()}addActiveCall(et){this.activeCalls.add(et),1!==this.activeCalls.size||(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(et,er,en,ei,es){let ea,eo,eu;let ec=et.toHttp2Headers();ec[eS]=er,ec[e_]=this.userAgent,ec[eT]="application/grpc",ec[ew]="POST",ec[eE]=en,ec[eC]="trailers";try{ea=this.session.request(ec)}catch(et){throw this.handleDisconnect(),et}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),eo={addMessageSent:()=>{var et;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null===(et=es.addMessageSent)||void 0===et||et.call(es)},addMessageReceived:()=>{var et;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null===(et=es.addMessageReceived)||void 0===et||et.call(es)},onCallEnd:et=>{var er;null===(er=es.onCallEnd)||void 0===er||er.call(es,et),this.removeActiveCall(eu)},onStreamEnd:et=>{var er;et?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null===(er=es.onStreamEnd)||void 0===er||er.call(es,et)}}):eo={addMessageSent:()=>{var et;null===(et=es.addMessageSent)||void 0===et||et.call(es)},addMessageReceived:()=>{var et;null===(et=es.addMessageReceived)||void 0===et||et.call(es)},onCallEnd:et=>{var er;null===(er=es.onCallEnd)||void 0===er||er.call(es,et),this.removeActiveCall(eu)},onStreamEnd:et=>{var er;null===(er=es.onStreamEnd)||void 0===er||er.call(es,et)}},eu=new em.Http2SubchannelCall(ea,eo,ei,this,(0,eg.getNextCallNumber)()),this.addActiveCall(eu),eu}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,ea.unregisterChannelzRef)(this.channelzRef)}}class eA{constructor(et){this.channelTarget=et,this.session=null,this.isShutdown=!1}trace(et){ec.trace(eo.LogVerbosity.DEBUG,ey,(0,ep.uriToString)(this.channelTarget)+" "+et)}createSession(et,er,en,ea){return this.isShutdown?Promise.reject():new Promise((eo,eu)=>{var ec,em,eg;let ey;ea.realTarget?(ey=(0,ep.uriToString)(ea.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,ep.uriToString)(ea.realTarget))):(ey=null,this.trace("creating HTTP/2 session to "+(0,ed.subchannelAddressToString)(et)));let ev=(0,eh.getDefaultAuthority)(null!==(ec=ea.realTarget)&&void 0!==ec?ec:this.channelTarget),eb=er._getConnectionOptions()||{};eb.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in en?eb.maxSessionMemory=en["grpc-node.max_session_memory"]:eb.maxSessionMemory=Number.MAX_SAFE_INTEGER;let eS="http://";if("secureContext"in eb){if(eS="https://",en["grpc.ssl_target_name_override"]){let et=en["grpc.ssl_target_name_override"];eb.checkServerIdentity=(er,en)=>(0,es.checkServerIdentity)(et,en),eb.servername=et}else{let et=null!==(eg=null===(em=(0,ep.splitHostPort)(ev))||void 0===em?void 0:em.host)&&void 0!==eg?eg:"localhost";eb.servername=et}ea.socket&&(eb.createConnection=(et,er)=>ea.socket)}else eb.createConnection=(er,en)=>ea.socket?ea.socket:ef.connect(et);eb=Object.assign(Object.assign(Object.assign({},eb),et),{enableTrace:1===en["grpc-node.tls_enable_trace"]});let eT=ei.connect(eS+ev,eb);this.session=eT;let ew="Failed to connect";eT.unref(),eT.once("connect",()=>{eT.removeAllListeners(),eo(new ex(eT,et,en,ey)),this.session=null}),eT.once("close",()=>{this.session=null,setImmediate(()=>{eu(`${ew} (${new Date().toISOString()})`)})}),eT.once("error",et=>{ew=et.message,this.trace("connection failed with error "+ew)})})}connect(et,er,en){var ei,ea;if(this.isShutdown)return Promise.reject();let eo=er._getConnectionOptions()||{};if("secureContext"in eo){if(eo.ALPNProtocols=["h2"],en["grpc.ssl_target_name_override"]){let et=en["grpc.ssl_target_name_override"];eo.checkServerIdentity=(er,en)=>(0,es.checkServerIdentity)(et,en),eo.servername=et}else if("grpc.http_connect_target"in en){let et=(0,eh.getDefaultAuthority)(null!==(ei=(0,ep.parseUri)(en["grpc.http_connect_target"]))&&void 0!==ei?ei:{path:"localhost"}),er=(0,ep.splitHostPort)(et);eo.servername=null!==(ea=null==er?void 0:er.host)&&void 0!==ea?ea:et}en["grpc-node.tls_enable_trace"]&&(eo.enableTrace=!0)}return(0,eu.getProxiedConnection)(et,en,eo).then(ei=>this.createSession(et,er,en,ei))}shutdown(){var et;this.isShutdown=!0,null===(et=this.session)||void 0===et||et.close(),this.session=null}}er.Http2SubchannelConnector=eA},14717:(et,er)=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0}),er.uriToString=er.splitHostPort=er.parseUri=void 0;let en=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function ei(et){let er=en.exec(et);return null===er?null:{scheme:er[1],authority:er[2],path:er[3]}}er.parseUri=ei;let es=/^\d+$/;function ea(et){if(et.startsWith("[")){let er=et.indexOf("]");if(-1===er)return null;let en=et.substring(1,er);if(-1===en.indexOf(":"))return null;if(!(et.length>er+1))return{host:en};if(":"!==et[er+1])return null;{let ei=et.substring(er+2);return es.test(ei)?{host:en,port:+ei}:null}}{let er=et.split(":");return 2!==er.length?{host:et}:es.test(er[1])?{host:er[0],port:+er[1]}:null}}function eo(et){let er="";return void 0!==et.scheme&&(er+=et.scheme+":"),void 0!==et.authority&&(er+="//"+et.authority+"/"),er+=et.path}er.splitHostPort=ea,er.uriToString=eo},18196:(et,er,en)=>{"use strict";var ei,es;/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */ei={value:!0},ei=ei=er.im=er.J_=ei=er.Cp=ei=ei=void 0;let ea=en(19977),eo=en(75962),eu=en(95307),ec=en(9234),eh=en(16933);ei=eh,ei=function(et){return"@type"in et&&"string"==typeof et["@type"]},function(et){et.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",et.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",et.IDEMPOTENT="IDEMPOTENT"}(es=er.Cp||(er.Cp={}));let ed={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function ep(et,er){return""===et?er:et+"."+er}function ef(et){return et instanceof eo.Service||et instanceof eo.Type||et instanceof eo.Enum}function em(et){return et instanceof eo.Namespace||et instanceof eo.Root}function eg(et,er){let en=ep(er,et.name);return ef(et)?[[en,et]]:em(et)&&void 0!==et.nested?Object.keys(et.nested).map(er=>eg(et.nested[er],en)).reduce((et,er)=>et.concat(er),[]):[]}function ey(et,er){return function(en){return et.toObject(et.decode(en),er)}}function ev(et){return function(er){if(Array.isArray(er))throw Error(`Failed to serialize message: expected object with ${et.name} structure, got array instead`);let en=et.fromObject(er);return et.encode(en).finish()}}function eb(et){return(et||[]).reduce((et,er)=>{for(let[en,ei]of Object.entries(er))"uninterpreted_option"===en?et.uninterpreted_option.push(er.uninterpreted_option):et[en]=ei;return et},{deprecated:!1,idempotency_level:es.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function eS(et,er,en,ei){let es=et.resolvedRequestType,eo=et.resolvedResponseType;return{path:"/"+er+"/"+et.name,requestStream:!!et.requestStream,responseStream:!!et.responseStream,requestSerialize:ev(es),requestDeserialize:ey(es,en),responseSerialize:ev(eo),responseDeserialize:ey(eo,en),originalName:ea(et.name),requestType:ew(es,ei),responseType:ew(eo,ei),options:eb(et.parsedOptions)}}function eT(et,er,en,ei){let es={};for(let ea of et.methodsArray)es[ea.name]=eS(ea,er,en,ei);return es}function ew(et,er){let en=et.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:en.$type.toObject(en,ed),fileDescriptorProtos:er}}function eE(et,er){let en=et.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:en.$type.toObject(en,ed),fileDescriptorProtos:er}}function eC(et,er,en,ei){if(et instanceof eo.Service)return eT(et,er,en,ei);if(et instanceof eo.Type)return ew(et,ei);if(et instanceof eo.Enum)return eE(et,ei);throw Error("Type mismatch in reflection object handling")}function e_(et,er){let en={};et.resolveAll();let ei=et.toDescriptor("proto3").file,es=ei.map(et=>Buffer.from(eu.FileDescriptorProto.encode(et).finish()));for(let[ei,ea]of eg(et,""))en[ei]=eC(ea,ei,er,es);return en}function eI(et,er){er=er||{};let en=eo.Root.fromDescriptor(et);return en.resolveAll(),e_(en,er)}function ek(et,er){let en=(0,ec.loadProtosWithOptionsSync)(et,er);return e_(en,er)}function ex(et,er){er=er||{};let en=eo.Root.fromJSON(et);return en.resolveAll(),e_(en,er)}ei=function(et,er){return(0,ec.loadProtosWithOptions)(et,er).then(et=>e_(et,er))},er.J_=ek,er.im=ex,ei=function(et,er){let en=eu.FileDescriptorSet.decode(et);return eI(en,er)},ei=function(et,er){let en=eu.FileDescriptorSet.fromObject(et);return eI(en,er)},(0,ec.addCommonProtos)()},9234:(et,er,en)=>{"use strict";/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */Object.defineProperty(er,"__esModule",{value:!0}),er.addCommonProtos=er.loadProtosWithOptionsSync=er.loadProtosWithOptions=void 0;let ei=en(57147),es=en(71017),ea=en(75962);function eo(et,er){let en=et.resolvePath;et.resolvePath=(et,ea)=>{if(es.isAbsolute(ea))return ea;for(let et of er){let er=es.join(et,ea);try{return ei.accessSync(er,ei.constants.R_OK),er}catch(et){continue}}return process.emitWarning(`${ea} not found in any of the include paths ${er}`),en(et,ea)}}async function eu(et,er){let en=new ea.Root;if((er=er||{}).includeDirs){if(!Array.isArray(er.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));eo(en,er.includeDirs)}let ei=await en.load(et,er);return ei.resolveAll(),ei}function ec(et,er){let en=new ea.Root;if((er=er||{}).includeDirs){if(!Array.isArray(er.includeDirs))throw Error("The includeDirs option must be an array");eo(en,er.includeDirs)}let ei=en.loadSync(et,er);return ei.resolveAll(),ei}function eh(){let et=en(56541),er=en(89987),ei=en(57674),es=en(73795);ea.common("api",et.nested.google.nested.protobuf.nested),ea.common("descriptor",er.nested.google.nested.protobuf.nested),ea.common("source_context",ei.nested.google.nested.protobuf.nested),ea.common("type",es.nested.google.nested.protobuf.nested)}er.loadProtosWithOptions=eu,er.loadProtosWithOptionsSync=ec,er.addCommonProtos=eh},18670:et=>{"use strict";function er(et,er){for(var en=Array(arguments.length-1),ei=0,es=2,ea=!0;es<arguments.length;)en[ei++]=arguments[es++];return new Promise(function(es,eo){en[ei]=function(et){if(ea){if(ea=!1,et)eo(et);else{for(var er=Array(arguments.length-1),en=0;en<er.length;)er[en++]=arguments[en];es.apply(null,er)}}};try{et.apply(er||null,en)}catch(et){ea&&(ea=!1,eo(et))}})}et.exports=er},36009:(et,er)=>{"use strict";var en=er;en.length=function(et){var er=et.length;if(!er)return 0;for(var en=0;--er%4>1&&"="===et.charAt(er);)++en;return Math.ceil(3*et.length)/4-en};for(var ei=Array(64),es=Array(123),ea=0;ea<64;)es[ei[ea]=ea<26?ea+65:ea<52?ea+71:ea<62?ea-4:ea-59|43]=ea++;en.encode=function(et,er,en){for(var es,ea=null,eo=[],eu=0,ec=0;er<en;){var eh=et[er++];switch(ec){case 0:eo[eu++]=ei[eh>>2],es=(3&eh)<<4,ec=1;break;case 1:eo[eu++]=ei[es|eh>>4],es=(15&eh)<<2,ec=2;break;case 2:eo[eu++]=ei[es|eh>>6],eo[eu++]=ei[63&eh],ec=0}eu>8191&&((ea||(ea=[])).push(String.fromCharCode.apply(String,eo)),eu=0)}return(ec&&(eo[eu++]=ei[es],eo[eu++]=61,1===ec&&(eo[eu++]=61)),ea)?(eu&&ea.push(String.fromCharCode.apply(String,eo.slice(0,eu))),ea.join("")):String.fromCharCode.apply(String,eo.slice(0,eu))};var eo="invalid encoding";en.decode=function(et,er,en){for(var ei,ea=en,eu=0,ec=0;ec<et.length;){var eh=et.charCodeAt(ec++);if(61===eh&&eu>1)break;if(void 0===(eh=es[eh]))throw Error(eo);switch(eu){case 0:ei=eh,eu=1;break;case 1:er[en++]=ei<<2|(48&eh)>>4,ei=eh,eu=2;break;case 2:er[en++]=(15&ei)<<4|(60&eh)>>2,ei=eh,eu=3;break;case 3:er[en++]=(3&ei)<<6|eh,eu=0}}if(1===eu)throw Error(eo);return en-ea},en.test=function(et){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(et)}},57311:et=>{"use strict";function er(et,en){"string"==typeof et&&(en=et,et=void 0);var ei=[];function es(et){if("string"!=typeof et){var en=ea();if(er.verbose&&console.log("codegen: "+en),en="return "+en,et){for(var eo=Object.keys(et),eu=Array(eo.length+1),ec=Array(eo.length),eh=0;eh<eo.length;)eu[eh]=eo[eh],ec[eh]=et[eo[eh++]];return eu[eh]=en,Function.apply(null,eu).apply(null,ec)}return Function(en)()}for(var ed=Array(arguments.length-1),ep=0;ep<ed.length;)ed[ep]=arguments[++ep];if(ep=0,et=et.replace(/%([%dfijs])/g,function(et,er){var en=ed[ep++];switch(er){case"d":case"f":return String(Number(en));case"i":return String(Math.floor(en));case"j":return JSON.stringify(en);case"s":return String(en)}return"%"}),ep!==ed.length)throw Error("parameter count mismatch");return ei.push(et),es}function ea(er){return"function "+(er||en||"")+"("+(et&&et.join(",")||"")+"){\n  "+ei.join("\n  ")+"\n}"}return es.toString=ea,es}et.exports=er,er.verbose=!1},50107:et=>{"use strict";function er(){this._listeners={}}et.exports=er,er.prototype.on=function(et,er,en){return(this._listeners[et]||(this._listeners[et]=[])).push({fn:er,ctx:en||this}),this},er.prototype.off=function(et,er){if(void 0===et)this._listeners={};else if(void 0===er)this._listeners[et]=[];else for(var en=this._listeners[et],ei=0;ei<en.length;)en[ei].fn===er?en.splice(ei,1):++ei;return this},er.prototype.emit=function(et){var er=this._listeners[et];if(er){for(var en=[],ei=1;ei<arguments.length;)en.push(arguments[ei++]);for(ei=0;ei<er.length;)er[ei].fn.apply(er[ei++].ctx,en)}return this}},82651:(et,er,en)=>{"use strict";et.exports=ea;var ei=en(18670),es=en(28031)("fs");function ea(et,er,en){return("function"==typeof er?(en=er,er={}):er||(er={}),en)?!er.xhr&&es&&es.readFile?es.readFile(et,function(ei,es){return ei&&"undefined"!=typeof XMLHttpRequest?ea.xhr(et,er,en):ei?en(ei):en(null,er.binary?es:es.toString("utf8"))}):ea.xhr(et,er,en):ei(ea,this,et,er)}ea.xhr=function(et,er,en){var ei=new XMLHttpRequest;ei.onreadystatechange=function(){if(4===ei.readyState){if(0!==ei.status&&200!==ei.status)return en(Error("status "+ei.status));if(er.binary){var et=ei.response;if(!et){et=[];for(var es=0;es<ei.responseText.length;++es)et.push(255&ei.responseText.charCodeAt(es))}return en(null,"undefined"!=typeof Uint8Array?new Uint8Array(et):et)}return en(null,ei.responseText)}},er.binary&&("overrideMimeType"in ei&&ei.overrideMimeType("text/plain; charset=x-user-defined"),ei.responseType="arraybuffer"),ei.open("GET",et),ei.send()}},71188:et=>{"use strict";function er(et){return"undefined"!=typeof Float32Array?function(){var er=new Float32Array([-0]),en=new Uint8Array(er.buffer),ei=128===en[3];function es(et,ei,es){er[0]=et,ei[es]=en[0],ei[es+1]=en[1],ei[es+2]=en[2],ei[es+3]=en[3]}function ea(et,ei,es){er[0]=et,ei[es]=en[3],ei[es+1]=en[2],ei[es+2]=en[1],ei[es+3]=en[0]}function eo(et,ei){return en[0]=et[ei],en[1]=et[ei+1],en[2]=et[ei+2],en[3]=et[ei+3],er[0]}function eu(et,ei){return en[3]=et[ei],en[2]=et[ei+1],en[1]=et[ei+2],en[0]=et[ei+3],er[0]}et.writeFloatLE=ei?es:ea,et.writeFloatBE=ei?ea:es,et.readFloatLE=ei?eo:eu,et.readFloatBE=ei?eu:eo}():function(){function er(et,er,en,ei){var es=er<0?1:0;if(es&&(er=-er),0===er)et(1/er>0?0:2147483648,en,ei);else if(isNaN(er))et(2143289344,en,ei);else if(er>34028234663852886e22)et((es<<31|2139095040)>>>0,en,ei);else if(er<11754943508222875e-54)et((es<<31|Math.round(er/1401298464324817e-60))>>>0,en,ei);else{var ea=Math.floor(Math.log(er)/Math.LN2),eo=8388607&Math.round(er*Math.pow(2,-ea)*8388608);et((es<<31|ea+127<<23|eo)>>>0,en,ei)}}function eo(et,er,en){var ei=et(er,en),es=(ei>>31)*2+1,ea=ei>>>23&255,eo=8388607&ei;return 255===ea?eo?NaN:es*(1/0):0===ea?1401298464324817e-60*es*eo:es*Math.pow(2,ea-150)*(eo+8388608)}et.writeFloatLE=er.bind(null,en),et.writeFloatBE=er.bind(null,ei),et.readFloatLE=eo.bind(null,es),et.readFloatBE=eo.bind(null,ea)}(),"undefined"!=typeof Float64Array?function(){var er=new Float64Array([-0]),en=new Uint8Array(er.buffer),ei=128===en[7];function es(et,ei,es){er[0]=et,ei[es]=en[0],ei[es+1]=en[1],ei[es+2]=en[2],ei[es+3]=en[3],ei[es+4]=en[4],ei[es+5]=en[5],ei[es+6]=en[6],ei[es+7]=en[7]}function ea(et,ei,es){er[0]=et,ei[es]=en[7],ei[es+1]=en[6],ei[es+2]=en[5],ei[es+3]=en[4],ei[es+4]=en[3],ei[es+5]=en[2],ei[es+6]=en[1],ei[es+7]=en[0]}function eo(et,ei){return en[0]=et[ei],en[1]=et[ei+1],en[2]=et[ei+2],en[3]=et[ei+3],en[4]=et[ei+4],en[5]=et[ei+5],en[6]=et[ei+6],en[7]=et[ei+7],er[0]}function eu(et,ei){return en[7]=et[ei],en[6]=et[ei+1],en[5]=et[ei+2],en[4]=et[ei+3],en[3]=et[ei+4],en[2]=et[ei+5],en[1]=et[ei+6],en[0]=et[ei+7],er[0]}et.writeDoubleLE=ei?es:ea,et.writeDoubleBE=ei?ea:es,et.readDoubleLE=ei?eo:eu,et.readDoubleBE=ei?eu:eo}():function(){function er(et,er,en,ei,es,ea){var eo,eu=ei<0?1:0;if(eu&&(ei=-ei),0===ei)et(0,es,ea+er),et(1/ei>0?0:2147483648,es,ea+en);else if(isNaN(ei))et(0,es,ea+er),et(2146959360,es,ea+en);else if(ei>17976931348623157e292)et(0,es,ea+er),et((eu<<31|2146435072)>>>0,es,ea+en);else if(ei<22250738585072014e-324)et((eo=ei/5e-324)>>>0,es,ea+er),et((eu<<31|eo/4294967296)>>>0,es,ea+en);else{var ec=Math.floor(Math.log(ei)/Math.LN2);1024===ec&&(ec=1023),et(4503599627370496*(eo=ei*Math.pow(2,-ec))>>>0,es,ea+er),et((eu<<31|ec+1023<<20|1048576*eo&1048575)>>>0,es,ea+en)}}function eo(et,er,en,ei,es){var ea=et(ei,es+er),eo=et(ei,es+en),eu=(eo>>31)*2+1,ec=eo>>>20&2047,eh=4294967296*(1048575&eo)+ea;return 2047===ec?eh?NaN:eu*(1/0):0===ec?5e-324*eu*eh:eu*Math.pow(2,ec-1075)*(eh+4503599627370496)}et.writeDoubleLE=er.bind(null,en,0,4),et.writeDoubleBE=er.bind(null,ei,4,0),et.readDoubleLE=eo.bind(null,es,0,4),et.readDoubleBE=eo.bind(null,ea,4,0)}(),et}function en(et,er,en){er[en]=255&et,er[en+1]=et>>>8&255,er[en+2]=et>>>16&255,er[en+3]=et>>>24}function ei(et,er,en){er[en]=et>>>24,er[en+1]=et>>>16&255,er[en+2]=et>>>8&255,er[en+3]=255&et}function es(et,er){return(et[er]|et[er+1]<<8|et[er+2]<<16|et[er+3]<<24)>>>0}function ea(et,er){return(et[er]<<24|et[er+1]<<16|et[er+2]<<8|et[er+3])>>>0}et.exports=er(er)},28031:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},52768:(et,er)=>{"use strict";var en=er,ei=en.isAbsolute=function(et){return/^(?:\/|\w+:)/.test(et)},es=en.normalize=function(et){var er=(et=et.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),en=ei(et),es="";en&&(es=er.shift()+"/");for(var ea=0;ea<er.length;)".."===er[ea]?ea>0&&".."!==er[ea-1]?er.splice(--ea,2):en?er.splice(ea,1):++ea:"."===er[ea]?er.splice(ea,1):++ea;return es+er.join("/")};en.resolve=function(et,er,en){return(en||(er=es(er)),ei(er))?er:(en||(et=es(et)),(et=et.replace(/(?:\/|^)[^/]+$/,"")).length?es(et+"/"+er):er)}},14314:et=>{"use strict";function er(et,er,en){var ei=en||8192,es=ei>>>1,ea=null,eo=ei;return function(en){if(en<1||en>es)return et(en);eo+en>ei&&(ea=et(ei),eo=0);var eu=er.call(ea,eo,eo+=en);return 7&eo&&(eo=(7|eo)+1),eu}}et.exports=er},67148:(et,er)=>{"use strict";var en=er;en.length=function(et){for(var er=0,en=0,ei=0;ei<et.length;++ei)(en=et.charCodeAt(ei))<128?er+=1:en<2048?er+=2:(64512&en)==55296&&(64512&et.charCodeAt(ei+1))==56320?(++ei,er+=4):er+=3;return er},en.read=function(et,er,en){if(en-er<1)return"";for(var ei,es=null,ea=[],eo=0;er<en;)(ei=et[er++])<128?ea[eo++]=ei:ei>191&&ei<224?ea[eo++]=(31&ei)<<6|63&et[er++]:ei>239&&ei<365?(ei=((7&ei)<<18|(63&et[er++])<<12|(63&et[er++])<<6|63&et[er++])-65536,ea[eo++]=55296+(ei>>10),ea[eo++]=56320+(1023&ei)):ea[eo++]=(15&ei)<<12|(63&et[er++])<<6|63&et[er++],eo>8191&&((es||(es=[])).push(String.fromCharCode.apply(String,ea)),eo=0);return es?(eo&&es.push(String.fromCharCode.apply(String,ea.slice(0,eo))),es.join("")):String.fromCharCode.apply(String,ea.slice(0,eo))},en.write=function(et,er,en){for(var ei,es,ea=en,eo=0;eo<et.length;++eo)(ei=et.charCodeAt(eo))<128?er[en++]=ei:(ei<2048?er[en++]=ei>>6|192:((64512&ei)==55296&&(64512&(es=et.charCodeAt(eo+1)))==56320?(ei=65536+((1023&ei)<<10)+(1023&es),++eo,er[en++]=ei>>18|240,er[en++]=ei>>12&63|128):er[en++]=ei>>12|224,er[en++]=ei>>6&63|128),er[en++]=63&ei|128);return en-ea}},58261:function(et){!function(er,en){et.exports=en()}(0,function(){"use strict";var et=function(et){return er(et)&&!en(et)};function er(et){return!!et&&"object"==typeof et}function en(et){var er=Object.prototype.toString.call(et);return"[object RegExp]"===er||"[object Date]"===er||es(et)}var ei="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function es(et){return et.$$typeof===ei}function ea(et){return Array.isArray(et)?[]:{}}function eo(et,er){return!1!==er.clone&&er.isMergeableObject(et)?eh(ea(et),et,er):et}function eu(et,er,en){return et.concat(er).map(function(et){return eo(et,en)})}function ec(et,er,en){var ei={};return en.isMergeableObject(et)&&Object.keys(et).forEach(function(er){ei[er]=eo(et[er],en)}),Object.keys(er).forEach(function(es){en.isMergeableObject(er[es])&&et[es]?ei[es]=eh(et[es],er[es],en):ei[es]=eo(er[es],en)}),ei}function eh(er,en,ei){(ei=ei||{}).arrayMerge=ei.arrayMerge||eu,ei.isMergeableObject=ei.isMergeableObject||et;var es=Array.isArray(en);return es!==Array.isArray(er)?eo(en,ei):es?ei.arrayMerge(er,en,ei):ec(er,en,ei)}return eh.all=function(et,er){if(!Array.isArray(et))throw Error("first argument should be an array");return et.reduce(function(et,en){return eh(et,en,er)},{})},eh})},44952:(et,er,en)=>{"use strict";function ei(et){return et&&"object"==typeof et&&"default"in et?et.default:et}es={value:!0};var es,ea=ei(en(58261)),eo=ei(en(7997)),eu=ei(en(24653)),ec=en(9885),eh=ei(en(79493)),ed=ei(en(98850)),ep=ei(en(23534)),ef=ei(en(85372)),em=ei(en(86753));function eg(){return(eg=Object.assign||function(et){for(var er=1;er<arguments.length;er++){var en=arguments[er];for(var ei in en)Object.prototype.hasOwnProperty.call(en,ei)&&(et[ei]=en[ei])}return et}).apply(this,arguments)}function ey(et,er){et.prototype=Object.create(er.prototype),et.prototype.constructor=et,et.__proto__=er}function ev(et,er){if(null==et)return{};var en,ei,es={},ea=Object.keys(et);for(ei=0;ei<ea.length;ei++)er.indexOf(en=ea[ei])>=0||(es[en]=et[en]);return es}function eb(et){if(void 0===et)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return et}var eS=ec.createContext(void 0);eS.displayName="FormikContext";var eT=eS.Provider,ew=eS.Consumer;function eE(){var et=ec.useContext(eS);return et||ed(!1),et}var eC=function(et){return Array.isArray(et)&&0===et.length},e_=function(et){return"function"==typeof et},eI=function(et){return null!==et&&"object"==typeof et},ek=function(et){return String(Math.floor(Number(et)))===et},ex=function(et){return"[object String]"===Object.prototype.toString.call(et)},eA=function(et){return 0===ec.Children.count(et)},eR=function(et){return eI(et)&&e_(et.then)};function eD(et,er,en,ei){void 0===ei&&(ei=0);for(var es=ef(er);et&&ei<es.length;)et=et[es[ei++]];return ei===es.length||et?void 0===et?en:et:en}function eO(et,er,en){for(var ei=ep(et),es=ei,ea=0,eo=ef(er);ea<eo.length-1;ea++){var eu=eo[ea],ec=eD(et,eo.slice(0,ea+1));if(ec&&(eI(ec)||Array.isArray(ec)))es=es[eu]=ep(ec);else{var eh=eo[ea+1];es=es[eu]=ek(eh)&&Number(eh)>=0?[]:{}}}return(0===ea?et:es)[eo[ea]]===en?et:(void 0===en?delete es[eo[ea]]:es[eo[ea]]=en,0===ea&&void 0===en&&delete ei[eo[ea]],ei)}function eN(et,er,en,ei){void 0===en&&(en=new WeakMap),void 0===ei&&(ei={});for(var es=0,ea=Object.keys(et);es<ea.length;es++){var eo=ea[es],eu=et[eo];eI(eu)?en.get(eu)||(en.set(eu,!0),ei[eo]=Array.isArray(eu)?[]:{},eN(eu,er,en,ei[eo])):ei[eo]=er}return ei}var eM={},eP={};function eL(et){var er=et.validateOnChange,en=void 0===er||er,ei=et.validateOnBlur,es=void 0===ei||ei,eo=et.validateOnMount,ed=void 0!==eo&&eo,ep=et.isInitialValid,ef=et.enableReinitialize,em=void 0!==ef&&ef,ey=et.onSubmit,eb=ev(et,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),eS=eg({validateOnChange:en,validateOnBlur:es,validateOnMount:ed,onSubmit:ey},eb),eT=ec.useRef(eS.initialValues),ew=ec.useRef(eS.initialErrors||eM),eE=ec.useRef(eS.initialTouched||eP),eC=ec.useRef(eS.initialStatus),ek=ec.useRef(!1),eA=ec.useRef({});ec.useEffect(function(){return ek.current=!0,function(){ek.current=!1}},[]);var eL=ec.useState(0)[1],eF=ec.useRef({values:eu(eS.initialValues),errors:eu(eS.initialErrors)||eM,touched:eu(eS.initialTouched)||eP,status:eu(eS.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),eU=eF.current,ez=ec.useCallback(function(et){var er=eF.current;eF.current=function(et,er){switch(er.type){case"SET_VALUES":return eg({},et,{values:er.payload});case"SET_TOUCHED":return eg({},et,{touched:er.payload});case"SET_ERRORS":return eh(et.errors,er.payload)?et:eg({},et,{errors:er.payload});case"SET_STATUS":return eg({},et,{status:er.payload});case"SET_ISSUBMITTING":return eg({},et,{isSubmitting:er.payload});case"SET_ISVALIDATING":return eg({},et,{isValidating:er.payload});case"SET_FIELD_VALUE":return eg({},et,{values:eO(et.values,er.payload.field,er.payload.value)});case"SET_FIELD_TOUCHED":return eg({},et,{touched:eO(et.touched,er.payload.field,er.payload.value)});case"SET_FIELD_ERROR":return eg({},et,{errors:eO(et.errors,er.payload.field,er.payload.value)});case"RESET_FORM":return eg({},et,er.payload);case"SET_FORMIK_STATE":return er.payload(et);case"SUBMIT_ATTEMPT":return eg({},et,{touched:eN(et.values,!0),isSubmitting:!0,submitCount:et.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return eg({},et,{isSubmitting:!1});default:return et}}(er,et),er!==eF.current&&eL(function(et){return et+1})},[]),eG=ec.useCallback(function(et,er){return new Promise(function(en,ei){var es=eS.validate(et,er);null==es?en(eM):eR(es)?es.then(function(et){en(et||eM)},function(et){ei(et)}):en(es)})},[eS.validate]),eK=ec.useCallback(function(et,er){var en=eS.validationSchema,ei=e_(en)?en(er):en,es=er&&ei.validateAt?ei.validateAt(er,et):ej(et,ei);return new Promise(function(et,er){es.then(function(){et(eM)},function(en){"ValidationError"===en.name?et(eB(en)):er(en)})})},[eS.validationSchema]),eH=ec.useCallback(function(et,er){return new Promise(function(en){return en(eA.current[et].validate(er))})},[]),eW=ec.useCallback(function(et){var er=Object.keys(eA.current).filter(function(et){return e_(eA.current[et].validate)});return Promise.all(er.length>0?er.map(function(er){return eH(er,eD(et,er))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")]).then(function(et){return et.reduce(function(et,en,ei){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===en||en&&(et=eO(et,er[ei],en)),et},{})})},[eH]),eQ=ec.useCallback(function(et){return Promise.all([eW(et),eS.validationSchema?eK(et):{},eS.validate?eG(et):{}]).then(function(et){return ea.all([et[0],et[1],et[2]],{arrayMerge:eV})})},[eS.validate,eS.validationSchema,eW,eG,eK]),eY=e$(function(et){return void 0===et&&(et=eU.values),ez({type:"SET_ISVALIDATING",payload:!0}),eQ(et).then(function(et){return ek.current&&(ez({type:"SET_ISVALIDATING",payload:!1}),ez({type:"SET_ERRORS",payload:et})),et})});ec.useEffect(function(){ed&&!0===ek.current&&eh(eT.current,eS.initialValues)&&eY(eT.current)},[ed,eY]);var eJ=ec.useCallback(function(et){var er=et&&et.values?et.values:eT.current,en=et&&et.errors?et.errors:ew.current?ew.current:eS.initialErrors||{},ei=et&&et.touched?et.touched:eE.current?eE.current:eS.initialTouched||{},es=et&&et.status?et.status:eC.current?eC.current:eS.initialStatus;eT.current=er,ew.current=en,eE.current=ei,eC.current=es;var ea=function(){ez({type:"RESET_FORM",payload:{isSubmitting:!!et&&!!et.isSubmitting,errors:en,touched:ei,status:es,values:er,isValidating:!!et&&!!et.isValidating,submitCount:et&&et.submitCount&&"number"==typeof et.submitCount?et.submitCount:0}})};if(eS.onReset){var eo=eS.onReset(eU.values,tu);eR(eo)?eo.then(ea):ea()}else ea()},[eS.initialErrors,eS.initialStatus,eS.initialTouched,eS.onReset]);ec.useEffect(function(){!0!==ek.current||eh(eT.current,eS.initialValues)||em&&(eT.current=eS.initialValues,eJ(),ed&&eY(eT.current))},[em,eS.initialValues,eJ,ed,eY]),ec.useEffect(function(){em&&!0===ek.current&&!eh(ew.current,eS.initialErrors)&&(ew.current=eS.initialErrors||eM,ez({type:"SET_ERRORS",payload:eS.initialErrors||eM}))},[em,eS.initialErrors]),ec.useEffect(function(){em&&!0===ek.current&&!eh(eE.current,eS.initialTouched)&&(eE.current=eS.initialTouched||eP,ez({type:"SET_TOUCHED",payload:eS.initialTouched||eP}))},[em,eS.initialTouched]),ec.useEffect(function(){em&&!0===ek.current&&!eh(eC.current,eS.initialStatus)&&(eC.current=eS.initialStatus,ez({type:"SET_STATUS",payload:eS.initialStatus}))},[em,eS.initialStatus,eS.initialTouched]);var eX=e$(function(et){if(eA.current[et]&&e_(eA.current[et].validate)){var er=eD(eU.values,et),en=eA.current[et].validate(er);return eR(en)?(ez({type:"SET_ISVALIDATING",payload:!0}),en.then(function(et){return et}).then(function(er){ez({type:"SET_FIELD_ERROR",payload:{field:et,value:er}}),ez({type:"SET_ISVALIDATING",payload:!1})})):(ez({type:"SET_FIELD_ERROR",payload:{field:et,value:en}}),Promise.resolve(en))}return eS.validationSchema?(ez({type:"SET_ISVALIDATING",payload:!0}),eK(eU.values,et).then(function(et){return et}).then(function(er){ez({type:"SET_FIELD_ERROR",payload:{field:et,value:eD(er,et)}}),ez({type:"SET_ISVALIDATING",payload:!1})})):Promise.resolve()}),eZ=ec.useCallback(function(et,er){eA.current[et]={validate:er.validate}},[]),e0=ec.useCallback(function(et){delete eA.current[et]},[]),e1=e$(function(et,er){return ez({type:"SET_TOUCHED",payload:et}),(void 0===er?es:er)?eY(eU.values):Promise.resolve()}),e2=ec.useCallback(function(et){ez({type:"SET_ERRORS",payload:et})},[]),e3=e$(function(et,er){var ei=e_(et)?et(eU.values):et;return ez({type:"SET_VALUES",payload:ei}),(void 0===er?en:er)?eY(ei):Promise.resolve()}),e6=ec.useCallback(function(et,er){ez({type:"SET_FIELD_ERROR",payload:{field:et,value:er}})},[]),e9=e$(function(et,er,ei){return ez({type:"SET_FIELD_VALUE",payload:{field:et,value:er}}),(void 0===ei?en:ei)?eY(eO(eU.values,et,er)):Promise.resolve()}),e4=ec.useCallback(function(et,er){var en,ei=er,es=et;if(!ex(et)){et.persist&&et.persist();var ea=et.target?et.target:et.currentTarget,eo=ea.type,eu=ea.value,ec=ea.checked,eh=ea.options,ed=ea.multiple;ei=er||ea.name||ea.id,es=/number|range/.test(eo)?isNaN(en=parseFloat(eu))?"":en:/checkbox/.test(eo)?function(et,er,en){if("boolean"==typeof et)return!!er;var ei=[],es=!1,ea=-1;if(Array.isArray(et))ei=et,es=(ea=et.indexOf(en))>=0;else if(!en||"true"==en||"false"==en)return!!er;return er&&en&&!es?ei.concat(en):es?ei.slice(0,ea).concat(ei.slice(ea+1)):ei}(eD(eU.values,ei),ec,eu):eh&&ed?function(et){return Array.from(et).filter(function(et){return et.selected}).map(function(et){return et.value})}(eh):eu}ei&&e9(ei,es)},[e9,eU.values]),e5=e$(function(et){if(ex(et))return function(er){return e4(er,et)};e4(et)}),e8=e$(function(et,er,en){return void 0===er&&(er=!0),ez({type:"SET_FIELD_TOUCHED",payload:{field:et,value:er}}),(void 0===en?es:en)?eY(eU.values):Promise.resolve()}),e7=ec.useCallback(function(et,er){et.persist&&et.persist();var en=et.target;e8(er||en.name||en.id,!0)},[e8]),tt=e$(function(et){if(ex(et))return function(er){return e7(er,et)};e7(et)}),tr=ec.useCallback(function(et){e_(et)?ez({type:"SET_FORMIK_STATE",payload:et}):ez({type:"SET_FORMIK_STATE",payload:function(){return et}})},[]),ti=ec.useCallback(function(et){ez({type:"SET_STATUS",payload:et})},[]),ts=ec.useCallback(function(et){ez({type:"SET_ISSUBMITTING",payload:et})},[]),ta=e$(function(){return ez({type:"SUBMIT_ATTEMPT"}),eY().then(function(et){var er,en=et instanceof Error;if(!en&&0===Object.keys(et).length){try{if(void 0===(er=tc()))return}catch(et){throw et}return Promise.resolve(er).then(function(et){return ek.current&&ez({type:"SUBMIT_SUCCESS"}),et}).catch(function(et){if(ek.current)throw ez({type:"SUBMIT_FAILURE"}),et})}if(ek.current&&(ez({type:"SUBMIT_FAILURE"}),en))throw et})}),tl=e$(function(et){et&&et.preventDefault&&e_(et.preventDefault)&&et.preventDefault(),et&&et.stopPropagation&&e_(et.stopPropagation)&&et.stopPropagation(),ta().catch(function(et){console.warn("Warning: An unhandled error was caught from submitForm()",et)})}),tu={resetForm:eJ,validateForm:eY,validateField:eX,setErrors:e2,setFieldError:e6,setFieldTouched:e8,setFieldValue:e9,setStatus:ti,setSubmitting:ts,setTouched:e1,setValues:e3,setFormikState:tr,submitForm:ta},tc=e$(function(){return ey(eU.values,tu)}),th=e$(function(et){et&&et.preventDefault&&e_(et.preventDefault)&&et.preventDefault(),et&&et.stopPropagation&&e_(et.stopPropagation)&&et.stopPropagation(),eJ()}),td=ec.useCallback(function(et){return{value:eD(eU.values,et),error:eD(eU.errors,et),touched:!!eD(eU.touched,et),initialValue:eD(eT.current,et),initialTouched:!!eD(eE.current,et),initialError:eD(ew.current,et)}},[eU.errors,eU.touched,eU.values]),tp=ec.useCallback(function(et){return{setValue:function(er,en){return e9(et,er,en)},setTouched:function(er,en){return e8(et,er,en)},setError:function(er){return e6(et,er)}}},[e9,e8,e6]),tf=ec.useCallback(function(et){var er=eI(et),en=er?et.name:et,ei=eD(eU.values,en),es={name:en,value:ei,onChange:e5,onBlur:tt};if(er){var ea=et.type,eo=et.value,eu=et.as,ec=et.multiple;"checkbox"===ea?void 0===eo?es.checked=!!ei:(es.checked=!(!Array.isArray(ei)||!~ei.indexOf(eo)),es.value=eo):"radio"===ea?(es.checked=ei===eo,es.value=eo):"select"===eu&&ec&&(es.value=es.value||[],es.multiple=!0)}return es},[tt,e5,eU.values]),tm=ec.useMemo(function(){return!eh(eT.current,eU.values)},[eT.current,eU.values]),tg=ec.useMemo(function(){return void 0!==ep?tm?eU.errors&&0===Object.keys(eU.errors).length:!1!==ep&&e_(ep)?ep(eS):ep:eU.errors&&0===Object.keys(eU.errors).length},[ep,tm,eU.errors,eS]);return eg({},eU,{initialValues:eT.current,initialErrors:ew.current,initialTouched:eE.current,initialStatus:eC.current,handleBlur:tt,handleChange:e5,handleReset:th,handleSubmit:tl,resetForm:eJ,setErrors:e2,setFormikState:tr,setFieldTouched:e8,setFieldValue:e9,setFieldError:e6,setStatus:ti,setSubmitting:ts,setTouched:e1,setValues:e3,submitForm:ta,validateForm:eY,validateField:eX,isValid:tg,dirty:tm,unregisterField:e0,registerField:eZ,getFieldProps:tf,getFieldMeta:td,getFieldHelpers:tp,validateOnBlur:es,validateOnChange:en,validateOnMount:ed})}function eF(et){var er=eL(et),en=et.component,ei=et.children,es=et.render;return ec.useImperativeHandle(et.innerRef,function(){return er}),ec.createElement(eT,{value:er},en?ec.createElement(en,er):es?es(er):ei?e_(ei)?ei(er):eA(ei)?null:ec.Children.only(ei):null)}function eB(et){var er={};if(et.inner){if(0===et.inner.length)return eO(er,et.path,et.message);var en=et.inner,ei=Array.isArray(en),es=0;for(en=ei?en:en[Symbol.iterator]();;){if(ei){if(es>=en.length)break;ea=en[es++]}else{if((es=en.next()).done)break;ea=es.value}var ea,eo=ea;eD(er,eo.path)||(er=eO(er,eo.path,eo.message))}}return er}function ej(et,er,en,ei){void 0===en&&(en=!1);var es=eU(et);return er[en?"validateSync":"validate"](es,{abortEarly:!1,context:ei||es})}function eU(et){var er=Array.isArray(et)?[]:{};for(var en in et)if(Object.prototype.hasOwnProperty.call(et,en)){var ei=String(en);er[ei]=!0===Array.isArray(et[ei])?et[ei].map(function(et){return!0===Array.isArray(et)||eo(et)?eU(et):""!==et?et:void 0}):eo(et[ei])?eU(et[ei]):""!==et[ei]?et[ei]:void 0}return er}function eV(et,er,en){var ei=et.slice();return er.forEach(function(er,es){if(void 0===ei[es]){var eo=!1!==en.clone&&en.isMergeableObject(er);ei[es]=eo?ea(Array.isArray(er)?[]:{},er,en):er}else en.isMergeableObject(er)?ei[es]=ea(et[es],er,en):-1===et.indexOf(er)&&ei.push(er)}),ei}var ez="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?ec.useLayoutEffect:ec.useEffect;function e$(et){var er=ec.useRef(et);return ez(function(){er.current=et}),ec.useCallback(function(){for(var et=arguments.length,en=Array(et),ei=0;ei<et;ei++)en[ei]=arguments[ei];return er.current.apply(void 0,en)},[])}var eG=ec.forwardRef(function(et,er){var en=et.action,ei=ev(et,["action"]),es=null!=en?en:"#",ea=eE();return ec.createElement("form",eg({onSubmit:ea.handleSubmit,ref:er,onReset:ea.handleReset,action:es},ei))});function eK(et){var er=function(er){return ec.createElement(ew,null,function(en){return en||ed(!1),ec.createElement(et,eg({},er,{formik:en}))})},en=et.displayName||et.name||et.constructor&&et.constructor.name||"Component";return er.WrappedComponent=et,er.displayName="FormikConnect("+en+")",em(er,et)}eG.displayName="Form";var eH=function(et,er,en){var ei=eJ(et),es=ei[er];return ei.splice(er,1),ei.splice(en,0,es),ei},eW=function(et,er,en){var ei=eJ(et),es=ei[er];return ei[er]=ei[en],ei[en]=es,ei},eQ=function(et,er,en){var ei=eJ(et);return ei.splice(er,0,en),ei},eY=function(et,er,en){var ei=eJ(et);return ei[er]=en,ei},eJ=function(et){if(et){if(Array.isArray(et))return[].concat(et);var er=Object.keys(et).map(function(et){return parseInt(et)}).reduce(function(et,er){return er>et?er:et},0);return Array.from(eg({},et,{length:er+1}))}return[]},eX=function(et,er){var en="function"==typeof et?et:er;return function(et){return Array.isArray(et)||eI(et)?en(eJ(et)):et}},eZ=function(et){function er(er){var en;return(en=et.call(this,er)||this).updateArrayField=function(et,er,ei){var es=en.props,ea=es.name;(0,es.formik.setFormikState)(function(en){var es=eX(ei,et),eo=eX(er,et),eu=eO(en.values,ea,et(eD(en.values,ea))),ec=ei?es(eD(en.errors,ea)):void 0,eh=er?eo(eD(en.touched,ea)):void 0;return eC(ec)&&(ec=void 0),eC(eh)&&(eh=void 0),eg({},en,{values:eu,errors:ei?eO(en.errors,ea,ec):en.errors,touched:er?eO(en.touched,ea,eh):en.touched})})},en.push=function(et){return en.updateArrayField(function(er){return[].concat(eJ(er),[eu(et)])},!1,!1)},en.handlePush=function(et){return function(){return en.push(et)}},en.swap=function(et,er){return en.updateArrayField(function(en){return eW(en,et,er)},!0,!0)},en.handleSwap=function(et,er){return function(){return en.swap(et,er)}},en.move=function(et,er){return en.updateArrayField(function(en){return eH(en,et,er)},!0,!0)},en.handleMove=function(et,er){return function(){return en.move(et,er)}},en.insert=function(et,er){return en.updateArrayField(function(en){return eQ(en,et,er)},function(er){return eQ(er,et,null)},function(er){return eQ(er,et,null)})},en.handleInsert=function(et,er){return function(){return en.insert(et,er)}},en.replace=function(et,er){return en.updateArrayField(function(en){return eY(en,et,er)},!1,!1)},en.handleReplace=function(et,er){return function(){return en.replace(et,er)}},en.unshift=function(et){var er=-1;return en.updateArrayField(function(en){var ei=en?[et].concat(en):[et];return er=ei.length,ei},function(et){return et?[null].concat(et):[null]},function(et){return et?[null].concat(et):[null]}),er},en.handleUnshift=function(et){return function(){return en.unshift(et)}},en.handleRemove=function(et){return function(){return en.remove(et)}},en.handlePop=function(){return function(){return en.pop()}},en.remove=en.remove.bind(eb(en)),en.pop=en.pop.bind(eb(en)),en}ey(er,et);var en=er.prototype;return en.componentDidUpdate=function(et){this.props.validateOnChange&&this.props.formik.validateOnChange&&!eh(eD(et.formik.values,et.name),eD(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},en.remove=function(et){var er;return this.updateArrayField(function(en){var ei=en?eJ(en):[];return er||(er=ei[et]),e_(ei.splice)&&ei.splice(et,1),e_(ei.every)&&ei.every(function(et){return void 0===et})?[]:ei},!0,!0),er},en.pop=function(){var et;return this.updateArrayField(function(er){var en=er.slice();return et||(et=en&&en.pop&&en.pop()),en},!0,!0),et},en.render=function(){var et=this.props,er=et.component,en=et.render,ei=et.children,es=et.name,ea=eg({},{push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},{form:ev(et.formik,["validate","validationSchema"]),name:es});return er?ec.createElement(er,ea):en?en(ea):ei?"function"==typeof ei?ei(ea):eA(ei)?null:ec.Children.only(ei):null},er}(ec.Component);eZ.defaultProps={validateOnChange:!0};var e0=eK(eZ),e1=eK(function(et){function er(){return et.apply(this,arguments)||this}ey(er,et);var en=er.prototype;return en.shouldComponentUpdate=function(et){return eD(this.props.formik.errors,this.props.name)!==eD(et.formik.errors,this.props.name)||eD(this.props.formik.touched,this.props.name)!==eD(et.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(et).length},en.render=function(){var et=this.props,er=et.component,en=et.formik,ei=et.render,es=et.children,ea=et.name,eo=ev(et,["component","formik","render","children","name"]),eu=eD(en.touched,ea),eh=eD(en.errors,ea);return eu&&eh?ei?e_(ei)?ei(eh):null:es?e_(es)?es(eh):null:er?ec.createElement(er,eo,eh):eh:null},er}(ec.Component)),e2=eK(function(et){function er(er){en=et.call(this,er)||this;var en,ei=er.render,es=er.children,ea=er.component,eo=er.as;return ei&&ed(!1),ea&&ei&&ed(!1),eo&&es&&e_(es)&&ed(!1),ea&&es&&e_(es)&&ed(!1),ei&&es&&!eA(es)&&ed(!1),en}ey(er,et);var en=er.prototype;return en.shouldComponentUpdate=function(et){return this.props.shouldUpdate?this.props.shouldUpdate(et,this.props):et.name!==this.props.name||eD(et.formik.values,this.props.name)!==eD(this.props.formik.values,this.props.name)||eD(et.formik.errors,this.props.name)!==eD(this.props.formik.errors,this.props.name)||eD(et.formik.touched,this.props.name)!==eD(this.props.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(et).length||et.formik.isSubmitting!==this.props.formik.isSubmitting},en.componentDidMount=function(){this.props.formik.registerField(this.props.name,{validate:this.props.validate})},en.componentDidUpdate=function(et){this.props.name!==et.name&&(this.props.formik.unregisterField(et.name),this.props.formik.registerField(this.props.name,{validate:this.props.validate})),this.props.validate!==et.validate&&this.props.formik.registerField(this.props.name,{validate:this.props.validate})},en.componentWillUnmount=function(){this.props.formik.unregisterField(this.props.name)},en.render=function(){var et=this.props,er=et.name,en=et.render,ei=et.as,es=et.children,ea=et.component,eo=et.formik,eu=ev(et,["validate","name","render","as","children","component","shouldUpdate","formik"]),eh=ev(eo,["validate","validationSchema"]),ed=eo.getFieldProps(eg({name:er},eu)),ep={field:ed,meta:{value:eD(eo.values,er),error:eD(eo.errors,er),touched:!!eD(eo.touched,er),initialValue:eD(eo.initialValues,er),initialTouched:!!eD(eo.initialTouched,er),initialError:eD(eo.initialErrors,er)},form:eh};if(en)return en(ep);if(e_(es))return es(ep);if(ea){if("string"==typeof ea){var ef=eu.innerRef,em=ev(eu,["innerRef"]);return ec.createElement(ea,eg({ref:ef},ed,em),es)}return ec.createElement(ea,eg({field:ed,form:eo},eu),es)}var ey=ei||"input";if("string"==typeof ey){var eb=eu.innerRef,eS=ev(eu,["innerRef"]);return ec.createElement(ey,eg({ref:eb},ed,eS),es)}return ec.createElement(ey,eg({},ed,eu),es)},er}(ec.Component));es=e1,es=e2,es=function(et){var er=et.validate,en=et.name,ei=et.render,es=et.children,ea=et.as,eo=et.component,eu=et.className,eh=ev(et,["validate","name","render","children","as","component","className"]),ed=ev(eE(),["validate","validationSchema"]),ep=ed.registerField,ef=ed.unregisterField;ec.useEffect(function(){return ep(en,{validate:er}),function(){ef(en)}},[ep,ef,en,er]);var em=ed.getFieldProps(eg({name:en},eh)),ey=ed.getFieldMeta(en),eb={field:em,form:ed};if(ei)return ei(eg({},eb,{meta:ey}));if(e_(es))return es(eg({},eb,{meta:ey}));if(eo){if("string"==typeof eo){var eS=eh.innerRef,eT=ev(eh,["innerRef"]);return ec.createElement(eo,eg({ref:eS},em,eT,{className:eu}),es)}return ec.createElement(eo,eg({field:em,form:ed},eh,{className:eu}),es)}var ew=ea||"input";if("string"==typeof ew){var eC=eh.innerRef,eI=ev(eh,["innerRef"]);return ec.createElement(ew,eg({ref:eC},em,eI,{className:eu}),es)}return ec.createElement(ew,eg({},em,eh,{className:eu}),es)},es=e0,es=eG,es=eF,es=ew,es=eS,es=eT,es=eK,es=function(et){if(void 0===(et=et||("undefined"!=typeof document?document:void 0)))return null;try{return et.activeElement||et.body}catch(er){return et.body}},es=eD,es=eQ,es=eC,es=eA,es=e_,es=function(et){return et&&eI(et)&&eI(et.target)},es=ek,es=function(et){return et!=et},es=eI,es=eR,es=ex,es=eH,es=eU,es=eY,es=eO,es=eN,es=eW,es=function(et){var er=eE(),en=er.getFieldProps,ei=er.getFieldMeta,es=er.getFieldHelpers,ea=er.registerField,eo=er.unregisterField,eu=eI(et)?et:{name:et},eh=eu.name,ep=eu.validate;ec.useEffect(function(){return eh&&ea(eh,{validate:ep}),function(){eh&&eo(eh)}},[ea,eo,eh,ep]),eh||ed(!1);var ef=ec.useMemo(function(){return es(eh)},[es,eh]);return[en(eu),ei(eh),ef]},er.TA=eL,es=eE,es=ej,es=function(et){var er=et.mapPropsToValues,en=void 0===er?function(et){var er={};for(var en in et)et.hasOwnProperty(en)&&"function"!=typeof et[en]&&(er[en]=et[en]);return er}:er,ei=ev(et,["mapPropsToValues"]);return function(et){var er=et.displayName||et.name||et.constructor&&et.constructor.name||"Component",es=function(er){function es(){for(var en,es=arguments.length,ea=Array(es),eo=0;eo<es;eo++)ea[eo]=arguments[eo];return(en=er.call.apply(er,[this].concat(ea))||this).validate=function(et){return ei.validate(et,en.props)},en.validationSchema=function(){return e_(ei.validationSchema)?ei.validationSchema(en.props):ei.validationSchema},en.handleSubmit=function(et,er){return ei.handleSubmit(et,eg({},er,{props:en.props}))},en.renderFormComponent=function(er){return ec.createElement(et,eg({},en.props,er))},en}return ey(es,er),es.prototype.render=function(){var et=ev(this.props,["children"]);return ec.createElement(eF,eg({},et,ei,{validate:ei.validate&&this.validate,validationSchema:ei.validationSchema&&this.validationSchema,initialValues:en(this.props),initialStatus:ei.mapPropsToStatus&&ei.mapPropsToStatus(this.props),initialErrors:ei.mapPropsToErrors&&ei.mapPropsToErrors(this.props),initialTouched:ei.mapPropsToTouched&&ei.mapPropsToTouched(this.props),onSubmit:this.handleSubmit,children:this.renderFormComponent}))},es}(ec.Component);return es.displayName="WithFormik("+er+")",em(es,et)}},es=eB},86753:(et,er,en)=>{"use strict";var ei=en(23314),es={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},ea={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},eo={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},eu={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ec={};function eh(et){return ei.isMemo(et)?eu:ec[et.$$typeof]||es}ec[ei.ForwardRef]=eo,ec[ei.Memo]=eu;var ed=Object.defineProperty,ep=Object.getOwnPropertyNames,ef=Object.getOwnPropertySymbols,em=Object.getOwnPropertyDescriptor,eg=Object.getPrototypeOf,ey=Object.prototype;function ev(et,er,en){if("string"!=typeof er){if(ey){var ei=eg(er);ei&&ei!==ey&&ev(et,ei,en)}var es=ep(er);ef&&(es=es.concat(ef(er)));for(var eo=eh(et),eu=eh(er),ec=0;ec<es.length;++ec){var eb=es[ec];if(!ea[eb]&&!(en&&en[eb])&&!(eu&&eu[eb])&&!(eo&&eo[eb])){var eS=em(er,eb);try{ed(et,eb,eS)}catch(et){}}}}return et}et.exports=ev},19977:et=>{var er=1/0,en="[object Symbol]",ei=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,es=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ea="\ud800-\udfff",eo="\\u0300-\\u036f\\ufe20-\\ufe23",eu="\\u20d0-\\u20f0",ec="\\u2700-\\u27bf",eh="a-z\\xdf-\\xf6\\xf8-\\xff",ed="A-Z\\xc0-\\xd6\\xd8-\\xde",ep="\\ufe0e\\ufe0f",ef="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",em="[']",eg="["+ea+"]",ey="["+ef+"]",ev="["+eo+eu+"]",eb="\\d+",eS="["+ec+"]",eT="["+eh+"]",ew="[^"+ea+ef+eb+ec+eh+ed+"]",eE="\ud83c[\udffb-\udfff]",eC="[^"+ea+"]",e_="(?:\ud83c[\udde6-\uddff]){2}",eI="[\ud800-\udbff][\udc00-\udfff]",ek="["+ed+"]",ex="\\u200d",eA="(?:"+eT+"|"+ew+")",eR="(?:"+ek+"|"+ew+")",eD="(?:"+em+"(?:d|ll|m|re|s|t|ve))?",eO="(?:"+em+"(?:D|LL|M|RE|S|T|VE))?",eN="(?:"+ev+"|"+eE+")?",eM="["+ep+"]?",eP="(?:"+ex+"(?:"+[eC,e_,eI].join("|")+")"+eM+eN+")*",eL=eM+eN+eP,eF="(?:"+[eS,e_,eI].join("|")+")"+eL,eB="(?:"+[eC+ev+"?",ev,e_,eI,eg].join("|")+")",ej=RegExp(em,"g"),eU=RegExp(ev,"g"),eV=RegExp(eE+"(?="+eE+")|"+eB+eL,"g"),ez=RegExp([ek+"?"+eT+"+"+eD+"(?="+[ey,ek,"$"].join("|")+")",eR+"+"+eO+"(?="+[ey,ek+eA,"$"].join("|")+")",ek+"?"+eA+"+"+eD,ek+"+"+eO,eb,eF].join("|"),"g"),e$=RegExp("["+ex+ea+eo+eu+ep+"]"),eG=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eK={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},eH="object"==typeof global&&global&&global.Object===Object&&global,eW="object"==typeof self&&self&&self.Object===Object&&self,eQ=eH||eW||Function("return this")();function eY(et,er,en,ei){var es=-1,ea=et?et.length:0;for(ei&&ea&&(en=et[++es]);++es<ea;)en=er(en,et[es],es,et);return en}function eJ(et){return et.split("")}function eX(et){return et.match(ei)||[]}var eZ=function(et){return function(er){return null==et?void 0:et[er]}}(eK);function e0(et){return e$.test(et)}function e1(et){return eG.test(et)}function e2(et){return e0(et)?e3(et):eJ(et)}function e3(et){return et.match(eV)||[]}function e6(et){return et.match(ez)||[]}var e9=Object.prototype.toString,e4=eQ.Symbol,e5=e4?e4.prototype:void 0,e8=e5?e5.toString:void 0;function e7(et,er,en){var ei=-1,es=et.length;er<0&&(er=-er>es?0:es+er),(en=en>es?es:en)<0&&(en+=es),es=er>en?0:en-er>>>0,er>>>=0;for(var ea=Array(es);++ei<es;)ea[ei]=et[ei+er];return ea}function tt(et){if("string"==typeof et)return et;if(ta(et))return e8?e8.call(et):"";var en=et+"";return"0"==en&&1/et==-er?"-0":en}function tr(et,er,en){var ei=et.length;return en=void 0===en?ei:en,!er&&en>=ei?et:e7(et,er,en)}function ti(et){return function(er){var en=e0(er=tl(er))?e2(er):void 0,ei=en?en[0]:er.charAt(0),es=en?tr(en,1).join(""):er.slice(1);return ei[et]()+es}}function ts(et){return!!et&&"object"==typeof et}function ta(et){return"symbol"==typeof et||ts(et)&&e9.call(et)==en}function tl(et){return null==et?"":tt(et)}var tu=function(et){return function(er){return eY(tp(th(er).replace(ej,"")),et,"")}}(function(et,er,en){return er=er.toLowerCase(),et+(en?tc(er):er)});function tc(et){return td(tl(et).toLowerCase())}function th(et){return(et=tl(et))&&et.replace(es,eZ).replace(eU,"")}var td=ti("toUpperCase");function tp(et,er,en){return(et=tl(et),void 0===(er=en?void 0:er))?e1(et)?e6(et):eX(et):et.match(er)||[]}et.exports=tu},5993:(et,er,en)=>{var ei=en(69153)(en(90191),"DataView");et.exports=ei},17446:(et,er,en)=>{var ei=en(61928),es=en(32859),ea=en(13478),eo=en(14021),eu=en(25935);function ec(et){var er=-1,en=null==et?0:et.length;for(this.clear();++er<en;){var ei=et[er];this.set(ei[0],ei[1])}}ec.prototype.clear=ei,ec.prototype.delete=es,ec.prototype.get=ea,ec.prototype.has=eo,ec.prototype.set=eu,et.exports=ec},14060:(et,er,en)=>{var ei=en(88252),es=en(21992),ea=en(58758),eo=en(9525),eu=en(40323);function ec(et){var er=-1,en=null==et?0:et.length;for(this.clear();++er<en;){var ei=et[er];this.set(ei[0],ei[1])}}ec.prototype.clear=ei,ec.prototype.delete=es,ec.prototype.get=ea,ec.prototype.has=eo,ec.prototype.set=eu,et.exports=ec},52586:(et,er,en)=>{var ei=en(69153)(en(90191),"Map");et.exports=ei},51753:(et,er,en)=>{var ei=en(17066),es=en(92106),ea=en(58728),eo=en(33772),eu=en(33577);function ec(et){var er=-1,en=null==et?0:et.length;for(this.clear();++er<en;){var ei=et[er];this.set(ei[0],ei[1])}}ec.prototype.clear=ei,ec.prototype.delete=es,ec.prototype.get=ea,ec.prototype.has=eo,ec.prototype.set=eu,et.exports=ec},17203:(et,er,en)=>{var ei=en(69153)(en(90191),"Promise");et.exports=ei},31959:(et,er,en)=>{var ei=en(69153)(en(90191),"Set");et.exports=ei},77381:(et,er,en)=>{var ei=en(14060),es=en(48847),ea=en(57083),eo=en(75353),eu=en(87109),ec=en(34202);function eh(et){var er=this.__data__=new ei(et);this.size=er.size}eh.prototype.clear=es,eh.prototype.delete=ea,eh.prototype.get=eo,eh.prototype.has=eu,eh.prototype.set=ec,et.exports=eh},40636:(et,er,en)=>{var ei=en(90191).Symbol;et.exports=ei},77388:(et,er,en)=>{var ei=en(90191).Uint8Array;et.exports=ei},56990:(et,er,en)=>{var ei=en(69153)(en(90191),"WeakMap");et.exports=ei},55256:et=>{function er(et,er){for(var en=-1,ei=null==et?0:et.length;++en<ei&&!1!==er(et[en],en,et););return et}et.exports=er},92325:et=>{function er(et,er){for(var en=-1,ei=null==et?0:et.length,es=0,ea=[];++en<ei;){var eo=et[en];er(eo,en,et)&&(ea[es++]=eo)}return ea}et.exports=er},25212:(et,er,en)=>{var ei=en(12490),es=en(1767),ea=en(49403),eo=en(17424),eu=en(10006),ec=en(96026),eh=Object.prototype.hasOwnProperty;function ed(et,er){var en=ea(et),ed=!en&&es(et),ep=!en&&!ed&&eo(et),ef=!en&&!ed&&!ep&&ec(et),em=en||ed||ep||ef,eg=em?ei(et.length,String):[],ey=eg.length;for(var ev in et)(er||eh.call(et,ev))&&!(em&&("length"==ev||ep&&("offset"==ev||"parent"==ev)||ef&&("buffer"==ev||"byteLength"==ev||"byteOffset"==ev)||eu(ev,ey)))&&eg.push(ev);return eg}et.exports=ed},30517:et=>{function er(et,er){for(var en=-1,ei=null==et?0:et.length,es=Array(ei);++en<ei;)es[en]=er(et[en],en,et);return es}et.exports=er},64945:et=>{function er(et,er){for(var en=-1,ei=er.length,es=et.length;++en<ei;)et[es+en]=er[en];return et}et.exports=er},93630:(et,er,en)=>{var ei=en(63136),es=en(53395),ea=Object.prototype.hasOwnProperty;function eo(et,er,en){var eo=et[er];ea.call(et,er)&&es(eo,en)&&(void 0!==en||er in et)||ei(et,er,en)}et.exports=eo},49762:(et,er,en)=>{var ei=en(53395);function es(et,er){for(var en=et.length;en--;)if(ei(et[en][0],er))return en;return -1}et.exports=es},68077:(et,er,en)=>{var ei=en(26403),es=en(65889);function ea(et,er){return et&&ei(er,es(er),et)}et.exports=ea},86259:(et,er,en)=>{var ei=en(26403),es=en(64042);function ea(et,er){return et&&ei(er,es(er),et)}et.exports=ea},63136:(et,er,en)=>{var ei=en(5258);function es(et,er,en){"__proto__"==er&&ei?ei(et,er,{configurable:!0,enumerable:!0,value:en,writable:!0}):et[er]=en}et.exports=es},27748:(et,er,en)=>{var ei=en(77381),es=en(55256),ea=en(93630),eo=en(68077),eu=en(86259),ec=en(10552),eh=en(52127),ed=en(81684),ep=en(798),ef=en(84886),em=en(51944),eg=en(58340),ey=en(43767),ev=en(77835),eb=en(17086),eS=en(49403),eT=en(17424),ew=en(67625),eE=en(99224),eC=en(21185),e_=en(65889),eI=en(64042),ek=1,ex=2,eA=4,eR="[object Arguments]",eD="[object Array]",eO="[object Boolean]",eN="[object Date]",eM="[object Error]",eP="[object Function]",eL="[object GeneratorFunction]",eF="[object Map]",eB="[object Number]",ej="[object Object]",eU="[object RegExp]",eV="[object Set]",ez="[object String]",e$="[object Symbol]",eG="[object WeakMap]",eK="[object ArrayBuffer]",eH="[object DataView]",eW="[object Float32Array]",eQ="[object Float64Array]",eY="[object Int8Array]",eJ="[object Int16Array]",eX="[object Int32Array]",eZ="[object Uint8Array]",e0="[object Uint8ClampedArray]",e1="[object Uint16Array]",e2="[object Uint32Array]",e3={};function e6(et,er,en,eD,eO,eN){var eM,eF=er&ek,eB=er&ex,eU=er&eA;if(en&&(eM=eO?en(et,eD,eO,eN):en(et)),void 0!==eM)return eM;if(!eE(et))return et;var eV=eS(et);if(eV){if(eM=ey(et),!eF)return eh(et,eM)}else{var ez=eg(et),e$=ez==eP||ez==eL;if(eT(et))return ec(et,eF);if(ez==ej||ez==eR||e$&&!eO){if(eM=eB||e$?{}:eb(et),!eF)return eB?ep(et,eu(eM,et)):ed(et,eo(eM,et))}else{if(!e3[ez])return eO?et:{};eM=ev(et,ez,eF)}}eN||(eN=new ei);var eG=eN.get(et);if(eG)return eG;eN.set(et,eM),eC(et)?et.forEach(function(ei){eM.add(e6(ei,er,en,ei,et,eN))}):ew(et)&&et.forEach(function(ei,es){eM.set(es,e6(ei,er,en,es,et,eN))});var eK=eU?eB?em:ef:eB?eI:e_,eH=eV?void 0:eK(et);return es(eH||et,function(ei,es){eH&&(ei=et[es=ei]),ea(eM,es,e6(ei,er,en,es,et,eN))}),eM}e3[eR]=e3[eD]=e3[eK]=e3[eH]=e3[eO]=e3[eN]=e3[eW]=e3[eQ]=e3[eY]=e3[eJ]=e3[eX]=e3[eF]=e3[eB]=e3[ej]=e3[eU]=e3[eV]=e3[ez]=e3[e$]=e3[eZ]=e3[e0]=e3[e1]=e3[e2]=!0,e3[eM]=e3[eP]=e3[eG]=!1,et.exports=e6},96918:(et,er,en)=>{var ei=en(99224),es=Object.create,ea=function(){function et(){}return function(er){if(!ei(er))return{};if(es)return es(er);et.prototype=er;var en=new et;return et.prototype=void 0,en}}();et.exports=ea},66175:(et,er,en)=>{var ei=en(64945),es=en(49403);function ea(et,er,en){var ea=er(et);return es(et)?ea:ei(ea,en(et))}et.exports=ea},92931:(et,er,en)=>{var ei=en(40636),es=en(34995),ea=en(3637),eo="[object Null]",eu="[object Undefined]",ec=ei?ei.toStringTag:void 0;function eh(et){return null==et?void 0===et?eu:eo:ec&&ec in Object(et)?es(et):ea(et)}et.exports=eh},8066:(et,er,en)=>{var ei=en(92931),es=en(71338),ea="[object Arguments]";function eo(et){return es(et)&&ei(et)==ea}et.exports=eo},52151:(et,er,en)=>{var ei=en(58340),es=en(71338),ea="[object Map]";function eo(et){return es(et)&&ei(et)==ea}et.exports=eo},78979:(et,er,en)=>{var ei=en(87102),es=en(23513),ea=en(99224),eo=en(4285),eu=/[\\^$.*+?()[\]{}|]/g,ec=/^\[object .+?Constructor\]$/,eh=Object.prototype,ed=Function.prototype.toString,ep=eh.hasOwnProperty,ef=RegExp("^"+ed.call(ep).replace(eu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function em(et){return!(!ea(et)||es(et))&&(ei(et)?ef:ec).test(eo(et))}et.exports=em},64282:(et,er,en)=>{var ei=en(58340),es=en(71338),ea="[object Set]";function eo(et){return es(et)&&ei(et)==ea}et.exports=eo},59310:(et,er,en)=>{var ei=en(92931),es=en(41610),ea=en(71338),eo="[object Arguments]",eu="[object Array]",ec="[object Boolean]",eh="[object Date]",ed="[object Error]",ep="[object Function]",ef="[object Map]",em="[object Number]",eg="[object Object]",ey="[object RegExp]",ev="[object Set]",eb="[object String]",eS="[object WeakMap]",eT="[object ArrayBuffer]",ew="[object DataView]",eE="[object Float64Array]",eC="[object Int8Array]",e_="[object Int16Array]",eI="[object Int32Array]",ek="[object Uint8Array]",ex="[object Uint8ClampedArray]",eA="[object Uint16Array]",eR="[object Uint32Array]",eD={};function eO(et){return ea(et)&&es(et.length)&&!!eD[ei(et)]}eD["[object Float32Array]"]=eD[eE]=eD[eC]=eD[e_]=eD[eI]=eD[ek]=eD[ex]=eD[eA]=eD[eR]=!0,eD[eo]=eD[eu]=eD[eT]=eD[ec]=eD[ew]=eD[eh]=eD[ed]=eD[ep]=eD[ef]=eD[em]=eD[eg]=eD[ey]=eD[ev]=eD[eb]=eD[eS]=!1,et.exports=eO},80907:(et,er,en)=>{var ei=en(83225),es=en(11704),ea=Object.prototype.hasOwnProperty;function eo(et){if(!ei(et))return es(et);var er=[];for(var en in Object(et))ea.call(et,en)&&"constructor"!=en&&er.push(en);return er}et.exports=eo},68071:(et,er,en)=>{var ei=en(99224),es=en(83225),ea=en(99493),eo=Object.prototype.hasOwnProperty;function eu(et){if(!ei(et))return ea(et);var er=es(et),en=[];for(var eu in et)"constructor"==eu&&(er||!eo.call(et,eu))||en.push(eu);return en}et.exports=eu},12490:et=>{function er(et,er){for(var en=-1,ei=Array(et);++en<et;)ei[en]=er(en);return ei}et.exports=er},498:(et,er,en)=>{var ei=en(40636),es=en(30517),ea=en(49403),eo=en(79910),eu=1/0,ec=ei?ei.prototype:void 0,eh=ec?ec.toString:void 0;function ed(et){if("string"==typeof et)return et;if(ea(et))return es(et,ed)+"";if(eo(et))return eh?eh.call(et):"";var er=et+"";return"0"==er&&1/et==-eu?"-0":er}et.exports=ed},96571:et=>{function er(et){return function(er){return et(er)}}et.exports=er},83066:(et,er,en)=>{var ei=en(77388);function es(et){var er=new et.constructor(et.byteLength);return new ei(er).set(new ei(et)),er}et.exports=es},10552:(et,er,en)=>{et=en.nmd(et);var ei=en(90191),es=er&&!er.nodeType&&er,ea=es&&et&&!et.nodeType&&et,eo=ea&&ea.exports===es?ei.Buffer:void 0,eu=eo?eo.allocUnsafe:void 0;function ec(et,er){if(er)return et.slice();var en=et.length,ei=eu?eu(en):new et.constructor(en);return et.copy(ei),ei}et.exports=ec},15306:(et,er,en)=>{var ei=en(83066);function es(et,er){var en=er?ei(et.buffer):et.buffer;return new et.constructor(en,et.byteOffset,et.byteLength)}et.exports=es},35107:et=>{var er=/\w*$/;function en(et){var en=new et.constructor(et.source,er.exec(et));return en.lastIndex=et.lastIndex,en}et.exports=en},57424:(et,er,en)=>{var ei=en(40636),es=ei?ei.prototype:void 0,ea=es?es.valueOf:void 0;function eo(et){return ea?Object(ea.call(et)):{}}et.exports=eo},78008:(et,er,en)=>{var ei=en(83066);function es(et,er){var en=er?ei(et.buffer):et.buffer;return new et.constructor(en,et.byteOffset,et.length)}et.exports=es},52127:et=>{function er(et,er){var en=-1,ei=et.length;for(er||(er=Array(ei));++en<ei;)er[en]=et[en];return er}et.exports=er},26403:(et,er,en)=>{var ei=en(93630),es=en(63136);function ea(et,er,en,ea){var eo=!en;en||(en={});for(var eu=-1,ec=er.length;++eu<ec;){var eh=er[eu],ed=ea?ea(en[eh],et[eh],eh,en,et):void 0;void 0===ed&&(ed=et[eh]),eo?es(en,eh,ed):ei(en,eh,ed)}return en}et.exports=ea},81684:(et,er,en)=>{var ei=en(26403),es=en(96073);function ea(et,er){return ei(et,es(et),er)}et.exports=ea},798:(et,er,en)=>{var ei=en(26403),es=en(21589);function ea(et,er){return ei(et,es(et),er)}et.exports=ea},56510:(et,er,en)=>{var ei=en(90191)["__core-js_shared__"];et.exports=ei},5258:(et,er,en)=>{var ei=en(69153),es=function(){try{var et=ei(Object,"defineProperty");return et({},"",{}),et}catch(et){}}();et.exports=es},66356:et=>{var er="object"==typeof global&&global&&global.Object===Object&&global;et.exports=er},84886:(et,er,en)=>{var ei=en(66175),es=en(96073),ea=en(65889);function eo(et){return ei(et,ea,es)}et.exports=eo},51944:(et,er,en)=>{var ei=en(66175),es=en(21589),ea=en(64042);function eo(et){return ei(et,ea,es)}et.exports=eo},76830:(et,er,en)=>{var ei=en(72638);function es(et,er){var en=et.__data__;return ei(er)?en["string"==typeof er?"string":"hash"]:en.map}et.exports=es},69153:(et,er,en)=>{var ei=en(78979),es=en(14450);function ea(et,er){var en=es(et,er);return ei(en)?en:void 0}et.exports=ea},89739:(et,er,en)=>{var ei=en(14573)(Object.getPrototypeOf,Object);et.exports=ei},34995:(et,er,en)=>{var ei=en(40636),es=Object.prototype,ea=es.hasOwnProperty,eo=es.toString,eu=ei?ei.toStringTag:void 0;function ec(et){var er=ea.call(et,eu),en=et[eu];try{et[eu]=void 0;var ei=!0}catch(et){}var es=eo.call(et);return ei&&(er?et[eu]=en:delete et[eu]),es}et.exports=ec},96073:(et,er,en)=>{var ei=en(92325),es=en(26051),ea=Object.prototype.propertyIsEnumerable,eo=Object.getOwnPropertySymbols,eu=eo?function(et){return null==et?[]:ei(eo(et=Object(et)),function(er){return ea.call(et,er)})}:es;et.exports=eu},21589:(et,er,en)=>{var ei=en(64945),es=en(89739),ea=en(96073),eo=en(26051),eu=Object.getOwnPropertySymbols?function(et){for(var er=[];et;)ei(er,ea(et)),et=es(et);return er}:eo;et.exports=eu},58340:(et,er,en)=>{var ei=en(5993),es=en(52586),ea=en(17203),eo=en(31959),eu=en(56990),ec=en(92931),eh=en(4285),ed="[object Map]",ep="[object Object]",ef="[object Promise]",em="[object Set]",eg="[object WeakMap]",ey="[object DataView]",ev=eh(ei),eb=eh(es),eS=eh(ea),eT=eh(eo),ew=eh(eu),eE=ec;(ei&&eE(new ei(new ArrayBuffer(1)))!=ey||es&&eE(new es)!=ed||ea&&eE(ea.resolve())!=ef||eo&&eE(new eo)!=em||eu&&eE(new eu)!=eg)&&(eE=function(et){var er=ec(et),en=er==ep?et.constructor:void 0,ei=en?eh(en):"";if(ei)switch(ei){case ev:return ey;case eb:return ed;case eS:return ef;case eT:return em;case ew:return eg}return er}),et.exports=eE},14450:et=>{function er(et,er){return null==et?void 0:et[er]}et.exports=er},61928:(et,er,en)=>{var ei=en(65418);function es(){this.__data__=ei?ei(null):{},this.size=0}et.exports=es},32859:et=>{function er(et){var er=this.has(et)&&delete this.__data__[et];return this.size-=er?1:0,er}et.exports=er},13478:(et,er,en)=>{var ei=en(65418),es="__lodash_hash_undefined__",ea=Object.prototype.hasOwnProperty;function eo(et){var er=this.__data__;if(ei){var en=er[et];return en===es?void 0:en}return ea.call(er,et)?er[et]:void 0}et.exports=eo},14021:(et,er,en)=>{var ei=en(65418),es=Object.prototype.hasOwnProperty;function ea(et){var er=this.__data__;return ei?void 0!==er[et]:es.call(er,et)}et.exports=ea},25935:(et,er,en)=>{var ei=en(65418),es="__lodash_hash_undefined__";function ea(et,er){var en=this.__data__;return this.size+=this.has(et)?0:1,en[et]=ei&&void 0===er?es:er,this}et.exports=ea},43767:et=>{var er=Object.prototype.hasOwnProperty;function en(et){var en=et.length,ei=new et.constructor(en);return en&&"string"==typeof et[0]&&er.call(et,"index")&&(ei.index=et.index,ei.input=et.input),ei}et.exports=en},77835:(et,er,en)=>{var ei=en(83066),es=en(15306),ea=en(35107),eo=en(57424),eu=en(78008),ec="[object Boolean]",eh="[object Date]",ed="[object Map]",ep="[object Number]",ef="[object RegExp]",em="[object Set]",eg="[object String]",ey="[object Symbol]",ev="[object ArrayBuffer]",eb="[object DataView]",eS="[object Float32Array]",eT="[object Float64Array]",ew="[object Int8Array]",eE="[object Int16Array]",eC="[object Int32Array]",e_="[object Uint8Array]",eI="[object Uint8ClampedArray]",ek="[object Uint16Array]",ex="[object Uint32Array]";function eA(et,er,en){var eA=et.constructor;switch(er){case ev:return ei(et);case ec:case eh:return new eA(+et);case eb:return es(et,en);case eS:case eT:case ew:case eE:case eC:case e_:case eI:case ek:case ex:return eu(et,en);case ed:return new eA;case ep:case eg:return new eA(et);case ef:return ea(et);case em:return new eA;case ey:return eo(et)}}et.exports=eA},17086:(et,er,en)=>{var ei=en(96918),es=en(89739),ea=en(83225);function eo(et){return"function"!=typeof et.constructor||ea(et)?{}:ei(es(et))}et.exports=eo},10006:et=>{var er=9007199254740991,en=/^(?:0|[1-9]\d*)$/;function ei(et,ei){var es=typeof et;return!!(ei=null==ei?er:ei)&&("number"==es||"symbol"!=es&&en.test(et))&&et>-1&&et%1==0&&et<ei}et.exports=ei},72638:et=>{function er(et){var er=typeof et;return"string"==er||"number"==er||"symbol"==er||"boolean"==er?"__proto__"!==et:null===et}et.exports=er},23513:(et,er,en)=>{var ei=en(56510),es=function(){var et=/[^.]+$/.exec(ei&&ei.keys&&ei.keys.IE_PROTO||"");return et?"Symbol(src)_1."+et:""}();function ea(et){return!!es&&es in et}et.exports=ea},83225:et=>{var er=Object.prototype;function en(et){var en=et&&et.constructor;return et===("function"==typeof en&&en.prototype||er)}et.exports=en},88252:et=>{function er(){this.__data__=[],this.size=0}et.exports=er},21992:(et,er,en)=>{var ei=en(49762),es=Array.prototype.splice;function ea(et){var er=this.__data__,en=ei(er,et);return!(en<0)&&(en==er.length-1?er.pop():es.call(er,en,1),--this.size,!0)}et.exports=ea},58758:(et,er,en)=>{var ei=en(49762);function es(et){var er=this.__data__,en=ei(er,et);return en<0?void 0:er[en][1]}et.exports=es},9525:(et,er,en)=>{var ei=en(49762);function es(et){return ei(this.__data__,et)>-1}et.exports=es},40323:(et,er,en)=>{var ei=en(49762);function es(et,er){var en=this.__data__,es=ei(en,et);return es<0?(++this.size,en.push([et,er])):en[es][1]=er,this}et.exports=es},17066:(et,er,en)=>{var ei=en(17446),es=en(14060),ea=en(52586);function eo(){this.size=0,this.__data__={hash:new ei,map:new(ea||es),string:new ei}}et.exports=eo},92106:(et,er,en)=>{var ei=en(76830);function es(et){var er=ei(this,et).delete(et);return this.size-=er?1:0,er}et.exports=es},58728:(et,er,en)=>{var ei=en(76830);function es(et){return ei(this,et).get(et)}et.exports=es},33772:(et,er,en)=>{var ei=en(76830);function es(et){return ei(this,et).has(et)}et.exports=es},33577:(et,er,en)=>{var ei=en(76830);function es(et,er){var en=ei(this,et),es=en.size;return en.set(et,er),this.size+=en.size==es?0:1,this}et.exports=es},50817:(et,er,en)=>{var ei=en(58885),es=500;function ea(et){var er=ei(et,function(et){return en.size===es&&en.clear(),et}),en=er.cache;return er}et.exports=ea},65418:(et,er,en)=>{var ei=en(69153)(Object,"create");et.exports=ei},11704:(et,er,en)=>{var ei=en(14573)(Object.keys,Object);et.exports=ei},99493:et=>{function er(et){var er=[];if(null!=et)for(var en in Object(et))er.push(en);return er}et.exports=er},97952:(et,er,en)=>{et=en.nmd(et);var ei=en(66356),es=er&&!er.nodeType&&er,ea=es&&et&&!et.nodeType&&et,eo=ea&&ea.exports===es&&ei.process,eu=function(){try{var et=ea&&ea.require&&ea.require("util").types;if(et)return et;return eo&&eo.binding&&eo.binding("util")}catch(et){}}();et.exports=eu},3637:et=>{var er=Object.prototype.toString;function en(et){return er.call(et)}et.exports=en},14573:et=>{function er(et,er){return function(en){return et(er(en))}}et.exports=er},90191:(et,er,en)=>{var ei=en(66356),es="object"==typeof self&&self&&self.Object===Object&&self,ea=ei||es||Function("return this")();et.exports=ea},48847:(et,er,en)=>{var ei=en(14060);function es(){this.__data__=new ei,this.size=0}et.exports=es},57083:et=>{function er(et){var er=this.__data__,en=er.delete(et);return this.size=er.size,en}et.exports=er},75353:et=>{function er(et){return this.__data__.get(et)}et.exports=er},87109:et=>{function er(et){return this.__data__.has(et)}et.exports=er},34202:(et,er,en)=>{var ei=en(14060),es=en(52586),ea=en(51753),eo=200;function eu(et,er){var en=this.__data__;if(en instanceof ei){var eu=en.__data__;if(!es||eu.length<eo-1)return eu.push([et,er]),this.size=++en.size,this;en=this.__data__=new ea(eu)}return en.set(et,er),this.size=en.size,this}et.exports=eu},33348:(et,er,en)=>{var ei=en(50817),es=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ea=/\\(\\)?/g,eo=ei(function(et){var er=[];return 46===et.charCodeAt(0)&&er.push(""),et.replace(es,function(et,en,ei,es){er.push(ei?es.replace(ea,"$1"):en||et)}),er});et.exports=eo},27172:(et,er,en)=>{var ei=en(79910),es=1/0;function ea(et){if("string"==typeof et||ei(et))return et;var er=et+"";return"0"==er&&1/et==-es?"-0":er}et.exports=ea},4285:et=>{var er=Function.prototype.toString;function en(et){if(null!=et){try{return er.call(et)}catch(et){}try{return et+""}catch(et){}}return""}et.exports=en},23534:(et,er,en)=>{var ei=en(27748),es=4;function ea(et){return ei(et,es)}et.exports=ea},24653:(et,er,en)=>{var ei=en(27748),es=1,ea=4;function eo(et){return ei(et,es|ea)}et.exports=eo},53395:et=>{function er(et,er){return et===er||et!=et&&er!=er}et.exports=er},1767:(et,er,en)=>{var ei=en(8066),es=en(71338),ea=Object.prototype,eo=ea.hasOwnProperty,eu=ea.propertyIsEnumerable,ec=ei(function(){return arguments}())?ei:function(et){return es(et)&&eo.call(et,"callee")&&!eu.call(et,"callee")};et.exports=ec},49403:et=>{var er=Array.isArray;et.exports=er},20058:(et,er,en)=>{var ei=en(87102),es=en(41610);function ea(et){return null!=et&&es(et.length)&&!ei(et)}et.exports=ea},17424:(et,er,en)=>{et=en.nmd(et);var ei=en(90191),es=en(47110),ea=er&&!er.nodeType&&er,eo=ea&&et&&!et.nodeType&&et,eu=eo&&eo.exports===ea?ei.Buffer:void 0,ec=(eu?eu.isBuffer:void 0)||es;et.exports=ec},87102:(et,er,en)=>{var ei=en(92931),es=en(99224),ea="[object AsyncFunction]",eo="[object Function]",eu="[object GeneratorFunction]",ec="[object Proxy]";function eh(et){if(!es(et))return!1;var er=ei(et);return er==eo||er==eu||er==ea||er==ec}et.exports=eh},41610:et=>{var er=9007199254740991;function en(et){return"number"==typeof et&&et>-1&&et%1==0&&et<=er}et.exports=en},67625:(et,er,en)=>{var ei=en(52151),es=en(96571),ea=en(97952),eo=ea&&ea.isMap,eu=eo?es(eo):ei;et.exports=eu},99224:et=>{function er(et){var er=typeof et;return null!=et&&("object"==er||"function"==er)}et.exports=er},71338:et=>{function er(et){return null!=et&&"object"==typeof et}et.exports=er},7997:(et,er,en)=>{var ei=en(92931),es=en(89739),ea=en(71338),eo="[object Object]",eu=Object.prototype,ec=Function.prototype.toString,eh=eu.hasOwnProperty,ed=ec.call(Object);function ep(et){if(!ea(et)||ei(et)!=eo)return!1;var er=es(et);if(null===er)return!0;var en=eh.call(er,"constructor")&&er.constructor;return"function"==typeof en&&en instanceof en&&ec.call(en)==ed}et.exports=ep},21185:(et,er,en)=>{var ei=en(64282),es=en(96571),ea=en(97952),eo=ea&&ea.isSet,eu=eo?es(eo):ei;et.exports=eu},79910:(et,er,en)=>{var ei=en(92931),es=en(71338),ea="[object Symbol]";function eo(et){return"symbol"==typeof et||es(et)&&ei(et)==ea}et.exports=eo},96026:(et,er,en)=>{var ei=en(59310),es=en(96571),ea=en(97952),eo=ea&&ea.isTypedArray,eu=eo?es(eo):ei;et.exports=eu},65889:(et,er,en)=>{var ei=en(25212),es=en(80907),ea=en(20058);function eo(et){return ea(et)?ei(et):es(et)}et.exports=eo},64042:(et,er,en)=>{var ei=en(25212),es=en(68071),ea=en(20058);function eo(et){return ea(et)?ei(et,!0):es(et)}et.exports=eo},58885:(et,er,en)=>{var ei=en(51753),es="Expected a function";function ea(et,er){if("function"!=typeof et||null!=er&&"function"!=typeof er)throw TypeError(es);var en=function(){var ei=arguments,es=er?er.apply(this,ei):ei[0],ea=en.cache;if(ea.has(es))return ea.get(es);var eo=et.apply(this,ei);return en.cache=ea.set(es,eo)||ea,eo};return en.cache=new(ea.Cache||ei),en}ea.Cache=ei,et.exports=ea},26051:et=>{function er(){return[]}et.exports=er},47110:et=>{function er(){return!1}et.exports=er},85372:(et,er,en)=>{var ei=en(30517),es=en(52127),ea=en(49403),eo=en(79910),eu=en(33348),ec=en(27172),eh=en(97885);function ed(et){return ea(et)?ei(et,ec):eo(et)?[et]:es(eu(eh(et)))}et.exports=ed},97885:(et,er,en)=>{var ei=en(498);function es(et){return null==et?"":ei(et)}et.exports=es},14738:et=>{"use strict";function er(et){this._maxSize=et,this.clear()}er.prototype.clear=function(){this._size=0,this._values=Object.create(null)},er.prototype.get=function(et){return this._values[et]},er.prototype.set=function(et,er){return this._size>=this._maxSize&&this.clear(),!(et in this._values)&&this._size++,this._values[et]=er};var en=/[^.^\]^[]+|(?=\[\]|\.\.)/g,ei=/^\d+$/,es=/^\d/,ea=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,eo=/^\s*(['"]?)(.*?)(\1)\s*$/,eu=512,ec=new er(eu),eh=new er(eu),ed=new er(eu);function ep(et){return ec.get(et)||ec.set(et,ef(et).map(function(et){return et.replace(eo,"$2")}))}function ef(et){return et.match(en)||[""]}function em(et,er,en){var ei,es,ea,eo,eu=et.length;for(es=0;es<eu;es++)(ei=et[es])&&(eb(ei)&&(ei='"'+ei+'"'),ea=!(eo=eg(ei))&&/^\d+$/.test(ei),er.call(en,ei,eo,ea,es,et))}function eg(et){return"string"==typeof et&&et&&-1!==["'",'"'].indexOf(et.charAt(0))}function ey(et){return et.match(es)&&!et.match(ei)}function ev(et){return ea.test(et)}function eb(et){return!eg(et)&&(ey(et)||ev(et))}et.exports={Cache:er,split:ef,normalizePath:ep,setter:function(et){var er=ep(et);return eh.get(et)||eh.set(et,function(et,en){for(var ei=0,es=er.length,ea=et;ei<es-1;){var eo=er[ei];if("__proto__"===eo||"constructor"===eo||"prototype"===eo)return et;ea=ea[er[ei++]]}ea[er[ei]]=en})},getter:function(et,er){var en=ep(et);return ed.get(et)||ed.set(et,function(et){for(var ei=0,es=en.length;ei<es;){if(null==et&&er)return;et=et[en[ei++]]}return et})},join:function(et){return et.reduce(function(et,er){return et+(eg(er)||ei.test(er)?"["+er+"]":(et?".":"")+er)},"")},forEach:function(et,er,en){em(Array.isArray(et)?et:ef(et),er,en)}}},95307:(et,er,en)=>{"use strict";var ei=en(75962);et.exports=er=ei.descriptor=ei.Root.fromJSON(en(89987)).lookup(".google.protobuf");var es=ei.Namespace,ea=ei.Root,eo=ei.Enum,eu=ei.Type,ec=ei.Field,eh=ei.MapField,ed=ei.OneOf,ep=ei.Service,ef=ei.Method;function em(et,en,ei){var eh=er.FileDescriptorProto.create({name:et.filename||(et.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});ei&&(eh.syntax=ei),et instanceof ea||(eh.package=et.fullName.substring(1));for(var ed,ef=0;ef<et.nestedArray.length;++ef)(ed=et._nestedArray[ef])instanceof eu?eh.messageType.push(ed.toDescriptor(ei)):ed instanceof eo?eh.enumType.push(ed.toDescriptor()):ed instanceof ec?eh.extension.push(ed.toDescriptor(ei)):ed instanceof ep?eh.service.push(ed.toDescriptor()):ed instanceof es&&em(ed,en,ei);eh.options=eI(et.options,er.FileOptions),eh.messageType.length+eh.enumType.length+eh.extension.length+eh.service.length&&en.push(eh)}ea.fromDescriptor=function(et){"number"==typeof et.length&&(et=er.FileDescriptorSet.decode(et));var en=new ea;if(et.file)for(var ei,es,eh,ed=0;ed<et.file.length;++ed){if(es=en,(ei=et.file[ed]).package&&ei.package.length&&(es=en.define(ei.package)),ei.name&&ei.name.length&&en.files.push(es.filename=ei.name),ei.messageType)for(eh=0;eh<ei.messageType.length;++eh)es.add(eu.fromDescriptor(ei.messageType[eh],ei.syntax));if(ei.enumType)for(eh=0;eh<ei.enumType.length;++eh)es.add(eo.fromDescriptor(ei.enumType[eh]));if(ei.extension)for(eh=0;eh<ei.extension.length;++eh)es.add(ec.fromDescriptor(ei.extension[eh]));if(ei.service)for(eh=0;eh<ei.service.length;++eh)es.add(ep.fromDescriptor(ei.service[eh]));var ef=e_(ei.options,er.FileOptions);if(ef){var em=Object.keys(ef);for(eh=0;eh<em.length;++eh)es.setOption(em[eh],ef[em[eh]])}}return en},ea.prototype.toDescriptor=function(et){var en=er.FileDescriptorSet.create();return em(this,en.file,et),en};var eg=0;eu.fromDescriptor=function(et,en){"number"==typeof et.length&&(et=er.DescriptorProto.decode(et));var ei,es=new eu(et.name.length?et.name:"Type"+eg++,e_(et.options,er.MessageOptions));if(et.oneofDecl)for(ei=0;ei<et.oneofDecl.length;++ei)es.add(ed.fromDescriptor(et.oneofDecl[ei]));if(et.field)for(ei=0;ei<et.field.length;++ei){var ea=ec.fromDescriptor(et.field[ei],en);es.add(ea),et.field[ei].hasOwnProperty("oneofIndex")&&es.oneofsArray[et.field[ei].oneofIndex].add(ea)}if(et.extension)for(ei=0;ei<et.extension.length;++ei)es.add(ec.fromDescriptor(et.extension[ei],en));if(et.nestedType)for(ei=0;ei<et.nestedType.length;++ei)es.add(eu.fromDescriptor(et.nestedType[ei],en)),et.nestedType[ei].options&&et.nestedType[ei].options.mapEntry&&es.setOption("map_entry",!0);if(et.enumType)for(ei=0;ei<et.enumType.length;++ei)es.add(eo.fromDescriptor(et.enumType[ei]));if(et.extensionRange&&et.extensionRange.length)for(ei=0,es.extensions=[];ei<et.extensionRange.length;++ei)es.extensions.push([et.extensionRange[ei].start,et.extensionRange[ei].end]);if(et.reservedRange&&et.reservedRange.length||et.reservedName&&et.reservedName.length){if(es.reserved=[],et.reservedRange)for(ei=0;ei<et.reservedRange.length;++ei)es.reserved.push([et.reservedRange[ei].start,et.reservedRange[ei].end]);if(et.reservedName)for(ei=0;ei<et.reservedName.length;++ei)es.reserved.push(et.reservedName[ei])}return es},eu.prototype.toDescriptor=function(et){var en,ei,es=er.DescriptorProto.create({name:this.name});for(ei=0;ei<this.fieldsArray.length;++ei)if(es.field.push(en=this._fieldsArray[ei].toDescriptor(et)),this._fieldsArray[ei]instanceof eh){var ea=eC(this._fieldsArray[ei].keyType,this._fieldsArray[ei].resolvedKeyType),ed=eC(this._fieldsArray[ei].type,this._fieldsArray[ei].resolvedType),ep=11===ed||14===ed?this._fieldsArray[ei].resolvedType&&ek(this.parent,this._fieldsArray[ei].resolvedType)||this._fieldsArray[ei].type:void 0;es.nestedType.push(er.DescriptorProto.create({name:en.typeName,field:[er.FieldDescriptorProto.create({name:"key",number:1,label:1,type:ea}),er.FieldDescriptorProto.create({name:"value",number:2,label:1,type:ed,typeName:ep})],options:er.MessageOptions.create({mapEntry:!0})}))}for(ei=0;ei<this.oneofsArray.length;++ei)es.oneofDecl.push(this._oneofsArray[ei].toDescriptor());for(ei=0;ei<this.nestedArray.length;++ei)this._nestedArray[ei]instanceof ec?es.field.push(this._nestedArray[ei].toDescriptor(et)):this._nestedArray[ei]instanceof eu?es.nestedType.push(this._nestedArray[ei].toDescriptor(et)):this._nestedArray[ei]instanceof eo&&es.enumType.push(this._nestedArray[ei].toDescriptor());if(this.extensions)for(ei=0;ei<this.extensions.length;++ei)es.extensionRange.push(er.DescriptorProto.ExtensionRange.create({start:this.extensions[ei][0],end:this.extensions[ei][1]}));if(this.reserved)for(ei=0;ei<this.reserved.length;++ei)"string"==typeof this.reserved[ei]?es.reservedName.push(this.reserved[ei]):es.reservedRange.push(er.DescriptorProto.ReservedRange.create({start:this.reserved[ei][0],end:this.reserved[ei][1]}));return es.options=eI(this.options,er.MessageOptions),es};var ey=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;ec.fromDescriptor=function(et,en){if("number"==typeof et.length&&(et=er.DescriptorProto.decode(et)),"number"!=typeof et.number)throw Error("missing field id");switch(ei=et.typeName&&et.typeName.length?et.typeName:ew(et.type),et.label){case 1:es=void 0;break;case 2:es="required";break;case 3:es="repeated";break;default:throw Error("illegal label: "+et.label)}var ei,es,ea=et.extendee;void 0!==et.extendee&&(ea=ea.length?ea:void 0);var eo=new ec(et.name.length?et.name:"field"+et.number,et.number,ei,es,ea);if(eo.options=e_(et.options,er.FieldOptions),et.defaultValue&&et.defaultValue.length){var eu=et.defaultValue;switch(eu){case"true":case"TRUE":eu=!0;break;case"false":case"FALSE":eu=!1;break;default:ey.exec(eu)&&(eu=parseInt(eu))}eo.setOption("default",eu)}return eE(et.type)&&("proto3"===en?et.options&&!et.options.packed&&eo.setOption("packed",!1):et.options&&et.options.packed||eo.setOption("packed",!1)),eo},ec.prototype.toDescriptor=function(et){var en=er.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)en.type=11,en.typeName=ei.util.ucFirst(this.name),en.label=3;else{switch(en.type=eC(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:en.typeName=this.resolvedType?ek(this.parent,this.resolvedType):this.type}switch(this.rule){case"repeated":en.label=3;break;case"required":en.label=2;break;default:en.label=1}}if(en.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(en.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(en.options=eI(this.options,er.FieldOptions),null!=this.options.default&&(en.defaultValue=String(this.options.default))),"proto3"===et?this.packed||((en.options||(en.options=er.FieldOptions.create())).packed=!1):this.packed&&((en.options||(en.options=er.FieldOptions.create())).packed=!0),en};var ev=0;eo.fromDescriptor=function(et){"number"==typeof et.length&&(et=er.EnumDescriptorProto.decode(et));var en={};if(et.value)for(var ei=0;ei<et.value.length;++ei){var es=et.value[ei].name,ea=et.value[ei].number||0;en[es&&es.length?es:"NAME"+ea]=ea}return new eo(et.name&&et.name.length?et.name:"Enum"+ev++,en,e_(et.options,er.EnumOptions))},eo.prototype.toDescriptor=function(){for(var et=[],en=0,ei=Object.keys(this.values);en<ei.length;++en)et.push(er.EnumValueDescriptorProto.create({name:ei[en],number:this.values[ei[en]]}));return er.EnumDescriptorProto.create({name:this.name,value:et,options:eI(this.options,er.EnumOptions)})};var eb=0;ed.fromDescriptor=function(et){return"number"==typeof et.length&&(et=er.OneofDescriptorProto.decode(et)),new ed(et.name&&et.name.length?et.name:"oneof"+eb++)},ed.prototype.toDescriptor=function(){return er.OneofDescriptorProto.create({name:this.name})};var eS=0;ep.fromDescriptor=function(et){"number"==typeof et.length&&(et=er.ServiceDescriptorProto.decode(et));var en=new ep(et.name&&et.name.length?et.name:"Service"+eS++,e_(et.options,er.ServiceOptions));if(et.method)for(var ei=0;ei<et.method.length;++ei)en.add(ef.fromDescriptor(et.method[ei]));return en},ep.prototype.toDescriptor=function(){for(var et=[],en=0;en<this.methodsArray.length;++en)et.push(this._methodsArray[en].toDescriptor());return er.ServiceDescriptorProto.create({name:this.name,method:et,options:eI(this.options,er.ServiceOptions)})};var eT=0;function ew(et){switch(et){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+et)}function eE(et){switch(et){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function eC(et,er){switch(et){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(er instanceof eo)return 14;if(er instanceof eu)return er.group?10:11;throw Error("illegal type: "+et)}function e_(et,er){if(et){for(var en,es,ea,eu=[],ec=0;ec<er.fieldsArray.length;++ec)"uninterpretedOption"!==(es=(en=er._fieldsArray[ec]).name)&&et.hasOwnProperty(es)&&(ea=et[es],en.resolvedType instanceof eo&&"number"==typeof ea&&void 0!==en.resolvedType.valuesById[ea]&&(ea=en.resolvedType.valuesById[ea]),eu.push(ex(es),ea));return eu.length?ei.util.toObject(eu):void 0}}function eI(et,er){if(et){for(var en,es,ea=[],eo=0,eu=Object.keys(et);eo<eu.length;++eo)if(es=et[en=eu[eo]],"default"!==en){var ec=er.fields[en];(ec||(ec=er.fields[en=ei.util.camelCase(en)]))&&ea.push(en,es)}return ea.length?er.fromObject(ei.util.toObject(ea)):void 0}}function ek(et,er){var en=et.fullName.split("."),ei=er.fullName.split("."),eo=0,eu=0,ec=ei.length-1;if(!(et instanceof ea)&&er instanceof es)for(;eo<en.length&&eu<ec&&en[eo]===ei[eu];){var eh=er.lookup(en[eo++],!0);if(null!==eh&&eh!==er)break;++eu}else for(;eo<en.length&&eu<ec&&en[eo]===ei[eu];++eo,++eu);return ei.slice(eu).join(".")}function ex(et){return et.substring(0,1)+et.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(et,er){return"_"+er.toLowerCase()})}ef.fromDescriptor=function(et){return"number"==typeof et.length&&(et=er.MethodDescriptorProto.decode(et)),new ef(et.name&&et.name.length?et.name:"Method"+eT++,"rpc",et.inputType,et.outputType,!!et.clientStreaming,!!et.serverStreaming,e_(et.options,er.MethodOptions))},ef.prototype.toDescriptor=function(){return er.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:eI(this.options,er.MethodOptions)})}},75962:(et,er,en)=>{"use strict";et.exports=en(23517)},79760:et=>{"use strict";et.exports=ei;var er,en=/\/|\./;function ei(et,er){en.test(et)||(et="google/protobuf/"+et+".proto",er={nested:{google:{nested:{protobuf:{nested:er}}}}}),ei[et]=er}ei("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),ei("duration",{Duration:er={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),ei("timestamp",{Timestamp:er}),ei("empty",{Empty:{fields:{}}}),ei("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),ei("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),ei("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),ei.get=function(et){return ei[et]||null}},84144:(et,er,en)=>{"use strict";var ei=er,es=en(59246),ea=en(66738);function eo(et,er,en,ei){var ea=!1;if(er.resolvedType){if(er.resolvedType instanceof es){et("switch(d%s){",ei);for(var eo=er.resolvedType.values,eu=Object.keys(eo),ec=0;ec<eu.length;++ec)eo[eu[ec]]!==er.typeDefault||ea||(et("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',ei,ei,ei),er.repeated||et("break"),ea=!0),et("case%j:",eu[ec])("case %i:",eo[eu[ec]])("m%s=%j",ei,eo[eu[ec]])("break");et("}")}else et('if(typeof d%s!=="object")',ei)("throw TypeError(%j)",er.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",ei,en,ei)}else{var eh=!1;switch(er.type){case"double":case"float":et("m%s=Number(d%s)",ei,ei);break;case"uint32":case"fixed32":et("m%s=d%s>>>0",ei,ei);break;case"int32":case"sint32":case"sfixed32":et("m%s=d%s|0",ei,ei);break;case"uint64":eh=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":et("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",ei,ei,eh)('else if(typeof d%s==="string")',ei)("m%s=parseInt(d%s,10)",ei,ei)('else if(typeof d%s==="number")',ei)("m%s=d%s",ei,ei)('else if(typeof d%s==="object")',ei)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",ei,ei,ei,eh?"true":"");break;case"bytes":et('if(typeof d%s==="string")',ei)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",ei,ei,ei)("else if(d%s.length >= 0)",ei)("m%s=d%s",ei,ei);break;case"string":et("m%s=String(d%s)",ei,ei);break;case"bool":et("m%s=Boolean(d%s)",ei,ei)}}return et}function eu(et,er,en,ei){if(er.resolvedType)er.resolvedType instanceof es?et("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",ei,en,ei,ei,en,ei,ei):et("d%s=types[%i].toObject(m%s,o)",ei,en,ei);else{var ea=!1;switch(er.type){case"double":case"float":et("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",ei,ei,ei,ei);break;case"uint64":ea=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":et('if(typeof m%s==="number")',ei)("d%s=o.longs===String?String(m%s):m%s",ei,ei,ei)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",ei,ei,ei,ei,ea?"true":"",ei);break;case"bytes":et("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",ei,ei,ei,ei,ei);break;default:et("d%s=m%s",ei,ei)}}return et}ei.fromObject=function(et){var er=et.fieldsArray,en=ea.codegen(["d"],et.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!er.length)return en("return new this.ctor");en("var m=new this.ctor");for(var ei=0;ei<er.length;++ei){var eu=er[ei].resolve(),ec=ea.safeProp(eu.name);eu.map?(en("if(d%s){",ec)('if(typeof d%s!=="object")',ec)("throw TypeError(%j)",eu.fullName+": object expected")("m%s={}",ec)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",ec),eo(en,eu,ei,ec+"[ks[i]]")("}")("}")):eu.repeated?(en("if(d%s){",ec)("if(!Array.isArray(d%s))",ec)("throw TypeError(%j)",eu.fullName+": array expected")("m%s=[]",ec)("for(var i=0;i<d%s.length;++i){",ec),eo(en,eu,ei,ec+"[i]")("}")("}")):(eu.resolvedType instanceof es||en("if(d%s!=null){",ec),eo(en,eu,ei,ec),eu.resolvedType instanceof es||en("}"))}return en("return m")},ei.toObject=function(et){var er=et.fieldsArray.slice().sort(ea.compareFieldsById);if(!er.length)return ea.codegen()("return {}");for(var en=ea.codegen(["m","o"],et.name+"$toObject")("if(!o)")("o={}")("var d={}"),ei=[],eo=[],ec=[],eh=0;eh<er.length;++eh)er[eh].partOf||(er[eh].resolve().repeated?ei:er[eh].map?eo:ec).push(er[eh]);if(ei.length){for(en("if(o.arrays||o.defaults){"),eh=0;eh<ei.length;++eh)en("d%s=[]",ea.safeProp(ei[eh].name));en("}")}if(eo.length){for(en("if(o.objects||o.defaults){"),eh=0;eh<eo.length;++eh)en("d%s={}",ea.safeProp(eo[eh].name));en("}")}if(ec.length){for(en("if(o.defaults){"),eh=0;eh<ec.length;++eh){var ed=ec[eh],ep=ea.safeProp(ed.name);if(ed.resolvedType instanceof es)en("d%s=o.enums===String?%j:%j",ep,ed.resolvedType.valuesById[ed.typeDefault],ed.typeDefault);else if(ed.long)en("if(util.Long){")("var n=new util.Long(%i,%i,%j)",ed.typeDefault.low,ed.typeDefault.high,ed.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",ep)("}else")("d%s=o.longs===String?%j:%i",ep,ed.typeDefault.toString(),ed.typeDefault.toNumber());else if(ed.bytes){var ef="["+Array.prototype.slice.call(ed.typeDefault).join(",")+"]";en("if(o.bytes===String)d%s=%j",ep,String.fromCharCode.apply(String,ed.typeDefault))("else{")("d%s=%s",ep,ef)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",ep,ep)("}")}else en("d%s=%j",ep,ed.typeDefault)}en("}")}var em=!1;for(eh=0;eh<er.length;++eh){var ed=er[eh],eg=et._fieldsArray.indexOf(ed),ep=ea.safeProp(ed.name);ed.map?(em||(em=!0,en("var ks2")),en("if(m%s&&(ks2=Object.keys(m%s)).length){",ep,ep)("d%s={}",ep)("for(var j=0;j<ks2.length;++j){"),eu(en,ed,eg,ep+"[ks2[j]]")("}")):ed.repeated?(en("if(m%s&&m%s.length){",ep,ep)("d%s=[]",ep)("for(var j=0;j<m%s.length;++j){",ep),eu(en,ed,eg,ep+"[j]")("}")):(en("if(m%s!=null&&m.hasOwnProperty(%j)){",ep,ed.name),eu(en,ed,eg,ep),ed.partOf&&en("if(o.oneofs)")("d%s=%j",ea.safeProp(ed.partOf.name),ed.name)),en("}")}return en("return d")}},87317:(et,er,en)=>{"use strict";et.exports=eu;var ei=en(59246),es=en(91708),ea=en(66738);function eo(et){return"missing required '"+et.name+"'"}function eu(et){var er=ea.codegen(["r","l"],et.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(et.fieldsArray.filter(function(et){return et.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");et.group&&er("if((t&7)===4)")("break"),er("switch(t>>>3){");for(var en=0;en<et.fieldsArray.length;++en){var eu=et._fieldsArray[en].resolve(),ec=eu.resolvedType instanceof ei?"int32":eu.type,eh="m"+ea.safeProp(eu.name);er("case %i: {",eu.id),eu.map?(er("if(%s===util.emptyObject)",eh)("%s={}",eh)("var c2 = r.uint32()+r.pos"),void 0!==es.defaults[eu.keyType]?er("k=%j",es.defaults[eu.keyType]):er("k=null"),void 0!==es.defaults[ec]?er("value=%j",es.defaults[ec]):er("value=null"),er("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",eu.keyType)("case 2:"),void 0===es.basic[ec]?er("value=types[%i].decode(r,r.uint32())",en):er("value=r.%s()",ec),er("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),er(void 0!==es.long[eu.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",eh)):eu.repeated?(er("if(!(%s&&%s.length))",eh,eh)("%s=[]",eh),void 0!==es.packed[ec]&&er("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",eh,ec)("}else"),void 0===es.basic[ec]?er(eu.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",eh,en):er("%s.push(r.%s())",eh,ec)):void 0===es.basic[ec]?er(eu.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",eh,en):er("%s=r.%s()",eh,ec),er("break")("}")}for(er("default:")("r.skipType(t&7)")("break")("}")("}"),en=0;en<et._fieldsArray.length;++en){var ed=et._fieldsArray[en];ed.required&&er("if(!m.hasOwnProperty(%j))",ed.name)("throw util.ProtocolError(%j,{instance:m})",eo(ed))}return er("return m")}},49561:(et,er,en)=>{"use strict";et.exports=eu;var ei=en(59246),es=en(91708),ea=en(66738);function eo(et,er,en,ei){return er.resolvedType.group?et("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",en,ei,(er.id<<3|3)>>>0,(er.id<<3|4)>>>0):et("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",en,ei,(er.id<<3|2)>>>0)}function eu(et){for(var er,en,eu=ea.codegen(["m","w"],et.name+"$encode")("if(!w)")("w=Writer.create()"),ec=et.fieldsArray.slice().sort(ea.compareFieldsById),er=0;er<ec.length;++er){var eh=ec[er].resolve(),ed=et._fieldsArray.indexOf(eh),ep=eh.resolvedType instanceof ei?"int32":eh.type,ef=es.basic[ep];en="m"+ea.safeProp(eh.name),eh.map?(eu("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",en,eh.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",en)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(eh.id<<3|2)>>>0,8|es.mapKey[eh.keyType],eh.keyType),void 0===ef?eu("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",ed,en):eu(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|ef,ep,en),eu("}")("}")):eh.repeated?(eu("if(%s!=null&&%s.length){",en,en),eh.packed&&void 0!==es.packed[ep]?eu("w.uint32(%i).fork()",(eh.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",en)("w.%s(%s[i])",ep,en)("w.ldelim()"):(eu("for(var i=0;i<%s.length;++i)",en),void 0===ef?eo(eu,eh,ed,en+"[i]"):eu("w.uint32(%i).%s(%s[i])",(eh.id<<3|ef)>>>0,ep,en)),eu("}")):(eh.optional&&eu("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",en,eh.name),void 0===ef?eo(eu,eh,ed,en):eu("w.uint32(%i).%s(%s)",(eh.id<<3|ef)>>>0,ep,en))}return eu("return w")}},59246:(et,er,en)=>{"use strict";et.exports=eo;var ei=en(61862);((eo.prototype=Object.create(ei.prototype)).constructor=eo).className="Enum";var es=en(97540),ea=en(66738);function eo(et,er,en,es,ea,eo){if(ei.call(this,et,en),er&&"object"!=typeof er)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=es,this.comments=ea||{},this.valuesOptions=eo,this.reserved=void 0,er)for(var eu=Object.keys(er),ec=0;ec<eu.length;++ec)"number"==typeof er[eu[ec]]&&(this.valuesById[this.values[eu[ec]]=er[eu[ec]]]=eu[ec])}eo.fromJSON=function(et,er){var en=new eo(et,er.values,er.options,er.comment,er.comments);return en.reserved=er.reserved,en},eo.prototype.toJSON=function(et){var er=!!et&&!!et.keepComments;return ea.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",er?this.comment:void 0,"comments",er?this.comments:void 0])},eo.prototype.add=function(et,er,en,ei){if(!ea.isString(et))throw TypeError("name must be a string");if(!ea.isInteger(er))throw TypeError("id must be an integer");if(void 0!==this.values[et])throw Error("duplicate name '"+et+"' in "+this);if(this.isReservedId(er))throw Error("id "+er+" is reserved in "+this);if(this.isReservedName(et))throw Error("name '"+et+"' is reserved in "+this);if(void 0!==this.valuesById[er]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+er+" in "+this);this.values[et]=er}else this.valuesById[this.values[et]=er]=et;return ei&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[et]=ei||null),this.comments[et]=en||null,this},eo.prototype.remove=function(et){if(!ea.isString(et))throw TypeError("name must be a string");var er=this.values[et];if(null==er)throw Error("name '"+et+"' does not exist in "+this);return delete this.valuesById[er],delete this.values[et],delete this.comments[et],this.valuesOptions&&delete this.valuesOptions[et],this},eo.prototype.isReservedId=function(et){return es.isReservedId(this.reserved,et)},eo.prototype.isReservedName=function(et){return es.isReservedName(this.reserved,et)}},23980:(et,er,en)=>{"use strict";et.exports=eh;var ei,es=en(61862);((eh.prototype=Object.create(es.prototype)).constructor=eh).className="Field";var ea=en(59246),eo=en(91708),eu=en(66738),ec=/^required|optional|repeated$/;function eh(et,er,en,ei,ea,eh,ed){if(eu.isObject(ei)?(ed=ea,eh=ei,ei=ea=void 0):eu.isObject(ea)&&(ed=eh,eh=ea,ea=void 0),es.call(this,et,eh),!eu.isInteger(er)||er<0)throw TypeError("id must be a non-negative integer");if(!eu.isString(en))throw TypeError("type must be a string");if(void 0!==ei&&!ec.test(ei=ei.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==ea&&!eu.isString(ea))throw TypeError("extend must be a string");"proto3_optional"===ei&&(ei="optional"),this.rule=ei&&"optional"!==ei?ei:void 0,this.type=en,this.id=er,this.extend=ea||void 0,this.required="required"===ei,this.optional=!this.required,this.repeated="repeated"===ei,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!eu.Long&&void 0!==eo.long[en],this.bytes="bytes"===en,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=ed}eh.fromJSON=function(et,er){return new eh(et,er.id,er.type,er.rule,er.extend,er.options,er.comment)},Object.defineProperty(eh.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),eh.prototype.setOption=function(et,er,en){return"packed"===et&&(this._packed=null),es.prototype.setOption.call(this,et,er,en)},eh.prototype.toJSON=function(et){var er=!!et&&!!et.keepComments;return eu.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",er?this.comment:void 0])},eh.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=eo.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof ei?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof ea&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof ea)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=eu.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var et;eu.base64.test(this.typeDefault)?eu.base64.decode(this.typeDefault,et=eu.newBuffer(eu.base64.length(this.typeDefault)),0):eu.utf8.write(this.typeDefault,et=eu.newBuffer(eu.utf8.length(this.typeDefault)),0),this.typeDefault=et}return this.map?this.defaultValue=eu.emptyObject:this.repeated?this.defaultValue=eu.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof ei&&(this.parent.ctor.prototype[this.name]=this.defaultValue),es.prototype.resolve.call(this)},eh.d=function(et,er,en,ei){return"function"==typeof er?er=eu.decorateType(er).name:er&&"object"==typeof er&&(er=eu.decorateEnum(er).name),function(es,ea){eu.decorateType(es.constructor).add(new eh(ea,et,er,en,{default:ei}))}},eh._configure=function(et){ei=et}},62982:(et,er,en)=>{"use strict";var ei=et.exports=en(82985);function es(et,er,en){return"function"==typeof er?(en=er,er=new ei.Root):er||(er=new ei.Root),er.load(et,en)}function ea(et,er){return er||(er=new ei.Root),er.loadSync(et)}ei.build="light",ei.load=es,ei.loadSync=ea,ei.encoder=en(49561),ei.decoder=en(87317),ei.verifier=en(17585),ei.converter=en(84144),ei.ReflectionObject=en(61862),ei.Namespace=en(97540),ei.Root=en(98373),ei.Enum=en(59246),ei.Type=en(59340),ei.Field=en(23980),ei.OneOf=en(32866),ei.MapField=en(67597),ei.Service=en(82791),ei.Method=en(28909),ei.Message=en(34294),ei.wrappers=en(34038),ei.types=en(91708),ei.util=en(66738),ei.ReflectionObject._configure(ei.Root),ei.Namespace._configure(ei.Type,ei.Service,ei.Enum),ei.Root._configure(ei.Type),ei.Field._configure(ei.Type)},82985:(et,er,en)=>{"use strict";var ei=er;function es(){ei.util._configure(),ei.Writer._configure(ei.BufferWriter),ei.Reader._configure(ei.BufferReader)}ei.build="minimal",ei.Writer=en(84353),ei.BufferWriter=en(81978),ei.Reader=en(95199),ei.BufferReader=en(15213),ei.util=en(18932),ei.rpc=en(69226),ei.roots=en(10182),ei.configure=es,es()},23517:(et,er,en)=>{"use strict";var ei=et.exports=en(62982);ei.build="full",ei.tokenize=en(86116),ei.parse=en(87897),ei.common=en(79760),ei.Root._configure(ei.Type,ei.parse,ei.common)},67597:(et,er,en)=>{"use strict";et.exports=eo;var ei=en(23980);((eo.prototype=Object.create(ei.prototype)).constructor=eo).className="MapField";var es=en(91708),ea=en(66738);function eo(et,er,en,es,eo,eu){if(ei.call(this,et,er,es,void 0,void 0,eo,eu),!ea.isString(en))throw TypeError("keyType must be a string");this.keyType=en,this.resolvedKeyType=null,this.map=!0}eo.fromJSON=function(et,er){return new eo(et,er.id,er.keyType,er.type,er.options,er.comment)},eo.prototype.toJSON=function(et){var er=!!et&&!!et.keepComments;return ea.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",er?this.comment:void 0])},eo.prototype.resolve=function(){if(this.resolved)return this;if(void 0===es.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return ei.prototype.resolve.call(this)},eo.d=function(et,er,en){return"function"==typeof en?en=ea.decorateType(en).name:en&&"object"==typeof en&&(en=ea.decorateEnum(en).name),function(ei,es){ea.decorateType(ei.constructor).add(new eo(es,et,er,en))}}},34294:(et,er,en)=>{"use strict";et.exports=es;var ei=en(18932);function es(et){if(et)for(var er=Object.keys(et),en=0;en<er.length;++en)this[er[en]]=et[er[en]]}es.create=function(et){return this.$type.create(et)},es.encode=function(et,er){return this.$type.encode(et,er)},es.encodeDelimited=function(et,er){return this.$type.encodeDelimited(et,er)},es.decode=function(et){return this.$type.decode(et)},es.decodeDelimited=function(et){return this.$type.decodeDelimited(et)},es.verify=function(et){return this.$type.verify(et)},es.fromObject=function(et){return this.$type.fromObject(et)},es.toObject=function(et,er){return this.$type.toObject(et,er)},es.prototype.toJSON=function(){return this.$type.toObject(this,ei.toJSONOptions)}},28909:(et,er,en)=>{"use strict";et.exports=ea;var ei=en(61862);((ea.prototype=Object.create(ei.prototype)).constructor=ea).className="Method";var es=en(66738);function ea(et,er,en,ea,eo,eu,ec,eh,ed){if(es.isObject(eo)?(ec=eo,eo=eu=void 0):es.isObject(eu)&&(ec=eu,eu=void 0),!(void 0===er||es.isString(er)))throw TypeError("type must be a string");if(!es.isString(en))throw TypeError("requestType must be a string");if(!es.isString(ea))throw TypeError("responseType must be a string");ei.call(this,et,ec),this.type=er||"rpc",this.requestType=en,this.requestStream=!!eo||void 0,this.responseType=ea,this.responseStream=!!eu||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=eh,this.parsedOptions=ed}ea.fromJSON=function(et,er){return new ea(et,er.type,er.requestType,er.responseType,er.requestStream,er.responseStream,er.options,er.comment,er.parsedOptions)},ea.prototype.toJSON=function(et){var er=!!et&&!!et.keepComments;return es.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",er?this.comment:void 0,"parsedOptions",this.parsedOptions])},ea.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),ei.prototype.resolve.call(this))}},97540:(et,er,en)=>{"use strict";et.exports=ep;var ei,es,ea,eo=en(61862);((ep.prototype=Object.create(eo.prototype)).constructor=ep).className="Namespace";var eu=en(23980),ec=en(66738),eh=en(32866);function ed(et,er){if(et&&et.length){for(var en={},ei=0;ei<et.length;++ei)en[et[ei].name]=et[ei].toJSON(er);return en}}function ep(et,er){eo.call(this,et,er),this.nested=void 0,this._nestedArray=null}function ef(et){return et._nestedArray=null,et}ep.fromJSON=function(et,er){return new ep(et,er.options).addJSON(er.nested)},ep.arrayToJSON=ed,ep.isReservedId=function(et,er){if(et){for(var en=0;en<et.length;++en)if("string"!=typeof et[en]&&et[en][0]<=er&&et[en][1]>er)return!0}return!1},ep.isReservedName=function(et,er){if(et){for(var en=0;en<et.length;++en)if(et[en]===er)return!0}return!1},Object.defineProperty(ep.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=ec.toArray(this.nested))}}),ep.prototype.toJSON=function(et){return ec.toObject(["options",this.options,"nested",ed(this.nestedArray,et)])},ep.prototype.addJSON=function(et){var er=this;if(et)for(var en,eo=Object.keys(et),ec=0;ec<eo.length;++ec)en=et[eo[ec]],er.add((void 0!==en.fields?ei.fromJSON:void 0!==en.values?ea.fromJSON:void 0!==en.methods?es.fromJSON:void 0!==en.id?eu.fromJSON:ep.fromJSON)(eo[ec],en));return this},ep.prototype.get=function(et){return this.nested&&this.nested[et]||null},ep.prototype.getEnum=function(et){if(this.nested&&this.nested[et]instanceof ea)return this.nested[et].values;throw Error("no such enum: "+et)},ep.prototype.add=function(et){if(!(et instanceof eu&&void 0!==et.extend||et instanceof ei||et instanceof eh||et instanceof ea||et instanceof es||et instanceof ep))throw TypeError("object must be a valid nested object");if(this.nested){var er=this.get(et.name);if(er){if(er instanceof ep&&et instanceof ep&&!(er instanceof ei||er instanceof es)){for(var en=er.nestedArray,eo=0;eo<en.length;++eo)et.add(en[eo]);this.remove(er),this.nested||(this.nested={}),et.setOptions(er.options,!0)}else throw Error("duplicate name '"+et.name+"' in "+this)}}else this.nested={};return this.nested[et.name]=et,et.onAdd(this),ef(this)},ep.prototype.remove=function(et){if(!(et instanceof eo))throw TypeError("object must be a ReflectionObject");if(et.parent!==this)throw Error(et+" is not a member of "+this);return delete this.nested[et.name],Object.keys(this.nested).length||(this.nested=void 0),et.onRemove(this),ef(this)},ep.prototype.define=function(et,er){if(ec.isString(et))et=et.split(".");else if(!Array.isArray(et))throw TypeError("illegal path");if(et&&et.length&&""===et[0])throw Error("path must be relative");for(var en=this;et.length>0;){var ei=et.shift();if(en.nested&&en.nested[ei]){if(!((en=en.nested[ei])instanceof ep))throw Error("path conflicts with non-namespace objects")}else en.add(en=new ep(ei))}return er&&en.addJSON(er),en},ep.prototype.resolveAll=function(){for(var et=this.nestedArray,er=0;er<et.length;)et[er]instanceof ep?et[er++].resolveAll():et[er++].resolve();return this.resolve()},ep.prototype.lookup=function(et,er,en){if("boolean"==typeof er?(en=er,er=void 0):er&&!Array.isArray(er)&&(er=[er]),ec.isString(et)&&et.length){if("."===et)return this.root;et=et.split(".")}else if(!et.length)return this;if(""===et[0])return this.root.lookup(et.slice(1),er);var ei=this.get(et[0]);if(ei){if(1===et.length){if(!er||er.indexOf(ei.constructor)>-1)return ei}else if(ei instanceof ep&&(ei=ei.lookup(et.slice(1),er,!0)))return ei}else for(var es=0;es<this.nestedArray.length;++es)if(this._nestedArray[es]instanceof ep&&(ei=this._nestedArray[es].lookup(et,er,!0)))return ei;return null===this.parent||en?null:this.parent.lookup(et,er)},ep.prototype.lookupType=function(et){var er=this.lookup(et,[ei]);if(!er)throw Error("no such type: "+et);return er},ep.prototype.lookupEnum=function(et){var er=this.lookup(et,[ea]);if(!er)throw Error("no such Enum '"+et+"' in "+this);return er},ep.prototype.lookupTypeOrEnum=function(et){var er=this.lookup(et,[ei,ea]);if(!er)throw Error("no such Type or Enum '"+et+"' in "+this);return er},ep.prototype.lookupService=function(et){var er=this.lookup(et,[es]);if(!er)throw Error("no such Service '"+et+"' in "+this);return er},ep._configure=function(et,er,en){ei=et,es=er,ea=en}},61862:(et,er,en)=>{"use strict";et.exports=ea,ea.className="ReflectionObject";var ei,es=en(66738);function ea(et,er){if(!es.isString(et))throw TypeError("name must be a string");if(er&&!es.isObject(er))throw TypeError("options must be an object");this.options=er,this.parsedOptions=null,this.name=et,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(ea.prototype,{root:{get:function(){for(var et=this;null!==et.parent;)et=et.parent;return et}},fullName:{get:function(){for(var et=[this.name],er=this.parent;er;)et.unshift(er.name),er=er.parent;return et.join(".")}}}),ea.prototype.toJSON=function(){throw Error()},ea.prototype.onAdd=function(et){this.parent&&this.parent!==et&&this.parent.remove(this),this.parent=et,this.resolved=!1;var er=et.root;er instanceof ei&&er._handleAdd(this)},ea.prototype.onRemove=function(et){var er=et.root;er instanceof ei&&er._handleRemove(this),this.parent=null,this.resolved=!1},ea.prototype.resolve=function(){return this.resolved||this.root instanceof ei&&(this.resolved=!0),this},ea.prototype.getOption=function(et){if(this.options)return this.options[et]},ea.prototype.setOption=function(et,er,en){return en&&this.options&&void 0!==this.options[et]||((this.options||(this.options={}))[et]=er),this},ea.prototype.setParsedOption=function(et,er,en){this.parsedOptions||(this.parsedOptions=[]);var ei=this.parsedOptions;if(en){var ea=ei.find(function(er){return Object.prototype.hasOwnProperty.call(er,et)});if(ea){var eo=ea[et];es.setProperty(eo,en,er)}else(ea={})[et]=es.setProperty({},en,er),ei.push(ea)}else{var eu={};eu[et]=er,ei.push(eu)}return this},ea.prototype.setOptions=function(et,er){if(et)for(var en=Object.keys(et),ei=0;ei<en.length;++ei)this.setOption(en[ei],et[en[ei]],er);return this},ea.prototype.toString=function(){var et=this.constructor.className,er=this.fullName;return er.length?et+" "+er:et},ea._configure=function(et){ei=et}},32866:(et,er,en)=>{"use strict";et.exports=eo;var ei=en(61862);((eo.prototype=Object.create(ei.prototype)).constructor=eo).className="OneOf";var es=en(23980),ea=en(66738);function eo(et,er,en,es){if(Array.isArray(er)||(en=er,er=void 0),ei.call(this,et,en),!(void 0===er||Array.isArray(er)))throw TypeError("fieldNames must be an Array");this.oneof=er||[],this.fieldsArray=[],this.comment=es}function eu(et){if(et.parent)for(var er=0;er<et.fieldsArray.length;++er)et.fieldsArray[er].parent||et.parent.add(et.fieldsArray[er])}eo.fromJSON=function(et,er){return new eo(et,er.oneof,er.options,er.comment)},eo.prototype.toJSON=function(et){var er=!!et&&!!et.keepComments;return ea.toObject(["options",this.options,"oneof",this.oneof,"comment",er?this.comment:void 0])},eo.prototype.add=function(et){if(!(et instanceof es))throw TypeError("field must be a Field");return et.parent&&et.parent!==this.parent&&et.parent.remove(et),this.oneof.push(et.name),this.fieldsArray.push(et),et.partOf=this,eu(this),this},eo.prototype.remove=function(et){if(!(et instanceof es))throw TypeError("field must be a Field");var er=this.fieldsArray.indexOf(et);if(er<0)throw Error(et+" is not a member of "+this);return this.fieldsArray.splice(er,1),(er=this.oneof.indexOf(et.name))>-1&&this.oneof.splice(er,1),et.partOf=null,this},eo.prototype.onAdd=function(et){ei.prototype.onAdd.call(this,et);for(var er=this,en=0;en<this.oneof.length;++en){var es=et.get(this.oneof[en]);es&&!es.partOf&&(es.partOf=er,er.fieldsArray.push(es))}eu(this)},eo.prototype.onRemove=function(et){for(var er,en=0;en<this.fieldsArray.length;++en)(er=this.fieldsArray[en]).parent&&er.parent.remove(er);ei.prototype.onRemove.call(this,et)},eo.d=function(){for(var et=Array(arguments.length),er=0;er<arguments.length;)et[er]=arguments[er++];return function(er,en){ea.decorateType(er.constructor).add(new eo(en,et)),Object.defineProperty(er,en,{get:ea.oneOfGetter(et),set:ea.oneOfSetter(et)})}}},87897:(et,er,en)=>{"use strict";et.exports=eI,eI.filename=null,eI.defaults={keepCase:!1};var ei=en(86116),es=en(98373),ea=en(59340),eo=en(23980),eu=en(67597),ec=en(32866),eh=en(59246),ed=en(82791),ep=en(28909),ef=en(91708),em=en(66738),eg=/^[1-9][0-9]*$/,ey=/^-?[1-9][0-9]*$/,ev=/^0[x][0-9a-fA-F]+$/,eb=/^-?0[x][0-9a-fA-F]+$/,eS=/^0[0-7]+$/,eT=/^-?0[0-7]+$/,ew=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,eE=/^[a-zA-Z_][a-zA-Z_0-9]*$/,eC=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,e_=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function eI(et,er,en){er instanceof es||(en=er,er=new es),en||(en=eI.defaults);var ek,ex,eA,eR,eD,eO=en.preferTrailingComment||!1,eN=ei(et,en.alternateCommentMode||!1),eM=eN.next,eP=eN.push,eL=eN.peek,eF=eN.skip,eB=eN.cmnt,ej=!0,eU=!1,eV=er,ez=en.keepCase?function(et){return et}:em.camelCase;function e$(et,er,en){var ei=eI.filename;return en||(eI.filename=null),Error("illegal "+(er||"token")+" '"+et+"' ("+(ei?ei+", ":"")+"line "+eN.line+")")}function eG(){var et,er=[];do{if('"'!==(et=eM())&&"'"!==et)throw e$(et);er.push(eM()),eF(et),et=eL()}while('"'===et||"'"===et);return er.join("")}function eK(et){var er=eM();switch(er){case"'":case'"':return eP(er),eG();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return eW(er,!0)}catch(en){if(et&&eC.test(er))return er;throw e$(er,"value")}}function eH(et,er){do er&&('"'===(en=eL())||"'"===en)?et.push(eG()):et.push([ei=eQ(eM()),eF("to",!0)?eQ(eM()):ei]);while(eF(",",!0));var en,ei,es={options:void 0};es.setOption=function(et,er){void 0===this.options&&(this.options={}),this.options[et]=er},e0(es,function(et){if("option"===et)e8(es,et),eF(";");else throw e$(et)},function(){ti(es)})}function eW(et,er){var en=1;switch("-"===et.charAt(0)&&(en=-1,et=et.substring(1)),et){case"inf":case"INF":case"Inf":return en*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(eg.test(et))return en*parseInt(et,10);if(ev.test(et))return en*parseInt(et,16);if(eS.test(et))return en*parseInt(et,8);if(ew.test(et))return en*parseFloat(et);throw e$(et,"number",er)}function eQ(et,er){switch(et){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!er&&"-"===et.charAt(0))throw e$(et,"id");if(ey.test(et))return parseInt(et,10);if(eb.test(et))return parseInt(et,16);if(eT.test(et))return parseInt(et,8);throw e$(et,"id")}function eY(){if(void 0!==ex)throw e$("package");if(ex=eM(),!eC.test(ex))throw e$(ex,"name");eV=eV.define(ex),eF(";")}function eJ(){var et,er=eL();switch(er){case"weak":et=eR||(eR=[]),eM();break;case"public":eM();default:et=eA||(eA=[])}er=eG(),eF(";"),et.push(er)}function eX(){if(eF("="),!(eU="proto3"===(eD=eG()))&&"proto2"!==eD)throw e$(eD,"syntax");er.setOption("syntax",eD),eF(";")}function eZ(et,er){switch(er){case"option":return e8(et,er),eF(";"),!0;case"message":return e1(et,er),!0;case"enum":return e4(et,er),!0;case"service":return ts(et,er),!0;case"extend":return tl(et,er),!0}return!1}function e0(et,er,en){var ei,es=eN.line;if(et&&("string"!=typeof et.comment&&(et.comment=eB()),et.filename=eI.filename),eF("{",!0)){for(;"}"!==(ei=eM());)er(ei);eF(";",!0)}else en&&en(),eF(";"),et&&("string"!=typeof et.comment||eO)&&(et.comment=eB(es)||et.comment)}function e1(et,er){if(!eE.test(er=eM()))throw e$(er,"type name");var en=new ea(er);e0(en,function(et){if(!eZ(en,et))switch(et){case"map":e6(en,et);break;case"required":case"repeated":e2(en,et);break;case"optional":eU?e2(en,"proto3_optional"):e2(en,"optional");break;case"oneof":e9(en,et);break;case"extensions":eH(en.extensions||(en.extensions=[]));break;case"reserved":eH(en.reserved||(en.reserved=[]),!0);break;default:if(!eU||!eC.test(et))throw e$(et);eP(et),e2(en,"optional")}}),et.add(en)}function e2(et,er,en){var ei=eM();if("group"===ei){e3(et,er);return}for(;ei.endsWith(".")||eL().startsWith(".");)ei+=eM();if(!eC.test(ei))throw e$(ei,"type");var es=eM();if(!eE.test(es))throw e$(es,"name");es=ez(es),eF("=");var ea=new eo(es,eQ(eM()),ei,er,en);if(e0(ea,function(et){if("option"===et)e8(ea,et),eF(";");else throw e$(et)},function(){ti(ea)}),"proto3_optional"===er){var eu=new ec("_"+es);ea.setOption("proto3_optional",!0),eu.add(ea),et.add(eu)}else et.add(ea);!eU&&ea.repeated&&(void 0!==ef.packed[ei]||void 0===ef.basic[ei])&&ea.setOption("packed",!1,!0)}function e3(et,er){var en=eM();if(!eE.test(en))throw e$(en,"name");var ei=em.lcFirst(en);en===ei&&(en=em.ucFirst(en)),eF("=");var es=eQ(eM()),eu=new ea(en);eu.group=!0;var ec=new eo(ei,es,en,er);ec.filename=eI.filename,e0(eu,function(et){switch(et){case"option":e8(eu,et),eF(";");break;case"required":case"repeated":e2(eu,et);break;case"optional":eU?e2(eu,"proto3_optional"):e2(eu,"optional");break;case"message":e1(eu,et);break;case"enum":e4(eu,et);break;default:throw e$(et)}}),et.add(eu).add(ec)}function e6(et){eF("<");var er=eM();if(void 0===ef.mapKey[er])throw e$(er,"type");eF(",");var en=eM();if(!eC.test(en))throw e$(en,"type");eF(">");var ei=eM();if(!eE.test(ei))throw e$(ei,"name");eF("=");var es=new eu(ez(ei),eQ(eM()),er,en);e0(es,function(et){if("option"===et)e8(es,et),eF(";");else throw e$(et)},function(){ti(es)}),et.add(es)}function e9(et,er){if(!eE.test(er=eM()))throw e$(er,"name");var en=new ec(ez(er));e0(en,function(et){"option"===et?(e8(en,et),eF(";")):(eP(et),e2(en,"optional"))}),et.add(en)}function e4(et,er){if(!eE.test(er=eM()))throw e$(er,"name");var en=new eh(er);e0(en,function(et){switch(et){case"option":e8(en,et),eF(";");break;case"reserved":eH(en.reserved||(en.reserved=[]),!0);break;default:e5(en,et)}}),et.add(en)}function e5(et,er){if(!eE.test(er))throw e$(er,"name");eF("=");var en=eQ(eM(),!0),ei={options:void 0};ei.setOption=function(et,er){void 0===this.options&&(this.options={}),this.options[et]=er},e0(ei,function(et){if("option"===et)e8(ei,et),eF(";");else throw e$(et)},function(){ti(ei)}),et.add(er,en,ei.comment,ei.options)}function e8(et,er){var en,ei=eF("(",!0);if(!eC.test(er=eM()))throw e$(er,"name");var es=er,ea=es;ei&&(eF(")"),ea=es="("+es+")",er=eL(),e_.test(er)&&(en=er.slice(1),es+=er,eM())),eF("=");var eo=e7(et,es);tr(et,ea,eo,en)}function e7(et,er){if(eF("{",!0)){for(var en={};!eF("}",!0);){if(!eE.test(ek=eM()))throw e$(ek,"name");if(null===ek)throw e$(ek,"end of input");var ei,es,ea=ek;if(eF(":",!0),"{"===eL())ei=e7(et,er+"."+ek);else if("["===eL()){if(ei=[],eF("[",!0)){do es=eK(!0),ei.push(es);while(eF(",",!0));eF("]"),void 0!==es&&tt(et,er+"."+ek,es)}}else ei=eK(!0),tt(et,er+"."+ek,ei);var eo=en[ea];eo&&(ei=[].concat(eo).concat(ei)),en[ea]=ei,eF(",",!0),eF(";",!0)}return en}var eu=eK(!0);return tt(et,er,eu),eu}function tt(et,er,en){et.setOption&&et.setOption(er,en)}function tr(et,er,en,ei){et.setParsedOption&&et.setParsedOption(er,en,ei)}function ti(et){if(eF("[",!0)){do e8(et,"option");while(eF(",",!0));eF("]")}return et}function ts(et,er){if(!eE.test(er=eM()))throw e$(er,"service name");var en=new ed(er);e0(en,function(et){if(!eZ(en,et)){if("rpc"===et)ta(en,et);else throw e$(et)}}),et.add(en)}function ta(et,er){var en=eB(),ei=er;if(!eE.test(er=eM()))throw e$(er,"name");var es,ea,eo,eu,ec=er;if(eF("("),eF("stream",!0)&&(ea=!0),!eC.test(er=eM())||(es=er,eF(")"),eF("returns"),eF("("),eF("stream",!0)&&(eu=!0),!eC.test(er=eM())))throw e$(er);eo=er,eF(")");var eh=new ep(ec,ei,es,eo,ea,eu);eh.comment=en,e0(eh,function(et){if("option"===et)e8(eh,et),eF(";");else throw e$(et)}),et.add(eh)}function tl(et,er){if(!eC.test(er=eM()))throw e$(er,"reference");var en=er;e0(null,function(er){switch(er){case"required":case"repeated":e2(et,er,en);break;case"optional":eU?e2(et,"proto3_optional",en):e2(et,"optional",en);break;default:if(!eU||!eC.test(er))throw e$(er);eP(er),e2(et,"optional",en)}})}for(;null!==(ek=eM());)switch(ek){case"package":if(!ej)throw e$(ek);eY();break;case"import":if(!ej)throw e$(ek);eJ();break;case"syntax":if(!ej)throw e$(ek);eX();break;case"option":e8(eV,ek),eF(";");break;default:if(eZ(eV,ek)){ej=!1;continue}throw e$(ek)}return eI.filename=null,{package:ex,imports:eA,weakImports:eR,syntax:eD,root:er}}},95199:(et,er,en)=>{"use strict";et.exports=ec;var ei,es=en(18932),ea=es.LongBits,eo=es.utf8;function eu(et,er){return RangeError("index out of range: "+et.pos+" + "+(er||1)+" > "+et.len)}function ec(et){this.buf=et,this.pos=0,this.len=et.length}var eh="undefined"!=typeof Uint8Array?function(et){if(et instanceof Uint8Array||Array.isArray(et))return new ec(et);throw Error("illegal buffer")}:function(et){if(Array.isArray(et))return new ec(et);throw Error("illegal buffer")},ed=function(){return es.Buffer?function(et){return(ec.create=function(et){return es.Buffer.isBuffer(et)?new ei(et):eh(et)})(et)}:eh};function ep(){var et=new ea(0,0),er=0;if(this.len-this.pos>4){for(;er<4;++er)if(et.lo=(et.lo|(127&this.buf[this.pos])<<7*er)>>>0,this.buf[this.pos++]<128)return et;if(et.lo=(et.lo|(127&this.buf[this.pos])<<28)>>>0,et.hi=(et.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return et;er=0}else{for(;er<3;++er){if(this.pos>=this.len)throw eu(this);if(et.lo=(et.lo|(127&this.buf[this.pos])<<7*er)>>>0,this.buf[this.pos++]<128)return et}return et.lo=(et.lo|(127&this.buf[this.pos++])<<7*er)>>>0,et}if(this.len-this.pos>4){for(;er<5;++er)if(et.hi=(et.hi|(127&this.buf[this.pos])<<7*er+3)>>>0,this.buf[this.pos++]<128)return et}else for(;er<5;++er){if(this.pos>=this.len)throw eu(this);if(et.hi=(et.hi|(127&this.buf[this.pos])<<7*er+3)>>>0,this.buf[this.pos++]<128)return et}throw Error("invalid varint encoding")}function ef(et,er){return(et[er-4]|et[er-3]<<8|et[er-2]<<16|et[er-1]<<24)>>>0}function em(){if(this.pos+8>this.len)throw eu(this,8);return new ea(ef(this.buf,this.pos+=4),ef(this.buf,this.pos+=4))}ec.create=ed(),ec.prototype._slice=es.Array.prototype.subarray||es.Array.prototype.slice,ec.prototype.uint32=function(){var et=4294967295;return function(){if(et=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(et=(et|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(et=(et|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(et=(et|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(et=(et|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return et;if((this.pos+=5)>this.len)throw this.pos=this.len,eu(this,10);return et}}(),ec.prototype.int32=function(){return 0|this.uint32()},ec.prototype.sint32=function(){var et=this.uint32();return et>>>1^-(1&et)|0},ec.prototype.bool=function(){return 0!==this.uint32()},ec.prototype.fixed32=function(){if(this.pos+4>this.len)throw eu(this,4);return ef(this.buf,this.pos+=4)},ec.prototype.sfixed32=function(){if(this.pos+4>this.len)throw eu(this,4);return 0|ef(this.buf,this.pos+=4)},ec.prototype.float=function(){if(this.pos+4>this.len)throw eu(this,4);var et=es.float.readFloatLE(this.buf,this.pos);return this.pos+=4,et},ec.prototype.double=function(){if(this.pos+8>this.len)throw eu(this,4);var et=es.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,et},ec.prototype.bytes=function(){var et=this.uint32(),er=this.pos,en=this.pos+et;if(en>this.len)throw eu(this,et);if(this.pos+=et,Array.isArray(this.buf))return this.buf.slice(er,en);if(er===en){var ei=es.Buffer;return ei?ei.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,er,en)},ec.prototype.string=function(){var et=this.bytes();return eo.read(et,0,et.length)},ec.prototype.skip=function(et){if("number"==typeof et){if(this.pos+et>this.len)throw eu(this,et);this.pos+=et}else do if(this.pos>=this.len)throw eu(this);while(128&this.buf[this.pos++]);return this},ec.prototype.skipType=function(et){switch(et){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(et=7&this.uint32());)this.skipType(et);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+et+" at offset "+this.pos)}return this},ec._configure=function(et){ei=et,ec.create=ed(),ei._configure();var er=es.Long?"toLong":"toNumber";es.merge(ec.prototype,{int64:function(){return ep.call(this)[er](!1)},uint64:function(){return ep.call(this)[er](!0)},sint64:function(){return ep.call(this).zzDecode()[er](!1)},fixed64:function(){return em.call(this)[er](!0)},sfixed64:function(){return em.call(this)[er](!1)}})}},15213:(et,er,en)=>{"use strict";et.exports=ea;var ei=en(95199);(ea.prototype=Object.create(ei.prototype)).constructor=ea;var es=en(18932);function ea(et){ei.call(this,et)}ea._configure=function(){es.Buffer&&(ea.prototype._slice=es.Buffer.prototype.slice)},ea.prototype.string=function(){var et=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+et,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+et,this.len))},ea._configure()},98373:(et,er,en)=>{"use strict";et.exports=ep;var ei,es,ea,eo=en(97540);((ep.prototype=Object.create(eo.prototype)).constructor=ep).className="Root";var eu=en(23980),ec=en(59246),eh=en(32866),ed=en(66738);function ep(et){eo.call(this,"",et),this.deferred=[],this.files=[]}function ef(){}ep.fromJSON=function(et,er){return er||(er=new ep),et.options&&er.setOptions(et.options),er.addJSON(et.nested)},ep.prototype.resolvePath=ed.path.resolve,ep.prototype.fetch=ed.fetch,ep.prototype.load=function et(er,en,ei){"function"==typeof en&&(ei=en,en=void 0);var eo=this;if(!ei)return ed.asPromise(et,eo,er,en);var eu=ei===ef;function ec(et,er){if(ei){if(eu)throw et;var en=ei;ei=null,en(et,er)}}function eh(et){var er=et.lastIndexOf("google/protobuf/");if(er>-1){var en=et.substring(er);if(en in ea)return en}return null}function ep(et,er){try{if(ed.isString(er)&&"{"===er.charAt(0)&&(er=JSON.parse(er)),ed.isString(er)){es.filename=et;var ei,ea=es(er,eo,en),ep=0;if(ea.imports)for(;ep<ea.imports.length;++ep)(ei=eh(ea.imports[ep])||eo.resolvePath(et,ea.imports[ep]))&&em(ei);if(ea.weakImports)for(ep=0;ep<ea.weakImports.length;++ep)(ei=eh(ea.weakImports[ep])||eo.resolvePath(et,ea.weakImports[ep]))&&em(ei,!0)}else eo.setOptions(er.options).addJSON(er.nested)}catch(et){ec(et)}eu||eg||ec(null,eo)}function em(et,er){if(et=eh(et)||et,!(eo.files.indexOf(et)>-1)){if(eo.files.push(et),et in ea){eu?ep(et,ea[et]):(++eg,setTimeout(function(){--eg,ep(et,ea[et])}));return}if(eu){var en;try{en=ed.fs.readFileSync(et).toString("utf8")}catch(et){er||ec(et);return}ep(et,en)}else++eg,eo.fetch(et,function(en,es){if(--eg,ei){if(en){er?eg||ec(null,eo):ec(en);return}ep(et,es)}})}}var eg=0;ed.isString(er)&&(er=[er]);for(var ey,ev=0;ev<er.length;++ev)(ey=eo.resolvePath("",er[ev]))&&em(ey);if(eu)return eo;eg||ec(null,eo)},ep.prototype.loadSync=function(et,er){if(!ed.isNode)throw Error("not supported");return this.load(et,er,ef)},ep.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(et){return"'extend "+et.extend+"' in "+et.parent.fullName}).join(", "));return eo.prototype.resolveAll.call(this)};var em=/^[A-Z]/;function eg(et,er){var en=er.parent.lookup(er.extend);if(en){var ei=new eu(er.fullName,er.id,er.type,er.rule,void 0,er.options);return!!en.get(ei.name)||(ei.declaringField=er,er.extensionField=ei,en.add(ei),!0)}return!1}ep.prototype._handleAdd=function(et){if(et instanceof eu)void 0===et.extend||et.extensionField||eg(this,et)||this.deferred.push(et);else if(et instanceof ec)em.test(et.name)&&(et.parent[et.name]=et.values);else if(!(et instanceof eh)){if(et instanceof ei)for(var er=0;er<this.deferred.length;)eg(this,this.deferred[er])?this.deferred.splice(er,1):++er;for(var en=0;en<et.nestedArray.length;++en)this._handleAdd(et._nestedArray[en]);em.test(et.name)&&(et.parent[et.name]=et)}},ep.prototype._handleRemove=function(et){if(et instanceof eu){if(void 0!==et.extend){if(et.extensionField)et.extensionField.parent.remove(et.extensionField),et.extensionField=null;else{var er=this.deferred.indexOf(et);er>-1&&this.deferred.splice(er,1)}}}else if(et instanceof ec)em.test(et.name)&&delete et.parent[et.name];else if(et instanceof eo){for(var en=0;en<et.nestedArray.length;++en)this._handleRemove(et._nestedArray[en]);em.test(et.name)&&delete et.parent[et.name]}},ep._configure=function(et,er,en){ei=et,es=er,ea=en}},10182:et=>{"use strict";et.exports={}},69226:(et,er,en)=>{"use strict";er.Service=en(12741)},12741:(et,er,en)=>{"use strict";et.exports=es;var ei=en(18932);function es(et,er,en){if("function"!=typeof et)throw TypeError("rpcImpl must be a function");ei.EventEmitter.call(this),this.rpcImpl=et,this.requestDelimited=!!er,this.responseDelimited=!!en}(es.prototype=Object.create(ei.EventEmitter.prototype)).constructor=es,es.prototype.rpcCall=function et(er,en,es,ea,eo){if(!ea)throw TypeError("request must be specified");var eu=this;if(!eo)return ei.asPromise(et,eu,er,en,es,ea);if(!eu.rpcImpl){setTimeout(function(){eo(Error("already ended"))},0);return}try{return eu.rpcImpl(er,en[eu.requestDelimited?"encodeDelimited":"encode"](ea).finish(),function(et,en){if(et)return eu.emit("error",et,er),eo(et);if(null===en){eu.end(!0);return}if(!(en instanceof es))try{en=es[eu.responseDelimited?"decodeDelimited":"decode"](en)}catch(et){return eu.emit("error",et,er),eo(et)}return eu.emit("data",en,er),eo(null,en)})}catch(et){eu.emit("error",et,er),setTimeout(function(){eo(et)},0);return}},es.prototype.end=function(et){return this.rpcImpl&&(et||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},82791:(et,er,en)=>{"use strict";et.exports=eu;var ei=en(97540);((eu.prototype=Object.create(ei.prototype)).constructor=eu).className="Service";var es=en(28909),ea=en(66738),eo=en(69226);function eu(et,er){ei.call(this,et,er),this.methods={},this._methodsArray=null}function ec(et){return et._methodsArray=null,et}eu.fromJSON=function(et,er){var en=new eu(et,er.options);if(er.methods)for(var ei=Object.keys(er.methods),ea=0;ea<ei.length;++ea)en.add(es.fromJSON(ei[ea],er.methods[ei[ea]]));return er.nested&&en.addJSON(er.nested),en.comment=er.comment,en},eu.prototype.toJSON=function(et){var er=ei.prototype.toJSON.call(this,et),en=!!et&&!!et.keepComments;return ea.toObject(["options",er&&er.options||void 0,"methods",ei.arrayToJSON(this.methodsArray,et)||{},"nested",er&&er.nested||void 0,"comment",en?this.comment:void 0])},Object.defineProperty(eu.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=ea.toArray(this.methods))}}),eu.prototype.get=function(et){return this.methods[et]||ei.prototype.get.call(this,et)},eu.prototype.resolveAll=function(){for(var et=this.methodsArray,er=0;er<et.length;++er)et[er].resolve();return ei.prototype.resolve.call(this)},eu.prototype.add=function(et){if(this.get(et.name))throw Error("duplicate name '"+et.name+"' in "+this);return et instanceof es?(this.methods[et.name]=et,et.parent=this,ec(this)):ei.prototype.add.call(this,et)},eu.prototype.remove=function(et){if(et instanceof es){if(this.methods[et.name]!==et)throw Error(et+" is not a member of "+this);return delete this.methods[et.name],et.parent=null,ec(this)}return ei.prototype.remove.call(this,et)},eu.prototype.create=function(et,er,en){for(var ei,es=new eo.Service(et,er,en),eu=0;eu<this.methodsArray.length;++eu){var ec=ea.lcFirst((ei=this._methodsArray[eu]).resolve().name).replace(/[^$\w_]/g,"");es[ec]=ea.codegen(["r","c"],ea.isReserved(ec)?ec+"_":ec)("return this.rpcCall(m,q,s,r,c)")({m:ei,q:ei.resolvedRequestType.ctor,s:ei.resolvedResponseType.ctor})}return es}},86116:et=>{"use strict";et.exports=ep;var er=/[\s{}=;:[\],'"()<>]/g,en=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,ei=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,es=/^ *[*/]+ */,ea=/^\s*\*?\/*/,eo=/\n/g,eu=/\s/,ec=/\\(.?)/g,eh={0:"\x00",r:"\r",n:"\n",t:"	"};function ed(et){return et.replace(ec,function(et,er){switch(er){case"\\":case"":return er;default:return eh[er]||""}})}function ep(et,ec){et=et.toString();var eh=0,ep=et.length,ef=1,em=0,eg={},ey=[],ev=null;function eb(et){return Error("illegal "+et+" (line "+ef+")")}function eS(){var er="'"===ev?ei:en;er.lastIndex=eh-1;var es=er.exec(et);if(!es)throw eb("string");return eh=er.lastIndex,eI(ev),ev=null,ed(es[1])}function eT(er){return et.charAt(er)}function ew(er,en,ei){var eu,eh,ed={type:et.charAt(er++),lineEmpty:!1,leading:ei},ep=er-(eu=ec?2:3);do if(--ep<0||"\n"===(eh=et.charAt(ep))){ed.lineEmpty=!0;break}while(" "===eh||"	"===eh);for(var ey=et.substring(er,en).split(eo),ev=0;ev<ey.length;++ev)ey[ev]=ey[ev].replace(ec?ea:es,"").trim();ed.text=ey.join("\n").trim(),eg[ef]=ed,em=ef}function eE(er){var en=eC(er),ei=et.substring(er,en);return/^\s*\/\//.test(ei)}function eC(et){for(var er=et;er<ep&&"\n"!==eT(er);)er++;return er}function e_(){if(ey.length>0)return ey.shift();if(ev)return eS();var en,ei,es,ea,eo,ed=0===eh;do{if(eh===ep)return null;for(en=!1;eu.test(es=eT(eh));)if("\n"===es&&(ed=!0,++ef),++eh===ep)return null;if("/"===eT(eh)){if(++eh===ep)throw eb("comment");if("/"===eT(eh)){if(ec){if(ea=eh,eo=!1,eE(eh-1)){eo=!0;do if((eh=eC(eh))===ep||(eh++,!ed))break;while(eE(eh))}else eh=Math.min(ep,eC(eh)+1);eo&&(ew(ea,eh,ed),ed=!0),ef++,en=!0}else{for(eo="/"===eT(ea=eh+1);"\n"!==eT(++eh);)if(eh===ep)return null;++eh,eo&&(ew(ea,eh-1,ed),ed=!0),++ef,en=!0}}else{if("*"!==(es=eT(eh)))return"/";ea=eh+1,eo=ec||"*"===eT(ea);do{if("\n"===es&&++ef,++eh===ep)throw eb("comment");ei=es,es=eT(eh)}while("*"!==ei||"/"!==es);++eh,eo&&(ew(ea,eh-2,ed),ed=!0),en=!0}}}while(en);var em=eh;if(er.lastIndex=0,!er.test(eT(em++)))for(;em<ep&&!er.test(eT(em));)++em;var eg=et.substring(eh,eh=em);return('"'===eg||"'"===eg)&&(ev=eg),eg}function eI(et){ey.push(et)}function ek(){if(!ey.length){var et=e_();if(null===et)return null;eI(et)}return ey[0]}function ex(et,er){var en=ek();if(en===et)return e_(),!0;if(!er)throw eb("token '"+en+"', '"+et+"' expected");return!1}function eA(et){var er,en=null;return void 0===et?(er=eg[ef-1],delete eg[ef-1],er&&(ec||"*"===er.type||er.lineEmpty)&&(en=er.leading?er.text:null)):(em<et&&ek(),er=eg[et],delete eg[et],er&&!er.lineEmpty&&(ec||"/"===er.type)&&(en=er.leading?null:er.text)),en}return Object.defineProperty({next:e_,peek:ek,push:eI,skip:ex,cmnt:eA},"line",{get:function(){return ef}})}ep.unescape=ed},59340:(et,er,en)=>{"use strict";et.exports=eS;var ei=en(97540);((eS.prototype=Object.create(ei.prototype)).constructor=eS).className="Type";var es=en(59246),ea=en(32866),eo=en(23980),eu=en(67597),ec=en(82791),eh=en(34294),ed=en(95199),ep=en(84353),ef=en(66738),em=en(49561),eg=en(87317),ey=en(17585),ev=en(84144),eb=en(34038);function eS(et,er){ei.call(this,et,er),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function eT(et){return et._fieldsById=et._fieldsArray=et._oneofsArray=null,delete et.encode,delete et.decode,delete et.verify,et}Object.defineProperties(eS.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var et=Object.keys(this.fields),er=0;er<et.length;++er){var en=this.fields[et[er]],ei=en.id;if(this._fieldsById[ei])throw Error("duplicate id "+ei+" in "+this);this._fieldsById[ei]=en}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=ef.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=ef.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=eS.generateConstructor(this)())},set:function(et){var er=et.prototype;er instanceof eh||((et.prototype=new eh).constructor=et,ef.merge(et.prototype,er)),et.$type=et.prototype.$type=this,ef.merge(et,eh,!0),this._ctor=et;for(var en=0;en<this.fieldsArray.length;++en)this._fieldsArray[en].resolve();var ei={};for(en=0;en<this.oneofsArray.length;++en)ei[this._oneofsArray[en].resolve().name]={get:ef.oneOfGetter(this._oneofsArray[en].oneof),set:ef.oneOfSetter(this._oneofsArray[en].oneof)};en&&Object.defineProperties(et.prototype,ei)}}}),eS.generateConstructor=function(et){for(var er,en=ef.codegen(["p"],et.name),ei=0;ei<et.fieldsArray.length;++ei)(er=et._fieldsArray[ei]).map?en("this%s={}",ef.safeProp(er.name)):er.repeated&&en("this%s=[]",ef.safeProp(er.name));return en("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},eS.fromJSON=function(et,er){var en=new eS(et,er.options);en.extensions=er.extensions,en.reserved=er.reserved;for(var eh=Object.keys(er.fields),ed=0;ed<eh.length;++ed)en.add((void 0!==er.fields[eh[ed]].keyType?eu.fromJSON:eo.fromJSON)(eh[ed],er.fields[eh[ed]]));if(er.oneofs)for(eh=Object.keys(er.oneofs),ed=0;ed<eh.length;++ed)en.add(ea.fromJSON(eh[ed],er.oneofs[eh[ed]]));if(er.nested)for(eh=Object.keys(er.nested),ed=0;ed<eh.length;++ed){var ep=er.nested[eh[ed]];en.add((void 0!==ep.id?eo.fromJSON:void 0!==ep.fields?eS.fromJSON:void 0!==ep.values?es.fromJSON:void 0!==ep.methods?ec.fromJSON:ei.fromJSON)(eh[ed],ep))}return er.extensions&&er.extensions.length&&(en.extensions=er.extensions),er.reserved&&er.reserved.length&&(en.reserved=er.reserved),er.group&&(en.group=!0),er.comment&&(en.comment=er.comment),en},eS.prototype.toJSON=function(et){var er=ei.prototype.toJSON.call(this,et),en=!!et&&!!et.keepComments;return ef.toObject(["options",er&&er.options||void 0,"oneofs",ei.arrayToJSON(this.oneofsArray,et),"fields",ei.arrayToJSON(this.fieldsArray.filter(function(et){return!et.declaringField}),et)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",er&&er.nested||void 0,"comment",en?this.comment:void 0])},eS.prototype.resolveAll=function(){for(var et=this.fieldsArray,er=0;er<et.length;)et[er++].resolve();var en=this.oneofsArray;for(er=0;er<en.length;)en[er++].resolve();return ei.prototype.resolveAll.call(this)},eS.prototype.get=function(et){return this.fields[et]||this.oneofs&&this.oneofs[et]||this.nested&&this.nested[et]||null},eS.prototype.add=function(et){if(this.get(et.name))throw Error("duplicate name '"+et.name+"' in "+this);if(et instanceof eo&&void 0===et.extend){if(this._fieldsById?this._fieldsById[et.id]:this.fieldsById[et.id])throw Error("duplicate id "+et.id+" in "+this);if(this.isReservedId(et.id))throw Error("id "+et.id+" is reserved in "+this);if(this.isReservedName(et.name))throw Error("name '"+et.name+"' is reserved in "+this);return et.parent&&et.parent.remove(et),this.fields[et.name]=et,et.message=this,et.onAdd(this),eT(this)}return et instanceof ea?(this.oneofs||(this.oneofs={}),this.oneofs[et.name]=et,et.onAdd(this),eT(this)):ei.prototype.add.call(this,et)},eS.prototype.remove=function(et){if(et instanceof eo&&void 0===et.extend){if(!this.fields||this.fields[et.name]!==et)throw Error(et+" is not a member of "+this);return delete this.fields[et.name],et.parent=null,et.onRemove(this),eT(this)}if(et instanceof ea){if(!this.oneofs||this.oneofs[et.name]!==et)throw Error(et+" is not a member of "+this);return delete this.oneofs[et.name],et.parent=null,et.onRemove(this),eT(this)}return ei.prototype.remove.call(this,et)},eS.prototype.isReservedId=function(et){return ei.isReservedId(this.reserved,et)},eS.prototype.isReservedName=function(et){return ei.isReservedName(this.reserved,et)},eS.prototype.create=function(et){return new this.ctor(et)},eS.prototype.setup=function(){for(var et=this.fullName,er=[],en=0;en<this.fieldsArray.length;++en)er.push(this._fieldsArray[en].resolve().resolvedType);this.encode=em(this)({Writer:ep,types:er,util:ef}),this.decode=eg(this)({Reader:ed,types:er,util:ef}),this.verify=ey(this)({types:er,util:ef}),this.fromObject=ev.fromObject(this)({types:er,util:ef}),this.toObject=ev.toObject(this)({types:er,util:ef});var ei=eb[et];if(ei){var es=Object.create(this);es.fromObject=this.fromObject,this.fromObject=ei.fromObject.bind(es),es.toObject=this.toObject,this.toObject=ei.toObject.bind(es)}return this},eS.prototype.encode=function(et,er){return this.setup().encode(et,er)},eS.prototype.encodeDelimited=function(et,er){return this.encode(et,er&&er.len?er.fork():er).ldelim()},eS.prototype.decode=function(et,er){return this.setup().decode(et,er)},eS.prototype.decodeDelimited=function(et){return et instanceof ed||(et=ed.create(et)),this.decode(et,et.uint32())},eS.prototype.verify=function(et){return this.setup().verify(et)},eS.prototype.fromObject=function(et){return this.setup().fromObject(et)},eS.prototype.toObject=function(et,er){return this.setup().toObject(et,er)},eS.d=function(et){return function(er){ef.decorateType(er,et)}}},91708:(et,er,en)=>{"use strict";var ei=er,es=en(66738),ea=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function eo(et,er){var en=0,ei={};for(er|=0;en<et.length;)ei[ea[en+er]]=et[en++];return ei}ei.basic=eo([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),ei.defaults=eo([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",es.emptyArray,null]),ei.long=eo([0,0,0,1,1],7),ei.mapKey=eo([0,0,0,5,5,0,0,0,1,1,0,2],2),ei.packed=eo([1,5,0,0,0,5,5,0,0,0,1,1,0])},66738:(et,er,en)=>{"use strict";var ei,es,ea=et.exports=en(18932),eo=en(10182);ea.codegen=en(57311),ea.fetch=en(82651),ea.path=en(52768),ea.fs=ea.inquire("fs"),ea.toArray=function(et){if(et){for(var er=Object.keys(et),en=Array(er.length),ei=0;ei<er.length;)en[ei]=et[er[ei++]];return en}return[]},ea.toObject=function(et){for(var er={},en=0;en<et.length;){var ei=et[en++],es=et[en++];void 0!==es&&(er[ei]=es)}return er};var eu=/\\/g,ec=/"/g;ea.isReserved=function(et){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(et)},ea.safeProp=function(et){return!/^[$\w_]+$/.test(et)||ea.isReserved(et)?'["'+et.replace(eu,"\\\\").replace(ec,'\\"')+'"]':"."+et},ea.ucFirst=function(et){return et.charAt(0).toUpperCase()+et.substring(1)};var eh=/_([a-z])/g;ea.camelCase=function(et){return et.substring(0,1)+et.substring(1).replace(eh,function(et,er){return er.toUpperCase()})},ea.compareFieldsById=function(et,er){return et.id-er.id},ea.decorateType=function(et,er){if(et.$type)return er&&et.$type.name!==er&&(ea.decorateRoot.remove(et.$type),et.$type.name=er,ea.decorateRoot.add(et.$type)),et.$type;ei||(ei=en(59340));var es=new ei(er||et.name);return ea.decorateRoot.add(es),es.ctor=et,Object.defineProperty(et,"$type",{value:es,enumerable:!1}),Object.defineProperty(et.prototype,"$type",{value:es,enumerable:!1}),es};var ed=0;ea.decorateEnum=function(et){if(et.$type)return et.$type;es||(es=en(59246));var er=new es("Enum"+ed++,et);return ea.decorateRoot.add(er),Object.defineProperty(et,"$type",{value:er,enumerable:!1}),er},ea.setProperty=function(et,er,en){function ei(et,er,en){var es=er.shift();if("__proto__"===es||"prototype"===es)return et;if(er.length>0)et[es]=ei(et[es]||{},er,en);else{var ea=et[es];ea&&(en=[].concat(ea).concat(en)),et[es]=en}return et}if("object"!=typeof et)throw TypeError("dst must be an object");if(!er)throw TypeError("path must be specified");return ei(et,er=er.split("."),en)},Object.defineProperty(ea,"decorateRoot",{get:function(){return eo.decorated||(eo.decorated=new(en(98373)))}})},41168:(et,er,en)=>{"use strict";et.exports=es;var ei=en(18932);function es(et,er){this.lo=et>>>0,this.hi=er>>>0}var ea=es.zero=new es(0,0);ea.toNumber=function(){return 0},ea.zzEncode=ea.zzDecode=function(){return this},ea.length=function(){return 1};var eo=es.zeroHash="\x00\x00\x00\x00\x00\x00\x00\x00";es.fromNumber=function(et){if(0===et)return ea;var er=et<0;er&&(et=-et);var en=et>>>0,ei=(et-en)/4294967296>>>0;return er&&(ei=~ei>>>0,en=~en>>>0,++en>4294967295&&(en=0,++ei>4294967295&&(ei=0))),new es(en,ei)},es.from=function(et){if("number"==typeof et)return es.fromNumber(et);if(ei.isString(et)){if(!ei.Long)return es.fromNumber(parseInt(et,10));et=ei.Long.fromString(et)}return et.low||et.high?new es(et.low>>>0,et.high>>>0):ea},es.prototype.toNumber=function(et){if(!et&&this.hi>>>31){var er=~this.lo+1>>>0,en=~this.hi>>>0;return er||(en=en+1>>>0),-(er+4294967296*en)}return this.lo+4294967296*this.hi},es.prototype.toLong=function(et){return ei.Long?new ei.Long(0|this.lo,0|this.hi,!!et):{low:0|this.lo,high:0|this.hi,unsigned:!!et}};var eu=String.prototype.charCodeAt;es.fromHash=function(et){return et===eo?ea:new es((eu.call(et,0)|eu.call(et,1)<<8|eu.call(et,2)<<16|eu.call(et,3)<<24)>>>0,(eu.call(et,4)|eu.call(et,5)<<8|eu.call(et,6)<<16|eu.call(et,7)<<24)>>>0)},es.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},es.prototype.zzEncode=function(){var et=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^et)>>>0,this.lo=(this.lo<<1^et)>>>0,this},es.prototype.zzDecode=function(){var et=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^et)>>>0,this.hi=(this.hi>>>1^et)>>>0,this},es.prototype.length=function(){var et=this.lo,er=(this.lo>>>28|this.hi<<4)>>>0,en=this.hi>>>24;return 0===en?0===er?et<16384?et<128?1:2:et<2097152?3:4:er<16384?er<128?5:6:er<2097152?7:8:en<128?9:10}},18932:function(et,er,en){"use strict";var ei=er;function es(et,er,en){for(var ei=Object.keys(er),es=0;es<ei.length;++es)void 0!==et[ei[es]]&&en||(et[ei[es]]=er[ei[es]]);return et}function ea(et){function er(et,en){if(!(this instanceof er))return new er(et,en);Object.defineProperty(this,"message",{get:function(){return et}}),Error.captureStackTrace?Error.captureStackTrace(this,er):Object.defineProperty(this,"stack",{value:Error().stack||""}),en&&es(this,en)}return er.prototype=Object.create(Error.prototype,{constructor:{value:er,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return et},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),er}ei.asPromise=en(18670),ei.base64=en(36009),ei.EventEmitter=en(50107),ei.float=en(71188),ei.inquire=en(28031),ei.utf8=en(67148),ei.pool=en(14314),ei.LongBits=en(41168),ei.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),ei.global=ei.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,ei.emptyArray=Object.freeze?Object.freeze([]):[],ei.emptyObject=Object.freeze?Object.freeze({}):{},ei.isInteger=Number.isInteger||function(et){return"number"==typeof et&&isFinite(et)&&Math.floor(et)===et},ei.isString=function(et){return"string"==typeof et||et instanceof String},ei.isObject=function(et){return et&&"object"==typeof et},ei.isset=ei.isSet=function(et,er){var en=et[er];return!!(null!=en&&et.hasOwnProperty(er))&&("object"!=typeof en||(Array.isArray(en)?en.length:Object.keys(en).length)>0)},ei.Buffer=function(){try{var et=ei.inquire("buffer").Buffer;return et.prototype.utf8Write?et:null}catch(et){return null}}(),ei._Buffer_from=null,ei._Buffer_allocUnsafe=null,ei.newBuffer=function(et){return"number"==typeof et?ei.Buffer?ei._Buffer_allocUnsafe(et):new ei.Array(et):ei.Buffer?ei._Buffer_from(et):"undefined"==typeof Uint8Array?et:new Uint8Array(et)},ei.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,ei.Long=ei.global.dcodeIO&&ei.global.dcodeIO.Long||ei.global.Long||ei.inquire("long"),ei.key2Re=/^true|false|0|1$/,ei.key32Re=/^-?(?:0|[1-9][0-9]*)$/,ei.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,ei.longToHash=function(et){return et?ei.LongBits.from(et).toHash():ei.LongBits.zeroHash},ei.longFromHash=function(et,er){var en=ei.LongBits.fromHash(et);return ei.Long?ei.Long.fromBits(en.lo,en.hi,er):en.toNumber(!!er)},ei.merge=es,ei.lcFirst=function(et){return et.charAt(0).toLowerCase()+et.substring(1)},ei.newError=ea,ei.ProtocolError=ea("ProtocolError"),ei.oneOfGetter=function(et){for(var er={},en=0;en<et.length;++en)er[et[en]]=1;return function(){for(var et=Object.keys(this),en=et.length-1;en>-1;--en)if(1===er[et[en]]&&void 0!==this[et[en]]&&null!==this[et[en]])return et[en]}},ei.oneOfSetter=function(et){return function(er){for(var en=0;en<et.length;++en)et[en]!==er&&delete this[et[en]]}},ei.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},ei._configure=function(){var et=ei.Buffer;if(!et){ei._Buffer_from=ei._Buffer_allocUnsafe=null;return}ei._Buffer_from=et.from!==Uint8Array.from&&et.from||function(er,en){return new et(er,en)},ei._Buffer_allocUnsafe=et.allocUnsafe||function(er){return new et(er)}}},17585:(et,er,en)=>{"use strict";et.exports=ec;var ei=en(59246),es=en(66738);function ea(et,er){return et.name+": "+er+(et.repeated&&"array"!==er?"[]":et.map&&"object"!==er?"{k:"+et.keyType+"}":"")+" expected"}function eo(et,er,en,es){if(er.resolvedType){if(er.resolvedType instanceof ei){et("switch(%s){",es)("default:")("return%j",ea(er,"enum value"));for(var eo=Object.keys(er.resolvedType.values),eu=0;eu<eo.length;++eu)et("case %i:",er.resolvedType.values[eo[eu]]);et("break")("}")}else et("{")("var e=types[%i].verify(%s);",en,es)("if(e)")("return%j+e",er.name+".")("}")}else switch(er.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":et("if(!util.isInteger(%s))",es)("return%j",ea(er,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":et("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",es,es,es,es)("return%j",ea(er,"integer|Long"));break;case"float":case"double":et('if(typeof %s!=="number")',es)("return%j",ea(er,"number"));break;case"bool":et('if(typeof %s!=="boolean")',es)("return%j",ea(er,"boolean"));break;case"string":et("if(!util.isString(%s))",es)("return%j",ea(er,"string"));break;case"bytes":et('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',es,es,es)("return%j",ea(er,"buffer"))}return et}function eu(et,er,en){switch(er.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":et("if(!util.key32Re.test(%s))",en)("return%j",ea(er,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":et("if(!util.key64Re.test(%s))",en)("return%j",ea(er,"integer|Long key"));break;case"bool":et("if(!util.key2Re.test(%s))",en)("return%j",ea(er,"boolean key"))}return et}function ec(et){var er=es.codegen(["m"],et.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),en=et.oneofsArray,ei={};en.length&&er("var p={}");for(var ec=0;ec<et.fieldsArray.length;++ec){var eh=et._fieldsArray[ec].resolve(),ed="m"+es.safeProp(eh.name);if(eh.optional&&er("if(%s!=null&&m.hasOwnProperty(%j)){",ed,eh.name),eh.map)er("if(!util.isObject(%s))",ed)("return%j",ea(eh,"object"))("var k=Object.keys(%s)",ed)("for(var i=0;i<k.length;++i){"),eu(er,eh,"k[i]"),eo(er,eh,ec,ed+"[k[i]]")("}");else if(eh.repeated)er("if(!Array.isArray(%s))",ed)("return%j",ea(eh,"array"))("for(var i=0;i<%s.length;++i){",ed),eo(er,eh,ec,ed+"[i]")("}");else{if(eh.partOf){var ep=es.safeProp(eh.partOf.name);1===ei[eh.partOf.name]&&er("if(p%s===1)",ep)("return%j",eh.partOf.name+": multiple values"),ei[eh.partOf.name]=1,er("p%s=1",ep)}eo(er,eh,ec,ed)}eh.optional&&er("}")}return er("return null")}},34038:(et,er,en)=>{"use strict";var ei=er,es=en(34294);ei[".google.protobuf.Any"]={fromObject:function(et){if(et&&et["@type"]){var er=et["@type"].substring(et["@type"].lastIndexOf("/")+1),en=this.lookup(er);if(en){var ei="."===et["@type"].charAt(0)?et["@type"].slice(1):et["@type"];return -1===ei.indexOf("/")&&(ei="/"+ei),this.create({type_url:ei,value:en.encode(en.fromObject(et)).finish()})}}return this.fromObject(et)},toObject:function(et,er){var en="type.googleapis.com/",ei="",ea="";if(er&&er.json&&et.type_url&&et.value){ea=et.type_url.substring(et.type_url.lastIndexOf("/")+1),ei=et.type_url.substring(0,et.type_url.lastIndexOf("/")+1);var eo=this.lookup(ea);eo&&(et=eo.decode(et.value))}if(!(et instanceof this.ctor)&&et instanceof es){var eu=et.$type.toObject(et,er),ec="."===et.$type.fullName[0]?et.$type.fullName.slice(1):et.$type.fullName;return""===ei&&(ei=en),ea=ei+ec,eu["@type"]=ea,eu}return this.toObject(et,er)}}},84353:(et,er,en)=>{"use strict";et.exports=ep;var ei,es=en(18932),ea=es.LongBits,eo=es.base64,eu=es.utf8;function ec(et,er,en){this.fn=et,this.len=er,this.next=void 0,this.val=en}function eh(){}function ed(et){this.head=et.head,this.tail=et.tail,this.len=et.len,this.next=et.states}function ep(){this.len=0,this.head=new ec(eh,0,0),this.tail=this.head,this.states=null}var ef=function(){return es.Buffer?function(){return(ep.create=function(){return new ei})()}:function(){return new ep}};function em(et,er,en){er[en]=255&et}function eg(et,er,en){for(;et>127;)er[en++]=127&et|128,et>>>=7;er[en]=et}function ey(et,er){this.len=et,this.next=void 0,this.val=er}function ev(et,er,en){for(;et.hi;)er[en++]=127&et.lo|128,et.lo=(et.lo>>>7|et.hi<<25)>>>0,et.hi>>>=7;for(;et.lo>127;)er[en++]=127&et.lo|128,et.lo=et.lo>>>7;er[en++]=et.lo}function eb(et,er,en){er[en]=255&et,er[en+1]=et>>>8&255,er[en+2]=et>>>16&255,er[en+3]=et>>>24}ep.create=ef(),ep.alloc=function(et){return new es.Array(et)},es.Array!==Array&&(ep.alloc=es.pool(ep.alloc,es.Array.prototype.subarray)),ep.prototype._push=function(et,er,en){return this.tail=this.tail.next=new ec(et,er,en),this.len+=er,this},ey.prototype=Object.create(ec.prototype),ey.prototype.fn=eg,ep.prototype.uint32=function(et){return this.len+=(this.tail=this.tail.next=new ey((et>>>=0)<128?1:et<16384?2:et<2097152?3:et<268435456?4:5,et)).len,this},ep.prototype.int32=function(et){return et<0?this._push(ev,10,ea.fromNumber(et)):this.uint32(et)},ep.prototype.sint32=function(et){return this.uint32((et<<1^et>>31)>>>0)},ep.prototype.uint64=function(et){var er=ea.from(et);return this._push(ev,er.length(),er)},ep.prototype.int64=ep.prototype.uint64,ep.prototype.sint64=function(et){var er=ea.from(et).zzEncode();return this._push(ev,er.length(),er)},ep.prototype.bool=function(et){return this._push(em,1,et?1:0)},ep.prototype.fixed32=function(et){return this._push(eb,4,et>>>0)},ep.prototype.sfixed32=ep.prototype.fixed32,ep.prototype.fixed64=function(et){var er=ea.from(et);return this._push(eb,4,er.lo)._push(eb,4,er.hi)},ep.prototype.sfixed64=ep.prototype.fixed64,ep.prototype.float=function(et){return this._push(es.float.writeFloatLE,4,et)},ep.prototype.double=function(et){return this._push(es.float.writeDoubleLE,8,et)};var eS=es.Array.prototype.set?function(et,er,en){er.set(et,en)}:function(et,er,en){for(var ei=0;ei<et.length;++ei)er[en+ei]=et[ei]};ep.prototype.bytes=function(et){var er=et.length>>>0;if(!er)return this._push(em,1,0);if(es.isString(et)){var en=ep.alloc(er=eo.length(et));eo.decode(et,en,0),et=en}return this.uint32(er)._push(eS,er,et)},ep.prototype.string=function(et){var er=eu.length(et);return er?this.uint32(er)._push(eu.write,er,et):this._push(em,1,0)},ep.prototype.fork=function(){return this.states=new ed(this),this.head=this.tail=new ec(eh,0,0),this.len=0,this},ep.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ec(eh,0,0),this.len=0),this},ep.prototype.ldelim=function(){var et=this.head,er=this.tail,en=this.len;return this.reset().uint32(en),en&&(this.tail.next=et.next,this.tail=er,this.len+=en),this},ep.prototype.finish=function(){for(var et=this.head.next,er=this.constructor.alloc(this.len),en=0;et;)et.fn(et.val,er,en),en+=et.len,et=et.next;return er},ep._configure=function(et){ei=et,ep.create=ef(),ei._configure()}},81978:(et,er,en)=>{"use strict";et.exports=ea;var ei=en(84353);(ea.prototype=Object.create(ei.prototype)).constructor=ea;var es=en(18932);function ea(){ei.call(this)}function eo(et,er,en){et.length<40?es.utf8.write(et,er,en):er.utf8Write?er.utf8Write(et,en):er.write(et,en)}ea._configure=function(){ea.alloc=es._Buffer_allocUnsafe,ea.writeBytesBuffer=es.Buffer&&es.Buffer.prototype instanceof Uint8Array&&"set"===es.Buffer.prototype.set.name?function(et,er,en){er.set(et,en)}:function(et,er,en){if(et.copy)et.copy(er,en,0,et.length);else for(var ei=0;ei<et.length;)er[en++]=et[ei++]}},ea.prototype.bytes=function(et){es.isString(et)&&(et=es._Buffer_from(et,"base64"));var er=et.length>>>0;return this.uint32(er),er&&this._push(ea.writeBytesBuffer,er,et),this},ea.prototype.string=function(et){var er=es.Buffer.byteLength(et);return this.uint32(er),er&&this._push(eo,er,et),this},ea._configure()},79493:et=>{"use strict";var er=Array.isArray,en=Object.keys,ei=Object.prototype.hasOwnProperty,es="undefined"!=typeof Element;function ea(et,eo){if(et===eo)return!0;if(et&&eo&&"object"==typeof et&&"object"==typeof eo){var eu,ec,eh,ed=er(et),ep=er(eo);if(ed&&ep){if((ec=et.length)!=eo.length)return!1;for(eu=ec;0!=eu--;)if(!ea(et[eu],eo[eu]))return!1;return!0}if(ed!=ep)return!1;var ef=et instanceof Date,em=eo instanceof Date;if(ef!=em)return!1;if(ef&&em)return et.getTime()==eo.getTime();var eg=et instanceof RegExp,ey=eo instanceof RegExp;if(eg!=ey)return!1;if(eg&&ey)return et.toString()==eo.toString();var ev=en(et);if((ec=ev.length)!==en(eo).length)return!1;for(eu=ec;0!=eu--;)if(!ei.call(eo,ev[eu]))return!1;if(es&&et instanceof Element&&eo instanceof Element)return et===eo;for(eu=ec;0!=eu--;)if(("_owner"!==(eh=ev[eu])||!et.$$typeof)&&!ea(et[eh],eo[eh]))return!1;return!0}return et!=et&&eo!=eo}et.exports=function(et,er){try{return ea(et,er)}catch(et){if(et.message&&et.message.match(/stack|recursion/i)||-2146828260===et.number)return console.warn("Warning: react-fast-compare does not handle circular references.",et.name,et.message),!1;throw et}}},26795:(et,er)=>{"use strict";/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var en="function"==typeof Symbol&&Symbol.for,ei=en?Symbol.for("react.element"):60103,es=en?Symbol.for("react.portal"):60106,ea=en?Symbol.for("react.fragment"):60107,eo=en?Symbol.for("react.strict_mode"):60108,eu=en?Symbol.for("react.profiler"):60114,ec=en?Symbol.for("react.provider"):60109,eh=en?Symbol.for("react.context"):60110,ed=en?Symbol.for("react.async_mode"):60111,ep=en?Symbol.for("react.concurrent_mode"):60111,ef=en?Symbol.for("react.forward_ref"):60112,em=en?Symbol.for("react.suspense"):60113,eg=en?Symbol.for("react.suspense_list"):60120,ey=en?Symbol.for("react.memo"):60115,ev=en?Symbol.for("react.lazy"):60116,eb=en?Symbol.for("react.block"):60121,eS=en?Symbol.for("react.fundamental"):60117,eT=en?Symbol.for("react.responder"):60118,ew=en?Symbol.for("react.scope"):60119;function eE(et){if("object"==typeof et&&null!==et){var er=et.$$typeof;switch(er){case ei:switch(et=et.type){case ed:case ep:case ea:case eu:case eo:case em:return et;default:switch(et=et&&et.$$typeof){case eh:case ef:case ev:case ey:case ec:return et;default:return er}}case es:return er}}}function eC(et){return eE(et)===ep}er.AsyncMode=ed,er.ConcurrentMode=ep,er.ContextConsumer=eh,er.ContextProvider=ec,er.Element=ei,er.ForwardRef=ef,er.Fragment=ea,er.Lazy=ev,er.Memo=ey,er.Portal=es,er.Profiler=eu,er.StrictMode=eo,er.Suspense=em,er.isAsyncMode=function(et){return eC(et)||eE(et)===ed},er.isConcurrentMode=eC,er.isContextConsumer=function(et){return eE(et)===eh},er.isContextProvider=function(et){return eE(et)===ec},er.isElement=function(et){return"object"==typeof et&&null!==et&&et.$$typeof===ei},er.isForwardRef=function(et){return eE(et)===ef},er.isFragment=function(et){return eE(et)===ea},er.isLazy=function(et){return eE(et)===ev},er.isMemo=function(et){return eE(et)===ey},er.isPortal=function(et){return eE(et)===es},er.isProfiler=function(et){return eE(et)===eu},er.isStrictMode=function(et){return eE(et)===eo},er.isSuspense=function(et){return eE(et)===em},er.isValidElementType=function(et){return"string"==typeof et||"function"==typeof et||et===ea||et===ep||et===eu||et===eo||et===em||et===eg||"object"==typeof et&&null!==et&&(et.$$typeof===ev||et.$$typeof===ey||et.$$typeof===ec||et.$$typeof===eh||et.$$typeof===ef||et.$$typeof===eS||et.$$typeof===eT||et.$$typeof===ew||et.$$typeof===eb)},er.typeOf=eE},23314:(et,er,en)=>{"use strict";et.exports=en(26795)},887:et=>{let er=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,en=et=>et.match(er)||[],ei=et=>et[0].toUpperCase()+et.slice(1),es=(et,er)=>en(et).join(er).toLowerCase(),ea=et=>en(et).reduce((et,er)=>`${et}${et?er[0].toUpperCase()+er.slice(1).toLowerCase():er.toLowerCase()}`,""),eo=et=>ei(ea(et)),eu=et=>es(et,"_"),ec=et=>es(et,"-"),eh=et=>ei(es(et," ")),ed=et=>en(et).map(ei).join(" ");et.exports={words:en,upperFirst:ei,camelCase:ea,pascalCase:eo,snakeCase:eu,kebabCase:ec,sentenceCase:eh,titleCase:ed}},98850:et=>{"use strict";var er=!0;function en(et,en){if(!er&&!et){var ei="Warning: "+en;"undefined"!=typeof console&&console.warn(ei);try{throw Error(ei)}catch(et){}}}et.exports=en},753:et=>{function er(et,er){var en=et.length,ea=Array(en),eo={},eu=en,ec=ei(er),eh=es(et);for(er.forEach(function(et){if(!eh.has(et[0])||!eh.has(et[1]))throw Error("Unknown node. There is an unknown node in the supplied edges.")});eu--;)eo[eu]||ed(et[eu],eu,new Set);return ea;function ed(et,er,ei){if(ei.has(et)){var es;try{es=", node was:"+JSON.stringify(et)}catch(et){es=""}throw Error("Cyclic dependency"+es)}if(!eh.has(et))throw Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(et));if(!eo[er]){eo[er]=!0;var eu=ec.get(et)||new Set;if(eu=Array.from(eu),er=eu.length){ei.add(et);do{var ep=eu[--er];ed(ep,eh.get(ep),ei)}while(er);ei.delete(et)}ea[--en]=et}}}function en(et){for(var er=new Set,en=0,ei=et.length;en<ei;en++){var es=et[en];er.add(es[0]),er.add(es[1])}return Array.from(er)}function ei(et){for(var er=new Map,en=0,ei=et.length;en<ei;en++){var es=et[en];er.has(es[0])||er.set(es[0],new Set),er.has(es[1])||er.set(es[1],new Set),er.get(es[0]).add(es[1])}return er}function es(et){for(var er=new Map,en=0,ei=et.length;en<ei;en++)er.set(et[en],en);return er}et.exports=function(et){return er(en(et),et)},et.exports.array=er},50298:(et,er,en)=>{"use strict";let ei,es,ea;eo={value:!0};var eo,eu=en(14738),ec=en(887),eh=function(et){return et&&"object"==typeof et&&"default"in et?et:{default:et}}(en(753));let ed=Object.prototype.toString,ep=Error.prototype.toString,ef=RegExp.prototype.toString,em="undefined"!=typeof Symbol?Symbol.prototype.toString:()=>"",eg=/^Symbol\((.*)\)(.*)$/;function ey(et){if(et!=+et)return"NaN";let er=0===et&&1/et<0;return er?"-0":""+et}function ev(et,er=!1){if(null==et||!0===et||!1===et)return""+et;let en=typeof et;if("number"===en)return ey(et);if("string"===en)return er?`"${et}"`:et;if("function"===en)return"[Function "+(et.name||"anonymous")+"]";if("symbol"===en)return em.call(et).replace(eg,"Symbol($1)");let ei=ed.call(et).slice(8,-1);return"Date"===ei?isNaN(et.getTime())?""+et:et.toISOString(et):"Error"===ei||et instanceof Error?"["+ep.call(et)+"]":"RegExp"===ei?ef.call(et):null}function eb(et,er){let en=ev(et,er);return null!==en?en:JSON.stringify(et,function(et,en){let ei=ev(this[et],er);return null!==ei?ei:en},2)}function eS(et){return null==et?[]:[].concat(et)}let eT=/\$\{\s*(\w+)\s*\}/g;ei=Symbol.toStringTag;class ew{constructor(et,er,en,es){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[ei]="Error",this.name="ValidationError",this.value=er,this.path=en,this.type=es,this.errors=[],this.inner=[],eS(et).forEach(et=>{if(eE.isError(et)){this.errors.push(...et.errors);let er=et.inner.length?et.inner:[et];this.inner.push(...er)}else this.errors.push(et)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}es=Symbol.hasInstance,ea=Symbol.toStringTag;class eE extends Error{static formatError(et,er){let en=er.label||er.path||"this";return(er=Object.assign({},er,{path:en,originalPath:er.path}),"string"==typeof et)?et.replace(eT,(et,en)=>eb(er[en])):"function"==typeof et?et(er):et}static isError(et){return et&&"ValidationError"===et.name}constructor(et,er,en,ei,es){let eo=new ew(et,er,en,ei);if(es)return eo;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[ea]="Error",this.name=eo.name,this.message=eo.message,this.type=eo.type,this.value=eo.value,this.path=eo.path,this.errors=eo.errors,this.inner=eo.inner,Error.captureStackTrace&&Error.captureStackTrace(this,eE)}static[es](et){return ew[Symbol.hasInstance](et)||super[Symbol.hasInstance](et)}}let eC={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:et,type:er,value:en,originalValue:ei})=>{let es=null!=ei&&ei!==en?` (cast from the value \`${eb(ei,!0)}\`).`:".";return"mixed"!==er?`${et} must be a \`${er}\` type, but the final value was: \`${eb(en,!0)}\``+es:`${et} must match the configured type. The validated value was: \`${eb(en,!0)}\``+es}},e_={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},eI={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},ek={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},ex={isValue:"${path} field must be ${value}"},eA={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},eR={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},eD={notType:et=>{let{path:er,value:en,spec:ei}=et,es=ei.types.length;if(Array.isArray(en)){if(en.length<es)return`${er} tuple value has too few items, expected a length of ${es} but got ${en.length} for value: \`${eb(en,!0)}\``;if(en.length>es)return`${er} tuple value has too many items, expected a length of ${es} but got ${en.length} for value: \`${eb(en,!0)}\``}return eE.formatError(eC.notType,et)}};var eO=Object.assign(Object.create(null),{mixed:eC,string:e_,number:eI,date:ek,object:eA,array:eR,boolean:ex,tuple:eD});let eN=et=>et&&et.__isYupSchema__;class eM{static fromOptions(et,er){if(!er.then&&!er.otherwise)throw TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:en,then:ei,otherwise:es}=er,ea="function"==typeof en?en:(...et)=>et.every(et=>et===en);return new eM(et,(et,er)=>{var en;let eo=ea(...et)?ei:es;return null!=(en=null==eo?void 0:eo(er))?en:er})}constructor(et,er){this.fn=void 0,this.refs=et,this.refs=et,this.fn=er}resolve(et,er){let en=this.refs.map(et=>et.getValue(null==er?void 0:er.value,null==er?void 0:er.parent,null==er?void 0:er.context)),ei=this.fn(en,et,er);if(void 0===ei||ei===et)return et;if(!eN(ei))throw TypeError("conditions must return a schema object");return ei.resolve(er)}}let eP={context:"$",value:"."};function eL(et,er){return new eF(et,er)}class eF{constructor(et,er={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,"string"!=typeof et)throw TypeError("ref must be a string, got: "+et);if(this.key=et.trim(),""===et)throw TypeError("ref must be a non-empty string");this.isContext=this.key[0]===eP.context,this.isValue=this.key[0]===eP.value,this.isSibling=!this.isContext&&!this.isValue;let en=this.isContext?eP.context:this.isValue?eP.value:"";this.path=this.key.slice(en.length),this.getter=this.path&&eu.getter(this.path,!0),this.map=er.map}getValue(et,er,en){let ei=this.isContext?en:this.isValue?et:er;return this.getter&&(ei=this.getter(ei||{})),this.map&&(ei=this.map(ei)),ei}cast(et,er){return this.getValue(et,null==er?void 0:er.parent,null==er?void 0:er.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(et){return et&&et.__isYupRef}}eF.prototype.__isYupRef=!0;let eB=et=>null==et;function ej(et){function er({value:er,path:en="",options:ei,originalValue:es,schema:ea},eo,eu){let ec;let{name:eh,test:ed,params:ep,message:ef,skipAbsent:em}=et,{parent:eg,context:ey,abortEarly:ev=ea.spec.abortEarly,disableStackTrace:eb=ea.spec.disableStackTrace}=ei;function eS(et){return eF.isRef(et)?et.getValue(er,eg,ey):et}function eT(et={}){let ei=Object.assign({value:er,originalValue:es,label:ea.spec.label,path:et.path||en,spec:ea.spec,disableStackTrace:et.disableStackTrace||eb},ep,et.params);for(let et of Object.keys(ei))ei[et]=eS(ei[et]);let eo=new eE(eE.formatError(et.message||ef,ei),er,ei.path,et.type||eh,ei.disableStackTrace);return eo.params=ei,eo}let ew=ev?eo:eu,eC={path:en,parent:eg,type:eh,from:ei.from,createError:eT,resolve:eS,options:ei,originalValue:es,schema:ea},e_=et=>{eE.isError(et)?ew(et):et?eu(null):ew(eT())},eI=et=>{eE.isError(et)?ew(et):eo(et)},ek=em&&eB(er);if(ek)return e_(!0);try{var ex;if(ec=ed.call(eC,er,eC),"function"==typeof(null==(ex=ec)?void 0:ex.then)){if(ei.sync)throw Error(`Validation test of type: "${eC.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(ec).then(e_,eI)}}catch(et){eI(et);return}e_(ec)}return er.OPTIONS=et,er}function eU(et,er,en,ei=en){let es,ea,eo;return er?(eu.forEach(er,(eu,ec,eh)=>{let ed=ec?eu.slice(1,eu.length-1):eu,ep="tuple"===(et=et.resolve({context:ei,parent:es,value:en})).type,ef=eh?parseInt(ed,10):0;if(et.innerType||ep){if(ep&&!eh)throw Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${eo}" must contain an index to the tuple element, e.g. "${eo}[0]"`);if(en&&ef>=en.length)throw Error(`Yup.reach cannot resolve an array item at index: ${eu}, in the path: ${er}. because there is no value at that index. `);es=en,en=en&&en[ef],et=ep?et.spec.types[ef]:et.innerType}if(!eh){if(!et.fields||!et.fields[ed])throw Error(`The schema does not contain the path: ${er}. (failed at: ${eo} which is a type: "${et.type}")`);es=en,en=en&&en[ed],et=et.fields[ed]}ea=ed,eo=ec?"["+eu+"]":"."+eu}),{schema:et,parent:es,parentPath:ea}):{parent:es,parentPath:er,schema:et}}function eV(et,er,en,ei){return eU(et,er,en,ei).schema}class ez extends Set{describe(){let et=[];for(let er of this.values())et.push(eF.isRef(er)?er.describe():er);return et}resolveAll(et){let er=[];for(let en of this.values())er.push(et(en));return er}clone(){return new ez(this.values())}merge(et,er){let en=this.clone();return et.forEach(et=>en.add(et)),er.forEach(et=>en.delete(et)),en}}function e$(et,er=new Map){let en;if(eN(et)||!et||"object"!=typeof et)return et;if(er.has(et))return er.get(et);if(et instanceof Date)en=new Date(et.getTime()),er.set(et,en);else if(et instanceof RegExp)en=new RegExp(et),er.set(et,en);else if(Array.isArray(et)){en=Array(et.length),er.set(et,en);for(let ei=0;ei<et.length;ei++)en[ei]=e$(et[ei],er)}else if(et instanceof Map)for(let[ei,es]of(en=new Map,er.set(et,en),et.entries()))en.set(ei,e$(es,er));else if(et instanceof Set)for(let ei of(en=new Set,er.set(et,en),et))en.add(e$(ei,er));else if(et instanceof Object)for(let[ei,es]of(en={},er.set(et,en),Object.entries(et)))en[ei]=e$(es,er);else throw Error(`Unable to clone ${et}`);return en}class eG{constructor(et){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new ez,this._blacklist=new ez,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(eC.notType)}),this.type=et.type,this._typeCheck=et.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},null==et?void 0:et.spec),this.withMutation(et=>{et.nonNullable()})}get _type(){return this.type}clone(et){if(this._mutate)return et&&Object.assign(this.spec,et),this;let er=Object.create(Object.getPrototypeOf(this));return er.type=this.type,er._typeCheck=this._typeCheck,er._whitelist=this._whitelist.clone(),er._blacklist=this._blacklist.clone(),er.internalTests=Object.assign({},this.internalTests),er.exclusiveTests=Object.assign({},this.exclusiveTests),er.deps=[...this.deps],er.conditions=[...this.conditions],er.tests=[...this.tests],er.transforms=[...this.transforms],er.spec=e$(Object.assign({},this.spec,et)),er}label(et){let er=this.clone();return er.spec.label=et,er}meta(...et){if(0===et.length)return this.spec.meta;let er=this.clone();return er.spec.meta=Object.assign(er.spec.meta||{},et[0]),er}withMutation(et){let er=this._mutate;this._mutate=!0;let en=et(this);return this._mutate=er,en}concat(et){if(!et||et===this)return this;if(et.type!==this.type&&"mixed"!==this.type)throw TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${et.type}`);let er=this,en=et.clone(),ei=Object.assign({},er.spec,en.spec);return en.spec=ei,en.internalTests=Object.assign({},er.internalTests,en.internalTests),en._whitelist=er._whitelist.merge(et._whitelist,et._blacklist),en._blacklist=er._blacklist.merge(et._blacklist,et._whitelist),en.tests=er.tests,en.exclusiveTests=er.exclusiveTests,en.withMutation(er=>{et.tests.forEach(et=>{er.test(et.OPTIONS)})}),en.transforms=[...er.transforms,...en.transforms],en}isType(et){return null==et?!!this.spec.nullable&&null===et||!!this.spec.optional&&void 0===et:this._typeCheck(et)}resolve(et){let er=this;if(er.conditions.length){let en=er.conditions;(er=er.clone()).conditions=[],er=(er=en.reduce((er,en)=>en.resolve(er,et),er)).resolve(et)}return er}resolveOptions(et){var er,en,ei,es;return Object.assign({},et,{from:et.from||[],strict:null!=(er=et.strict)?er:this.spec.strict,abortEarly:null!=(en=et.abortEarly)?en:this.spec.abortEarly,recursive:null!=(ei=et.recursive)?ei:this.spec.recursive,disableStackTrace:null!=(es=et.disableStackTrace)?es:this.spec.disableStackTrace})}cast(et,er={}){let en=this.resolve(Object.assign({value:et},er)),ei="ignore-optionality"===er.assert,es=en._cast(et,er);if(!1!==er.assert&&!en.isType(es)){if(ei&&eB(es))return es;let ea=eb(et),eo=eb(es);throw TypeError(`The value of ${er.path||"field"} could not be cast to a value that satisfies the schema type: "${en.type}". 

attempted value: ${ea} 
`+(eo!==ea?`result of cast: ${eo}`:""))}return es}_cast(et,er){let en=void 0===et?et:this.transforms.reduce((er,en)=>en.call(this,er,et,this),et);return void 0===en&&(en=this.getDefault(er)),en}_validate(et,er={},en,ei){let{path:es,originalValue:ea=et,strict:eo=this.spec.strict}=er,eu=et;eo||(eu=this._cast(eu,Object.assign({assert:!1},er)));let ec=[];for(let et of Object.values(this.internalTests))et&&ec.push(et);this.runTests({path:es,value:eu,originalValue:ea,options:er,tests:ec},en,et=>{if(et.length)return ei(et,eu);this.runTests({path:es,value:eu,originalValue:ea,options:er,tests:this.tests},en,ei)})}runTests(et,er,en){let ei=!1,{tests:es,value:ea,originalValue:eo,path:eu,options:ec}=et,eh=et=>{ei||(ei=!0,er(et,ea))},ed=et=>{ei||(ei=!0,en(et,ea))},ep=es.length,ef=[];if(!ep)return ed([]);let em={value:ea,originalValue:eo,path:eu,options:ec,schema:this};for(let et=0;et<es.length;et++){let er=es[et];er(em,eh,function(et){et&&(Array.isArray(et)?ef.push(...et):ef.push(et)),--ep<=0&&ed(ef)})}}asNestedTest({key:et,index:er,parent:en,parentPath:ei,originalParent:es,options:ea}){let eo=null!=et?et:er;if(null==eo)throw TypeError("Must include `key` or `index` for nested validations");let eu="number"==typeof eo,ec=en[eo],eh=Object.assign({},ea,{strict:!0,parent:en,value:ec,originalValue:es[eo],key:void 0,[eu?"index":"key"]:eo,path:eu||eo.includes(".")?`${ei||""}[${eu?eo:`"${eo}"`}]`:(ei?`${ei}.`:"")+et});return(et,er,en)=>this.resolve(eh)._validate(ec,eh,er,en)}validate(et,er){var en;let ei=this.resolve(Object.assign({},er,{value:et})),es=null!=(en=null==er?void 0:er.disableStackTrace)?en:ei.spec.disableStackTrace;return new Promise((en,ea)=>ei._validate(et,er,(et,er)=>{eE.isError(et)&&(et.value=er),ea(et)},(et,er)=>{et.length?ea(new eE(et,er,void 0,void 0,es)):en(er)}))}validateSync(et,er){var en;let ei;let es=this.resolve(Object.assign({},er,{value:et})),ea=null!=(en=null==er?void 0:er.disableStackTrace)?en:es.spec.disableStackTrace;return es._validate(et,Object.assign({},er,{sync:!0}),(et,er)=>{throw eE.isError(et)&&(et.value=er),et},(er,en)=>{if(er.length)throw new eE(er,et,void 0,void 0,ea);ei=en}),ei}isValid(et,er){return this.validate(et,er).then(()=>!0,et=>{if(eE.isError(et))return!1;throw et})}isValidSync(et,er){try{return this.validateSync(et,er),!0}catch(et){if(eE.isError(et))return!1;throw et}}_getDefault(et){let er=this.spec.default;return null==er?er:"function"==typeof er?er.call(this,et):e$(er)}getDefault(et){return this.resolve(et||{})._getDefault(et)}default(et){return 0==arguments.length?this._getDefault():this.clone({default:et})}strict(et=!0){return this.clone({strict:et})}nullability(et,er){let en=this.clone({nullable:et});return en.internalTests.nullable=ej({message:er,name:"nullable",test(et){return null!==et||this.schema.spec.nullable}}),en}optionality(et,er){let en=this.clone({optional:et});return en.internalTests.optionality=ej({message:er,name:"optionality",test(et){return void 0!==et||this.schema.spec.optional}}),en}optional(){return this.optionality(!0)}defined(et=eC.defined){return this.optionality(!1,et)}nullable(){return this.nullability(!0)}nonNullable(et=eC.notNull){return this.nullability(!1,et)}required(et=eC.required){return this.clone().withMutation(er=>er.nonNullable(et).defined(et))}notRequired(){return this.clone().withMutation(et=>et.nullable().optional())}transform(et){let er=this.clone();return er.transforms.push(et),er}test(...et){let er;if(void 0===(er=1===et.length?"function"==typeof et[0]?{test:et[0]}:et[0]:2===et.length?{name:et[0],test:et[1]}:{name:et[0],message:et[1],test:et[2]}).message&&(er.message=eC.default),"function"!=typeof er.test)throw TypeError("`test` is a required parameters");let en=this.clone(),ei=ej(er),es=er.exclusive||er.name&&!0===en.exclusiveTests[er.name];if(er.exclusive&&!er.name)throw TypeError("Exclusive tests must provide a unique `name` identifying the test");return er.name&&(en.exclusiveTests[er.name]=!!er.exclusive),en.tests=en.tests.filter(et=>et.OPTIONS.name!==er.name||!es&&et.OPTIONS.test!==ei.OPTIONS.test),en.tests.push(ei),en}when(et,er){Array.isArray(et)||"string"==typeof et||(er=et,et=".");let en=this.clone(),ei=eS(et).map(et=>new eF(et));return ei.forEach(et=>{et.isSibling&&en.deps.push(et.key)}),en.conditions.push("function"==typeof er?new eM(ei,er):eM.fromOptions(ei,er)),en}typeError(et){let er=this.clone();return er.internalTests.typeError=ej({message:et,name:"typeError",skipAbsent:!0,test(et){return!!this.schema._typeCheck(et)||this.createError({params:{type:this.schema.type}})}}),er}oneOf(et,er=eC.oneOf){let en=this.clone();return et.forEach(et=>{en._whitelist.add(et),en._blacklist.delete(et)}),en.internalTests.whiteList=ej({message:er,name:"oneOf",skipAbsent:!0,test(et){let er=this.schema._whitelist,en=er.resolveAll(this.resolve);return!!en.includes(et)||this.createError({params:{values:Array.from(er).join(", "),resolved:en}})}}),en}notOneOf(et,er=eC.notOneOf){let en=this.clone();return et.forEach(et=>{en._blacklist.add(et),en._whitelist.delete(et)}),en.internalTests.blacklist=ej({message:er,name:"notOneOf",test(et){let er=this.schema._blacklist,en=er.resolveAll(this.resolve);return!en.includes(et)||this.createError({params:{values:Array.from(er).join(", "),resolved:en}})}}),en}strip(et=!0){let er=this.clone();return er.spec.strip=et,er}describe(et){let er=(et?this.resolve(et):this).clone(),{label:en,meta:ei,optional:es,nullable:ea}=er.spec,eo={meta:ei,label:en,optional:es,nullable:ea,default:er.getDefault(et),type:er.type,oneOf:er._whitelist.describe(),notOneOf:er._blacklist.describe(),tests:er.tests.map(et=>({name:et.OPTIONS.name,params:et.OPTIONS.params})).filter((et,er,en)=>en.findIndex(er=>er.name===et.name)===er)};return eo}}for(let et of(eG.prototype.__isYupSchema__=!0,["validate","validateSync"]))eG.prototype[`${et}At`]=function(er,en,ei={}){let{parent:es,parentPath:ea,schema:eo}=eU(this,er,en,ei.context);return eo[et](es&&es[ea],Object.assign({},ei,{parent:es,path:er}))};for(let et of["equals","is"])eG.prototype[et]=eG.prototype.oneOf;for(let et of["not","nope"])eG.prototype[et]=eG.prototype.notOneOf;let eK=()=>!0;function eH(et){return new eW(et)}class eW extends eG{constructor(et){super("function"==typeof et?{type:"mixed",check:et}:Object.assign({type:"mixed",check:eK},et))}}function eQ(){return new eY}eH.prototype=eW.prototype;class eY extends eG{constructor(){super({type:"boolean",check:et=>(et instanceof Boolean&&(et=et.valueOf()),"boolean"==typeof et)}),this.withMutation(()=>{this.transform((et,er,en)=>{if(en.spec.coerce&&!en.isType(et)){if(/^(true|1)$/i.test(String(et)))return!0;if(/^(false|0)$/i.test(String(et)))return!1}return et})})}isTrue(et=ex.isValue){return this.test({message:et,name:"is-value",exclusive:!0,params:{value:"true"},test:et=>eB(et)||!0===et})}isFalse(et=ex.isValue){return this.test({message:et,name:"is-value",exclusive:!0,params:{value:"false"},test:et=>eB(et)||!1===et})}default(et){return super.default(et)}defined(et){return super.defined(et)}optional(){return super.optional()}required(et){return super.required(et)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(et){return super.nonNullable(et)}strip(et){return super.strip(et)}}eQ.prototype=eY.prototype;let eJ=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function eX(et){let er=eZ(et);if(!er)return Date.parse?Date.parse(et):Number.NaN;if(void 0===er.z&&void 0===er.plusMinus)return new Date(er.year,er.month,er.day,er.hour,er.minute,er.second,er.millisecond).valueOf();let en=0;return"Z"!==er.z&&void 0!==er.plusMinus&&(en=60*er.hourOffset+er.minuteOffset,"+"===er.plusMinus&&(en=0-en)),Date.UTC(er.year,er.month,er.day,er.hour,er.minute+en,er.second,er.millisecond)}function eZ(et){var er,en;let ei=eJ.exec(et);return ei?{year:e0(ei[1]),month:e0(ei[2],1)-1,day:e0(ei[3],1),hour:e0(ei[4]),minute:e0(ei[5]),second:e0(ei[6]),millisecond:ei[7]?e0(ei[7].substring(0,3)):0,precision:null!=(er=null==(en=ei[7])?void 0:en.length)?er:void 0,z:ei[8]||void 0,plusMinus:ei[9]||void 0,hourOffset:e0(ei[10]),minuteOffset:e0(ei[11])}:null}function e0(et,er=0){return Number(et)||er}let e1=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,e2=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,e3=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,e6=RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"),e9=et=>eB(et)||et===et.trim(),e4=({}).toString();function e5(){return new e8}class e8 extends eG{constructor(){super({type:"string",check:et=>(et instanceof String&&(et=et.valueOf()),"string"==typeof et)}),this.withMutation(()=>{this.transform((et,er,en)=>{if(!en.spec.coerce||en.isType(et)||Array.isArray(et))return et;let ei=null!=et&&et.toString?et.toString():et;return ei===e4?et:ei})})}required(et){return super.required(et).withMutation(er=>er.test({message:et||eC.required,name:"required",skipAbsent:!0,test:et=>!!et.length}))}notRequired(){return super.notRequired().withMutation(et=>(et.tests=et.tests.filter(et=>"required"!==et.OPTIONS.name),et))}length(et,er=e_.length){return this.test({message:er,name:"length",exclusive:!0,params:{length:et},skipAbsent:!0,test(er){return er.length===this.resolve(et)}})}min(et,er=e_.min){return this.test({message:er,name:"min",exclusive:!0,params:{min:et},skipAbsent:!0,test(er){return er.length>=this.resolve(et)}})}max(et,er=e_.max){return this.test({name:"max",exclusive:!0,message:er,params:{max:et},skipAbsent:!0,test(er){return er.length<=this.resolve(et)}})}matches(et,er){let en,ei,es=!1;return er&&("object"==typeof er?{excludeEmptyString:es=!1,message:en,name:ei}=er:en=er),this.test({name:ei||"matches",message:en||e_.matches,params:{regex:et},skipAbsent:!0,test:er=>""===er&&es||-1!==er.search(et)})}email(et=e_.email){return this.matches(e1,{name:"email",message:et,excludeEmptyString:!0})}url(et=e_.url){return this.matches(e2,{name:"url",message:et,excludeEmptyString:!0})}uuid(et=e_.uuid){return this.matches(e3,{name:"uuid",message:et,excludeEmptyString:!1})}datetime(et){let er,en,ei="";return et&&("object"==typeof et?{message:ei="",allowOffset:er=!1,precision:en}=et:ei=et),this.matches(e6,{name:"datetime",message:ei||e_.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:ei||e_.datetime_offset,params:{allowOffset:er},skipAbsent:!0,test:et=>{if(!et||er)return!0;let en=eZ(et);return!!en&&!!en.z}}).test({name:"datetime_precision",message:ei||e_.datetime_precision,params:{precision:en},skipAbsent:!0,test:et=>{if(!et||void 0==en)return!0;let er=eZ(et);return!!er&&er.precision===en}})}ensure(){return this.default("").transform(et=>null===et?"":et)}trim(et=e_.trim){return this.transform(et=>null!=et?et.trim():et).test({message:et,name:"trim",test:e9})}lowercase(et=e_.lowercase){return this.transform(et=>eB(et)?et:et.toLowerCase()).test({message:et,name:"string_case",exclusive:!0,skipAbsent:!0,test:et=>eB(et)||et===et.toLowerCase()})}uppercase(et=e_.uppercase){return this.transform(et=>eB(et)?et:et.toUpperCase()).test({message:et,name:"string_case",exclusive:!0,skipAbsent:!0,test:et=>eB(et)||et===et.toUpperCase()})}}e5.prototype=e8.prototype;let e7=et=>et!=+et;function tt(){return new tr}class tr extends eG{constructor(){super({type:"number",check:et=>(et instanceof Number&&(et=et.valueOf()),"number"==typeof et&&!e7(et))}),this.withMutation(()=>{this.transform((et,er,en)=>{if(!en.spec.coerce)return et;let ei=et;if("string"==typeof ei){if(""===(ei=ei.replace(/\s/g,"")))return NaN;ei=+ei}return en.isType(ei)||null===ei?ei:parseFloat(ei)})})}min(et,er=eI.min){return this.test({message:er,name:"min",exclusive:!0,params:{min:et},skipAbsent:!0,test(er){return er>=this.resolve(et)}})}max(et,er=eI.max){return this.test({message:er,name:"max",exclusive:!0,params:{max:et},skipAbsent:!0,test(er){return er<=this.resolve(et)}})}lessThan(et,er=eI.lessThan){return this.test({message:er,name:"max",exclusive:!0,params:{less:et},skipAbsent:!0,test(er){return er<this.resolve(et)}})}moreThan(et,er=eI.moreThan){return this.test({message:er,name:"min",exclusive:!0,params:{more:et},skipAbsent:!0,test(er){return er>this.resolve(et)}})}positive(et=eI.positive){return this.moreThan(0,et)}negative(et=eI.negative){return this.lessThan(0,et)}integer(et=eI.integer){return this.test({name:"integer",message:et,skipAbsent:!0,test:et=>Number.isInteger(et)})}truncate(){return this.transform(et=>eB(et)?et:0|et)}round(et){var er;let en=["ceil","floor","round","trunc"];if("trunc"===(et=(null==(er=et)?void 0:er.toLowerCase())||"round"))return this.truncate();if(-1===en.indexOf(et.toLowerCase()))throw TypeError("Only valid options for round() are: "+en.join(", "));return this.transform(er=>eB(er)?er:Math[et](er))}}tt.prototype=tr.prototype;let ti=new Date(""),ts=et=>"[object Date]"===Object.prototype.toString.call(et);function ta(){return new tl}class tl extends eG{constructor(){super({type:"date",check:et=>ts(et)&&!isNaN(et.getTime())}),this.withMutation(()=>{this.transform((et,er,en)=>!en.spec.coerce||en.isType(et)||null===et?et:isNaN(et=eX(et))?tl.INVALID_DATE:new Date(et))})}prepareParam(et,er){let en;if(eF.isRef(et))en=et;else{let ei=this.cast(et);if(!this._typeCheck(ei))throw TypeError(`\`${er}\` must be a Date or a value that can be \`cast()\` to a Date`);en=ei}return en}min(et,er=ek.min){let en=this.prepareParam(et,"min");return this.test({message:er,name:"min",exclusive:!0,params:{min:et},skipAbsent:!0,test(et){return et>=this.resolve(en)}})}max(et,er=ek.max){let en=this.prepareParam(et,"max");return this.test({message:er,name:"max",exclusive:!0,params:{max:et},skipAbsent:!0,test(et){return et<=this.resolve(en)}})}}function tu(et,er=[]){let en=[],ei=new Set,es=new Set(er.map(([et,er])=>`${et}-${er}`));function ea(et,er){let ea=eu.split(et)[0];ei.add(ea),es.has(`${er}-${ea}`)||en.push([er,ea])}for(let er of Object.keys(et)){let en=et[er];ei.add(er),eF.isRef(en)&&en.isSibling?ea(en.path,er):eN(en)&&"deps"in en&&en.deps.forEach(et=>ea(et,er))}return eh.default.array(Array.from(ei),en).reverse()}function tc(et,er){let en=1/0;return et.some((et,ei)=>{var es;if(null!=(es=er.path)&&es.includes(et))return en=ei,!0}),en}function th(et){return(er,en)=>tc(et,er)-tc(et,en)}tl.INVALID_DATE=ti,ta.prototype=tl.prototype,ta.INVALID_DATE=ti;let td=(et,er,en)=>{if("string"!=typeof et)return et;let ei=et;try{ei=JSON.parse(et)}catch(et){}return en.isType(ei)?ei:et};function tp(et){if("fields"in et){let er={};for(let[en,ei]of Object.entries(et.fields))er[en]=tp(ei);return et.setFields(er)}if("array"===et.type){let er=et.optional();return er.innerType&&(er.innerType=tp(er.innerType)),er}return"tuple"===et.type?et.optional().clone({types:et.spec.types.map(tp)}):"optional"in et?et.optional():et}let tf=(et,er)=>{let en=[...eu.normalizePath(er)];if(1===en.length)return en[0]in et;let ei=en.pop(),es=eu.getter(eu.join(en),!0)(et);return!!(es&&ei in es)},tm=et=>"[object Object]"===Object.prototype.toString.call(et);function tg(et,er){let en=Object.keys(et.fields);return Object.keys(er).filter(et=>-1===en.indexOf(et))}let ty=th([]);function tv(et){return new tb(et)}class tb extends eG{constructor(et){super({type:"object",check:et=>tm(et)||"function"==typeof et}),this.fields=Object.create(null),this._sortErrors=ty,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{et&&this.shape(et)})}_cast(et,er={}){var en;let ei=super._cast(et,er);if(void 0===ei)return this.getDefault(er);if(!this._typeCheck(ei))return ei;let es=this.fields,ea=null!=(en=er.stripUnknown)?en:this.spec.noUnknown,eo=[].concat(this._nodes,Object.keys(ei).filter(et=>!this._nodes.includes(et))),eu={},ec=Object.assign({},er,{parent:eu,__validating:er.__validating||!1}),eh=!1;for(let et of eo){let en=es[et],eo=et in ei;if(en){let es;let ea=ei[et];ec.path=(er.path?`${er.path}.`:"")+et;let eo=(en=en.resolve({value:ea,context:er.context,parent:eu}))instanceof eG?en.spec:void 0,ed=null==eo?void 0:eo.strict;if(null!=eo&&eo.strip){eh=eh||et in ei;continue}void 0!==(es=er.__validating&&ed?ei[et]:en.cast(ei[et],ec))&&(eu[et]=es)}else eo&&!ea&&(eu[et]=ei[et]);(eo!==et in eu||eu[et]!==ei[et])&&(eh=!0)}return eh?eu:ei}_validate(et,er={},en,ei){let{from:es=[],originalValue:ea=et,recursive:eo=this.spec.recursive}=er;er.from=[{schema:this,value:ea},...es],er.__validating=!0,er.originalValue=ea,super._validate(et,er,en,(et,es)=>{if(!eo||!tm(es)){ei(et,es);return}ea=ea||es;let eu=[];for(let et of this._nodes){let en=this.fields[et];!en||eF.isRef(en)||eu.push(en.asNestedTest({options:er,key:et,parent:es,parentPath:er.path,originalParent:ea}))}this.runTests({tests:eu,value:es,originalValue:ea,options:er},en,er=>{ei(er.sort(this._sortErrors).concat(et),es)})})}clone(et){let er=super.clone(et);return er.fields=Object.assign({},this.fields),er._nodes=this._nodes,er._excludedEdges=this._excludedEdges,er._sortErrors=this._sortErrors,er}concat(et){let er=super.concat(et),en=er.fields;for(let[et,er]of Object.entries(this.fields)){let ei=en[et];en[et]=void 0===ei?er:ei}return er.withMutation(er=>er.setFields(en,[...this._excludedEdges,...et._excludedEdges]))}_getDefault(et){if("default"in this.spec)return super._getDefault(et);if(!this._nodes.length)return;let er={};return this._nodes.forEach(en=>{var ei;let es=this.fields[en],ea=et;null!=(ei=ea)&&ei.value&&(ea=Object.assign({},ea,{parent:ea.value,value:ea.value[en]})),er[en]=es&&"getDefault"in es?es.getDefault(ea):void 0}),er}setFields(et,er){let en=this.clone();return en.fields=et,en._nodes=tu(et,er),en._sortErrors=th(Object.keys(et)),er&&(en._excludedEdges=er),en}shape(et,er=[]){return this.clone().withMutation(en=>{let ei=en._excludedEdges;return er.length&&(Array.isArray(er[0])||(er=[er]),ei=[...en._excludedEdges,...er]),en.setFields(Object.assign(en.fields,et),ei)})}partial(){let et={};for(let[er,en]of Object.entries(this.fields))et[er]="optional"in en&&en.optional instanceof Function?en.optional():en;return this.setFields(et)}deepPartial(){let et=tp(this);return et}pick(et){let er={};for(let en of et)this.fields[en]&&(er[en]=this.fields[en]);return this.setFields(er,this._excludedEdges.filter(([er,en])=>et.includes(er)&&et.includes(en)))}omit(et){let er=[];for(let en of Object.keys(this.fields))et.includes(en)||er.push(en);return this.pick(er)}from(et,er,en){let ei=eu.getter(et,!0);return this.transform(es=>{if(!es)return es;let ea=es;return tf(es,et)&&(ea=Object.assign({},es),en||delete ea[et],ea[er]=ei(es)),ea})}json(){return this.transform(td)}exact(et){return this.test({name:"exact",exclusive:!0,message:et||eA.exact,test(et){if(null==et)return!0;let er=tg(this.schema,et);return 0===er.length||this.createError({params:{properties:er.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(et=!0,er=eA.noUnknown){"boolean"!=typeof et&&(er=et,et=!0);let en=this.test({name:"noUnknown",exclusive:!0,message:er,test(er){if(null==er)return!0;let en=tg(this.schema,er);return!et||0===en.length||this.createError({params:{unknown:en.join(", ")}})}});return en.spec.noUnknown=et,en}unknown(et=!0,er=eA.noUnknown){return this.noUnknown(!et,er)}transformKeys(et){return this.transform(er=>{if(!er)return er;let en={};for(let ei of Object.keys(er))en[et(ei)]=er[ei];return en})}camelCase(){return this.transformKeys(ec.camelCase)}snakeCase(){return this.transformKeys(ec.snakeCase)}constantCase(){return this.transformKeys(et=>ec.snakeCase(et).toUpperCase())}describe(et){let er=(et?this.resolve(et):this).clone(),en=super.describe(et);for(let[es,ea]of(en.fields={},Object.entries(er.fields))){var ei;let er=et;null!=(ei=er)&&ei.value&&(er=Object.assign({},er,{parent:er.value,value:er.value[es]})),en.fields[es]=ea.describe(er)}return en}}function tS(et){return new tT(et)}tv.prototype=tb.prototype;class tT extends eG{constructor(et){super({type:"array",spec:{types:et},check:et=>Array.isArray(et)}),this.innerType=void 0,this.innerType=et}_cast(et,er){let en=super._cast(et,er);if(!this._typeCheck(en)||!this.innerType)return en;let ei=!1,es=en.map((et,en)=>{let es=this.innerType.cast(et,Object.assign({},er,{path:`${er.path||""}[${en}]`}));return es!==et&&(ei=!0),es});return ei?es:en}_validate(et,er={},en,ei){var es;let ea=this.innerType,eo=null!=(es=er.recursive)?es:this.spec.recursive;null!=er.originalValue&&er.originalValue,super._validate(et,er,en,(es,eu)=>{var ec,eh;if(!eo||!ea||!this._typeCheck(eu)){ei(es,eu);return}let ed=Array(eu.length);for(let en=0;en<eu.length;en++)ed[en]=ea.asNestedTest({options:er,index:en,parent:eu,parentPath:er.path,originalParent:null!=(eh=er.originalValue)?eh:et});this.runTests({value:eu,tests:ed,originalValue:null!=(ec=er.originalValue)?ec:et,options:er},en,et=>ei(et.concat(es),eu))})}clone(et){let er=super.clone(et);return er.innerType=this.innerType,er}json(){return this.transform(td)}concat(et){let er=super.concat(et);return er.innerType=this.innerType,et.innerType&&(er.innerType=er.innerType?er.innerType.concat(et.innerType):et.innerType),er}of(et){let er=this.clone();if(!eN(et))throw TypeError("`array.of()` sub-schema must be a valid yup schema not: "+eb(et));return er.innerType=et,er.spec=Object.assign({},er.spec,{types:et}),er}length(et,er=eR.length){return this.test({message:er,name:"length",exclusive:!0,params:{length:et},skipAbsent:!0,test(er){return er.length===this.resolve(et)}})}min(et,er){return er=er||eR.min,this.test({message:er,name:"min",exclusive:!0,params:{min:et},skipAbsent:!0,test(er){return er.length>=this.resolve(et)}})}max(et,er){return er=er||eR.max,this.test({message:er,name:"max",exclusive:!0,params:{max:et},skipAbsent:!0,test(er){return er.length<=this.resolve(et)}})}ensure(){return this.default(()=>[]).transform((et,er)=>this._typeCheck(et)?et:null==er?[]:[].concat(er))}compact(et){let er=et?(er,en,ei)=>!et(er,en,ei):et=>!!et;return this.transform(et=>null!=et?et.filter(er):et)}describe(et){let er=(et?this.resolve(et):this).clone(),en=super.describe(et);if(er.innerType){var ei;let es=et;null!=(ei=es)&&ei.value&&(es=Object.assign({},es,{parent:es.value,value:es.value[0]})),en.innerType=er.innerType.describe(es)}return en}}function tw(et){return new tE(et)}tS.prototype=tT.prototype;class tE extends eG{constructor(et){super({type:"tuple",spec:{types:et},check(et){let er=this.spec.types;return Array.isArray(et)&&et.length===er.length}}),this.withMutation(()=>{this.typeError(eD.notType)})}_cast(et,er){let{types:en}=this.spec,ei=super._cast(et,er);if(!this._typeCheck(ei))return ei;let es=!1,ea=en.map((et,en)=>{let ea=et.cast(ei[en],Object.assign({},er,{path:`${er.path||""}[${en}]`}));return ea!==ei[en]&&(es=!0),ea});return es?ea:ei}_validate(et,er={},en,ei){let es=this.spec.types;super._validate(et,er,en,(ea,eo)=>{var eu,ec;if(!this._typeCheck(eo)){ei(ea,eo);return}let eh=[];for(let[en,ei]of es.entries())eh[en]=ei.asNestedTest({options:er,index:en,parent:eo,parentPath:er.path,originalParent:null!=(ec=er.originalValue)?ec:et});this.runTests({value:eo,tests:eh,originalValue:null!=(eu=er.originalValue)?eu:et,options:er},en,et=>ei(et.concat(ea),eo))})}describe(et){let er=(et?this.resolve(et):this).clone(),en=super.describe(et);return en.innerType=er.spec.types.map((er,en)=>{var ei;let es=et;return null!=(ei=es)&&ei.value&&(es=Object.assign({},es,{parent:es.value,value:es.value[en]})),er.describe(es)}),en}}function tC(et){return new tI(et)}function t_(et){try{return et()}catch(et){if(eE.isError(et))return Promise.reject(et);throw et}}tw.prototype=tE.prototype;class tI{constructor(et){this.type="lazy",this.__isYupSchema__=!0,this.spec=void 0,this._resolve=(et,er={})=>{let en=this.builder(et,er);if(!eN(en))throw TypeError("lazy() functions must return a valid schema");return this.spec.optional&&(en=en.optional()),en.resolve(er)},this.builder=et,this.spec={meta:void 0,optional:!1}}clone(et){let er=new tI(this.builder);return er.spec=Object.assign({},this.spec,et),er}optionality(et){let er=this.clone({optional:et});return er}optional(){return this.optionality(!0)}resolve(et){return this._resolve(et.value,et)}cast(et,er){return this._resolve(et,er).cast(et,er)}asNestedTest(et){let{key:er,index:en,parent:ei,options:es}=et,ea=ei[null!=en?en:er];return this._resolve(ea,Object.assign({},es,{value:ea,parent:ei})).asNestedTest(et)}validate(et,er){return t_(()=>this._resolve(et,er).validate(et,er))}validateSync(et,er){return this._resolve(et,er).validateSync(et,er)}validateAt(et,er,en){return t_(()=>this._resolve(er,en).validateAt(et,er,en))}validateSyncAt(et,er,en){return this._resolve(er,en).validateSyncAt(et,er,en)}isValid(et,er){try{return this._resolve(et,er).isValid(et,er)}catch(et){if(eE.isError(et))return Promise.resolve(!1);throw et}}isValidSync(et,er){return this._resolve(et,er).isValidSync(et,er)}describe(et){return et?this.resolve(et).describe(et):{type:"lazy",meta:this.spec.meta,label:void 0}}meta(...et){if(0===et.length)return this.spec.meta;let er=this.clone();return er.spec.meta=Object.assign(er.spec.meta||{},et[0]),er}}function tk(et){Object.keys(et).forEach(er=>{Object.keys(et[er]).forEach(en=>{eO[er][en]=et[er][en]})})}function tA(et,er,en){if(!et||!eN(et.prototype))throw TypeError("You must provide a yup schema constructor function");if("string"!=typeof er)throw TypeError("A Method name must be provided");if("function"!=typeof en)throw TypeError("Method function must be provided");et.prototype[er]=en}eo=tT,eo=eY,eo=tl,eo=tI,eo=eW,eo=tr,eo=tb,eo=eG,eo=e8,eo=tE,eo=eE,eo=tA,eo=tS,eo=eQ,eo=eQ,eo=ta,eo=eO,eo=eU,eo=eN,eo=tC,eo=eH,eo=tt,er.Ry=tv,eo=eb,eo=eV,eo=eL,eo=tk,er.Z_=e5,eo=tw},16933:(et,er)=>{var en,ei=function(et){"use strict";Object.defineProperty(et,"__esModule",{value:!0}),et.default=void 0;/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */var er=null;try{er=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(et){}function en(et,er,en){this.low=0|et,this.high=0|er,this.unsigned=!!en}function ei(et){return!0===(et&&et.__isLong__)}function es(et){var er=Math.clz32(et&-et);return et?31-er:er}en.prototype.__isLong__,Object.defineProperty(en.prototype,"__isLong__",{value:!0}),en.isLong=ei;var ea={},eo={};function eu(et,er){var en,ei,es;return er?(et>>>=0,(es=0<=et&&et<256)&&(ei=eo[et]))?ei:(en=eh(et,0,!0),es&&(eo[et]=en),en):(et|=0,(es=-128<=et&&et<128)&&(ei=ea[et]))?ei:(en=eh(et,et<0?-1:0,!1),es&&(ea[et]=en),en)}function ec(et,er){if(isNaN(et))return er?eS:eb;if(er){if(et<0)return eS;if(et>=eg)return e_}else{if(et<=-ey)return eI;if(et+1>=ey)return eC}return et<0?ec(-et,er).neg():eh(et%em|0,et/em|0,er)}function eh(et,er,ei){return new en(et,er,ei)}en.fromInt=eu,en.fromNumber=ec,en.fromBits=eh;var ed=Math.pow;function ep(et,er,en){if(0===et.length)throw Error("empty string");if("number"==typeof er?(en=er,er=!1):er=!!er,"NaN"===et||"Infinity"===et||"+Infinity"===et||"-Infinity"===et)return er?eS:eb;if((en=en||10)<2||36<en)throw RangeError("radix");if((ei=et.indexOf("-"))>0)throw Error("interior hyphen");if(0===ei)return ep(et.substring(1),er,en).neg();for(var ei,es=ec(ed(en,8)),ea=eb,eo=0;eo<et.length;eo+=8){var eu=Math.min(8,et.length-eo),eh=parseInt(et.substring(eo,eo+eu),en);if(eu<8){var ef=ec(ed(en,eu));ea=ea.mul(ef).add(ec(eh))}else ea=(ea=ea.mul(es)).add(ec(eh))}return ea.unsigned=er,ea}function ef(et,er){return"number"==typeof et?ec(et,er):"string"==typeof et?ep(et,er):eh(et.low,et.high,"boolean"==typeof er?er:et.unsigned)}en.fromString=ep,en.fromValue=ef;var em=4294967296,eg=18446744073709552e3,ey=0x7fffffffffffffff,ev=eu(16777216),eb=eu(0);en.ZERO=eb;var eS=eu(0,!0);en.UZERO=eS;var eT=eu(1);en.ONE=eT;var ew=eu(1,!0);en.UONE=ew;var eE=eu(-1);en.NEG_ONE=eE;var eC=eh(-1,2147483647,!1);en.MAX_VALUE=eC;var e_=eh(-1,-1,!0);en.MAX_UNSIGNED_VALUE=e_;var eI=eh(0,-2147483648,!1);en.MIN_VALUE=eI;var ek=en.prototype;ek.toInt=function(){return this.unsigned?this.low>>>0:this.low},ek.toNumber=function(){return this.unsigned?(this.high>>>0)*em+(this.low>>>0):this.high*em+(this.low>>>0)},ek.toString=function(et){if((et=et||10)<2||36<et)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(eI))return"-"+this.neg().toString(et);var er=ec(et),en=this.div(er),ei=en.mul(er).sub(this);return en.toString(et)+ei.toInt().toString(et)}for(var es=ec(ed(et,6),this.unsigned),ea=this,eo="";;){var eu=ea.div(es),eh=(ea.sub(eu.mul(es)).toInt()>>>0).toString(et);if((ea=eu).isZero())return eh+eo;for(;eh.length<6;)eh="0"+eh;eo=""+eh+eo}},ek.getHighBits=function(){return this.high},ek.getHighBitsUnsigned=function(){return this.high>>>0},ek.getLowBits=function(){return this.low},ek.getLowBitsUnsigned=function(){return this.low>>>0},ek.getNumBitsAbs=function(){if(this.isNegative())return this.eq(eI)?64:this.neg().getNumBitsAbs();for(var et=0!=this.high?this.high:this.low,er=31;er>0&&(et&1<<er)==0;er--);return 0!=this.high?er+33:er+1},ek.isZero=function(){return 0===this.high&&0===this.low},ek.eqz=ek.isZero,ek.isNegative=function(){return!this.unsigned&&this.high<0},ek.isPositive=function(){return this.unsigned||this.high>=0},ek.isOdd=function(){return(1&this.low)==1},ek.isEven=function(){return(1&this.low)==0},ek.equals=function(et){return ei(et)||(et=ef(et)),(this.unsigned===et.unsigned||this.high>>>31!=1||et.high>>>31!=1)&&this.high===et.high&&this.low===et.low},ek.eq=ek.equals,ek.notEquals=function(et){return!this.eq(et)},ek.neq=ek.notEquals,ek.ne=ek.notEquals,ek.lessThan=function(et){return 0>this.comp(et)},ek.lt=ek.lessThan,ek.lessThanOrEqual=function(et){return 0>=this.comp(et)},ek.lte=ek.lessThanOrEqual,ek.le=ek.lessThanOrEqual,ek.greaterThan=function(et){return this.comp(et)>0},ek.gt=ek.greaterThan,ek.greaterThanOrEqual=function(et){return this.comp(et)>=0},ek.gte=ek.greaterThanOrEqual,ek.ge=ek.greaterThanOrEqual,ek.compare=function(et){if(ei(et)||(et=ef(et)),this.eq(et))return 0;var er=this.isNegative(),en=et.isNegative();return er&&!en?-1:!er&&en?1:this.unsigned?et.high>>>0>this.high>>>0||et.high===this.high&&et.low>>>0>this.low>>>0?-1:1:this.sub(et).isNegative()?-1:1},ek.comp=ek.compare,ek.negate=function(){return!this.unsigned&&this.eq(eI)?eI:this.not().add(eT)},ek.neg=ek.negate,ek.add=function(et){ei(et)||(et=ef(et));var er,en,es=this.high>>>16,ea=65535&this.high,eo=this.low>>>16,eu=65535&this.low,ec=et.high>>>16,ed=65535&et.high,ep=et.low>>>16,em=65535&et.low,eg=0,ey=0;return er=0+((en=0+(eu+em))>>>16),en&=65535,er+=eo+ep,ey+=er>>>16,er&=65535,ey+=ea+ed,eg+=ey>>>16,ey&=65535,eg+=es+ec,eh(er<<16|en,(eg&=65535)<<16|ey,this.unsigned)},ek.subtract=function(et){return ei(et)||(et=ef(et)),this.add(et.neg())},ek.sub=ek.subtract,ek.multiply=function(et){if(this.isZero())return this;if(ei(et)||(et=ef(et)),er)return eh(er.mul(this.low,this.high,et.low,et.high),er.get_high(),this.unsigned);if(et.isZero())return this.unsigned?eS:eb;if(this.eq(eI))return et.isOdd()?eI:eb;if(et.eq(eI))return this.isOdd()?eI:eb;if(this.isNegative())return et.isNegative()?this.neg().mul(et.neg()):this.neg().mul(et).neg();if(et.isNegative())return this.mul(et.neg()).neg();if(this.lt(ev)&&et.lt(ev))return ec(this.toNumber()*et.toNumber(),this.unsigned);var en,es,ea=this.high>>>16,eo=65535&this.high,eu=this.low>>>16,ed=65535&this.low,ep=et.high>>>16,em=65535&et.high,eg=et.low>>>16,ey=65535&et.low,eT=0,ew=0;return en=0+((es=0+ed*ey)>>>16),es&=65535,en+=eu*ey,ew+=en>>>16,en&=65535,en+=ed*eg,ew+=en>>>16,en&=65535,ew+=eo*ey,eT+=ew>>>16,ew&=65535,ew+=eu*eg,eT+=ew>>>16,ew&=65535,ew+=ed*em,eT+=ew>>>16,ew&=65535,eT+=ea*ey+eo*eg+eu*em+ed*ep,eh(en<<16|es,(eT&=65535)<<16|ew,this.unsigned)},ek.mul=ek.multiply,ek.divide=function(et){if(ei(et)||(et=ef(et)),et.isZero())throw Error("division by zero");if(er){var en,es,ea;return this.unsigned||-2147483648!==this.high||-1!==et.low||-1!==et.high?eh((this.unsigned?er.div_u:er.div_s)(this.low,this.high,et.low,et.high),er.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?eS:eb;if(this.unsigned){if(et.unsigned||(et=et.toUnsigned()),et.gt(this))return eS;if(et.gt(this.shru(1)))return ew;ea=eS}else{if(this.eq(eI))return et.eq(eT)||et.eq(eE)?eI:et.eq(eI)?eT:(en=this.shr(1).div(et).shl(1)).eq(eb)?et.isNegative()?eT:eE:(es=this.sub(et.mul(en)),ea=en.add(es.div(et)));if(et.eq(eI))return this.unsigned?eS:eb;if(this.isNegative())return et.isNegative()?this.neg().div(et.neg()):this.neg().div(et).neg();if(et.isNegative())return this.div(et.neg()).neg();ea=eb}for(es=this;es.gte(et);){for(var eo=Math.ceil(Math.log(en=Math.max(1,Math.floor(es.toNumber()/et.toNumber())))/Math.LN2),eu=eo<=48?1:ed(2,eo-48),ep=ec(en),em=ep.mul(et);em.isNegative()||em.gt(es);)en-=eu,em=(ep=ec(en,this.unsigned)).mul(et);ep.isZero()&&(ep=eT),ea=ea.add(ep),es=es.sub(em)}return ea},ek.div=ek.divide,ek.modulo=function(et){return(ei(et)||(et=ef(et)),er)?eh((this.unsigned?er.rem_u:er.rem_s)(this.low,this.high,et.low,et.high),er.get_high(),this.unsigned):this.sub(this.div(et).mul(et))},ek.mod=ek.modulo,ek.rem=ek.modulo,ek.not=function(){return eh(~this.low,~this.high,this.unsigned)},ek.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},ek.clz=ek.countLeadingZeros,ek.countTrailingZeros=function(){return this.low?es(this.low):es(this.high)+32},ek.ctz=ek.countTrailingZeros,ek.and=function(et){return ei(et)||(et=ef(et)),eh(this.low&et.low,this.high&et.high,this.unsigned)},ek.or=function(et){return ei(et)||(et=ef(et)),eh(this.low|et.low,this.high|et.high,this.unsigned)},ek.xor=function(et){return ei(et)||(et=ef(et)),eh(this.low^et.low,this.high^et.high,this.unsigned)},ek.shiftLeft=function(et){return(ei(et)&&(et=et.toInt()),0==(et&=63))?this:et<32?eh(this.low<<et,this.high<<et|this.low>>>32-et,this.unsigned):eh(0,this.low<<et-32,this.unsigned)},ek.shl=ek.shiftLeft,ek.shiftRight=function(et){return(ei(et)&&(et=et.toInt()),0==(et&=63))?this:et<32?eh(this.low>>>et|this.high<<32-et,this.high>>et,this.unsigned):eh(this.high>>et-32,this.high>=0?0:-1,this.unsigned)},ek.shr=ek.shiftRight,ek.shiftRightUnsigned=function(et){return(ei(et)&&(et=et.toInt()),0==(et&=63))?this:et<32?eh(this.low>>>et|this.high<<32-et,this.high>>>et,this.unsigned):32===et?eh(this.high,0,this.unsigned):eh(this.high>>>et-32,0,this.unsigned)},ek.shru=ek.shiftRightUnsigned,ek.shr_u=ek.shiftRightUnsigned,ek.rotateLeft=function(et){var er;return(ei(et)&&(et=et.toInt()),0==(et&=63))?this:32===et?eh(this.high,this.low,this.unsigned):et<32?(er=32-et,eh(this.low<<et|this.high>>>er,this.high<<et|this.low>>>er,this.unsigned)):(et-=32,er=32-et,eh(this.high<<et|this.low>>>er,this.low<<et|this.high>>>er,this.unsigned))},ek.rotl=ek.rotateLeft,ek.rotateRight=function(et){var er;return(ei(et)&&(et=et.toInt()),0==(et&=63))?this:32===et?eh(this.high,this.low,this.unsigned):et<32?(er=32-et,eh(this.high<<er|this.low>>>et,this.low<<er|this.high>>>et,this.unsigned)):(et-=32,er=32-et,eh(this.low<<er|this.high>>>et,this.high<<er|this.low>>>et,this.unsigned))},ek.rotr=ek.rotateRight,ek.toSigned=function(){return this.unsigned?eh(this.low,this.high,!1):this},ek.toUnsigned=function(){return this.unsigned?this:eh(this.low,this.high,!0)},ek.toBytes=function(et){return et?this.toBytesLE():this.toBytesBE()},ek.toBytesLE=function(){var et=this.high,er=this.low;return[255&er,er>>>8&255,er>>>16&255,er>>>24,255&et,et>>>8&255,et>>>16&255,et>>>24]},ek.toBytesBE=function(){var et=this.high,er=this.low;return[et>>>24,et>>>16&255,et>>>8&255,255&et,er>>>24,er>>>16&255,er>>>8&255,255&er]},en.fromBytes=function(et,er,ei){return ei?en.fromBytesLE(et,er):en.fromBytesBE(et,er)},en.fromBytesLE=function(et,er){return new en(et[0]|et[1]<<8|et[2]<<16|et[3]<<24,et[4]|et[5]<<8|et[6]<<16|et[7]<<24,er)},en.fromBytesBE=function(et,er){return new en(et[4]<<24|et[5]<<16|et[6]<<8|et[7],et[0]<<24|et[1]<<16|et[2]<<8|et[3],er)};var ex=en;return et.default=ex,"default"in et?et.default:et}({});void 0!==(en=(function(){return ei}).apply(er,[]))&&(et.exports=en)},55087:(et,er,en)=>{"use strict";let ei,es;en.d(er,{Jn:()=>tf,qX:()=>tc,Xd:()=>tu,Mq:()=>tg,ZF:()=>tm,KN:()=>ty});var ea=en(77345),eo=en(9292),eu=en(51780);let ec=(et,er)=>er.some(er=>et instanceof er);function eh(){return ei||(ei=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ed(){return es||(es=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let ep=new WeakMap,ef=new WeakMap,em=new WeakMap,eg=new WeakMap,ey=new WeakMap;function ev(et){let er=new Promise((er,en)=>{let ei=()=>{et.removeEventListener("success",es),et.removeEventListener("error",ea)},es=()=>{er(eC(et.result)),ei()},ea=()=>{en(et.error),ei()};et.addEventListener("success",es),et.addEventListener("error",ea)});return er.then(er=>{er instanceof IDBCursor&&ep.set(er,et)}).catch(()=>{}),ey.set(er,et),er}function eb(et){if(ef.has(et))return;let er=new Promise((er,en)=>{let ei=()=>{et.removeEventListener("complete",es),et.removeEventListener("error",ea),et.removeEventListener("abort",ea)},es=()=>{er(),ei()},ea=()=>{en(et.error||new DOMException("AbortError","AbortError")),ei()};et.addEventListener("complete",es),et.addEventListener("error",ea),et.addEventListener("abort",ea)});ef.set(et,er)}let eS={get(et,er,en){if(et instanceof IDBTransaction){if("done"===er)return ef.get(et);if("objectStoreNames"===er)return et.objectStoreNames||em.get(et);if("store"===er)return en.objectStoreNames[1]?void 0:en.objectStore(en.objectStoreNames[0])}return eC(et[er])},set:(et,er,en)=>(et[er]=en,!0),has:(et,er)=>et instanceof IDBTransaction&&("done"===er||"store"===er)||er in et};function eT(et){eS=et(eS)}function ew(et){return et!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?ed().includes(et)?function(...er){return et.apply(e_(this),er),eC(ep.get(this))}:function(...er){return eC(et.apply(e_(this),er))}:function(er,...en){let ei=et.call(e_(this),er,...en);return em.set(ei,er.sort?er.sort():[er]),eC(ei)}}function eE(et){return"function"==typeof et?ew(et):(et instanceof IDBTransaction&&eb(et),ec(et,eh()))?new Proxy(et,eS):et}function eC(et){if(et instanceof IDBRequest)return ev(et);if(eg.has(et))return eg.get(et);let er=eE(et);return er!==et&&(eg.set(et,er),ey.set(er,et)),er}let e_=et=>ey.get(et);function eI(et,er,{blocked:en,upgrade:ei,blocking:es,terminated:ea}={}){let eo=indexedDB.open(et,er),eu=eC(eo);return ei&&eo.addEventListener("upgradeneeded",et=>{ei(eC(eo.result),et.oldVersion,et.newVersion,eC(eo.transaction),et)}),en&&eo.addEventListener("blocked",et=>en(et.oldVersion,et.newVersion,et)),eu.then(et=>{ea&&et.addEventListener("close",()=>ea()),es&&et.addEventListener("versionchange",et=>es(et.oldVersion,et.newVersion,et))}).catch(()=>{}),eu}let ek=["get","getKey","getAll","getAllKeys","count"],ex=["put","add","delete","clear"],eA=new Map;function eR(et,er){if(!(et instanceof IDBDatabase&&!(er in et)&&"string"==typeof er))return;if(eA.get(er))return eA.get(er);let en=er.replace(/FromIndex$/,""),ei=er!==en,es=ex.includes(en);if(!(en in(ei?IDBIndex:IDBObjectStore).prototype)||!(es||ek.includes(en)))return;let ea=async function(et,...er){let ea=this.transaction(et,es?"readwrite":"readonly"),eo=ea.store;return ei&&(eo=eo.index(er.shift())),(await Promise.all([eo[en](...er),es&&ea.done]))[0]};return eA.set(er,ea),ea}eT(et=>({...et,get:(er,en,ei)=>eR(er,en)||et.get(er,en,ei),has:(er,en)=>!!eR(er,en)||et.has(er,en)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(et){this.container=et}getPlatformInfoString(){let et=this.container.getProviders();return et.map(et=>{if(!eO(et))return null;{let er=et.getImmediate();return`${er.library}/${er.version}`}}).filter(et=>et).join(" ")}}function eO(et){let er=et.getComponent();return(null==er?void 0:er.type)==="VERSION"}let eN="@firebase/app",eM="0.10.18",eP=new eo.Yd("@firebase/app"),eL="@firebase/app-compat",eF="@firebase/analytics-compat",eB="@firebase/analytics",ej="@firebase/app-check-compat",eU="@firebase/app-check",eV="@firebase/auth",ez="@firebase/auth-compat",e$="@firebase/database",eG="@firebase/data-connect",eK="@firebase/database-compat",eH="@firebase/functions",eW="@firebase/functions-compat",eQ="@firebase/installations",eY="@firebase/installations-compat",eJ="@firebase/messaging",eX="@firebase/messaging-compat",eZ="@firebase/performance",e0="@firebase/performance-compat",e1="@firebase/remote-config",e2="@firebase/remote-config-compat",e3="@firebase/storage",e6="@firebase/storage-compat",e9="@firebase/firestore",e4="@firebase/vertexai",e5="@firebase/firestore-compat",e8="firebase",e7="11.2.0",tt="[DEFAULT]",tr={[eN]:"fire-core",[eL]:"fire-core-compat",[eB]:"fire-analytics",[eF]:"fire-analytics-compat",[eU]:"fire-app-check",[ej]:"fire-app-check-compat",[eV]:"fire-auth",[ez]:"fire-auth-compat",[e$]:"fire-rtdb",[eG]:"fire-data-connect",[eK]:"fire-rtdb-compat",[eH]:"fire-fn",[eW]:"fire-fn-compat",[eQ]:"fire-iid",[eY]:"fire-iid-compat",[eJ]:"fire-fcm",[eX]:"fire-fcm-compat",[eZ]:"fire-perf",[e0]:"fire-perf-compat",[e1]:"fire-rc",[e2]:"fire-rc-compat",[e3]:"fire-gcs",[e6]:"fire-gcs-compat",[e9]:"fire-fst",[e5]:"fire-fst-compat",[e4]:"fire-vertex","fire-js":"fire-js",[e8]:"fire-js-all"},ti=new Map,ts=new Map,ta=new Map;function tl(et,er){try{et.container.addComponent(er)}catch(en){eP.debug(`Component ${er.name} failed to register with FirebaseApp ${et.name}`,en)}}function tu(et){let er=et.name;if(ta.has(er))return eP.debug(`There were multiple attempts to register component ${er}.`),!1;for(let en of(ta.set(er,et),ti.values()))tl(en,et);for(let er of ts.values())tl(er,et);return!0}function tc(et,er){let en=et.container.getProvider("heartbeat").getImmediate({optional:!0});return en&&en.triggerHeartbeat(),et.container.getProvider(er)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},td=new eu.LL("app","Firebase",th);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(et,er,en){this._isDeleted=!1,this._options=Object.assign({},et),this._config=Object.assign({},er),this._name=er.name,this._automaticDataCollectionEnabled=er.automaticDataCollectionEnabled,this._container=en,this.container.addComponent(new ea.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(et){this.checkDestroyed(),this._automaticDataCollectionEnabled=et}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(et){this._isDeleted=et}checkDestroyed(){if(this.isDeleted)throw td.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf=e7;function tm(et,er={}){let en=et;if("object"!=typeof er){let et=er;er={name:et}}let ei=Object.assign({name:tt,automaticDataCollectionEnabled:!1},er),es=ei.name;if("string"!=typeof es||!es)throw td.create("bad-app-name",{appName:String(es)});if(en||(en=(0,eu.aH)()),!en)throw td.create("no-options");let eo=ti.get(es);if(eo){if((0,eu.vZ)(en,eo.options)&&(0,eu.vZ)(ei,eo.config))return eo;throw td.create("duplicate-app",{appName:es})}let ec=new ea.H0(es);for(let et of ta.values())ec.addComponent(et);let eh=new tp(en,ei,ec);return ti.set(es,eh),eh}function tg(et=tt){let er=ti.get(et);if(!er&&et===tt&&(0,eu.aH)())return tm();if(!er)throw td.create("no-app",{appName:et});return er}function ty(et,er,en){var ei;let es=null!==(ei=tr[et])&&void 0!==ei?ei:et;en&&(es+=`-${en}`);let eo=es.match(/\s|\//),eu=er.match(/\s|\//);if(eo||eu){let et=[`Unable to register library "${es}" with version "${er}":`];eo&&et.push(`library name "${es}" contains illegal characters (whitespace or "/")`),eo&&eu&&et.push("and"),eu&&et.push(`version name "${er}" contains illegal characters (whitespace or "/")`),eP.warn(et.join(" "));return}tu(new ea.wA(`${es}-version`,()=>({library:es,version:er}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tv="firebase-heartbeat-database",tb=1,tS="firebase-heartbeat-store",tT=null;function tw(){return tT||(tT=eI(tv,tb,{upgrade:(et,er)=>{if(0===er)try{et.createObjectStore(tS)}catch(et){console.warn(et)}}}).catch(et=>{throw td.create("idb-open",{originalErrorMessage:et.message})})),tT}async function tE(et){try{let er=await tw(),en=er.transaction(tS),ei=await en.objectStore(tS).get(t_(et));return await en.done,ei}catch(et){if(et instanceof eu.ZR)eP.warn(et.message);else{let er=td.create("idb-get",{originalErrorMessage:null==et?void 0:et.message});eP.warn(er.message)}}}async function tC(et,er){try{let en=await tw(),ei=en.transaction(tS,"readwrite"),es=ei.objectStore(tS);await es.put(er,t_(et)),await ei.done}catch(et){if(et instanceof eu.ZR)eP.warn(et.message);else{let er=td.create("idb-set",{originalErrorMessage:null==et?void 0:et.message});eP.warn(er.message)}}}function t_(et){return`${et.name}!${et.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tI=1024,tk=2592e6;class tA{constructor(et){this.container=et,this._heartbeatsCache=null;let er=this.container.getProvider("app").getImmediate();this._storage=new tO(er),this._heartbeatsCachePromise=this._storage.read().then(et=>(this._heartbeatsCache=et,et))}async triggerHeartbeat(){var et,er;try{let en=this.container.getProvider("platform-logger").getImmediate(),ei=en.getPlatformInfoString(),es=tR();if((null===(et=this._heartbeatsCache)||void 0===et?void 0:et.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null===(er=this._heartbeatsCache)||void 0===er?void 0:er.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===es||this._heartbeatsCache.heartbeats.some(et=>et.date===es))return;return this._heartbeatsCache.heartbeats.push({date:es,agent:ei}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(et=>{let er=new Date(et.date).valueOf(),en=Date.now();return en-er<=tk}),this._storage.overwrite(this._heartbeatsCache)}catch(et){eP.warn(et)}}async getHeartbeatsHeader(){var et;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null===(et=this._heartbeatsCache)||void 0===et?void 0:et.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let er=tR(),{heartbeatsToSend:en,unsentEntries:ei}=tD(this._heartbeatsCache.heartbeats),es=(0,eu.L)(JSON.stringify({version:2,heartbeats:en}));return this._heartbeatsCache.lastSentHeartbeatDate=er,ei.length>0?(this._heartbeatsCache.heartbeats=ei,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),es}catch(et){return eP.warn(et),""}}}function tR(){let et=new Date;return et.toISOString().substring(0,10)}function tD(et,er=tI){let en=[],ei=et.slice();for(let es of et){let et=en.find(et=>et.agent===es.agent);if(et){if(et.dates.push(es.date),tN(en)>er){et.dates.pop();break}}else if(en.push({agent:es.agent,dates:[es.date]}),tN(en)>er){en.pop();break}ei=ei.slice(1)}return{heartbeatsToSend:en,unsentEntries:ei}}class tO{constructor(et){this.app=et,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,eu.hl)()&&(0,eu.eu)().then(()=>!0).catch(()=>!1)}async read(){let et=await this._canUseIndexedDBPromise;if(!et)return{heartbeats:[]};{let et=await tE(this.app);return(null==et?void 0:et.heartbeats)?et:{heartbeats:[]}}}async overwrite(et){var er;let en=await this._canUseIndexedDBPromise;if(en){let en=await this.read();return tC(this.app,{lastSentHeartbeatDate:null!==(er=et.lastSentHeartbeatDate)&&void 0!==er?er:en.lastSentHeartbeatDate,heartbeats:et.heartbeats})}}async add(et){var er;let en=await this._canUseIndexedDBPromise;if(en){let en=await this.read();return tC(this.app,{lastSentHeartbeatDate:null!==(er=et.lastSentHeartbeatDate)&&void 0!==er?er:en.lastSentHeartbeatDate,heartbeats:[...en.heartbeats,...et.heartbeats]})}}}function tN(et){return(0,eu.L)(JSON.stringify({version:2,heartbeats:et})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(et){tu(new ea.wA("platform-logger",et=>new eD(et),"PRIVATE")),tu(new ea.wA("heartbeat",et=>new tA(et),"PRIVATE")),ty(eN,eM,""),ty(eN,eM,"esm2017"),ty("fire-js","")})(0)},77345:(et,er,en)=>{"use strict";en.d(er,{H0:()=>eh,wA:()=>es});var ei=en(51780);class es{constructor(et,er,en){this.name=et,this.instanceFactory=er,this.type=en,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(et){return this.instantiationMode=et,this}setMultipleInstances(et){return this.multipleInstances=et,this}setServiceProps(et){return this.serviceProps=et,this}setInstanceCreatedCallback(et){return this.onInstanceCreated=et,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(et,er){this.name=et,this.container=er,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(et){let er=this.normalizeInstanceIdentifier(et);if(!this.instancesDeferred.has(er)){let et=new ei.BH;if(this.instancesDeferred.set(er,et),this.isInitialized(er)||this.shouldAutoInitialize())try{let en=this.getOrInitializeService({instanceIdentifier:er});en&&et.resolve(en)}catch(et){}}return this.instancesDeferred.get(er).promise}getImmediate(et){var er;let en=this.normalizeInstanceIdentifier(null==et?void 0:et.identifier),ei=null!==(er=null==et?void 0:et.optional)&&void 0!==er&&er;if(this.isInitialized(en)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:en})}catch(et){if(ei)return null;throw et}else{if(ei)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(et){if(et.name!==this.name)throw Error(`Mismatching Component ${et.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=et,this.shouldAutoInitialize()){if(ec(et))try{this.getOrInitializeService({instanceIdentifier:ea})}catch(et){}for(let[et,er]of this.instancesDeferred.entries()){let en=this.normalizeInstanceIdentifier(et);try{let et=this.getOrInitializeService({instanceIdentifier:en});er.resolve(et)}catch(et){}}}}clearInstance(et=ea){this.instancesDeferred.delete(et),this.instancesOptions.delete(et),this.instances.delete(et)}async delete(){let et=Array.from(this.instances.values());await Promise.all([...et.filter(et=>"INTERNAL"in et).map(et=>et.INTERNAL.delete()),...et.filter(et=>"_delete"in et).map(et=>et._delete())])}isComponentSet(){return null!=this.component}isInitialized(et=ea){return this.instances.has(et)}getOptions(et=ea){return this.instancesOptions.get(et)||{}}initialize(et={}){let{options:er={}}=et,en=this.normalizeInstanceIdentifier(et.instanceIdentifier);if(this.isInitialized(en))throw Error(`${this.name}(${en}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let ei=this.getOrInitializeService({instanceIdentifier:en,options:er});for(let[et,er]of this.instancesDeferred.entries()){let es=this.normalizeInstanceIdentifier(et);en===es&&er.resolve(ei)}return ei}onInit(et,er){var en;let ei=this.normalizeInstanceIdentifier(er),es=null!==(en=this.onInitCallbacks.get(ei))&&void 0!==en?en:new Set;es.add(et),this.onInitCallbacks.set(ei,es);let ea=this.instances.get(ei);return ea&&et(ea,ei),()=>{es.delete(et)}}invokeOnInitCallbacks(et,er){let en=this.onInitCallbacks.get(er);if(en)for(let ei of en)try{ei(et,er)}catch(et){}}getOrInitializeService({instanceIdentifier:et,options:er={}}){let en=this.instances.get(et);if(!en&&this.component&&(en=this.component.instanceFactory(this.container,{instanceIdentifier:eu(et),options:er}),this.instances.set(et,en),this.instancesOptions.set(et,er),this.invokeOnInitCallbacks(en,et),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,et,en)}catch(et){}return en||null}normalizeInstanceIdentifier(et=ea){return this.component?this.component.multipleInstances?et:ea:et}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function eu(et){return et===ea?void 0:et}function ec(et){return"EAGER"===et.instantiationMode}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(et){this.name=et,this.providers=new Map}addComponent(et){let er=this.getProvider(et.name);if(er.isComponentSet())throw Error(`Component ${et.name} has already been registered with ${this.name}`);er.setComponent(et)}addOrOverwriteComponent(et){let er=this.getProvider(et.name);er.isComponentSet()&&this.providers.delete(et.name),this.addComponent(et)}getProvider(et){if(this.providers.has(et))return this.providers.get(et);let er=new eo(et,this);return this.providers.set(et,er),er}getProviders(){return Array.from(this.providers.values())}}},9292:(et,er,en)=>{"use strict";var ei;en.d(er,{Yd:()=>eh,in:()=>ei});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let es=[];!function(et){et[et.DEBUG=0]="DEBUG",et[et.VERBOSE=1]="VERBOSE",et[et.INFO=2]="INFO",et[et.WARN=3]="WARN",et[et.ERROR=4]="ERROR",et[et.SILENT=5]="SILENT"}(ei||(ei={}));let ea={debug:ei.DEBUG,verbose:ei.VERBOSE,info:ei.INFO,warn:ei.WARN,error:ei.ERROR,silent:ei.SILENT},eo=ei.INFO,eu={[ei.DEBUG]:"log",[ei.VERBOSE]:"log",[ei.INFO]:"info",[ei.WARN]:"warn",[ei.ERROR]:"error"},ec=(et,er,...en)=>{if(er<et.logLevel)return;let ei=new Date().toISOString(),es=eu[er];if(es)console[es](`[${ei}]  ${et.name}:`,...en);else throw Error(`Attempted to log a message with an invalid logType (value: ${er})`)};class eh{constructor(et){this.name=et,this._logLevel=eo,this._logHandler=ec,this._userLogHandler=null,es.push(this)}get logLevel(){return this._logLevel}set logLevel(et){if(!(et in ei))throw TypeError(`Invalid value "${et}" assigned to \`logLevel\``);this._logLevel=et}setLogLevel(et){this._logLevel="string"==typeof et?ea[et]:et}get logHandler(){return this._logHandler}set logHandler(et){if("function"!=typeof et)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=et}get userLogHandler(){return this._userLogHandler}set userLogHandler(et){this._userLogHandler=et}debug(...et){this._userLogHandler&&this._userLogHandler(this,ei.DEBUG,...et),this._logHandler(this,ei.DEBUG,...et)}log(...et){this._userLogHandler&&this._userLogHandler(this,ei.VERBOSE,...et),this._logHandler(this,ei.VERBOSE,...et)}info(...et){this._userLogHandler&&this._userLogHandler(this,ei.INFO,...et),this._logHandler(this,ei.INFO,...et)}warn(...et){this._userLogHandler&&this._userLogHandler(this,ei.WARN,...et),this._logHandler(this,ei.WARN,...et)}error(...et){this._userLogHandler&&this._userLogHandler(this,ei.ERROR,...et),this._logHandler(this,ei.ERROR,...et)}}},51780:(et,er,en)=>{"use strict";en.d(er,{BH:()=>eT,G6:()=>e_,L:()=>eh,LL:()=>eR,P0:()=>eb,Sg:()=>ew,ZR:()=>eA,aH:()=>eS,eu:()=>ek,hl:()=>eI,m9:()=>eP,vZ:()=>eN,z$:()=>eE});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ei={NODE_CLIENT:!1},es=function(et){let er=[],en=0;for(let ei=0;ei<et.length;ei++){let es=et.charCodeAt(ei);es<128?er[en++]=es:(es<2048?er[en++]=es>>6|192:((64512&es)==55296&&ei+1<et.length&&(64512&et.charCodeAt(ei+1))==56320?(es=65536+((1023&es)<<10)+(1023&et.charCodeAt(++ei)),er[en++]=es>>18|240,er[en++]=es>>12&63|128):er[en++]=es>>12|224,er[en++]=es>>6&63|128),er[en++]=63&es|128)}return er},ea=function(et){let er=[],en=0,ei=0;for(;en<et.length;){let es=et[en++];if(es<128)er[ei++]=String.fromCharCode(es);else if(es>191&&es<224){let ea=et[en++];er[ei++]=String.fromCharCode((31&es)<<6|63&ea)}else if(es>239&&es<365){let ea=et[en++],eo=et[en++],eu=et[en++],ec=((7&es)<<18|(63&ea)<<12|(63&eo)<<6|63&eu)-65536;er[ei++]=String.fromCharCode(55296+(ec>>10)),er[ei++]=String.fromCharCode(56320+(1023&ec))}else{let ea=et[en++],eo=et[en++];er[ei++]=String.fromCharCode((15&es)<<12|(63&ea)<<6|63&eo)}}return er.join("")},eo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(et,er){if(!Array.isArray(et))throw Error("encodeByteArray takes an array as a parameter");this.init_();let en=er?this.byteToCharMapWebSafe_:this.byteToCharMap_,ei=[];for(let er=0;er<et.length;er+=3){let es=et[er],ea=er+1<et.length,eo=ea?et[er+1]:0,eu=er+2<et.length,ec=eu?et[er+2]:0,eh=es>>2,ed=(3&es)<<4|eo>>4,ep=(15&eo)<<2|ec>>6,ef=63&ec;eu||(ef=64,ea||(ep=64)),ei.push(en[eh],en[ed],en[ep],en[ef])}return ei.join("")},encodeString(et,er){return this.HAS_NATIVE_SUPPORT&&!er?btoa(et):this.encodeByteArray(es(et),er)},decodeString(et,er){return this.HAS_NATIVE_SUPPORT&&!er?atob(et):ea(this.decodeStringToByteArray(et,er))},decodeStringToByteArray(et,er){this.init_();let en=er?this.charToByteMapWebSafe_:this.charToByteMap_,ei=[];for(let er=0;er<et.length;){let es=en[et.charAt(er++)],ea=er<et.length,eo=ea?en[et.charAt(er)]:0;++er;let ec=er<et.length,eh=ec?en[et.charAt(er)]:64;++er;let ed=er<et.length,ep=ed?en[et.charAt(er)]:64;if(++er,null==es||null==eo||null==eh||null==ep)throw new eu;let ef=es<<2|eo>>4;if(ei.push(ef),64!==eh){let et=eo<<4&240|eh>>2;if(ei.push(et),64!==ep){let et=eh<<6&192|ep;ei.push(et)}}}return ei},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let et=0;et<this.ENCODED_VALS.length;et++)this.byteToCharMap_[et]=this.ENCODED_VALS.charAt(et),this.charToByteMap_[this.byteToCharMap_[et]]=et,this.byteToCharMapWebSafe_[et]=this.ENCODED_VALS_WEBSAFE.charAt(et),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[et]]=et,et>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(et)]=et,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(et)]=et)}}};class eu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let ec=function(et){let er=es(et);return eo.encodeByteArray(er,!0)},eh=function(et){return ec(et).replace(/\./g,"")},ed=function(et){try{return eo.decodeString(et,!0)}catch(et){console.error("base64Decode failed: ",et)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ef=()=>ep().__FIREBASE_DEFAULTS__,em=()=>{if("undefined"==typeof process||void 0===process.env)return;let et=process.env.__FIREBASE_DEFAULTS__;if(et)return JSON.parse(et)},eg=()=>{let et;if("undefined"==typeof document)return;try{et=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(et){return}let er=et&&ed(et[1]);return er&&JSON.parse(er)},ey=()=>{try{return ef()||em()||eg()}catch(et){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${et}`);return}},ev=et=>{var er,en;return null===(en=null===(er=ey())||void 0===er?void 0:er.emulatorHosts)||void 0===en?void 0:en[et]},eb=et=>{let er=ev(et);if(!er)return;let en=er.lastIndexOf(":");if(en<=0||en+1===er.length)throw Error(`Invalid host ${er} with no separate hostname and port!`);let ei=parseInt(er.substring(en+1),10);return"["===er[0]?[er.substring(1,en-1),ei]:[er.substring(0,en),ei]},eS=()=>{var et;return null===(et=ey())||void 0===et?void 0:et.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((et,er)=>{this.resolve=et,this.reject=er})}wrapCallback(et){return(er,en)=>{er?this.reject(er):this.resolve(en),"function"==typeof et&&(this.promise.catch(()=>{}),1===et.length?et(er):et(er,en))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(et,er){if(et.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let en={alg:"none",type:"JWT"},ei=er||"demo-project",es=et.iat||0,ea=et.sub||et.user_id;if(!ea)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let eo=Object.assign({iss:`https://securetoken.google.com/${ei}`,aud:ei,iat:es,exp:es+3600,auth_time:es,sub:ea,user_id:ea,firebase:{sign_in_provider:"custom",identities:{}}},et),eu="";return[eh(JSON.stringify(en)),eh(JSON.stringify(eo)),eu].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function eC(){var et;let er=null===(et=ey())||void 0===et?void 0:et.forceEnvironment;if("node"===er)return!0;if("browser"===er)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(et){return!1}}function e_(){return!eC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eI(){try{return"object"==typeof indexedDB}catch(et){return!1}}function ek(){return new Promise((et,er)=>{try{let en=!0,ei="validate-browser-context-for-indexeddb-analytics-module",es=self.indexedDB.open(ei);es.onsuccess=()=>{es.result.close(),en||self.indexedDB.deleteDatabase(ei),et(!0)},es.onupgradeneeded=()=>{en=!1},es.onerror=()=>{var et;er((null===(et=es.error)||void 0===et?void 0:et.message)||"")}}catch(et){er(et)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ex="FirebaseError";class eA extends Error{constructor(et,er,en){super(er),this.code=et,this.customData=en,this.name=ex,Object.setPrototypeOf(this,eA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eR.prototype.create)}}class eR{constructor(et,er,en){this.service=et,this.serviceName=er,this.errors=en}create(et,...er){let en=er[0]||{},ei=`${this.service}/${et}`,es=this.errors[et],ea=es?eD(es,en):"Error",eo=`${this.serviceName}: ${ea} (${ei}).`,eu=new eA(ei,eo,en);return eu}}function eD(et,er){return et.replace(eO,(et,en)=>{let ei=er[en];return null!=ei?String(ei):`<${en}?>`})}let eO=/\{\$([^}]+)}/g;function eN(et,er){if(et===er)return!0;let en=Object.keys(et),ei=Object.keys(er);for(let es of en){if(!ei.includes(es))return!1;let en=et[es],ea=er[es];if(eM(en)&&eM(ea)){if(!eN(en,ea))return!1}else if(en!==ea)return!1}for(let et of ei)if(!en.includes(et))return!1;return!0}function eM(et){return null!==et&&"object"==typeof et}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(et){return et&&et._delegate?et._delegate:et}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ei.NODE_CLIENT=!0},72856:(et,er,en)=>{"use strict";en.d(er,{ZF:()=>ei.ZF});var ei=en(55087),es="firebase",ea="11.2.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(0,ei.KN)(es,ea,"app")},29904:(et,er,en)=>{"use strict";en.d(er,{ET:()=>g5,hJ:()=>m1,ad:()=>m5});var ei,es,ea,eo,eu=en(55087),ec=en(77345),eh=en(9292),ed=en(73837),ep=en(51780),ef=en(6113),em="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},eg={};(function(){function et(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function er(et,er,en){en||(en=0);var ei=Array(16);if("string"==typeof er)for(var es=0;16>es;++es)ei[es]=er.charCodeAt(en++)|er.charCodeAt(en++)<<8|er.charCodeAt(en++)<<16|er.charCodeAt(en++)<<24;else for(es=0;16>es;++es)ei[es]=er[en++]|er[en++]<<8|er[en++]<<16|er[en++]<<24;er=et.g[0],en=et.g[1],es=et.g[2];var ea=et.g[3],eo=er+(ea^en&(es^ea))+ei[0]+3614090360&4294967295;eo=ea+(es^(er=en+(eo<<7&4294967295|eo>>>25))&(en^es))+ei[1]+3905402710&4294967295,eo=es+(en^(ea=er+(eo<<12&4294967295|eo>>>20))&(er^en))+ei[2]+606105819&4294967295,eo=en+(er^(es=ea+(eo<<17&4294967295|eo>>>15))&(ea^er))+ei[3]+3250441966&4294967295,eo=er+(ea^(en=es+(eo<<22&4294967295|eo>>>10))&(es^ea))+ei[4]+4118548399&4294967295,eo=ea+(es^(er=en+(eo<<7&4294967295|eo>>>25))&(en^es))+ei[5]+1200080426&4294967295,eo=es+(en^(ea=er+(eo<<12&4294967295|eo>>>20))&(er^en))+ei[6]+2821735955&4294967295,eo=en+(er^(es=ea+(eo<<17&4294967295|eo>>>15))&(ea^er))+ei[7]+4249261313&4294967295,eo=er+(ea^(en=es+(eo<<22&4294967295|eo>>>10))&(es^ea))+ei[8]+1770035416&4294967295,eo=ea+(es^(er=en+(eo<<7&4294967295|eo>>>25))&(en^es))+ei[9]+2336552879&4294967295,eo=es+(en^(ea=er+(eo<<12&4294967295|eo>>>20))&(er^en))+ei[10]+4294925233&4294967295,eo=en+(er^(es=ea+(eo<<17&4294967295|eo>>>15))&(ea^er))+ei[11]+2304563134&4294967295,eo=er+(ea^(en=es+(eo<<22&4294967295|eo>>>10))&(es^ea))+ei[12]+1804603682&4294967295,eo=ea+(es^(er=en+(eo<<7&4294967295|eo>>>25))&(en^es))+ei[13]+4254626195&4294967295,eo=es+(en^(ea=er+(eo<<12&4294967295|eo>>>20))&(er^en))+ei[14]+2792965006&4294967295,eo=en+(er^(es=ea+(eo<<17&4294967295|eo>>>15))&(ea^er))+ei[15]+1236535329&4294967295,en=es+(eo<<22&4294967295|eo>>>10),eo=er+(es^ea&(en^es))+ei[1]+4129170786&4294967295,er=en+(eo<<5&4294967295|eo>>>27),eo=ea+(en^es&(er^en))+ei[6]+3225465664&4294967295,ea=er+(eo<<9&4294967295|eo>>>23),eo=es+(er^en&(ea^er))+ei[11]+643717713&4294967295,es=ea+(eo<<14&4294967295|eo>>>18),eo=en+(ea^er&(es^ea))+ei[0]+3921069994&4294967295,en=es+(eo<<20&4294967295|eo>>>12),eo=er+(es^ea&(en^es))+ei[5]+3593408605&4294967295,er=en+(eo<<5&4294967295|eo>>>27),eo=ea+(en^es&(er^en))+ei[10]+38016083&4294967295,ea=er+(eo<<9&4294967295|eo>>>23),eo=es+(er^en&(ea^er))+ei[15]+3634488961&4294967295,es=ea+(eo<<14&4294967295|eo>>>18),eo=en+(ea^er&(es^ea))+ei[4]+3889429448&4294967295,en=es+(eo<<20&4294967295|eo>>>12),eo=er+(es^ea&(en^es))+ei[9]+568446438&4294967295,er=en+(eo<<5&4294967295|eo>>>27),eo=ea+(en^es&(er^en))+ei[14]+3275163606&4294967295,ea=er+(eo<<9&4294967295|eo>>>23),eo=es+(er^en&(ea^er))+ei[3]+4107603335&4294967295,es=ea+(eo<<14&4294967295|eo>>>18),eo=en+(ea^er&(es^ea))+ei[8]+1163531501&4294967295,en=es+(eo<<20&4294967295|eo>>>12),eo=er+(es^ea&(en^es))+ei[13]+2850285829&4294967295,er=en+(eo<<5&4294967295|eo>>>27),eo=ea+(en^es&(er^en))+ei[2]+4243563512&4294967295,ea=er+(eo<<9&4294967295|eo>>>23),eo=es+(er^en&(ea^er))+ei[7]+1735328473&4294967295,es=ea+(eo<<14&4294967295|eo>>>18),eo=en+(ea^er&(es^ea))+ei[12]+2368359562&4294967295,eo=er+((en=es+(eo<<20&4294967295|eo>>>12))^es^ea)+ei[5]+4294588738&4294967295,eo=ea+((er=en+(eo<<4&4294967295|eo>>>28))^en^es)+ei[8]+2272392833&4294967295,eo=es+((ea=er+(eo<<11&4294967295|eo>>>21))^er^en)+ei[11]+1839030562&4294967295,eo=en+((es=ea+(eo<<16&4294967295|eo>>>16))^ea^er)+ei[14]+4259657740&4294967295,eo=er+((en=es+(eo<<23&4294967295|eo>>>9))^es^ea)+ei[1]+2763975236&4294967295,eo=ea+((er=en+(eo<<4&4294967295|eo>>>28))^en^es)+ei[4]+1272893353&4294967295,eo=es+((ea=er+(eo<<11&4294967295|eo>>>21))^er^en)+ei[7]+4139469664&4294967295,eo=en+((es=ea+(eo<<16&4294967295|eo>>>16))^ea^er)+ei[10]+3200236656&4294967295,eo=er+((en=es+(eo<<23&4294967295|eo>>>9))^es^ea)+ei[13]+681279174&4294967295,eo=ea+((er=en+(eo<<4&4294967295|eo>>>28))^en^es)+ei[0]+3936430074&4294967295,eo=es+((ea=er+(eo<<11&4294967295|eo>>>21))^er^en)+ei[3]+3572445317&4294967295,eo=en+((es=ea+(eo<<16&4294967295|eo>>>16))^ea^er)+ei[6]+76029189&4294967295,eo=er+((en=es+(eo<<23&4294967295|eo>>>9))^es^ea)+ei[9]+3654602809&4294967295,eo=ea+((er=en+(eo<<4&4294967295|eo>>>28))^en^es)+ei[12]+3873151461&4294967295,eo=es+((ea=er+(eo<<11&4294967295|eo>>>21))^er^en)+ei[15]+530742520&4294967295,eo=en+((es=ea+(eo<<16&4294967295|eo>>>16))^ea^er)+ei[2]+3299628645&4294967295,en=es+(eo<<23&4294967295|eo>>>9),eo=er+(es^(en|~ea))+ei[0]+4096336452&4294967295,er=en+(eo<<6&4294967295|eo>>>26),eo=ea+(en^(er|~es))+ei[7]+1126891415&4294967295,ea=er+(eo<<10&4294967295|eo>>>22),eo=es+(er^(ea|~en))+ei[14]+2878612391&4294967295,es=ea+(eo<<15&4294967295|eo>>>17),eo=en+(ea^(es|~er))+ei[5]+4237533241&4294967295,en=es+(eo<<21&4294967295|eo>>>11),eo=er+(es^(en|~ea))+ei[12]+1700485571&4294967295,er=en+(eo<<6&4294967295|eo>>>26),eo=ea+(en^(er|~es))+ei[3]+2399980690&4294967295,ea=er+(eo<<10&4294967295|eo>>>22),eo=es+(er^(ea|~en))+ei[10]+4293915773&4294967295,es=ea+(eo<<15&4294967295|eo>>>17),eo=en+(ea^(es|~er))+ei[1]+2240044497&4294967295,en=es+(eo<<21&4294967295|eo>>>11),eo=er+(es^(en|~ea))+ei[8]+1873313359&4294967295,er=en+(eo<<6&4294967295|eo>>>26),eo=ea+(en^(er|~es))+ei[15]+4264355552&4294967295,ea=er+(eo<<10&4294967295|eo>>>22),eo=es+(er^(ea|~en))+ei[6]+2734768916&4294967295,es=ea+(eo<<15&4294967295|eo>>>17),eo=en+(ea^(es|~er))+ei[13]+1309151649&4294967295,en=es+(eo<<21&4294967295|eo>>>11),eo=er+(es^(en|~ea))+ei[4]+4149444226&4294967295,er=en+(eo<<6&4294967295|eo>>>26),eo=ea+(en^(er|~es))+ei[11]+3174756917&4294967295,ea=er+(eo<<10&4294967295|eo>>>22),eo=es+(er^(ea|~en))+ei[2]+718787259&4294967295,es=ea+(eo<<15&4294967295|eo>>>17),eo=en+(ea^(es|~er))+ei[9]+3951481745&4294967295,et.g[0]=et.g[0]+er&4294967295,et.g[1]=et.g[1]+(es+(eo<<21&4294967295|eo>>>11))&4294967295,et.g[2]=et.g[2]+es&4294967295,et.g[3]=et.g[3]+ea&4294967295}function en(et,er){var en=eu;return Object.prototype.hasOwnProperty.call(en,et)?en[et]:en[et]=er(et)}function ea(et,er){this.h=er;for(var en=[],ei=!0,es=et.length-1;0<=es;es--){var ea=0|et[es];ei&&ea==er||(en[es]=ea,ei=!1)}this.g=en}(function(et,er){function en(){}en.prototype=er.prototype,et.D=er.prototype,et.prototype=new en,et.prototype.constructor=et,et.C=function(et,en,ei){for(var es=Array(arguments.length-2),ea=2;ea<arguments.length;ea++)es[ea-2]=arguments[ea];return er.prototype[en].apply(et,es)}})(et,function(){this.blockSize=-1}),et.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},et.prototype.u=function(et,en){void 0===en&&(en=et.length);for(var ei=en-this.blockSize,es=this.B,ea=this.h,eo=0;eo<en;){if(0==ea)for(;eo<=ei;)er(this,et,eo),eo+=this.blockSize;if("string"==typeof et){for(;eo<en;)if(es[ea++]=et.charCodeAt(eo++),ea==this.blockSize){er(this,es),ea=0;break}}else for(;eo<en;)if(es[ea++]=et[eo++],ea==this.blockSize){er(this,es),ea=0;break}}this.h=ea,this.o+=en},et.prototype.v=function(){var et=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);et[0]=128;for(var er=1;er<et.length-8;++er)et[er]=0;var en=8*this.o;for(er=et.length-8;er<et.length;++er)et[er]=255&en,en/=256;for(this.u(et),et=Array(16),er=en=0;4>er;++er)for(var ei=0;32>ei;ei+=8)et[en++]=this.g[er]>>>ei&255;return et};var eo,eu={};function ec(et){return -128<=et&&128>et?en(et,function(et){return new ea([0|et],0>et?-1:0)}):new ea([0|et],0>et?-1:0)}function eh(et){if(isNaN(et)||!isFinite(et))return ep;if(0>et)return eb(eh(-et));for(var er=[],en=1,ei=0;et>=en;ei++)er[ei]=et/en|0,en*=4294967296;return new ea(er,0)}function ed(et,er){if(0==et.length)throw Error("number format error: empty string");if(2>(er=er||10)||36<er)throw Error("radix out of range: "+er);if("-"==et.charAt(0))return eb(ed(et.substring(1),er));if(0<=et.indexOf("-"))throw Error('number format error: interior "-" character');for(var en=eh(Math.pow(er,8)),ei=ep,es=0;es<et.length;es+=8){var ea=Math.min(8,et.length-es),eo=parseInt(et.substring(es,es+ea),er);8>ea?(ea=eh(Math.pow(er,ea)),ei=ei.j(ea).add(eh(eo))):ei=(ei=ei.j(en)).add(eh(eo))}return ei}var ep=ec(0),ef=ec(1),em=ec(16777216);function ey(et){if(0!=et.h)return!1;for(var er=0;er<et.g.length;er++)if(0!=et.g[er])return!1;return!0}function ev(et){return -1==et.h}function eb(et){for(var er=et.g.length,en=[],ei=0;ei<er;ei++)en[ei]=~et.g[ei];return new ea(en,~et.h).add(ef)}function eS(et,er){return et.add(eb(er))}function eT(et,er){for(;(65535&et[er])!=et[er];)et[er+1]+=et[er]>>>16,et[er]&=65535,er++}function ew(et,er){this.g=et,this.h=er}function eE(et,er){if(ey(er))throw Error("division by zero");if(ey(et))return new ew(ep,ep);if(ev(et))return er=eE(eb(et),er),new ew(eb(er.g),eb(er.h));if(ev(er))return er=eE(et,eb(er)),new ew(eb(er.g),er.h);if(30<et.g.length){if(ev(et)||ev(er))throw Error("slowDivide_ only works with positive integers.");for(var en=ef,ei=er;0>=ei.l(et);)en=eC(en),ei=eC(ei);var es=e_(en,1),ea=e_(ei,1);for(ei=e_(ei,2),en=e_(en,2);!ey(ei);){var eo=ea.add(ei);0>=eo.l(et)&&(es=es.add(en),ea=eo),ei=e_(ei,1),en=e_(en,1)}return er=eS(et,es.j(er)),new ew(es,er)}for(es=ep;0<=et.l(er);){for(ei=48>=(ei=Math.ceil(Math.log(en=Math.max(1,Math.floor(et.m()/er.m())))/Math.LN2))?1:Math.pow(2,ei-48),eo=(ea=eh(en)).j(er);ev(eo)||0<eo.l(et);)en-=ei,eo=(ea=eh(en)).j(er);ey(ea)&&(ea=ef),es=es.add(ea),et=eS(et,eo)}return new ew(es,et)}function eC(et){for(var er=et.g.length+1,en=[],ei=0;ei<er;ei++)en[ei]=et.i(ei)<<1|et.i(ei-1)>>>31;return new ea(en,et.h)}function e_(et,er){var en=er>>5;er%=32;for(var ei=et.g.length-en,es=[],eo=0;eo<ei;eo++)es[eo]=0<er?et.i(eo+en)>>>er|et.i(eo+en+1)<<32-er:et.i(eo+en);return new ea(es,et.h)}(eo=ea.prototype).m=function(){if(ev(this))return-eb(this).m();for(var et=0,er=1,en=0;en<this.g.length;en++){var ei=this.i(en);et+=(0<=ei?ei:4294967296+ei)*er,er*=4294967296}return et},eo.toString=function(et){if(2>(et=et||10)||36<et)throw Error("radix out of range: "+et);if(ey(this))return"0";if(ev(this))return"-"+eb(this).toString(et);for(var er=eh(Math.pow(et,6)),en=this,ei="";;){var es=eE(en,er).g,ea=((0<(en=eS(en,es.j(er))).g.length?en.g[0]:en.h)>>>0).toString(et);if(ey(en=es))return ea+ei;for(;6>ea.length;)ea="0"+ea;ei=ea+ei}},eo.i=function(et){return 0>et?0:et<this.g.length?this.g[et]:this.h},eo.l=function(et){return ev(et=eS(this,et))?-1:ey(et)?0:1},eo.abs=function(){return ev(this)?eb(this):this},eo.add=function(et){for(var er=Math.max(this.g.length,et.g.length),en=[],ei=0,es=0;es<=er;es++){var eo=ei+(65535&this.i(es))+(65535&et.i(es)),eu=(eo>>>16)+(this.i(es)>>>16)+(et.i(es)>>>16);ei=eu>>>16,eo&=65535,eu&=65535,en[es]=eu<<16|eo}return new ea(en,-2147483648&en[en.length-1]?-1:0)},eo.j=function(et){if(ey(this)||ey(et))return ep;if(ev(this))return ev(et)?eb(this).j(eb(et)):eb(eb(this).j(et));if(ev(et))return eb(this.j(eb(et)));if(0>this.l(em)&&0>et.l(em))return eh(this.m()*et.m());for(var er=this.g.length+et.g.length,en=[],ei=0;ei<2*er;ei++)en[ei]=0;for(ei=0;ei<this.g.length;ei++)for(var es=0;es<et.g.length;es++){var eo=this.i(ei)>>>16,eu=65535&this.i(ei),ec=et.i(es)>>>16,ed=65535&et.i(es);en[2*ei+2*es]+=eu*ed,eT(en,2*ei+2*es),en[2*ei+2*es+1]+=eo*ed,eT(en,2*ei+2*es+1),en[2*ei+2*es+1]+=eu*ec,eT(en,2*ei+2*es+1),en[2*ei+2*es+2]+=eo*ec,eT(en,2*ei+2*es+2)}for(ei=0;ei<er;ei++)en[ei]=en[2*ei+1]<<16|en[2*ei];for(ei=er;ei<2*er;ei++)en[ei]=0;return new ea(en,0)},eo.A=function(et){return eE(this,et).h},eo.and=function(et){for(var er=Math.max(this.g.length,et.g.length),en=[],ei=0;ei<er;ei++)en[ei]=this.i(ei)&et.i(ei);return new ea(en,this.h&et.h)},eo.or=function(et){for(var er=Math.max(this.g.length,et.g.length),en=[],ei=0;ei<er;ei++)en[ei]=this.i(ei)|et.i(ei);return new ea(en,this.h|et.h)},eo.xor=function(et){for(var er=Math.max(this.g.length,et.g.length),en=[],ei=0;ei<er;ei++)en[ei]=this.i(ei)^et.i(ei);return new ea(en,this.h^et.h)},et.prototype.digest=et.prototype.v,et.prototype.reset=et.prototype.s,et.prototype.update=et.prototype.u,es=eg.Md5=et,ea.prototype.add=ea.prototype.add,ea.prototype.multiply=ea.prototype.j,ea.prototype.modulo=ea.prototype.A,ea.prototype.compare=ea.prototype.l,ea.prototype.toNumber=ea.prototype.m,ea.prototype.toString=ea.prototype.toString,ea.prototype.getBits=ea.prototype.i,ea.fromNumber=eh,ea.fromString=ed,ei=eg.Integer=ea}).apply(void 0!==em?em:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ey=en(16063),ev=en(18196);let eb="@firebase/firestore",eS="4.7.6";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(et){this.uid=et}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(et){return et.uid===this.uid}}eT.UNAUTHENTICATED=new eT(null),eT.GOOGLE_CREDENTIALS=new eT("google-credentials-uid"),eT.FIRST_PARTY=new eT("first-party-uid"),eT.MOCK_USER=new eT("mock-user");let ew="11.2.0",eE=ew;function eC(et){eE=et}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(et){return(0,ed.inspect)(et,{depth:100})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eI=new eh.Yd("@firebase/firestore");function ek(){return eI.logLevel}function ex(et,...er){if(eI.logLevel<=eh.in.DEBUG){let en=er.map(eD);eI.debug(`Firestore (${eE}): ${et}`,...en)}}function eA(et,...er){if(eI.logLevel<=eh.in.ERROR){let en=er.map(eD);eI.error(`Firestore (${eE}): ${et}`,...en)}}function eR(et,...er){if(eI.logLevel<=eh.in.WARN){let en=er.map(eD);eI.warn(`Firestore (${eE}): ${et}`,...en)}}function eD(et){if("string"==typeof et)return et;try{return e_(et)}catch(er){return et}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eO(et="Unexpected state"){let er=`FIRESTORE (${eE}) INTERNAL ASSERTION FAILED: `+et;throw eA(er),Error(er)}function eN(et,er){et||eO()}function eM(et,er){return et}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eP={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class eL extends ep.ZR{constructor(et,er){super(et,er),this.code=et,this.message=er,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(){this.promise=new Promise((et,er)=>{this.resolve=et,this.reject=er})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB{constructor(et,er){this.user=er,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${et}`)}}class ej{getToken(){return Promise.resolve(null)}invalidateToken(){}start(et,er){et.enqueueRetryable(()=>er(eT.UNAUTHENTICATED))}shutdown(){}}class eU{constructor(et){this.token=et,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(et,er){this.changeListener=er,et.enqueueRetryable(()=>er(this.token.user))}shutdown(){this.changeListener=null}}class eV{constructor(et){this.authProvider=et,this.currentUser=eT.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(et,er){eN(void 0===this.tokenListener);let en=this.tokenCounter,ei=et=>this.tokenCounter!==en?(en=this.tokenCounter,er(et)):Promise.resolve(),es=new eF;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),es.resolve(),es=new eF,et.enqueueRetryable(()=>ei(this.currentUser))};let ea=()=>{let er=es;et.enqueueRetryable(async()=>{await er.promise,await ei(this.currentUser)})},eo=et=>{ex("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=et,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),ea())};this.authProvider.onInit(et=>eo(et)),setTimeout(()=>{if(!this.auth){let et=this.authProvider.getImmediate({optional:!0});et?eo(et):(ex("FirebaseAuthCredentialsProvider","Auth not yet detected"),es.resolve(),es=new eF)}},0),ea()}getToken(){let et=this.tokenCounter,er=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(er).then(er=>this.tokenCounter!==et?(ex("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):er?(eN("string"==typeof er.accessToken),new eB(er.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let et=this.auth&&this.auth.getUid();return eN(null===et||"string"==typeof et),new eT(et)}}class ez{constructor(et,er,en){this.sessionIndex=et,this.iamToken=er,this.authTokenFactory=en,this.type="FirstParty",this.user=eT.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let et=this.getAuthToken();return et&&this._headers.set("Authorization",et),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class e${constructor(et,er,en){this.sessionIndex=et,this.iamToken=er,this.authTokenFactory=en}getToken(){return Promise.resolve(new ez(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(et,er){et.enqueueRetryable(()=>er(eT.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eG{constructor(et){this.value=et,this.type="AppCheck",this.headers=new Map,et&&et.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eK{constructor(et){this.appCheckProvider=et,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(et,er){eN(void 0===this.tokenListener);let en=et=>{null!=et.error&&ex("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${et.error.message}`);let en=et.token!==this.latestAppCheckToken;return this.latestAppCheckToken=et.token,ex("FirebaseAppCheckTokenProvider",`Received ${en?"new":"existing"} token.`),en?er(et.token):Promise.resolve()};this.tokenListener=er=>{et.enqueueRetryable(()=>en(er))};let ei=et=>{ex("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=et,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(et=>ei(et)),setTimeout(()=>{if(!this.appCheck){let et=this.appCheckProvider.getImmediate({optional:!0});et?ei(et):ex("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let et=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(et).then(et=>et?(eN("string"==typeof et.token),this.latestAppCheckToken=et.token,new eG(et.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function eH(et){if(!et)return new ej;switch(et.type){case"firstParty":return new e$(et.sessionIndex||"0",et.iamToken||null,et.authTokenFactory||null);case"provider":return et.client;default:throw new eL(eP.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eW(et){return(0,ef.randomBytes)(et)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{static newId(){let et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",er=Math.floor(256/et.length)*et.length,en="",ei=20;for(;en.length<ei;){let es=eW(40);for(let ea=0;ea<es.length;++ea)en.length<ei&&es[ea]<er&&(en+=et.charAt(es[ea]%et.length))}return en}}function eY(et,er){return et<er?-1:et>er?1:0}function eJ(et,er,en){return et.length===er.length&&et.every((et,ei)=>en(et,er[ei]))}function eX(et){return et+"\x00"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eZ=-62135596800,e0=1e6;class e1{static now(){return e1.fromMillis(Date.now())}static fromDate(et){return e1.fromMillis(et.getTime())}static fromMillis(et){let er=Math.floor(et/1e3),en=Math.floor((et-1e3*er)*e0);return new e1(er,en)}constructor(et,er){if(this.seconds=et,this.nanoseconds=er,er<0||er>=1e9)throw new eL(eP.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+er);if(et<eZ||et>=253402300800)throw new eL(eP.INVALID_ARGUMENT,"Timestamp seconds out of range: "+et)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/e0}_compareTo(et){return this.seconds===et.seconds?eY(this.nanoseconds,et.nanoseconds):eY(this.seconds,et.seconds)}isEqual(et){return et.seconds===this.seconds&&et.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let et=this.seconds-eZ,er=String(et).padStart(12,"0"),en=String(this.nanoseconds).padStart(9,"0");return er+"."+en}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{static fromTimestamp(et){return new e2(et)}static min(){return new e2(new e1(0,0))}static max(){return new e2(new e1(253402300799,1e9-1))}constructor(et){this.timestamp=et}compareTo(et){return this.timestamp._compareTo(et.timestamp)}isEqual(et){return this.timestamp.isEqual(et.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e3="__name__";class e6{constructor(et,er,en){void 0===er?er=0:er>et.length&&eO(),void 0===en?en=et.length-er:en>et.length-er&&eO(),this.segments=et,this.offset=er,this.len=en}get length(){return this.len}isEqual(et){return 0===e6.comparator(this,et)}child(et){let er=this.segments.slice(this.offset,this.limit());return et instanceof e6?et.forEach(et=>{er.push(et)}):er.push(et),this.construct(er)}limit(){return this.offset+this.length}popFirst(et){return et=void 0===et?1:et,this.construct(this.segments,this.offset+et,this.length-et)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(et){return this.segments[this.offset+et]}isEmpty(){return 0===this.length}isPrefixOf(et){if(et.length<this.length)return!1;for(let er=0;er<this.length;er++)if(this.get(er)!==et.get(er))return!1;return!0}isImmediateParentOf(et){if(this.length+1!==et.length)return!1;for(let er=0;er<this.length;er++)if(this.get(er)!==et.get(er))return!1;return!0}forEach(et){for(let er=this.offset,en=this.limit();er<en;er++)et(this.segments[er])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(et,er){let en=Math.min(et.length,er.length);for(let ei=0;ei<en;ei++){let en=e6.compareSegments(et.get(ei),er.get(ei));if(0!==en)return en}return Math.sign(et.length-er.length)}static compareSegments(et,er){let en=e6.isNumericId(et),ei=e6.isNumericId(er);return en&&!ei?-1:!en&&ei?1:en&&ei?e6.extractNumericId(et).compare(e6.extractNumericId(er)):et<er?-1:et>er?1:0}static isNumericId(et){return et.startsWith("__id")&&et.endsWith("__")}static extractNumericId(et){return ei.fromString(et.substring(4,et.length-2))}}class e9 extends e6{construct(et,er,en){return new e9(et,er,en)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...et){let er=[];for(let en of et){if(en.indexOf("//")>=0)throw new eL(eP.INVALID_ARGUMENT,`Invalid segment (${en}). Paths must not contain // in them.`);er.push(...en.split("/").filter(et=>et.length>0))}return new e9(er)}static emptyPath(){return new e9([])}}let e4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class e5 extends e6{construct(et,er,en){return new e5(et,er,en)}static isValidIdentifier(et){return e4.test(et)}canonicalString(){return this.toArray().map(et=>(et=et.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e5.isValidIdentifier(et)||(et="`"+et+"`"),et)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===e3}static keyField(){return new e5([e3])}static fromServerFormat(et){let er=[],en="",ei=0,es=()=>{if(0===en.length)throw new eL(eP.INVALID_ARGUMENT,`Invalid field path (${et}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);er.push(en),en=""},ea=!1;for(;ei<et.length;){let er=et[ei];if("\\"===er){if(ei+1===et.length)throw new eL(eP.INVALID_ARGUMENT,"Path has trailing escape character: "+et);let er=et[ei+1];if(!("\\"===er||"."===er||"`"===er))throw new eL(eP.INVALID_ARGUMENT,"Path has invalid escape sequence: "+et);en+=er,ei+=2}else"`"===er?ea=!ea:"."!==er||ea?en+=er:es(),ei++}if(es(),ea)throw new eL(eP.INVALID_ARGUMENT,"Unterminated ` in path: "+et);return new e5(er)}static emptyPath(){return new e5([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(et){this.path=et}static fromPath(et){return new e8(e9.fromString(et))}static fromName(et){return new e8(e9.fromString(et).popFirst(5))}static empty(){return new e8(e9.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(et){return this.path.length>=2&&this.path.get(this.path.length-2)===et}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(et){return null!==et&&0===e9.comparator(this.path,et.path)}toString(){return this.path.toString()}static comparator(et,er){return e9.comparator(et.path,er.path)}static isDocumentKey(et){return et.length%2==0}static fromSegments(et){return new e8(new e9(et.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e7=-1,tt=0;class tr{constructor(et,er,en,ei){this.indexId=et,this.collectionGroup=er,this.fields=en,this.indexState=ei}}function ti(et){return et.fields.find(et=>2===et.kind)}function ts(et){return et.fields.filter(et=>2!==et.kind)}function ta(et){let er=ts(et);return 0===er.length?0:er[er.length-1].kind}function tl(et,er){let en=eY(et.collectionGroup,er.collectionGroup);if(0!==en)return en;for(let ei=0;ei<Math.min(et.fields.length,er.fields.length);++ei)if(0!==(en=th(et.fields[ei],er.fields[ei])))return en;return eY(et.fields.length,er.fields.length)}function tu(et){return`id=${et.indexId}|cg=${et.collectionGroup}|f=${et.fields.map(et=>`${et.fieldPath}:${et.kind}`).join(",")}`}tr.UNKNOWN_ID=-1;class tc{constructor(et,er){this.fieldPath=et,this.kind=er}}function th(et,er){let en=e5.comparator(et.fieldPath,er.fieldPath);return 0!==en?en:eY(et.kind,er.kind)}class td{constructor(et,er){this.sequenceNumber=et,this.offset=er}static empty(){return new td(tt,tm.min())}}function tp(et,er){let en=et.toTimestamp().seconds,ei=et.toTimestamp().nanoseconds+1,es=e2.fromTimestamp(1e9===ei?new e1(en+1,0):new e1(en,ei));return new tm(es,e8.empty(),er)}function tf(et){return new tm(et.readTime,et.key,e7)}class tm{constructor(et,er,en){this.readTime=et,this.documentKey=er,this.largestBatchId=en}static min(){return new tm(e2.min(),e8.empty(),e7)}static max(){return new tm(e2.max(),e8.empty(),e7)}}function tg(et,er){let en=et.readTime.compareTo(er.readTime);return 0!==en||0!==(en=e8.comparator(et.documentKey,er.documentKey))?en:eY(et.largestBatchId,er.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ty="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(et){this.onCommittedListeners.push(et)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(et=>et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tb(et){if(et.code===eP.FAILED_PRECONDITION&&et.message===ty)ex("LocalStore","Unexpectedly lost primary lease");else throw et}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(et){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,et(et=>{this.isDone=!0,this.result=et,this.nextCallback&&this.nextCallback(et)},et=>{this.isDone=!0,this.error=et,this.catchCallback&&this.catchCallback(et)})}catch(et){return this.next(void 0,et)}next(et,er){return(this.callbackAttached&&eO(),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(er,this.error):this.wrapSuccess(et,this.result):new tS((en,ei)=>{this.nextCallback=er=>{this.wrapSuccess(et,er).next(en,ei)},this.catchCallback=et=>{this.wrapFailure(er,et).next(en,ei)}})}toPromise(){return new Promise((et,er)=>{this.next(et,er)})}wrapUserFunction(et){try{let er=et();if(er instanceof tS)return er;return tS.resolve(er)}catch(et){return tS.reject(et)}}wrapSuccess(et,er){return et?this.wrapUserFunction(()=>et(er)):tS.resolve(er)}wrapFailure(et,er){return et?this.wrapUserFunction(()=>et(er)):tS.reject(er)}static resolve(et){return new tS((er,en)=>{er(et)})}static reject(et){return new tS((er,en)=>{en(et)})}static waitFor(et){return new tS((er,en)=>{let ei=0,es=0,ea=!1;et.forEach(et=>{++ei,et.next(()=>{++es,ea&&es===ei&&er()},et=>en(et))}),ea=!0,es===ei&&er()})}static or(et){let er=tS.resolve(!1);for(let en of et)er=er.next(et=>et?tS.resolve(et):en());return er}static forEach(et,er){let en=[];return et.forEach((et,ei)=>{en.push(er.call(this,et,ei))}),this.waitFor(en)}static mapArray(et,er){return new tS((en,ei)=>{let es=et.length,ea=Array(es),eo=0;for(let eu=0;eu<es;eu++){let ec=eu;er(et[ec]).next(et=>{ea[ec]=et,++eo===es&&en(ea)},et=>ei(et))}})}static doWhile(et,er){return new tS((en,ei)=>{let es=()=>{!0===et()?er().next(()=>{es()},ei):en()};es()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tT="SimpleDb",tw=3;class tE{static open(et,er,en,ei){try{return new tE(er,et.transaction(ei,en))}catch(et){throw new tk(er,et)}}constructor(et,er){this.action=et,this.transaction=er,this.aborted=!1,this.completionDeferred=new eF,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{er.error?this.completionDeferred.reject(new tk(et,er.error)):this.completionDeferred.resolve()},this.transaction.onerror=er=>{let en=tN(er.target.error);this.completionDeferred.reject(new tk(et,en))}}get completionPromise(){return this.completionDeferred.promise}abort(et){et&&this.completionDeferred.reject(et),this.aborted||(ex(tT,"Aborting transaction:",et?et.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let et=this.transaction;this.aborted||"function"!=typeof et.commit||et.commit()}store(et){let er=this.transaction.objectStore(et);return new tR(er)}}class tC{static delete(et){return ex(tT,"Removing database:",et),tD(window.indexedDB.deleteDatabase(et)).toPromise()}static isAvailable(){if(!isIndexedDBAvailable())return!1;if(tC.isMockPersistence())return!0;let et=getUA(),er=tC.getIOSVersion(et),en=0<er&&er<10,ei=t_(et),es=0<ei&&ei<4.5;return!(et.indexOf("MSIE ")>0||et.indexOf("Trident/")>0||et.indexOf("Edge/")>0)&&!en&&!es}static isMockPersistence(){var et;return"undefined"!=typeof process&&(null===(et=process.env)||void 0===et?void 0:et.USE_MOCK_PERSISTENCE)==="YES"}static getStore(et,er){return et.store(er)}static getIOSVersion(et){let er=et.match(/i(?:phone|pad|pod) os ([\d_]+)/i),en=er?er[1].split("_").slice(0,2).join("."):"-1";return Number(en)}constructor(et,er,en){this.name=et,this.version=er,this.schemaConverter=en;let ei=tC.getIOSVersion(getUA());12.2===ei&&eA("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(et){return this.db||(ex(tT,"Opening database:",this.name),this.db=await new Promise((er,en)=>{let ei=indexedDB.open(this.name,this.version);ei.onsuccess=et=>{let en=et.target.result;er(en)},ei.onblocked=()=>{en(new tk(et,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},ei.onerror=er=>{let ei=er.target.error;"VersionError"===ei.name?en(new eL(eP.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===ei.name?en(new eL(eP.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+ei)):en(new tk(et,ei))},ei.onupgradeneeded=et=>{ex(tT,'Database "'+this.name+'" requires upgrade from version:',et.oldVersion);let er=et.target.result;this.schemaConverter.createOrUpgrade(er,ei.transaction,et.oldVersion,this.version).next(()=>{ex(tT,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=et=>this.versionchangelistener(et)),this.db}setVersionChangeListener(et){this.versionchangelistener=et,this.db&&(this.db.onversionchange=er=>et(er))}async runTransaction(et,er,en,ei){let es="readonly"===er,ea=0;for(;;){++ea;try{this.db=await this.ensureDb(et);let er=tE.open(this.db,et,es?"readonly":"readwrite",en),ea=ei(er).next(et=>(er.maybeCommit(),et)).catch(et=>(er.abort(et),tS.reject(et))).toPromise();return ea.catch(()=>{}),await er.completionPromise,ea}catch(en){let et=en,er="FirebaseError"!==et.name&&ea<tw;if(ex(tT,"Transaction failed with error:",et.message,"Retrying:",er),this.close(),!er)return Promise.reject(et)}}}close(){this.db&&this.db.close(),this.db=void 0}}function t_(et){let er=et.match(/Android ([\d.]+)/i),en=er?er[1].split(".").slice(0,2).join("."):"-1";return Number(en)}class tI{constructor(et){this.dbCursor=et,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(et){this.dbCursor=et}done(){this.shouldStop=!0}skip(et){this.nextKey=et}delete(){return tD(this.dbCursor.delete())}}class tk extends null{constructor(et,er){super(eP.UNAVAILABLE,`IndexedDB transaction '${et}' failed: ${er}`),this.name="IndexedDbTransactionError"}}function tA(et){return"IndexedDbTransactionError"===et.name}class tR{constructor(et){this.store=et}put(et,er){let en;return void 0!==er?(ex(tT,"PUT",this.store.name,et,er),en=this.store.put(er,et)):(ex(tT,"PUT",this.store.name,"<auto-key>",et),en=this.store.put(et)),tD(en)}add(et){ex(tT,"ADD",this.store.name,et,et);let er=this.store.add(et);return tD(er)}get(et){let er=this.store.get(et);return tD(er).next(er=>(void 0===er&&(er=null),ex(tT,"GET",this.store.name,et,er),er))}delete(et){ex(tT,"DELETE",this.store.name,et);let er=this.store.delete(et);return tD(er)}count(){ex(tT,"COUNT",this.store.name);let et=this.store.count();return tD(et)}loadAll(et,er){let en=this.options(et,er),ei=en.index?this.store.index(en.index):this.store;if("function"==typeof ei.getAll){let et=ei.getAll(en.range);return new tS((er,en)=>{et.onerror=et=>{en(et.target.error)},et.onsuccess=et=>{er(et.target.result)}})}{let et=this.cursor(en),er=[];return this.iterateCursor(et,(et,en)=>{er.push(en)}).next(()=>er)}}loadFirst(et,er){let en=this.store.getAll(et,null===er?void 0:er);return new tS((et,er)=>{en.onerror=et=>{er(et.target.error)},en.onsuccess=er=>{et(er.target.result)}})}deleteAll(et,er){ex(tT,"DELETE ALL",this.store.name);let en=this.options(et,er);en.keysOnly=!1;let ei=this.cursor(en);return this.iterateCursor(ei,(et,er,en)=>en.delete())}iterate(et,er){let en;er?en=et:(en={},er=et);let ei=this.cursor(en);return this.iterateCursor(ei,er)}iterateSerial(et){let er=this.cursor({});return new tS((en,ei)=>{er.onerror=et=>{let er=tN(et.target.error);ei(er)},er.onsuccess=er=>{let ei=er.target.result;if(!ei){en();return}et(ei.primaryKey,ei.value).next(et=>{et?ei.continue():en()})}})}iterateCursor(et,er){let en=[];return new tS((ei,es)=>{et.onerror=et=>{es(et.target.error)},et.onsuccess=et=>{let es=et.target.result;if(!es){ei();return}let ea=new tI(es),eo=er(es.primaryKey,es.value,ea);if(eo instanceof tS){let et=eo.catch(et=>(ea.done(),tS.reject(et)));en.push(et)}ea.isDone?ei():null===ea.skipToKey?es.continue():es.continue(ea.skipToKey)}}).next(()=>tS.waitFor(en))}options(et,er){let en;return void 0!==et&&("string"==typeof et?en=et:er=et),{index:en,range:er}}cursor(et){let er="next";if(et.reverse&&(er="prev"),!et.index)return this.store.openCursor(et.range,er);{let en=this.store.index(et.index);return et.keysOnly?en.openKeyCursor(et.range,er):en.openCursor(et.range,er)}}}function tD(et){return new tS((er,en)=>{et.onsuccess=et=>{let en=et.target.result;er(en)},et.onerror=et=>{let er=tN(et.target.error);en(er)}})}let tO=!1;function tN(et){let er=tC.getIOSVersion(getUA());if(er>=12.2&&er<13){let er="An internal error was encountered in the Indexed Database server";if(et.message.indexOf(er)>=0){let et=new eL("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${er}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tO||(tO=!0,setTimeout(()=>{throw et},0)),et}}return et}let tM="IndexBackfiller",tP=null,tL=null,tF=50;class tB{constructor(et,er){this.asyncQueue=et,this.backfiller=er,this.task=null}start(){this.schedule(tP)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(et){ex(tM,`Scheduled in ${et}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",et,async()=>{this.task=null;try{let et=await this.backfiller.backfill();ex(tM,`Documents written: ${et}`)}catch(et){tA(et)?ex(tM,"Ignoring IndexedDB error during index backfill: ",et):await tb(et)}await this.schedule(tL)})}}class tj{constructor(et,er){this.localStore=et,this.persistence=er}async backfill(et=tF){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",er=>this.writeIndexEntries(er,et))}writeIndexEntries(et,er){let en=new Set,ei=er,es=!0;return tS.doWhile(()=>!0===es&&ei>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(et).next(er=>{if(!(null===er||en.has(er)))return ex(tM,`Processing collection: ${er}`),this.writeEntriesForCollectionGroup(et,er,ei).next(et=>{ei-=et,en.add(er)});es=!1})).next(()=>er-ei)}writeEntriesForCollectionGroup(et,er,en){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(et,er).next(ei=>this.localStore.localDocuments.getNextDocuments(et,er,ei,en).next(en=>{let es=en.changes;return this.localStore.indexManager.updateIndexEntries(et,es).next(()=>this.getNewOffset(ei,en)).next(en=>(ex(tM,`Updating offset: ${en}`),this.localStore.indexManager.updateCollectionGroup(et,er,en))).next(()=>es.size)}))}getNewOffset(et,er){let en=et;return er.changes.forEach((et,er)=>{let ei=tf(er);tg(ei,en)>0&&(en=ei)}),new tm(en.readTime,en.documentKey,Math.max(er.batchId,et.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(et,er){this.previousValue=et,er&&(er.sequenceNumberHandler=et=>this.setPreviousValue(et),this.writeNewSequenceNumber=et=>er.writeSequenceNumber(et))}setPreviousValue(et){return this.previousValue=Math.max(et,this.previousValue),this.previousValue}next(){let et=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(et),et}}tU.INVALID=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tV="\x01",tz="\x01",tq="\x10",t$="\x11";function tG(et){let er="";for(let en=0;en<et.length;en++)er.length>0&&(er=tH(er)),er=tK(et.get(en),er);return tH(er)}function tK(et,er){let en=er,ei=et.length;for(let er=0;er<ei;er++){let ei=et.charAt(er);switch(ei){case"\x00":en+=tV+tq;break;case tV:en+=tV+t$;break;default:en+=ei}}return en}function tH(et){return et+tV+tz}function tW(et){let er=et.length;if(eN(er>=2),2===er)return eN(et.charAt(0)===tV&&et.charAt(1)===tz),e9.emptyPath();let en=er-2,ei=[],es="";for(let ea=0;ea<er;){let er=et.indexOf(tV,ea);(er<0||er>en)&&eO();let eo=et.charAt(er+1);switch(eo){case tz:let eu;let ec=et.substring(ea,er);0===es.length?eu=ec:(es+=ec,eu=es,es=""),ei.push(eu);break;case tq:es+=et.substring(ea,er)+"\x00";break;case t$:es+=et.substring(ea,er+1);break;default:eO()}ea=er+2}return new e9(ei)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tQ="remoteDocuments",tY="owner",tJ="owner",tX="mutationQueues",tZ="userId",t0="mutations",t1="batchId",t2="userMutationsIndex",t3=null;function t6(et){return[et]}function t9(et,er){return[et,tG(er)]}function t4(et,er,en){return[et,tG(er),en]}let t5={},t8="documentMutations",t7="remoteDocumentsV14",rt=null,rr="documentKeyIndex",rn=null,ri="collectionGroupIndex",rs=null,ra="remoteDocumentGlobal",ro="remoteDocumentGlobalKey",rl="targets",ru="targetId",rc="queryTargetsIndex",rh=null,rd="targetDocuments",rp=null,rf="documentTargetsIndex",rm=null,rg="targetGlobalKey",ry="targetGlobal",rv="collectionParents",rb=null,rS="clientMetadata",rT="clientId",rw="bundles",rE="bundleId",rC="namedQueries",r_="name",rI="indexConfiguration",rk="indexId",rx="collectionGroupIndex",rA="collectionGroup",rR="indexState",rD=null,rO="sequenceNumberIndex",rN=null,rM="indexEntries",rP=null,rL="documentKeyIndex",rF=null,rB="documentOverlays",rj=null,rU="collectionPathOverlayIndex",rV=null,rz="collectionGroupOverlayIndex",rq=null,r$="globals",rG="name",rK=[tX,t0,t8,tQ,rl,tY,ry,rd],rH=rK,rW=[...rH,rS],rQ=[...rW,ra],rY=[...rQ,rv],rJ=[...rY,rw,rC],rX=[...rJ,rB],rZ=[tX,t0,t8,t7,rl,tY,ry,rd,rS,ra,rv,rw,rC,rB],r0=rZ,r1=[...r0,rI,rR,rM],r2=null,r3=[...r1,r$];function r6(et){return 17===et?r3:16===et?r2:15===et?r1:14===et?r0:13===et?rZ:12===et?rX:11===et?rJ:void eO()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9 extends null{constructor(et,er){super(),this.simpleDbTransaction=et,this.currentSequenceNumber=er}}function r4(et,er){let en=eM(et);return tC.getStore(en.simpleDbTransaction,er)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(et){let er=0;for(let en in et)Object.prototype.hasOwnProperty.call(et,en)&&er++;return er}function r8(et,er){for(let en in et)Object.prototype.hasOwnProperty.call(et,en)&&er(en,et[en])}function r7(et){for(let er in et)if(Object.prototype.hasOwnProperty.call(et,er))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(et,er){this.comparator=et,this.root=er||ni.EMPTY}insert(et,er){return new nt(this.comparator,this.root.insert(et,er,this.comparator).copy(null,null,ni.BLACK,null,null))}remove(et){return new nt(this.comparator,this.root.remove(et,this.comparator).copy(null,null,ni.BLACK,null,null))}get(et){let er=this.root;for(;!er.isEmpty();){let en=this.comparator(et,er.key);if(0===en)return er.value;en<0?er=er.left:en>0&&(er=er.right)}return null}indexOf(et){let er=0,en=this.root;for(;!en.isEmpty();){let ei=this.comparator(et,en.key);if(0===ei)return er+en.left.size;ei<0?en=en.left:(er+=en.left.size+1,en=en.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(et){return this.root.inorderTraversal(et)}forEach(et){this.inorderTraversal((er,en)=>(et(er,en),!1))}toString(){let et=[];return this.inorderTraversal((er,en)=>(et.push(`${er}:${en}`),!1)),`{${et.join(", ")}}`}reverseTraversal(et){return this.root.reverseTraversal(et)}getIterator(){return new nn(this.root,null,this.comparator,!1)}getIteratorFrom(et){return new nn(this.root,et,this.comparator,!1)}getReverseIterator(){return new nn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(et){return new nn(this.root,et,this.comparator,!0)}}class nn{constructor(et,er,en,ei){this.isReverse=ei,this.nodeStack=[];let es=1;for(;!et.isEmpty();)if(es=er?en(et.key,er):1,er&&ei&&(es*=-1),es<0)et=this.isReverse?et.left:et.right;else if(0===es){this.nodeStack.push(et);break}else this.nodeStack.push(et),et=this.isReverse?et.right:et.left}getNext(){let et=this.nodeStack.pop(),er={key:et.key,value:et.value};if(this.isReverse)for(et=et.left;!et.isEmpty();)this.nodeStack.push(et),et=et.right;else for(et=et.right;!et.isEmpty();)this.nodeStack.push(et),et=et.left;return er}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let et=this.nodeStack[this.nodeStack.length-1];return{key:et.key,value:et.value}}}class ni{constructor(et,er,en,ei,es){this.key=et,this.value=er,this.color=null!=en?en:ni.RED,this.left=null!=ei?ei:ni.EMPTY,this.right=null!=es?es:ni.EMPTY,this.size=this.left.size+1+this.right.size}copy(et,er,en,ei,es){return new ni(null!=et?et:this.key,null!=er?er:this.value,null!=en?en:this.color,null!=ei?ei:this.left,null!=es?es:this.right)}isEmpty(){return!1}inorderTraversal(et){return this.left.inorderTraversal(et)||et(this.key,this.value)||this.right.inorderTraversal(et)}reverseTraversal(et){return this.right.reverseTraversal(et)||et(this.key,this.value)||this.left.reverseTraversal(et)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(et,er,en){let ei=this,es=en(et,ei.key);return(ei=es<0?ei.copy(null,null,null,ei.left.insert(et,er,en),null):0===es?ei.copy(null,er,null,null,null):ei.copy(null,null,null,null,ei.right.insert(et,er,en))).fixUp()}removeMin(){if(this.left.isEmpty())return ni.EMPTY;let et=this;return et.left.isRed()||et.left.left.isRed()||(et=et.moveRedLeft()),(et=et.copy(null,null,null,et.left.removeMin(),null)).fixUp()}remove(et,er){let en;let ei=this;if(0>er(et,ei.key))ei.left.isEmpty()||ei.left.isRed()||ei.left.left.isRed()||(ei=ei.moveRedLeft()),ei=ei.copy(null,null,null,ei.left.remove(et,er),null);else{if(ei.left.isRed()&&(ei=ei.rotateRight()),ei.right.isEmpty()||ei.right.isRed()||ei.right.left.isRed()||(ei=ei.moveRedRight()),0===er(et,ei.key)){if(ei.right.isEmpty())return ni.EMPTY;en=ei.right.min(),ei=ei.copy(en.key,en.value,null,null,ei.right.removeMin())}ei=ei.copy(null,null,null,null,ei.right.remove(et,er))}return ei.fixUp()}isRed(){return this.color}fixUp(){let et=this;return et.right.isRed()&&!et.left.isRed()&&(et=et.rotateLeft()),et.left.isRed()&&et.left.left.isRed()&&(et=et.rotateRight()),et.left.isRed()&&et.right.isRed()&&(et=et.colorFlip()),et}moveRedLeft(){let et=this.colorFlip();return et.right.left.isRed()&&(et=(et=(et=et.copy(null,null,null,null,et.right.rotateRight())).rotateLeft()).colorFlip()),et}moveRedRight(){let et=this.colorFlip();return et.left.left.isRed()&&(et=(et=et.rotateRight()).colorFlip()),et}rotateLeft(){let et=this.copy(null,null,ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,et,null)}rotateRight(){let et=this.copy(null,null,ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,et)}colorFlip(){let et=this.left.copy(null,null,!this.left.color,null,null),er=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,et,er)}checkMaxDepth(){let et=this.check();return Math.pow(2,et)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw eO();let et=this.left.check();if(et===this.right.check())return et+(this.isRed()?0:1);throw eO()}}ni.EMPTY=null,ni.RED=!0,ni.BLACK=!1;class na{constructor(){this.size=0}get key(){throw eO()}get value(){throw eO()}get color(){throw eO()}get left(){throw eO()}get right(){throw eO()}copy(et,er,en,ei,es){return this}insert(et,er,en){return new ni(et,er)}remove(et,er){return this}isEmpty(){return!0}inorderTraversal(et){return!1}reverseTraversal(et){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}ni.EMPTY=new na;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(et){this.comparator=et,this.data=new nt(this.comparator)}has(et){return null!==this.data.get(et)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(et){return this.data.indexOf(et)}forEach(et){this.data.inorderTraversal((er,en)=>(et(er),!1))}forEachInRange(et,er){let en=this.data.getIteratorFrom(et[0]);for(;en.hasNext();){let ei=en.getNext();if(this.comparator(ei.key,et[1])>=0)return;er(ei.key)}}forEachWhile(et,er){let en;for(en=void 0!==er?this.data.getIteratorFrom(er):this.data.getIterator();en.hasNext();){let er=en.getNext(),ei=et(er.key);if(!ei)return}}firstAfterOrEqual(et){let er=this.data.getIteratorFrom(et);return er.hasNext()?er.getNext().key:null}getIterator(){return new nu(this.data.getIterator())}getIteratorFrom(et){return new nu(this.data.getIteratorFrom(et))}add(et){return this.copy(this.data.remove(et).insert(et,!0))}delete(et){return this.has(et)?this.copy(this.data.remove(et)):this}isEmpty(){return this.data.isEmpty()}unionWith(et){let er=this;return er.size<et.size&&(er=et,et=this),et.forEach(et=>{er=er.add(et)}),er}isEqual(et){if(!(et instanceof no)||this.size!==et.size)return!1;let er=this.data.getIterator(),en=et.data.getIterator();for(;er.hasNext();){let et=er.getNext().key,ei=en.getNext().key;if(0!==this.comparator(et,ei))return!1}return!0}toArray(){let et=[];return this.forEach(er=>{et.push(er)}),et}toString(){let et=[];return this.forEach(er=>et.push(er)),"SortedSet("+et.toString()+")"}copy(et){let er=new no(this.comparator);return er.data=et,er}}class nu{constructor(et){this.iter=et}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nc(et,er,en,ei,es){let ea=et.getIterator(),eo=er.getIterator(),eu=nh(ea),ec=nh(eo);for(;eu||ec;){let et=!1,er=!1;if(eu&&ec){let ei=en(eu,ec);ei<0?er=!0:ei>0&&(et=!0)}else null!=eu?er=!0:et=!0;et?(ei(ec),ec=nh(eo)):er?(es(eu),eu=nh(ea)):(eu=nh(ea),ec=nh(eo))}}function nh(et){return et.hasNext()?et.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(et){this.fields=et,et.sort(e5.comparator)}static empty(){return new nd([])}unionWith(et){let er=new no(e5.comparator);for(let et of this.fields)er=er.add(et);for(let en of et)er=er.add(en);return new nd(er.toArray())}covers(et){for(let er of this.fields)if(er.isPrefixOf(et))return!0;return!1}isEqual(et){return eJ(this.fields,et.fields,(et,er)=>et.isEqual(er))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(et){return Buffer.from(et,"base64").toString("binary")}function nf(et){return Buffer.from(et,"binary").toString("base64")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(et){this.binaryString=et}static fromBase64String(et){let er=np(et);return new nm(er)}static fromUint8Array(et){let er=ng(et);return new nm(er)}[Symbol.iterator](){let et=0;return{next:()=>et<this.binaryString.length?{value:this.binaryString.charCodeAt(et++),done:!1}:{value:void 0,done:!0}}}toBase64(){return nf(this.binaryString)}toUint8Array(){return ny(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(et){return eY(this.binaryString,et.binaryString)}isEqual(et){return this.binaryString===et.binaryString}}function ng(et){let er="";for(let en=0;en<et.length;++en)er+=String.fromCharCode(et[en]);return er}function ny(et){let er=new Uint8Array(et.length);for(let en=0;en<et.length;en++)er[en]=et.charCodeAt(en);return er}nm.EMPTY_BYTE_STRING=new nm("");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nb(et){if(eN(!!et),"string"==typeof et){let er=0,en=nv.exec(et);if(eN(!!en),en[1]){let et=en[1];er=Number(et=(et+"000000000").substr(0,9))}let ei=new Date(et),es=Math.floor(ei.getTime()/1e3);return{seconds:es,nanos:er}}{let er=nS(et.seconds),en=nS(et.nanos);return{seconds:er,nanos:en}}}function nS(et){return"number"==typeof et?et:"string"==typeof et?Number(et):0}function nT(et){return"string"==typeof et?nm.fromBase64String(et):nm.fromUint8Array(et)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nw="server_timestamp",nE="__type__",nC="__previous_value__",n_="__local_write_time__";function nI(et){var er,en;let ei=null===(en=((null===(er=null==et?void 0:et.mapValue)||void 0===er?void 0:er.fields)||{})[nE])||void 0===en?void 0:en.stringValue;return ei===nw}function nk(et,er){let en={fields:{[nE]:{stringValue:nw},[n_]:{timestampValue:{seconds:et.seconds,nanos:et.nanoseconds}}}};return er&&nI(er)&&(er=nx(er)),er&&(en.fields[nC]=er),{mapValue:en}}function nx(et){let er=et.mapValue.fields[nC];return nI(er)?nx(er):er}function nA(et){let er=nb(et.mapValue.fields[n_].timestampValue);return new e1(er.seconds,er.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(et,er,en,ei,es,ea,eo,eu,ec){this.databaseId=et,this.appId=er,this.persistenceKey=en,this.host=ei,this.ssl=es,this.forceLongPolling=ea,this.autoDetectLongPolling=eo,this.longPollingOptions=eu,this.useFetchStreams=ec}}let nD="(default)";class nO{constructor(et,er){this.projectId=et,this.database=er||nD}static empty(){return new nO("","")}get isDefaultDatabase(){return this.database===nD}isEqual(et){return et instanceof nO&&et.projectId===this.projectId&&et.database===this.database}}function nN(et,er){if(!Object.prototype.hasOwnProperty.apply(et.options,["projectId"]))throw new eL(eP.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nO(et.options.projectId,er)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nM=-1;function nP(et){return null==et}function nL(et){return 0===et&&1/et==-1/0}function nF(et){return"number"==typeof et&&Number.isInteger(et)&&!nL(et)&&et<=Number.MAX_SAFE_INTEGER&&et>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nB="__type__",nj="__max__",nU={mapValue:{fields:{__type__:{stringValue:nj}}}},nV="__vector__",nz="value",nq={nullValue:"NULL_VALUE"};function n$(et){return"nullValue"in et?0:"booleanValue"in et?1:"integerValue"in et||"doubleValue"in et?2:"timestampValue"in et?3:"stringValue"in et?5:"bytesValue"in et?6:"referenceValue"in et?7:"geoPointValue"in et?8:"arrayValue"in et?9:"mapValue"in et?nI(et)?4:ik(et)?9007199254740991:i_(et)?10:11:eO()}function nG(et,er){if(et===er)return!0;let en=n$(et),ei=n$(er);if(en!==ei)return!1;switch(en){case 0:case 9007199254740991:return!0;case 1:return et.booleanValue===er.booleanValue;case 4:return nA(et).isEqual(nA(er));case 3:return nK(et,er);case 5:return et.stringValue===er.stringValue;case 6:return nW(et,er);case 7:return et.referenceValue===er.referenceValue;case 8:return nH(et,er);case 2:return nQ(et,er);case 9:return eJ(et.arrayValue.values||[],er.arrayValue.values||[],nG);case 10:case 11:return nY(et,er);default:return eO()}}function nK(et,er){if("string"==typeof et.timestampValue&&"string"==typeof er.timestampValue&&et.timestampValue.length===er.timestampValue.length)return et.timestampValue===er.timestampValue;let en=nb(et.timestampValue),ei=nb(er.timestampValue);return en.seconds===ei.seconds&&en.nanos===ei.nanos}function nH(et,er){return nS(et.geoPointValue.latitude)===nS(er.geoPointValue.latitude)&&nS(et.geoPointValue.longitude)===nS(er.geoPointValue.longitude)}function nW(et,er){return nT(et.bytesValue).isEqual(nT(er.bytesValue))}function nQ(et,er){if("integerValue"in et&&"integerValue"in er)return nS(et.integerValue)===nS(er.integerValue);if("doubleValue"in et&&"doubleValue"in er){let en=nS(et.doubleValue),ei=nS(er.doubleValue);return en===ei?nL(en)===nL(ei):isNaN(en)&&isNaN(ei)}return!1}function nY(et,er){let en=et.mapValue.fields||{},ei=er.mapValue.fields||{};if(r5(en)!==r5(ei))return!1;for(let et in en)if(en.hasOwnProperty(et)&&(void 0===ei[et]||!nG(en[et],ei[et])))return!1;return!0}function nJ(et,er){return void 0!==(et.values||[]).find(et=>nG(et,er))}function nX(et,er){if(et===er)return 0;let en=n$(et),ei=n$(er);if(en!==ei)return eY(en,ei);switch(en){case 0:case 9007199254740991:return 0;case 1:return eY(et.booleanValue,er.booleanValue);case 2:return nZ(et,er);case 3:return n0(et.timestampValue,er.timestampValue);case 4:return n0(nA(et),nA(er));case 5:return eY(et.stringValue,er.stringValue);case 6:return n9(et.bytesValue,er.bytesValue);case 7:return n3(et.referenceValue,er.referenceValue);case 8:return n6(et.geoPointValue,er.geoPointValue);case 9:return n4(et.arrayValue,er.arrayValue);case 10:return n5(et.mapValue,er.mapValue);case 11:return n8(et.mapValue,er.mapValue);default:throw eO()}}function nZ(et,er){let en=nS(et.integerValue||et.doubleValue),ei=nS(er.integerValue||er.doubleValue);return en<ei?-1:en>ei?1:en===ei?0:isNaN(en)?isNaN(ei)?0:-1:1}function n0(et,er){if("string"==typeof et&&"string"==typeof er&&et.length===er.length)return eY(et,er);let en=nb(et),ei=nb(er),es=eY(en.seconds,ei.seconds);return 0!==es?es:eY(en.nanos,ei.nanos)}function n3(et,er){let en=et.split("/"),ei=er.split("/");for(let et=0;et<en.length&&et<ei.length;et++){let er=eY(en[et],ei[et]);if(0!==er)return er}return eY(en.length,ei.length)}function n6(et,er){let en=eY(nS(et.latitude),nS(er.latitude));return 0!==en?en:eY(nS(et.longitude),nS(er.longitude))}function n9(et,er){let en=nT(et),ei=nT(er);return en.compareTo(ei)}function n4(et,er){let en=et.values||[],ei=er.values||[];for(let et=0;et<en.length&&et<ei.length;++et){let er=nX(en[et],ei[et]);if(er)return er}return eY(en.length,ei.length)}function n5(et,er){var en,ei,es,ea;let eo=et.fields||{},eu=er.fields||{},ec=null===(en=eo[nz])||void 0===en?void 0:en.arrayValue,eh=null===(ei=eu[nz])||void 0===ei?void 0:ei.arrayValue,ed=eY((null===(es=null==ec?void 0:ec.values)||void 0===es?void 0:es.length)||0,(null===(ea=null==eh?void 0:eh.values)||void 0===ea?void 0:ea.length)||0);return 0!==ed?ed:n4(ec,eh)}function n8(et,er){if(et===nU.mapValue&&er===nU.mapValue)return 0;if(et===nU.mapValue)return 1;if(er===nU.mapValue)return -1;let en=et.fields||{},ei=Object.keys(en),es=er.fields||{},ea=Object.keys(es);ei.sort(),ea.sort();for(let et=0;et<ei.length&&et<ea.length;++et){let er=eY(ei[et],ea[et]);if(0!==er)return er;let eo=nX(en[ei[et]],es[ea[et]]);if(0!==eo)return eo}return eY(ei.length,ea.length)}function n7(et){return ir(et)}function ir(et){if("nullValue"in et)return"null";if("booleanValue"in et)return""+et.booleanValue;if("integerValue"in et)return""+et.integerValue;if("doubleValue"in et)return""+et.doubleValue;if("timestampValue"in et)return io(et.timestampValue);if("stringValue"in et)return et.stringValue;if("bytesValue"in et)return ia(et.bytesValue);else if("referenceValue"in et)return iu(et.referenceValue);else if("geoPointValue"in et)return il(et.geoPointValue);else if("arrayValue"in et)return ih(et.arrayValue);else if("mapValue"in et)return ic(et.mapValue);else return eO()}function ia(et){return nT(et).toBase64()}function io(et){let er=nb(et);return`time(${er.seconds},${er.nanos})`}function il(et){return`geo(${et.latitude},${et.longitude})`}function iu(et){return e8.fromName(et).toString()}function ic(et){let er=Object.keys(et.fields||{}).sort(),en="{",ei=!0;for(let es of er)ei?ei=!1:en+=",",en+=`${es}:${ir(et.fields[es])}`;return en+"}"}function ih(et){let er="[",en=!0;for(let ei of et.values||[])en?en=!1:er+=",",er+=ir(ei);return er+"]"}function ip(et){switch(n$(et)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let er=nx(et);return er?16+ip(er):16;case 5:return 2*et.stringValue.length;case 6:return nT(et.bytesValue).approximateByteSize();case 7:return et.referenceValue.length;case 9:return ig(et.arrayValue);case 10:case 11:return im(et.mapValue);default:throw eO()}}function im(et){let er=0;return r8(et.fields,(et,en)=>{er+=et.length+ip(en)}),er}function ig(et){return(et.values||[]).reduce((et,er)=>et+ip(er),0)}function iy(et,er){return{referenceValue:`projects/${et.projectId}/databases/${et.database}/documents/${er.path.canonicalString()}`}}function iv(et){return!!et&&"integerValue"in et}function ib(et){return!!et&&"doubleValue"in et}function iS(et){return iv(et)||ib(et)}function iT(et){return!!et&&"arrayValue"in et}function iw(et){return!!et&&"nullValue"in et}function iE(et){return!!et&&"doubleValue"in et&&isNaN(Number(et.doubleValue))}function iC(et){return!!et&&"mapValue"in et}function i_(et){var er,en;let ei=null===(en=((null===(er=null==et?void 0:et.mapValue)||void 0===er?void 0:er.fields)||{})[nB])||void 0===en?void 0:en.stringValue;return ei===nV}function iI(et){if(et.geoPointValue)return{geoPointValue:Object.assign({},et.geoPointValue)};if(et.timestampValue&&"object"==typeof et.timestampValue)return{timestampValue:Object.assign({},et.timestampValue)};if(et.mapValue){let er={mapValue:{fields:{}}};return r8(et.mapValue.fields,(et,en)=>er.mapValue.fields[et]=iI(en)),er}{if(!et.arrayValue)return Object.assign({},et);let er={arrayValue:{values:[]}};for(let en=0;en<(et.arrayValue.values||[]).length;++en)er.arrayValue.values[en]=iI(et.arrayValue.values[en]);return er}}function ik(et){return(((et.mapValue||{}).fields||{}).__type__||{}).stringValue===nj}let ix={mapValue:{fields:{[nB]:{stringValue:nV},[nz]:{arrayValue:{}}}}};function iA(et){if("nullValue"in et)return nq;if("booleanValue"in et)return{booleanValue:!1};if("integerValue"in et||"doubleValue"in et)return{doubleValue:NaN};if("timestampValue"in et)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in et)return{stringValue:""};if("bytesValue"in et)return{bytesValue:""};if("referenceValue"in et)return iy(nO.empty(),e8.empty());else if("geoPointValue"in et)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in et)return{arrayValue:{}};else if(!("mapValue"in et))return eO();else return i_(et)?ix:{mapValue:{}}}function iR(et){if("nullValue"in et)return{booleanValue:!1};if("booleanValue"in et)return{doubleValue:NaN};if("integerValue"in et||"doubleValue"in et)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in et)return{stringValue:""};if("stringValue"in et)return{bytesValue:""};if("bytesValue"in et)return iy(nO.empty(),e8.empty());if("referenceValue"in et)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in et)return{arrayValue:{}};else if("arrayValue"in et)return ix;else if(!("mapValue"in et))return eO();else return i_(et)?{mapValue:{}}:nU}function iD(et,er){let en=nX(et.value,er.value);return 0!==en?en:et.inclusive&&!er.inclusive?-1:!et.inclusive&&er.inclusive?1:0}function iO(et,er){let en=nX(et.value,er.value);return 0!==en?en:et.inclusive&&!er.inclusive?1:!et.inclusive&&er.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(et){this.value=et}static empty(){return new iN({mapValue:{}})}field(et){if(et.isEmpty())return this.value;{let er=this.value;for(let en=0;en<et.length-1;++en)if(!iC(er=(er.mapValue.fields||{})[et.get(en)]))return null;return(er=(er.mapValue.fields||{})[et.lastSegment()])||null}}set(et,er){let en=this.getFieldsMap(et.popLast());en[et.lastSegment()]=iI(er)}setAll(et){let er=e5.emptyPath(),en={},ei=[];et.forEach((et,es)=>{if(!er.isImmediateParentOf(es)){let et=this.getFieldsMap(er);this.applyChanges(et,en,ei),en={},ei=[],er=es.popLast()}et?en[es.lastSegment()]=iI(et):ei.push(es.lastSegment())});let es=this.getFieldsMap(er);this.applyChanges(es,en,ei)}delete(et){let er=this.field(et.popLast());iC(er)&&er.mapValue.fields&&delete er.mapValue.fields[et.lastSegment()]}isEqual(et){return nG(this.value,et.value)}getFieldsMap(et){let er=this.value;er.mapValue.fields||(er.mapValue={fields:{}});for(let en=0;en<et.length;++en){let ei=er.mapValue.fields[et.get(en)];iC(ei)&&ei.mapValue.fields||(ei={mapValue:{fields:{}}},er.mapValue.fields[et.get(en)]=ei),er=ei}return er.mapValue.fields}applyChanges(et,er,en){for(let ei of(r8(er,(er,en)=>et[er]=en),en))delete et[ei]}clone(){return new iN(iI(this.value))}}function iM(et){let er=[];return r8(et.fields,(et,en)=>{let ei=new e5([et]);if(iC(en)){let et=iM(en.mapValue),es=et.fields;if(0===es.length)er.push(ei);else for(let et of es)er.push(ei.child(et))}else er.push(ei)}),new nd(er)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(et,er,en,ei,es,ea,eo){this.key=et,this.documentType=er,this.version=en,this.readTime=ei,this.createTime=es,this.data=ea,this.documentState=eo}static newInvalidDocument(et){return new iP(et,0,e2.min(),e2.min(),e2.min(),iN.empty(),0)}static newFoundDocument(et,er,en,ei){return new iP(et,1,er,e2.min(),en,ei,0)}static newNoDocument(et,er){return new iP(et,2,er,e2.min(),e2.min(),iN.empty(),0)}static newUnknownDocument(et,er){return new iP(et,3,er,e2.min(),e2.min(),iN.empty(),2)}convertToFoundDocument(et,er){return this.createTime.isEqual(e2.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=et),this.version=et,this.documentType=1,this.data=er,this.documentState=0,this}convertToNoDocument(et){return this.version=et,this.documentType=2,this.data=iN.empty(),this.documentState=0,this}convertToUnknownDocument(et){return this.version=et,this.documentType=3,this.data=iN.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=e2.min(),this}setReadTime(et){return this.readTime=et,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(et){return et instanceof iP&&this.key.isEqual(et.key)&&this.version.isEqual(et.version)&&this.documentType===et.documentType&&this.documentState===et.documentState&&this.data.isEqual(et.data)}mutableCopy(){return new iP(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function iL(et,er,en){let ei=er.data.field(et),es=en.data.field(et);return null!==ei&&null!==es?nX(ei,es):eO()}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(et,er){this.position=et,this.inclusive=er}}function iB(et,er,en){let ei=0;for(let es=0;es<et.position.length;es++){let ea=er[es],eo=et.position[es];if(ea.field.isKeyField())ei=e8.comparator(e8.fromName(eo.referenceValue),en.key);else{let et=en.data.field(ea.field);ei=nX(eo,et)}if("desc"===ea.dir&&(ei*=-1),0!==ei)break}return ei}function ij(et,er,en){let ei=iB(et,er,en);return et.inclusive?ei>=0:ei>0}function iU(et,er,en){let ei=iB(et,er,en);return et.inclusive?ei<=0:ei<0}function iV(et,er){if(null===et)return null===er;if(null===er||et.inclusive!==er.inclusive||et.position.length!==er.position.length)return!1;for(let en=0;en<et.position.length;en++){let ei=et.position[en],es=er.position[en];if(!nG(ei,es))return!1}return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(et,er="asc"){this.field=et,this.dir=er}}function iq(et){return et.field.canonicalString()+et.dir}function i$(et){return`${et.field.canonicalString()} (${et.dir})`}function iG(et,er){return et.dir===er.dir&&et.field.isEqual(er.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iK{}class iH extends iK{constructor(et,er,en){super(),this.field=et,this.op=er,this.value=en}static create(et,er,en){return et.isKeyField()?"in"===er||"not-in"===er?this.createKeyFieldInFilter(et,er,en):new i5(et,er,en):"array-contains"===er?new sr(et,en):"in"===er?new sn(et,en):"not-in"===er?new si(et,en):"array-contains-any"===er?new ss(et,en):new iH(et,er,en)}static createKeyFieldInFilter(et,er,en){return"in"===er?new i8(et,en):new i7(et,en)}matches(et){let er=et.data.field(this.field);return"!="===this.op?null!==er&&this.matchesComparison(nX(er,this.value)):null!==er&&n$(this.value)===n$(er)&&this.matchesComparison(nX(er,this.value))}matchesComparison(et){switch(this.op){case"<":return et<0;case"<=":return et<=0;case"==":return 0===et;case"!=":return 0!==et;case">":return et>0;case">=":return et>=0;default:return eO()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class iW extends iK{constructor(et,er){super(),this.filters=et,this.op=er,this.memoizedFlattenedFilters=null}static create(et,er){return new iW(et,er)}matches(et){return iQ(this)?void 0===this.filters.find(er=>!er.matches(et)):void 0!==this.filters.find(er=>er.matches(et))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((et,er)=>et.concat(er.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function iQ(et){return"and"===et.op}function iY(et){return"or"===et.op}function iJ(et){return iX(et)&&iQ(et)}function iX(et){for(let er of et.filters)if(er instanceof iW)return!1;return!0}function iZ(et){if(et instanceof iH)return et.field.canonicalString()+et.op.toString()+n7(et.value);if(iJ(et))return et.filters.map(et=>iZ(et)).join(",");{let er=et.filters.map(et=>iZ(et)).join(",");return`${et.op}(${er})`}}function i0(et,er){return et instanceof iH?i1(et,er):et instanceof iW?i2(et,er):void eO()}function i1(et,er){return er instanceof iH&&et.op===er.op&&et.field.isEqual(er.field)&&nG(et.value,er.value)}function i2(et,er){if(er instanceof iW&&et.op===er.op&&et.filters.length===er.filters.length){let en=et.filters.reduce((et,en,ei)=>et&&i0(en,er.filters[ei]),!0);return en}return!1}function i3(et,er){let en=et.filters.concat(er);return iW.create(en,et.op)}function i6(et){return et instanceof iH?i4(et):et instanceof iW?i9(et):"Filter"}function i9(et){return et.op.toString()+" {"+et.getFilters().map(i6).join(" ,")+"}"}function i4(et){return`${et.field.canonicalString()} ${et.op} ${n7(et.value)}`}class i5 extends iH{constructor(et,er,en){super(et,er,en),this.key=e8.fromName(en.referenceValue)}matches(et){let er=e8.comparator(et.key,this.key);return this.matchesComparison(er)}}class i8 extends iH{constructor(et,er){super(et,"in",er),this.keys=st("in",er)}matches(et){return this.keys.some(er=>er.isEqual(et.key))}}class i7 extends iH{constructor(et,er){super(et,"not-in",er),this.keys=st("not-in",er)}matches(et){return!this.keys.some(er=>er.isEqual(et.key))}}function st(et,er){var en;return((null===(en=er.arrayValue)||void 0===en?void 0:en.values)||[]).map(et=>e8.fromName(et.referenceValue))}class sr extends iH{constructor(et,er){super(et,"array-contains",er)}matches(et){let er=et.data.field(this.field);return iT(er)&&nJ(er.arrayValue,this.value)}}class sn extends iH{constructor(et,er){super(et,"in",er)}matches(et){let er=et.data.field(this.field);return null!==er&&nJ(this.value.arrayValue,er)}}class si extends iH{constructor(et,er){super(et,"not-in",er)}matches(et){if(nJ(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let er=et.data.field(this.field);return null!==er&&!nJ(this.value.arrayValue,er)}}class ss extends iH{constructor(et,er){super(et,"array-contains-any",er)}matches(et){let er=et.data.field(this.field);return!!iT(er)&&!!er.arrayValue.values&&er.arrayValue.values.some(et=>nJ(this.value.arrayValue,et))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(et,er=null,en=[],ei=[],es=null,ea=null,eo=null){this.path=et,this.collectionGroup=er,this.orderBy=en,this.filters=ei,this.limit=es,this.startAt=ea,this.endAt=eo,this.memoizedCanonicalId=null}}function so(et,er=null,en=[],ei=[],es=null,ea=null,eo=null){return new sa(et,er,en,ei,es,ea,eo)}function sl(et){let er=eM(et);if(null===er.memoizedCanonicalId){let et=er.path.canonicalString();null!==er.collectionGroup&&(et+="|cg:"+er.collectionGroup),et+="|f:"+er.filters.map(et=>iZ(et)).join(",")+"|ob:"+er.orderBy.map(et=>iq(et)).join(","),nP(er.limit)||(et+="|l:"+er.limit),er.startAt&&(et+="|lb:"+(er.startAt.inclusive?"b:":"a:")+er.startAt.position.map(et=>n7(et)).join(",")),er.endAt&&(et+="|ub:"+(er.endAt.inclusive?"a:":"b:")+er.endAt.position.map(et=>n7(et)).join(",")),er.memoizedCanonicalId=et}return er.memoizedCanonicalId}function su(et){let er=et.path.canonicalString();return null!==et.collectionGroup&&(er+=" collectionGroup="+et.collectionGroup),et.filters.length>0&&(er+=`, filters: [${et.filters.map(et=>i6(et)).join(", ")}]`),nP(et.limit)||(er+=", limit: "+et.limit),et.orderBy.length>0&&(er+=`, orderBy: [${et.orderBy.map(et=>i$(et)).join(", ")}]`),et.startAt&&(er+=", startAt: "+(et.startAt.inclusive?"b:":"a:")+et.startAt.position.map(et=>n7(et)).join(",")),et.endAt&&(er+=", endAt: "+(et.endAt.inclusive?"a:":"b:")+et.endAt.position.map(et=>n7(et)).join(",")),`Target(${er})`}function sc(et,er){if(et.limit!==er.limit||et.orderBy.length!==er.orderBy.length)return!1;for(let en=0;en<et.orderBy.length;en++)if(!iG(et.orderBy[en],er.orderBy[en]))return!1;if(et.filters.length!==er.filters.length)return!1;for(let en=0;en<et.filters.length;en++)if(!i0(et.filters[en],er.filters[en]))return!1;return!!(et.collectionGroup===er.collectionGroup&&et.path.isEqual(er.path)&&iV(et.startAt,er.startAt))&&iV(et.endAt,er.endAt)}function sh(et){return e8.isDocumentKey(et.path)&&null===et.collectionGroup&&0===et.filters.length}function sd(et,er){return et.filters.filter(et=>et instanceof iH&&et.field.isEqual(er))}function sp(et,er){let en=ti(er);if(void 0===en)return null;for(let er of sd(et,en.fieldPath))switch(er.op){case"array-contains-any":return er.value.arrayValue.values||[];case"array-contains":return[er.value]}return null}function sf(et,er){let en=new Map;for(let ei of ts(er))for(let er of sd(et,ei.fieldPath))switch(er.op){case"==":case"in":en.set(ei.fieldPath.canonicalString(),er.value);break;case"not-in":case"!=":return en.set(ei.fieldPath.canonicalString(),er.value),Array.from(en.values())}return null}function sm(et,er){let en=[],ei=!0;for(let es of ts(er)){let er=0===es.kind?sy(et,es.fieldPath,et.startAt):sv(et,es.fieldPath,et.startAt);en.push(er.value),ei&&(ei=er.inclusive)}return new iF(en,ei)}function sg(et,er){let en=[],ei=!0;for(let es of ts(er)){let er=0===es.kind?sv(et,es.fieldPath,et.endAt):sy(et,es.fieldPath,et.endAt);en.push(er.value),ei&&(ei=er.inclusive)}return new iF(en,ei)}function sy(et,er,en){let ei=nq,es=!0;for(let en of sd(et,er)){let et=nq,er=!0;switch(en.op){case"<":case"<=":et=iA(en.value);break;case"==":case"in":case">=":et=en.value;break;case">":et=en.value,er=!1;break;case"!=":case"not-in":et=nq}0>iD({value:ei,inclusive:es},{value:et,inclusive:er})&&(ei=et,es=er)}if(null!==en)for(let ea=0;ea<et.orderBy.length;++ea){let eo=et.orderBy[ea];if(eo.field.isEqual(er)){let et=en.position[ea];0>iD({value:ei,inclusive:es},{value:et,inclusive:en.inclusive})&&(ei=et,es=en.inclusive);break}}return{value:ei,inclusive:es}}function sv(et,er,en){let ei=nU,es=!0;for(let en of sd(et,er)){let et=nU,er=!0;switch(en.op){case">=":case">":et=iR(en.value),er=!1;break;case"==":case"in":case"<=":et=en.value;break;case"<":et=en.value,er=!1;break;case"!=":case"not-in":et=nU}iO({value:ei,inclusive:es},{value:et,inclusive:er})>0&&(ei=et,es=er)}if(null!==en)for(let ea=0;ea<et.orderBy.length;++ea){let eo=et.orderBy[ea];if(eo.field.isEqual(er)){let et=en.position[ea];iO({value:ei,inclusive:es},{value:et,inclusive:en.inclusive})>0&&(ei=et,es=en.inclusive);break}}return{value:ei,inclusive:es}}function sb(et){let er=new no(e5.comparator),en=!1;for(let ei of et.filters)for(let et of ei.getFlattenedFilters())et.field.isKeyField()||("array-contains"===et.op||"array-contains-any"===et.op?en=!0:er=er.add(et.field));for(let en of et.orderBy)en.field.isKeyField()||(er=er.add(en.field));return er.size+(en?1:0)}function sS(et){return null!==et.limit}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(et,er=null,en=[],ei=[],es=null,ea="F",eo=null,eu=null){this.path=et,this.collectionGroup=er,this.explicitOrderBy=en,this.filters=ei,this.limit=es,this.limitType=ea,this.startAt=eo,this.endAt=eu,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function sw(et,er,en,ei,es,ea,eo,eu){return new sT(et,er,en,ei,es,ea,eo,eu)}function sE(et){return new sT(et)}function sC(et,er){return new sT(er,null,et.explicitOrderBy.slice(),et.filters.slice(),et.limit,et.limitType,et.startAt,et.endAt)}function s_(et){return 0===et.filters.length&&null===et.limit&&null==et.startAt&&null==et.endAt&&(0===et.explicitOrderBy.length||1===et.explicitOrderBy.length&&et.explicitOrderBy[0].field.isKeyField())}function sI(et){let er=new no(e5.comparator);return et.filters.forEach(et=>{let en=et.getFlattenedFilters();en.forEach(et=>{et.isInequality()&&(er=er.add(et.field))})}),er}function sk(et){return e8.isDocumentKey(et.path)&&null===et.collectionGroup&&0===et.filters.length}function sx(et){return null!==et.collectionGroup}function sA(et){let er=eM(et);if(null===er.memoizedNormalizedOrderBy){er.memoizedNormalizedOrderBy=[];let et=new Set;for(let en of er.explicitOrderBy)er.memoizedNormalizedOrderBy.push(en),et.add(en.field.canonicalString());let en=er.explicitOrderBy.length>0?er.explicitOrderBy[er.explicitOrderBy.length-1].dir:"asc",ei=sI(er);ei.forEach(ei=>{et.has(ei.canonicalString())||ei.isKeyField()||er.memoizedNormalizedOrderBy.push(new iz(ei,en))}),et.has(e5.keyField().canonicalString())||er.memoizedNormalizedOrderBy.push(new iz(e5.keyField(),en))}return er.memoizedNormalizedOrderBy}function sR(et){let er=eM(et);return er.memoizedTarget||(er.memoizedTarget=sO(er,sA(et))),er.memoizedTarget}function sD(et){let er=eM(et);return er.memoizedAggregateTarget||(er.memoizedAggregateTarget=sO(er,et.explicitOrderBy)),er.memoizedAggregateTarget}function sO(et,er){if("F"===et.limitType)return so(et.path,et.collectionGroup,er,et.filters,et.limit,et.startAt,et.endAt);{er=er.map(et=>{let er="desc"===et.dir?"asc":"desc";return new iz(et.field,er)});let en=et.endAt?new iF(et.endAt.position,et.endAt.inclusive):null,ei=et.startAt?new iF(et.startAt.position,et.startAt.inclusive):null;return so(et.path,et.collectionGroup,er,et.filters,et.limit,en,ei)}}function sN(et,er){let en=et.filters.concat([er]);return new sT(et.path,et.collectionGroup,et.explicitOrderBy.slice(),en,et.limit,et.limitType,et.startAt,et.endAt)}function sM(et,er){let en=et.explicitOrderBy.concat([er]);return new sT(et.path,et.collectionGroup,en,et.filters.slice(),et.limit,et.limitType,et.startAt,et.endAt)}function sP(et,er,en){return new sT(et.path,et.collectionGroup,et.explicitOrderBy.slice(),et.filters.slice(),er,en,et.startAt,et.endAt)}function sL(et,er){return new sT(et.path,et.collectionGroup,et.explicitOrderBy.slice(),et.filters.slice(),et.limit,et.limitType,er,et.endAt)}function sF(et,er){return new sT(et.path,et.collectionGroup,et.explicitOrderBy.slice(),et.filters.slice(),et.limit,et.limitType,et.startAt,er)}function sB(et,er){return sc(sR(et),sR(er))&&et.limitType===er.limitType}function sj(et){return`${sl(sR(et))}|lt:${et.limitType}`}function sU(et){return`Query(target=${su(sR(et))}; limitType=${et.limitType})`}function sV(et,er){return er.isFoundDocument()&&sz(et,er)&&sq(et,er)&&s$(et,er)&&sG(et,er)}function sz(et,er){let en=er.key.path;return null!==et.collectionGroup?er.key.hasCollectionId(et.collectionGroup)&&et.path.isPrefixOf(en):e8.isDocumentKey(et.path)?et.path.isEqual(en):et.path.isImmediateParentOf(en)}function sq(et,er){for(let en of sA(et))if(!en.field.isKeyField()&&null===er.data.field(en.field))return!1;return!0}function s$(et,er){for(let en of et.filters)if(!en.matches(er))return!1;return!0}function sG(et,er){return(!et.startAt||!!iU(et.startAt,sA(et),er))&&(!et.endAt||!!ij(et.endAt,sA(et),er))}function sK(et){return et.collectionGroup||(et.path.length%2==1?et.path.lastSegment():et.path.get(et.path.length-2))}function sH(et){return(er,en)=>{let ei=!1;for(let es of sA(et)){let et=sW(es,er,en);if(0!==et)return et;ei=ei||es.field.isKeyField()}return 0}}function sW(et,er,en){let ei=et.field.isKeyField()?e8.comparator(er.key,en.key):iL(et.field,er,en);switch(et.dir){case"asc":return ei;case"desc":return -1*ei;default:return eO()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sQ{constructor(et,er){this.mapKeyFn=et,this.equalsFn=er,this.inner={},this.innerSize=0}get(et){let er=this.mapKeyFn(et),en=this.inner[er];if(void 0!==en){for(let[er,ei]of en)if(this.equalsFn(er,et))return ei}}has(et){return void 0!==this.get(et)}set(et,er){let en=this.mapKeyFn(et),ei=this.inner[en];if(void 0===ei){this.inner[en]=[[et,er]],this.innerSize++;return}for(let en=0;en<ei.length;en++)if(this.equalsFn(ei[en][0],et)){ei[en]=[et,er];return}ei.push([et,er]),this.innerSize++}delete(et){let er=this.mapKeyFn(et),en=this.inner[er];if(void 0===en)return!1;for(let ei=0;ei<en.length;ei++)if(this.equalsFn(en[ei][0],et))return 1===en.length?delete this.inner[er]:en.splice(ei,1),this.innerSize--,!0;return!1}forEach(et){r8(this.inner,(er,en)=>{for(let[er,ei]of en)et(er,ei)})}isEmpty(){return r7(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sY=new nt(e8.comparator);function sJ(){return sY}let sX=new nt(e8.comparator);function sZ(...et){let er=sX;for(let en of et)er=er.insert(en.key,en);return er}function s0(){return s6()}function s1(et){let er=sX;return et.forEach((et,en)=>er=er.insert(et,en.overlayedDocument)),er}function s2(){return s6()}function s3(){return s6()}function s6(){return new sQ(et=>et.toString(),(et,er)=>et.isEqual(er))}let s9=new nt(e8.comparator);function s4(){return s9}let s5=new no(e8.comparator);function s8(...et){let er=s5;for(let en of et)er=er.add(en);return er}let s7=new no(eY);function at(){return s7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(et,er){if(et.useProto3Json){if(isNaN(er))return{doubleValue:"NaN"};if(er===1/0)return{doubleValue:"Infinity"};if(er===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nL(er)?"-0":er}}function an(et){return{integerValue:""+et}}function ai(et,er){return nF(er)?an(er):ar(et,er)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(){this._=void 0}}function aa(et,er,en){return et instanceof ac?nk(en,er):et instanceof ah?ad(et,er):et instanceof ap?af(et,er):ag(et,er)}function ao(et,er,en){return et instanceof ah?ad(et,er):et instanceof ap?af(et,er):en}function al(et,er){return et instanceof am?iS(er)?er:{integerValue:0}:null}function au(et,er){return et instanceof ah&&er instanceof ah||et instanceof ap&&er instanceof ap?eJ(et.elements,er.elements,nG):et instanceof am&&er instanceof am?nG(et.operand,er.operand):et instanceof ac&&er instanceof ac}class ac extends as{}class ah extends as{constructor(et){super(),this.elements=et}}function ad(et,er){let en=av(er);for(let er of et.elements)en.some(et=>nG(et,er))||en.push(er);return{arrayValue:{values:en}}}class ap extends as{constructor(et){super(),this.elements=et}}function af(et,er){let en=av(er);for(let er of et.elements)en=en.filter(et=>!nG(et,er));return{arrayValue:{values:en}}}class am extends as{constructor(et,er){super(),this.serializer=et,this.operand=er}}function ag(et,er){let en=al(et,er),ei=ay(en)+ay(et.operand);return iv(en)&&iv(et.operand)?an(ei):ar(et.serializer,ei)}function ay(et){return nS(et.integerValue||et.doubleValue)}function av(et){return iT(et)&&et.arrayValue.values?et.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(et,er){this.field=et,this.transform=er}}function aS(et,er){return et.field.isEqual(er.field)&&au(et.transform,er.transform)}function aT(et,er){return void 0===et&&void 0===er||!!et&&!!er&&eJ(et,er,(et,er)=>aS(et,er))}class aw{constructor(et,er){this.version=et,this.transformResults=er}}class aE{constructor(et,er){this.updateTime=et,this.exists=er}static none(){return new aE}static exists(et){return new aE(void 0,et)}static updateTime(et){return new aE(et)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(et){return this.exists===et.exists&&(this.updateTime?!!et.updateTime&&this.updateTime.isEqual(et.updateTime):!et.updateTime)}}function aC(et,er){return void 0!==et.updateTime?er.isFoundDocument()&&er.version.isEqual(et.updateTime):void 0===et.exists||et.exists===er.isFoundDocument()}class a_{}function aI(et,er){if(!et.hasLocalMutations||er&&0===er.fields.length)return null;if(null===er)return et.isNoDocument()?new aU(et.key,aE.none()):new aD(et.key,et.data,aE.none());{let en=et.data,ei=iN.empty(),es=new no(e5.comparator);for(let et of er.fields)if(!es.has(et)){let er=en.field(et);null===er&&et.length>1&&(et=et.popLast(),er=en.field(et)),null===er?ei.delete(et):ei.set(et,er),es=es.add(et)}return new aM(et.key,ei,new nd(es.toArray()),aE.none())}}function ak(et,er,en){et instanceof aD?aO(et,er,en):et instanceof aM?aP(et,er,en):aV(et,er,en)}function ax(et,er,en,ei){return et instanceof aD?aN(et,er,en,ei):et instanceof aM?aL(et,er,en,ei):az(et,er,en)}function aA(et,er){let en=null;for(let ei of et.fieldTransforms){let et=er.data.field(ei.field),es=al(ei.transform,et||null);null!=es&&(null===en&&(en=iN.empty()),en.set(ei.field,es))}return en||null}function aR(et,er){return!!(et.type===er.type&&et.key.isEqual(er.key)&&et.precondition.isEqual(er.precondition)&&aT(et.fieldTransforms,er.fieldTransforms))&&(0===et.type?et.value.isEqual(er.value):1!==et.type||et.data.isEqual(er.data)&&et.fieldMask.isEqual(er.fieldMask))}class aD extends a_{constructor(et,er,en,ei=[]){super(),this.key=et,this.value=er,this.precondition=en,this.fieldTransforms=ei,this.type=0}getFieldMask(){return null}}function aO(et,er,en){let ei=et.value.clone(),es=aB(et.fieldTransforms,er,en.transformResults);ei.setAll(es),er.convertToFoundDocument(en.version,ei).setHasCommittedMutations()}function aN(et,er,en,ei){if(!aC(et.precondition,er))return en;let es=et.value.clone(),ea=aj(et.fieldTransforms,ei,er);return es.setAll(ea),er.convertToFoundDocument(er.version,es).setHasLocalMutations(),null}class aM extends a_{constructor(et,er,en,ei,es=[]){super(),this.key=et,this.data=er,this.fieldMask=en,this.precondition=ei,this.fieldTransforms=es,this.type=1}getFieldMask(){return this.fieldMask}}function aP(et,er,en){if(!aC(et.precondition,er)){er.convertToUnknownDocument(en.version);return}let ei=aB(et.fieldTransforms,er,en.transformResults),es=er.data;es.setAll(aF(et)),es.setAll(ei),er.convertToFoundDocument(en.version,es).setHasCommittedMutations()}function aL(et,er,en,ei){if(!aC(et.precondition,er))return en;let es=aj(et.fieldTransforms,ei,er),ea=er.data;return(ea.setAll(aF(et)),ea.setAll(es),er.convertToFoundDocument(er.version,ea).setHasLocalMutations(),null===en)?null:en.unionWith(et.fieldMask.fields).unionWith(et.fieldTransforms.map(et=>et.field))}function aF(et){let er=new Map;return et.fieldMask.fields.forEach(en=>{if(!en.isEmpty()){let ei=et.data.field(en);er.set(en,ei)}}),er}function aB(et,er,en){let ei=new Map;eN(et.length===en.length);for(let es=0;es<en.length;es++){let ea=et[es],eo=ea.transform,eu=er.data.field(ea.field);ei.set(ea.field,ao(eo,eu,en[es]))}return ei}function aj(et,er,en){let ei=new Map;for(let es of et){let et=es.transform,ea=en.data.field(es.field);ei.set(es.field,aa(et,ea,er))}return ei}class aU extends a_{constructor(et,er){super(),this.key=et,this.precondition=er,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function aV(et,er,en){er.convertToNoDocument(en.version).setHasCommittedMutations()}function az(et,er,en){return aC(et.precondition,er)?(er.convertToNoDocument(er.version).setHasLocalMutations(),null):en}class aq extends a_{constructor(et,er){super(),this.key=et,this.precondition=er,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a${constructor(et,er,en,ei){this.batchId=et,this.localWriteTime=er,this.baseMutations=en,this.mutations=ei}applyToRemoteDocument(et,er){let en=er.mutationResults;for(let er=0;er<this.mutations.length;er++){let ei=this.mutations[er];if(ei.key.isEqual(et.key)){let es=en[er];ak(ei,et,es)}}}applyToLocalView(et,er){for(let en of this.baseMutations)en.key.isEqual(et.key)&&(er=ax(en,et,er,this.localWriteTime));for(let en of this.mutations)en.key.isEqual(et.key)&&(er=ax(en,et,er,this.localWriteTime));return er}applyToLocalDocumentSet(et,er){let en=s3();return this.mutations.forEach(ei=>{let es=et.get(ei.key),ea=es.overlayedDocument,eo=this.applyToLocalView(ea,es.mutatedFields);eo=er.has(ei.key)?null:eo;let eu=aI(ea,eo);null!==eu&&en.set(ei.key,eu),ea.isValidDocument()||ea.convertToNoDocument(e2.min())}),en}keys(){return this.mutations.reduce((et,er)=>et.add(er.key),s8())}isEqual(et){return this.batchId===et.batchId&&eJ(this.mutations,et.mutations,(et,er)=>aR(et,er))&&eJ(this.baseMutations,et.baseMutations,(et,er)=>aR(et,er))}}class aG{constructor(et,er,en,ei){this.batch=et,this.commitVersion=er,this.mutationResults=en,this.docVersions=ei}static from(et,er,en){eN(et.mutations.length===en.length);let ei=s4(),es=et.mutations;for(let et=0;et<es.length;et++)ei=ei.insert(es[et].key,en[et].version);return new aG(et,er,en,ei)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(et,er){this.largestBatchId=et,this.mutation=er}getKey(){return this.mutation.key}isEqual(et){return null!==et&&this.mutation===et.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aH{constructor(et,er){this.count=et,this.unchangedNames=er}}function aW(et){switch(et){case eP.OK:return eO();case eP.CANCELLED:case eP.UNKNOWN:case eP.DEADLINE_EXCEEDED:case eP.RESOURCE_EXHAUSTED:case eP.INTERNAL:case eP.UNAVAILABLE:case eP.UNAUTHENTICATED:return!1;case eP.INVALID_ARGUMENT:case eP.NOT_FOUND:case eP.ALREADY_EXISTS:case eP.PERMISSION_DENIED:case eP.FAILED_PRECONDITION:case eP.ABORTED:case eP.OUT_OF_RANGE:case eP.UNIMPLEMENTED:case eP.DATA_LOSS:return!0;default:return eO()}}function aQ(et){return aW(et)&&et!==eP.ABORTED}function aY(et){if(void 0===et)return eA("GRPC error has no .code"),eP.UNKNOWN;switch(et){case ea.OK:return eP.OK;case ea.CANCELLED:return eP.CANCELLED;case ea.UNKNOWN:return eP.UNKNOWN;case ea.DEADLINE_EXCEEDED:return eP.DEADLINE_EXCEEDED;case ea.RESOURCE_EXHAUSTED:return eP.RESOURCE_EXHAUSTED;case ea.INTERNAL:return eP.INTERNAL;case ea.UNAVAILABLE:return eP.UNAVAILABLE;case ea.UNAUTHENTICATED:return eP.UNAUTHENTICATED;case ea.INVALID_ARGUMENT:return eP.INVALID_ARGUMENT;case ea.NOT_FOUND:return eP.NOT_FOUND;case ea.ALREADY_EXISTS:return eP.ALREADY_EXISTS;case ea.PERMISSION_DENIED:return eP.PERMISSION_DENIED;case ea.FAILED_PRECONDITION:return eP.FAILED_PRECONDITION;case ea.ABORTED:return eP.ABORTED;case ea.OUT_OF_RANGE:return eP.OUT_OF_RANGE;case ea.UNIMPLEMENTED:return eP.UNIMPLEMENTED;case ea.DATA_LOSS:return eP.DATA_LOSS;default:return eO()}}!function(et){et[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS"}(ea||(ea={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aJ extends null{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aX=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aZ(){return new TextEncoder}function a0(){return new TextDecoder("utf-8")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a1=new ei([4294967295,4294967295],0);function a2(et){let er=aZ().encode(et),en=new Md5;return en.update(er),new Uint8Array(en.digest())}function a3(et){let er=new DataView(et.buffer),en=er.getUint32(0,!0),ei=er.getUint32(4,!0),es=er.getUint32(8,!0),ea=er.getUint32(12,!0),eo=new Integer([en,ei],0),eu=new Integer([es,ea],0);return[eo,eu]}class a6{constructor(et,er,en){if(this.bitmap=et,this.padding=er,this.hashCount=en,er<0||er>=8)throw new a9(`Invalid padding: ${er}`);if(en<0||et.length>0&&0===this.hashCount)throw new a9(`Invalid hash count: ${en}`);if(0===et.length&&0!==er)throw new a9(`Invalid padding when bitmap length is 0: ${er}`);this.bitCount=8*et.length-er,this.bitCountInInteger=Integer.fromNumber(this.bitCount)}getBitIndex(et,er,en){let ei=et.add(er.multiply(Integer.fromNumber(en)));return 1===ei.compare(a1)&&(ei=new Integer([ei.getBits(0),ei.getBits(1)],0)),ei.modulo(this.bitCountInInteger).toNumber()}isBitSet(et){let er=this.bitmap[Math.floor(et/8)],en=et%8;return(er&1<<en)!=0}mightContain(et){if(0===this.bitCount)return!1;let er=a2(et),[en,ei]=a3(er);for(let et=0;et<this.hashCount;et++){let er=this.getBitIndex(en,ei,et);if(!this.isBitSet(er))return!1}return!0}static create(et,er,en){let ei=et%8==0?0:8-et%8,es=new Uint8Array(Math.ceil(et/8)),ea=new a6(es,ei,er);return en.forEach(et=>ea.insert(et)),ea}insert(et){if(0===this.bitCount)return;let er=a2(et),[en,ei]=a3(er);for(let et=0;et<this.hashCount;et++){let er=this.getBitIndex(en,ei,et);this.setBit(er)}}setBit(et){let er=Math.floor(et/8),en=et%8;this.bitmap[er]|=1<<en}}class a9 extends null{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(et,er,en,ei,es){this.snapshotVersion=et,this.targetChanges=er,this.targetMismatches=en,this.documentUpdates=ei,this.resolvedLimboDocuments=es}static createSynthesizedRemoteEventForCurrentChange(et,er,en){let ei=new Map;return ei.set(et,a5.createSynthesizedTargetChangeForCurrentChange(et,er,en)),new a4(e2.min(),ei,new nt(eY),sJ(),s8())}}class a5{constructor(et,er,en,ei,es){this.resumeToken=et,this.current=er,this.addedDocuments=en,this.modifiedDocuments=ei,this.removedDocuments=es}static createSynthesizedTargetChangeForCurrentChange(et,er,en){return new a5(en,er,s8(),s8(),s8())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(et,er,en,ei){this.updatedTargetIds=et,this.removedTargetIds=er,this.key=en,this.newDoc=ei}}class a7{constructor(et,er){this.targetId=et,this.existenceFilter=er}}class ot{constructor(et,er,en=nm.EMPTY_BYTE_STRING,ei=null){this.state=et,this.targetIds=er,this.resumeToken=en,this.cause=ei}}class or{constructor(){this.pendingResponses=0,this.documentChanges=oo(),this._resumeToken=nm.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(et){et.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=et)}toTargetChange(){let et=s8(),er=s8(),en=s8();return this.documentChanges.forEach((ei,es)=>{switch(es){case 0:et=et.add(ei);break;case 2:er=er.add(ei);break;case 1:en=en.add(ei);break;default:eO()}}),new a5(this._resumeToken,this._current,et,er,en)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=oo()}addDocumentChange(et,er){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(et,er)}removeDocumentChange(et){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(et)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,eN(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let on="WatchChangeAggregator";class oi{constructor(et){this.metadataProvider=et,this.targetStates=new Map,this.pendingDocumentUpdates=sJ(),this.pendingDocumentUpdatesByTarget=oa(),this.pendingDocumentTargetMapping=oa(),this.pendingTargetResets=new nt(eY)}handleDocumentChange(et){for(let er of et.updatedTargetIds)et.newDoc&&et.newDoc.isFoundDocument()?this.addDocumentToTarget(er,et.newDoc):this.removeDocumentFromTarget(er,et.key,et.newDoc);for(let er of et.removedTargetIds)this.removeDocumentFromTarget(er,et.key,et.newDoc)}handleTargetChange(et){this.forEachTarget(et,er=>{let en=this.ensureTargetState(er);switch(et.state){case 0:this.isActiveTarget(er)&&en.updateResumeToken(et.resumeToken);break;case 1:en.recordTargetResponse(),en.isPending||en.clearPendingChanges(),en.updateResumeToken(et.resumeToken);break;case 2:en.recordTargetResponse(),en.isPending||this.removeTarget(er);break;case 3:this.isActiveTarget(er)&&(en.markCurrent(),en.updateResumeToken(et.resumeToken));break;case 4:this.isActiveTarget(er)&&(this.resetTarget(er),en.updateResumeToken(et.resumeToken));break;default:eO()}})}forEachTarget(et,er){et.targetIds.length>0?et.targetIds.forEach(er):this.targetStates.forEach((et,en)=>{this.isActiveTarget(en)&&er(en)})}handleExistenceFilter(et){let er=et.targetId,en=et.existenceFilter.count,ei=this.targetDataForActiveTarget(er);if(ei){let es=ei.target;if(sh(es)){if(0===en){let et=new e8(es.path);this.removeDocumentFromTarget(er,et,iP.newNoDocument(et,e2.min()))}else eN(1===en)}else{let ei=this.getCurrentDocumentCountForTarget(er);if(ei!==en){let en=this.parseBloomFilter(et),es=en?this.applyBloomFilter(en,et,ei):1;if(0!==es){this.resetTarget(er);let et=2===es?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(er,et)}null==aX||aX.notifyOnExistenceFilterMismatch(ol(ei,et.existenceFilter,this.metadataProvider.getDatabaseId(),en,es))}}}}parseBloomFilter(et){let er,en;let ei=et.existenceFilter.unchangedNames;if(!ei||!ei.bits)return null;let{bits:{bitmap:es="",padding:ea=0},hashCount:eo=0}=ei;try{er=nT(es).toUint8Array()}catch(et){if(et instanceof aJ)return eR("Decoding the base64 bloom filter in existence filter failed ("+et.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw et}try{en=new a6(er,ea,eo)}catch(et){return et instanceof a9?eR("BloomFilter error: ",et):eR("Applying bloom filter failed: ",et),null}return 0===en.bitCount?null:en}applyBloomFilter(et,er,en){let ei=er.existenceFilter.count,es=this.filterRemovedDocuments(et,er.targetId);return ei===en-es?0:2}filterRemovedDocuments(et,er){let en=this.metadataProvider.getRemoteKeysForTarget(er),ei=0;return en.forEach(en=>{let es=this.metadataProvider.getDatabaseId(),ea=`projects/${es.projectId}/databases/${es.database}/documents/${en.path.canonicalString()}`;!et.mightContain(ea)&&(this.removeDocumentFromTarget(er,en,null),ei++)}),ei}createRemoteEvent(et){let er=new Map;this.targetStates.forEach((en,ei)=>{let es=this.targetDataForActiveTarget(ei);if(es){if(en.current&&sh(es.target)){let er=new e8(es.target.path);this.ensureDocumentUpdateByTarget(er).has(ei)||this.targetContainsDocument(ei,er)||this.removeDocumentFromTarget(ei,er,iP.newNoDocument(er,et))}en.hasPendingChanges&&(er.set(ei,en.toTargetChange()),en.clearPendingChanges())}});let en=s8();this.pendingDocumentTargetMapping.forEach((et,er)=>{let ei=!0;er.forEachWhile(et=>{let er=this.targetDataForActiveTarget(et);return!er||"TargetPurposeLimboResolution"===er.purpose||(ei=!1,!1)}),ei&&(en=en.add(et))}),this.pendingDocumentUpdates.forEach((er,en)=>en.setReadTime(et));let ei=new a4(et,er,this.pendingTargetResets,this.pendingDocumentUpdates,en);return this.pendingDocumentUpdates=sJ(),this.pendingDocumentUpdatesByTarget=oa(),this.pendingDocumentTargetMapping=oa(),this.pendingTargetResets=new nt(eY),ei}addDocumentToTarget(et,er){if(!this.isActiveTarget(et))return;let en=this.targetContainsDocument(et,er.key)?2:0,ei=this.ensureTargetState(et);ei.addDocumentChange(er.key,en),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(er.key,er),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(er.key,this.ensureDocumentUpdateByTarget(er.key).add(et)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(er.key,this.ensureDocumentTargetMapping(er.key).add(et))}removeDocumentFromTarget(et,er,en){if(!this.isActiveTarget(et))return;let ei=this.ensureTargetState(et);this.targetContainsDocument(et,er)?ei.addDocumentChange(er,1):ei.removeDocumentChange(er),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(er,this.ensureDocumentTargetMapping(er).delete(et)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(er,this.ensureDocumentTargetMapping(er).add(et)),en&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(er,en))}removeTarget(et){this.targetStates.delete(et)}getCurrentDocumentCountForTarget(et){let er=this.ensureTargetState(et),en=er.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(et).size+en.addedDocuments.size-en.removedDocuments.size}recordPendingTargetRequest(et){let er=this.ensureTargetState(et);er.recordPendingTargetRequest()}ensureTargetState(et){let er=this.targetStates.get(et);return er||(er=new or,this.targetStates.set(et,er)),er}ensureDocumentTargetMapping(et){let er=this.pendingDocumentTargetMapping.get(et);return er||(er=new no(eY),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(et,er)),er}ensureDocumentUpdateByTarget(et){let er=this.pendingDocumentUpdatesByTarget.get(et);return er||(er=new no(eY),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(et,er)),er}isActiveTarget(et){let er=null!==this.targetDataForActiveTarget(et);return er||ex(on,"Detected inactive target",et),er}targetDataForActiveTarget(et){let er=this.targetStates.get(et);return er&&er.isPending?null:this.metadataProvider.getTargetDataForTarget(et)}resetTarget(et){this.targetStates.set(et,new or);let er=this.metadataProvider.getRemoteKeysForTarget(et);er.forEach(er=>{this.removeDocumentFromTarget(et,er,null)})}targetContainsDocument(et,er){let en=this.metadataProvider.getRemoteKeysForTarget(et);return en.has(er)}}function oa(){return new nt(e8.comparator)}function oo(){return new nt(e8.comparator)}function ol(et,er,en,ei,es){var ea,eo,eu,ec,eh,ed;let ep={localCacheCount:et,existenceFilterCount:er.count,databaseId:en.database,projectId:en.projectId},ef=er.unchangedNames;return ef&&(ep.bloomFilter={applied:0===es,hashCount:null!==(ea=null==ef?void 0:ef.hashCount)&&void 0!==ea?ea:0,bitmapLength:null!==(ec=null===(eu=null===(eo=null==ef?void 0:ef.bits)||void 0===eo?void 0:eo.bitmap)||void 0===eu?void 0:eu.length)&&void 0!==ec?ec:0,padding:null!==(ed=null===(eh=null==ef?void 0:ef.bits)||void 0===eh?void 0:eh.padding)&&void 0!==ed?ed:0,mightContain:et=>{var er;return null!==(er=null==ei?void 0:ei.mightContain(et))&&void 0!==er&&er}}),ep}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ou=(()=>{let et={};return et.asc="ASCENDING",et.desc="DESCENDING",et})(),oc=(()=>{let et={};return et["<"]="LESS_THAN",et["<="]="LESS_THAN_OR_EQUAL",et[">"]="GREATER_THAN",et[">="]="GREATER_THAN_OR_EQUAL",et["=="]="EQUAL",et["!="]="NOT_EQUAL",et["array-contains"]="ARRAY_CONTAINS",et.in="IN",et["not-in"]="NOT_IN",et["array-contains-any"]="ARRAY_CONTAINS_ANY",et})(),oh=(()=>{let et={};return et.and="AND",et.or="OR",et})();class od{constructor(et,er){this.databaseId=et,this.useProto3Json=er}}function of(et){let er=void 0===et.code?eP.UNKNOWN:aY(et.code);return new eL(er,et.message||"")}function om(et,er){return et.useProto3Json||nP(er)?er:{value:er}}function og(et){let er;return nP(er="object"==typeof et?et.value:et)?null:er}function oy(et,er){if(!et.useProto3Json)return{seconds:""+er.seconds,nanos:er.nanoseconds};{let et=new Date(1e3*er.seconds).toISOString(),en=et.replace(/\.\d*/,"").replace("Z",""),ei=("000000000"+er.nanoseconds).slice(-9);return`${en}.${ei}Z`}}function ov(et){let er=nb(et);return new e1(er.seconds,er.nanos)}function ob(et,er){return et.useProto3Json?er.toBase64():er.toUint8Array()}function oS(et,er){return et.useProto3Json?(eN(void 0===er||"string"==typeof er),nm.fromBase64String(er||"")):(eN(void 0===er||er instanceof Buffer||er instanceof Uint8Array),nm.fromUint8Array(er||new Uint8Array))}function oT(et,er){return oy(et,er.toTimestamp())}function ow(et){return eN(!!et),e2.fromTimestamp(ov(et))}function oE(et,er){return oC(et,er).canonicalString()}function oC(et,er){let en=oD(et).child("documents");return void 0===er?en:en.child(er)}function o_(et){let er=e9.fromString(et);return eN(lC(er)),er}function oI(et,er){return oE(et.databaseId,er.path)}function ok(et,er){let en=o_(er);if(en.get(1)!==et.databaseId.projectId)throw new eL(eP.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+en.get(1)+" vs "+et.databaseId.projectId);if(en.get(3)!==et.databaseId.database)throw new eL(eP.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+en.get(3)+" vs "+et.databaseId.database);return new e8(oO(en))}function ox(et,er){return oE(et.databaseId,er)}function oA(et){let er=o_(et);return 4===er.length?e9.emptyPath():oO(er)}function oR(et){let er=new e9(["projects",et.databaseId.projectId,"databases",et.databaseId.database]);return er.canonicalString()}function oD(et){return new e9(["projects",et.projectId,"databases",et.database])}function oO(et){return eN(et.length>4&&"documents"===et.get(4)),et.popFirst(5)}function oN(et,er,en){return{name:oI(et,er),fields:en.value.mapValue.fields}}function oM(et,er){return{name:oI(et,er.key),fields:er.data.value.mapValue.fields,updateTime:oy(et,er.version.toTimestamp()),createTime:oy(et,er.createTime.toTimestamp())}}function oP(et,er,en){let ei=ok(et,er.name),es=ow(er.updateTime),ea=er.createTime?ow(er.createTime):e2.min(),eo=new iN({mapValue:{fields:er.fields}}),eu=iP.newFoundDocument(ei,es,ea,eo);return en&&eu.setHasCommittedMutations(),en?eu.setHasCommittedMutations():eu}function oL(et,er){eN(!!er.found),er.found.name,er.found.updateTime;let en=ok(et,er.found.name),ei=ow(er.found.updateTime),es=er.found.createTime?ow(er.found.createTime):e2.min(),ea=new iN({mapValue:{fields:er.found.fields}});return iP.newFoundDocument(en,ei,es,ea)}function oF(et,er){eN(!!er.missing),eN(!!er.readTime);let en=ok(et,er.missing),ei=ow(er.readTime);return iP.newNoDocument(en,ei)}function oB(et,er){return"found"in er?oL(et,er):"missing"in er?oF(et,er):eO()}function oj(et,er){let en;if("targetChange"in er){er.targetChange;let ei=oU(er.targetChange.targetChangeType||"NO_CHANGE"),es=er.targetChange.targetIds||[],ea=oS(et,er.targetChange.resumeToken),eo=er.targetChange.cause,eu=eo&&of(eo);en=new ot(ei,es,ea,eu||null)}else if("documentChange"in er){er.documentChange;let ei=er.documentChange;ei.document,ei.document.name,ei.document.updateTime;let es=ok(et,ei.document.name),ea=ow(ei.document.updateTime),eo=ei.document.createTime?ow(ei.document.createTime):e2.min(),eu=new iN({mapValue:{fields:ei.document.fields}}),ec=iP.newFoundDocument(es,ea,eo,eu),eh=ei.targetIds||[],ed=ei.removedTargetIds||[];en=new a8(eh,ed,ec.key,ec)}else if("documentDelete"in er){er.documentDelete;let ei=er.documentDelete;ei.document;let es=ok(et,ei.document),ea=ei.readTime?ow(ei.readTime):e2.min(),eo=iP.newNoDocument(es,ea),eu=ei.removedTargetIds||[];en=new a8([],eu,eo.key,eo)}else if("documentRemove"in er){er.documentRemove;let ei=er.documentRemove;ei.document;let es=ok(et,ei.document),ea=ei.removedTargetIds||[];en=new a8([],ea,es,null)}else{if(!("filter"in er))return eO();er.filter;let et=er.filter;et.targetId;let{count:ei=0,unchangedNames:es}=et,ea=new aH(ei,es),eo=et.targetId;en=new a7(eo,ea)}return en}function oU(et){return"NO_CHANGE"===et?0:"ADD"===et?1:"REMOVE"===et?2:"CURRENT"===et?3:"RESET"===et?4:eO()}function oV(et){if(!("targetChange"in et))return e2.min();let er=et.targetChange;return er.targetIds&&er.targetIds.length||!er.readTime?e2.min():ow(er.readTime)}function oz(et,er){let en;if(er instanceof aD)en={update:oN(et,er.key,er.value)};else if(er instanceof aU)en={delete:oI(et,er.key)};else if(er instanceof aM)en={update:oN(et,er.key,er.data),updateMask:lw(er.fieldMask)};else{if(!(er instanceof aq))return eO();en={verify:oI(et,er.key)}}return er.fieldTransforms.length>0&&(en.updateTransforms=er.fieldTransforms.map(er=>oW(et,er))),er.precondition.isNone||(en.currentDocument=o$(et,er.precondition)),en}function oq(et,er){let en=er.currentDocument?oG(er.currentDocument):aE.none(),ei=er.updateTransforms?er.updateTransforms.map(er=>oQ(et,er)):[];if(er.update){er.update.name;let es=ok(et,er.update.name),ea=new iN({mapValue:{fields:er.update.fields}});if(!er.updateMask)return new aD(es,ea,en,ei);{let et=lE(er.updateMask);return new aM(es,ea,et,en,ei)}}if(er.delete){let ei=ok(et,er.delete);return new aU(ei,en)}if(!er.verify)return eO();{let ei=ok(et,er.verify);return new aq(ei,en)}}function o$(et,er){return void 0!==er.updateTime?{updateTime:oT(et,er.updateTime)}:void 0!==er.exists?{exists:er.exists}:eO()}function oG(et){return void 0!==et.updateTime?aE.updateTime(ow(et.updateTime)):void 0!==et.exists?aE.exists(et.exists):aE.none()}function oK(et,er){let en=et.updateTime?ow(et.updateTime):ow(er);return en.isEqual(e2.min())&&(en=ow(er)),new aw(en,et.transformResults||[])}function oH(et,er){return et&&et.length>0?(eN(void 0!==er),et.map(et=>oK(et,er))):[]}function oW(et,er){let en=er.transform;if(en instanceof ac)return{fieldPath:er.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(en instanceof ah)return{fieldPath:er.field.canonicalString(),appendMissingElements:{values:en.elements}};if(en instanceof ap)return{fieldPath:er.field.canonicalString(),removeAllFromArray:{values:en.elements}};if(en instanceof am)return{fieldPath:er.field.canonicalString(),increment:en.operand};throw eO()}function oQ(et,er){let en=null;if("setToServerValue"in er)eN("REQUEST_TIME"===er.setToServerValue),en=new ac;else if("appendMissingElements"in er){let et=er.appendMissingElements.values||[];en=new ah(et)}else if("removeAllFromArray"in er){let et=er.removeAllFromArray.values||[];en=new ap(et)}else"increment"in er?en=new am(et,er.increment):eO();let ei=e5.fromServerFormat(er.fieldPath);return new ab(ei,en)}function oY(et,er){return{documents:[ox(et,er.path)]}}function oJ(et){let er=et.documents.length;eN(1===er);let en=et.documents[0];return sR(sE(oA(en)))}function oX(et,er){let en;let ei={structuredQuery:{}},es=er.path;null!==er.collectionGroup?(en=es,ei.structuredQuery.from=[{collectionId:er.collectionGroup,allDescendants:!0}]):(en=es.popLast(),ei.structuredQuery.from=[{collectionId:es.lastSegment()}]),ei.parent=ox(et,en);let ea=o9(er.filters);ea&&(ei.structuredQuery.where=ea);let eo=o8(er.orderBy);eo&&(ei.structuredQuery.orderBy=eo);let eu=om(et,er.limit);return null!==eu&&(ei.structuredQuery.limit=eu),er.startAt&&(ei.structuredQuery.startAt=lt(er.startAt)),er.endAt&&(ei.structuredQuery.endAt=lr(er.endAt)),{queryTarget:ei,parent:en}}function oZ(et,er,en,ei){let{queryTarget:es,parent:ea}=oX(et,er),eo={},eu=[],ec=0;return en.forEach(et=>{let er=ei?et.alias:`aggregate_${ec++}`;eo[er]=et.alias,"count"===et.aggregateType?eu.push({alias:er,count:{}}):"avg"===et.aggregateType?eu.push({alias:er,avg:{field:ld(et.fieldPath)}}):"sum"===et.aggregateType&&eu.push({alias:er,sum:{field:ld(et.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:eu,structuredQuery:es.structuredQuery},parent:es.parent},aliasMap:eo,parent:ea}}function o0(et){let er=oA(et.parent),en=et.structuredQuery,ei=en.from?en.from.length:0,es=null;if(ei>0){eN(1===ei);let et=en.from[0];et.allDescendants?es=et.collectionId:er=er.child(et.collectionId)}let ea=[];en.where&&(ea=o4(en.where));let eo=[];en.orderBy&&(eo=o7(en.orderBy));let eu=null;en.limit&&(eu=og(en.limit));let ec=null;en.startAt&&(ec=ln(en.startAt));let eh=null;return en.endAt&&(eh=li(en.endAt)),sw(er,es,eo,ea,eu,"F",ec,eh)}function o1(et){return sR(o0(et))}function o2(et,er){let en=o3(er.purpose);return null==en?null:{"goog-listen-tags":en}}function o3(et){switch(et){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return eO()}}function o6(et,er){let en;let ei=er.target;if((en=sh(ei)?{documents:oY(et,ei)}:{query:oX(et,ei).queryTarget}).targetId=er.targetId,er.resumeToken.approximateByteSize()>0){en.resumeToken=ob(et,er.resumeToken);let ei=om(et,er.expectedCount);null!==ei&&(en.expectedCount=ei)}else if(er.snapshotVersion.compareTo(e2.min())>0){en.readTime=oy(et,er.snapshotVersion.toTimestamp());let ei=om(et,er.expectedCount);null!==ei&&(en.expectedCount=ei)}return en}function o9(et){if(0!==et.length)return lg(iW.create(et,"and"))}function o4(et){let er=o5(et);return er instanceof iW&&iJ(er)?er.getFilters():[er]}function o5(et){return void 0!==et.unaryFilter?lb(et):void 0!==et.fieldFilter?lS(et):void 0!==et.compositeFilter?lT(et):eO()}function o8(et){if(0!==et.length)return et.map(et=>lf(et))}function o7(et){return et.map(et=>lm(et))}function lt(et){return{before:et.inclusive,values:et.position}}function lr(et){return{before:!et.inclusive,values:et.position}}function ln(et){let er=!!et.before,en=et.values||[];return new iF(en,er)}function li(et){let er=!et.before,en=et.values||[];return new iF(en,er)}function ls(et){return ou[et]}function la(et){switch(et){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function ll(et){return oc[et]}function lu(et){return oh[et]}function lc(et){switch(et){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return eO()}}function lh(et){switch(et){case"AND":return"and";case"OR":return"or";default:return eO()}}function ld(et){return{fieldPath:et.canonicalString()}}function lp(et){return e5.fromServerFormat(et.fieldPath)}function lf(et){return{field:ld(et.field),direction:ls(et.dir)}}function lm(et){return new iz(lp(et.field),la(et.direction))}function lg(et){return et instanceof iH?lv(et):et instanceof iW?ly(et):eO()}function ly(et){let er=et.getFilters().map(et=>lg(et));return 1===er.length?er[0]:{compositeFilter:{op:lu(et.op),filters:er}}}function lv(et){if("=="===et.op){if(iE(et.value))return{unaryFilter:{field:ld(et.field),op:"IS_NAN"}};if(iw(et.value))return{unaryFilter:{field:ld(et.field),op:"IS_NULL"}}}else if("!="===et.op){if(iE(et.value))return{unaryFilter:{field:ld(et.field),op:"IS_NOT_NAN"}};if(iw(et.value))return{unaryFilter:{field:ld(et.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ld(et.field),op:ll(et.op),value:et.value}}}function lb(et){switch(et.unaryFilter.op){case"IS_NAN":let er=lp(et.unaryFilter.field);return iH.create(er,"==",{doubleValue:NaN});case"IS_NULL":let en=lp(et.unaryFilter.field);return iH.create(en,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let ei=lp(et.unaryFilter.field);return iH.create(ei,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let es=lp(et.unaryFilter.field);return iH.create(es,"!=",{nullValue:"NULL_VALUE"});default:return eO()}}function lS(et){return iH.create(lp(et.fieldFilter.field),lc(et.fieldFilter.op),et.fieldFilter.value)}function lT(et){return iW.create(et.compositeFilter.filters.map(et=>o5(et)),lh(et.compositeFilter.op))}function lw(et){let er=[];return et.fields.forEach(et=>er.push(et.canonicalString())),{fieldPaths:er}}function lE(et){let er=et.fieldPaths||[];return new nd(er.map(et=>e5.fromServerFormat(et)))}function lC(et){return et.length>=4&&"projects"===et.get(0)&&"databases"===et.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(et,er,en,ei,es=e2.min(),ea=e2.min(),eo=nm.EMPTY_BYTE_STRING,eu=null){this.target=et,this.targetId=er,this.purpose=en,this.sequenceNumber=ei,this.snapshotVersion=es,this.lastLimboFreeSnapshotVersion=ea,this.resumeToken=eo,this.expectedCount=eu}withSequenceNumber(et){return new l_(this.target,this.targetId,this.purpose,et,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(et,er){return new l_(this.target,this.targetId,this.purpose,this.sequenceNumber,er,this.lastLimboFreeSnapshotVersion,et,null)}withExpectedCount(et){return new l_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,et)}withLastLimboFreeSnapshotVersion(et){return new l_(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,et,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(et){this.remoteSerializer=et}}function lk(et,er){let en;if(er.document)en=oP(et.remoteSerializer,er.document,!!er.hasCommittedMutations);else if(er.noDocument){let et=e8.fromSegments(er.noDocument.path),ei=lO(er.noDocument.readTime);en=iP.newNoDocument(et,ei),er.hasCommittedMutations&&en.setHasCommittedMutations()}else{if(!er.unknownDocument)return eO();let et=e8.fromSegments(er.unknownDocument.path),ei=lO(er.unknownDocument.version);en=iP.newUnknownDocument(et,ei)}return er.readTime&&en.setReadTime(lR(er.readTime)),en}function lx(et,er){let en=er.key,ei={prefixPath:en.getCollectionPath().popLast().toArray(),collectionGroup:en.collectionGroup,documentId:en.path.lastSegment(),readTime:lA(er.readTime),hasCommittedMutations:er.hasCommittedMutations};if(er.isFoundDocument())ei.document=oM(et.remoteSerializer,er);else if(er.isNoDocument())ei.noDocument={path:en.path.toArray(),readTime:lD(er.version)};else{if(!er.isUnknownDocument())return eO();ei.unknownDocument={path:en.path.toArray(),version:lD(er.version)}}return ei}function lA(et){let er=et.toTimestamp();return[er.seconds,er.nanoseconds]}function lR(et){let er=new e1(et[0],et[1]);return e2.fromTimestamp(er)}function lD(et){let er=et.toTimestamp();return{seconds:er.seconds,nanoseconds:er.nanoseconds}}function lO(et){let er=new e1(et.seconds,et.nanoseconds);return e2.fromTimestamp(er)}function lN(et,er,en){let ei=en.baseMutations.map(er=>oz(et.remoteSerializer,er)),es=en.mutations.map(er=>oz(et.remoteSerializer,er));return{userId:er,batchId:en.batchId,localWriteTimeMs:en.localWriteTime.toMillis(),baseMutations:ei,mutations:es}}function lM(et,er){let en=(er.baseMutations||[]).map(er=>oq(et.remoteSerializer,er));for(let et=0;et<er.mutations.length-1;++et){let en=er.mutations[et],ei=et+1<er.mutations.length&&void 0!==er.mutations[et+1].transform;if(ei){let ei=er.mutations[et+1];en.updateTransforms=ei.transform.fieldTransforms,er.mutations.splice(et+1,1),++et}}let ei=er.mutations.map(er=>oq(et.remoteSerializer,er)),es=e1.fromMillis(er.localWriteTimeMs);return new a$(er.batchId,es,en,ei)}function lP(et){let er;let en=lO(et.readTime),ei=void 0!==et.lastLimboFreeSnapshotVersion?lO(et.lastLimboFreeSnapshotVersion):e2.min();return er=lF(et.query)?oJ(et.query):o1(et.query),new l_(er,et.targetId,"TargetPurposeListen",et.lastListenSequenceNumber,en,ei,nm.fromBase64String(et.resumeToken))}function lL(et,er){let en;let ei=lD(er.snapshotVersion),es=lD(er.lastLimboFreeSnapshotVersion);en=sh(er.target)?oY(et.remoteSerializer,er.target):oX(et.remoteSerializer,er.target).queryTarget;let ea=er.resumeToken.toBase64();return{targetId:er.targetId,canonicalId:sl(er.target),readTime:ei,resumeToken:ea,lastListenSequenceNumber:er.sequenceNumber,lastLimboFreeSnapshotVersion:es,query:en}}function lF(et){return void 0!==et.documents}function lB(et){return{id:et.bundleId,createTime:lO(et.createTime),version:et.version}}function lj(et){return{bundleId:et.id,createTime:lD(ow(et.createTime)),version:et.version}}function lU(et){return{name:et.name,query:lz(et.bundledQuery),readTime:lO(et.readTime)}}function lV(et){return{name:et.name,readTime:lD(ow(et.readTime)),bundledQuery:et.bundledQuery}}function lz(et){let er=o0({parent:et.parent,structuredQuery:et.structuredQuery});return"LAST"===et.limitType?sP(er,er.limit,"L"):er}function lq(et){return{name:et.name,query:lz(et.bundledQuery),readTime:ow(et.readTime)}}function l$(et){return{id:et.id,version:et.version,createTime:ow(et.createTime)}}function lG(et,er){return new aK(er.largestBatchId,oq(et.remoteSerializer,er.overlayMutation))}function lK(et,er,en){let[ei,es,ea]=lH(er,en.mutation.key);return{userId:er,collectionPath:es,documentId:ea,collectionGroup:en.mutation.key.getCollectionGroup(),largestBatchId:en.largestBatchId,overlayMutation:oz(et.remoteSerializer,en.mutation)}}function lH(et,er){let en=er.path.lastSegment(),ei=tG(er.path.popLast());return[et,ei,en]}function lW(et){return{indexId:et.indexId,collectionGroup:et.collectionGroup,fields:et.fields.map(et=>[et.fieldPath.canonicalString(),et.kind])}}function lQ(et,er){let en=er?new td(er.sequenceNumber,new tm(lO(er.readTime),new e8(tW(er.documentKey)),er.largestBatchId)):td.empty(),ei=et.fields.map(([et,er])=>new tc(e5.fromServerFormat(et),er));return new tr(et.indexId,et.collectionGroup,ei,en)}function lY(et,er,en,ei){return{indexId:et,uid:er,sequenceNumber:en,readTime:lD(ei.readTime),documentKey:tG(ei.documentKey.path),largestBatchId:ei.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJ{getBundleMetadata(et,er){return lX(et).get(er).next(et=>{if(et)return lB(et)})}saveBundleMetadata(et,er){return lX(et).put(lj(er))}getNamedQuery(et,er){return lZ(et).get(er).next(et=>{if(et)return lU(et)})}saveNamedQuery(et,er){return lZ(et).put(lV(er))}}function lX(et){return r4(et,rw)}function lZ(et){return r4(et,rC)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(et,er){this.serializer=et,this.userId=er}static forUser(et,er){let en=er.uid||"";return new l0(et,en)}getOverlay(et,er){return l1(et).get(lH(this.userId,er)).next(et=>et?lG(this.serializer,et):null)}getOverlays(et,er){let en=s2();return tS.forEach(er,er=>this.getOverlay(et,er).next(et=>{null!==et&&en.set(er,et)})).next(()=>en)}saveOverlays(et,er,en){let ei=[];return en.forEach((en,es)=>{let ea=new aK(er,es);ei.push(this.saveOverlay(et,ea))}),tS.waitFor(ei)}removeOverlaysForBatchId(et,er,en){let ei=new Set;er.forEach(et=>ei.add(tG(et.getCollectionPath())));let es=[];return ei.forEach(er=>{let ei=IDBKeyRange.bound([this.userId,er,en],[this.userId,er,en+1],!1,!0);es.push(l1(et).deleteAll(rU,ei))}),tS.waitFor(es)}getOverlaysForCollection(et,er,en){let ei=s2(),es=tG(er),ea=IDBKeyRange.bound([this.userId,es,en],[this.userId,es,Number.POSITIVE_INFINITY],!0);return l1(et).loadAll(rU,ea).next(et=>{for(let er of et){let et=lG(this.serializer,er);ei.set(et.getKey(),et)}return ei})}getOverlaysForCollectionGroup(et,er,en,ei){let es;let ea=s2(),eo=IDBKeyRange.bound([this.userId,er,en],[this.userId,er,Number.POSITIVE_INFINITY],!0);return l1(et).iterate({index:rz,range:eo},(et,er,en)=>{let eo=lG(this.serializer,er);ea.size()<ei||eo.largestBatchId===es?(ea.set(eo.getKey(),eo),es=eo.largestBatchId):en.done()}).next(()=>ea)}saveOverlay(et,er){return l1(et).put(lK(this.serializer,this.userId,er))}}function l1(et){return r4(et,rB)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{globalsStore(et){return r4(et,r$)}getSessionToken(et){let er=this.globalsStore(et);return er.get("sessionToken").next(et=>{let er=null==et?void 0:et.value;return er?nm.fromUint8Array(er):nm.EMPTY_BYTE_STRING})}setSessionToken(et,er){let en=this.globalsStore(et);return en.put({name:"sessionToken",value:er.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l3=5,l6=10,l9=13,l4=15,l5=20,l8=25,l7=30,ut=37,ur=45,un=50,ui=53,us=55,uo=60,ul=2;class uu{constructor(){}writeIndexValue(et,er){this.writeIndexValueAux(et,er),er.writeInfinity()}writeIndexValueAux(et,er){if("nullValue"in et)this.writeValueTypeLabel(er,l3);else if("booleanValue"in et)this.writeValueTypeLabel(er,l6),er.writeNumber(et.booleanValue?1:0);else if("integerValue"in et)this.writeValueTypeLabel(er,l4),er.writeNumber(nS(et.integerValue));else if("doubleValue"in et){let en=nS(et.doubleValue);isNaN(en)?this.writeValueTypeLabel(er,l9):(this.writeValueTypeLabel(er,l4),nL(en)?er.writeNumber(0):er.writeNumber(en))}else if("timestampValue"in et){let en=et.timestampValue;this.writeValueTypeLabel(er,l5),"string"==typeof en&&(en=nb(en)),er.writeString(`${en.seconds||""}`),er.writeNumber(en.nanos||0)}else if("stringValue"in et)this.writeIndexString(et.stringValue,er),this.writeTruncationMarker(er);else if("bytesValue"in et)this.writeValueTypeLabel(er,l7),er.writeBytes(nT(et.bytesValue)),this.writeTruncationMarker(er);else if("referenceValue"in et)this.writeIndexEntityRef(et.referenceValue,er);else if("geoPointValue"in et){let en=et.geoPointValue;this.writeValueTypeLabel(er,ur),er.writeNumber(en.latitude||0),er.writeNumber(en.longitude||0)}else"mapValue"in et?ik(et)?this.writeValueTypeLabel(er,Number.MAX_SAFE_INTEGER):i_(et)?this.writeIndexVector(et.mapValue,er):(this.writeIndexMap(et.mapValue,er),this.writeTruncationMarker(er)):"arrayValue"in et?(this.writeIndexArray(et.arrayValue,er),this.writeTruncationMarker(er)):eO()}writeIndexString(et,er){this.writeValueTypeLabel(er,l8),this.writeUnlabeledIndexString(et,er)}writeUnlabeledIndexString(et,er){er.writeString(et)}writeIndexMap(et,er){let en=et.fields||{};for(let et of(this.writeValueTypeLabel(er,us),Object.keys(en)))this.writeIndexString(et,er),this.writeIndexValueAux(en[et],er)}writeIndexVector(et,er){var en,ei;let es=et.fields||{};this.writeValueTypeLabel(er,ui);let ea=nz,eo=(null===(ei=null===(en=es[ea].arrayValue)||void 0===en?void 0:en.values)||void 0===ei?void 0:ei.length)||0;this.writeValueTypeLabel(er,l4),er.writeNumber(nS(eo)),this.writeIndexString(ea,er),this.writeIndexValueAux(es[ea],er)}writeIndexArray(et,er){let en=et.values||[];for(let et of(this.writeValueTypeLabel(er,un),en))this.writeIndexValueAux(et,er)}writeIndexEntityRef(et,er){this.writeValueTypeLabel(er,ut);let en=e8.fromName(et).path;en.forEach(et=>{this.writeValueTypeLabel(er,uo),this.writeUnlabeledIndexString(et,er)})}writeValueTypeLabel(et,er){et.writeNumber(er)}writeTruncationMarker(et){et.writeNumber(ul)}}uu.INSTANCE=new uu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uc="\uD800",uh="\uDBFF",ud=0,up=255,uf=1,um=255,ug=255,uy=0,uv=64,ub=8,uS=1024;function uT(et){let er=new DataView(new ArrayBuffer(8));return er.setFloat64(0,et,!1),new Uint8Array(er.buffer)}function uw(et){if(0===et)return 8;let er=0;return et>>4==0&&(er+=4,et<<=4),et>>6==0&&(er+=2,et<<=2),et>>7==0&&(er+=1),er}function uE(et){let er=0;for(let en=0;en<8;++en){let ei=uw(255&et[en]);if(er+=ei,8!==ei)break}return er}function uC(et){let er=uv-uE(et);return Math.ceil(er/ub)}class u_{constructor(){this.buffer=new Uint8Array(uS),this.position=0}writeBytesAscending(et){let er=et[Symbol.iterator](),en=er.next();for(;!en.done;)this.writeByteAscending(en.value),en=er.next();this.writeSeparatorAscending()}writeBytesDescending(et){let er=et[Symbol.iterator](),en=er.next();for(;!en.done;)this.writeByteDescending(en.value),en=er.next();this.writeSeparatorDescending()}writeUtf8Ascending(et){for(let er of et){let et=er.charCodeAt(0);if(et<128)this.writeByteAscending(et);else if(et<2048)this.writeByteAscending(960|et>>>6),this.writeByteAscending(128|63&et);else if(er<uc||uh<er)this.writeByteAscending(480|et>>>12),this.writeByteAscending(128|63&et>>>6),this.writeByteAscending(128|63&et);else{let et=er.codePointAt(0);this.writeByteAscending(240|et>>>18),this.writeByteAscending(128|63&et>>>12),this.writeByteAscending(128|63&et>>>6),this.writeByteAscending(128|63&et)}}this.writeSeparatorAscending()}writeUtf8Descending(et){for(let er of et){let et=er.charCodeAt(0);if(et<128)this.writeByteDescending(et);else if(et<2048)this.writeByteDescending(960|et>>>6),this.writeByteDescending(128|63&et);else if(er<uc||uh<er)this.writeByteDescending(480|et>>>12),this.writeByteDescending(128|63&et>>>6),this.writeByteDescending(128|63&et);else{let et=er.codePointAt(0);this.writeByteDescending(240|et>>>18),this.writeByteDescending(128|63&et>>>12),this.writeByteDescending(128|63&et>>>6),this.writeByteDescending(128|63&et)}}this.writeSeparatorDescending()}writeNumberAscending(et){let er=this.toOrderedBits(et),en=uC(er);this.ensureAvailable(1+en),this.buffer[this.position++]=255&en;for(let et=er.length-en;et<er.length;++et)this.buffer[this.position++]=255&er[et]}writeNumberDescending(et){let er=this.toOrderedBits(et),en=uC(er);this.ensureAvailable(1+en),this.buffer[this.position++]=~(255&en);for(let et=er.length-en;et<er.length;++et)this.buffer[this.position++]=~(255&er[et])}writeInfinityAscending(){this.writeEscapedByteAscending(um),this.writeEscapedByteAscending(ug)}writeInfinityDescending(){this.writeEscapedByteDescending(um),this.writeEscapedByteDescending(ug)}reset(){this.position=0}seed(et){this.ensureAvailable(et.length),this.buffer.set(et,this.position),this.position+=et.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(et){let er=uT(et),en=(128&er[0])!=0;er[0]^=en?255:128;for(let et=1;et<er.length;++et)er[et]^=en?255:0;return er}writeByteAscending(et){let er=255&et;er===ud?(this.writeEscapedByteAscending(ud),this.writeEscapedByteAscending(up)):er===um?(this.writeEscapedByteAscending(um),this.writeEscapedByteAscending(uy)):this.writeEscapedByteAscending(er)}writeByteDescending(et){let er=255&et;er===ud?(this.writeEscapedByteDescending(ud),this.writeEscapedByteDescending(up)):er===um?(this.writeEscapedByteDescending(um),this.writeEscapedByteDescending(uy)):this.writeEscapedByteDescending(et)}writeSeparatorAscending(){this.writeEscapedByteAscending(ud),this.writeEscapedByteAscending(uf)}writeSeparatorDescending(){this.writeEscapedByteDescending(ud),this.writeEscapedByteDescending(uf)}writeEscapedByteAscending(et){this.ensureAvailable(1),this.buffer[this.position++]=et}writeEscapedByteDescending(et){this.ensureAvailable(1),this.buffer[this.position++]=~et}ensureAvailable(et){let er=et+this.position;if(er<=this.buffer.length)return;let en=2*this.buffer.length;en<er&&(en=er);let ei=new Uint8Array(en);ei.set(this.buffer),this.buffer=ei}}class uI{constructor(et){this.orderedCode=et}writeBytes(et){this.orderedCode.writeBytesAscending(et)}writeString(et){this.orderedCode.writeUtf8Ascending(et)}writeNumber(et){this.orderedCode.writeNumberAscending(et)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class uk{constructor(et){this.orderedCode=et}writeBytes(et){this.orderedCode.writeBytesDescending(et)}writeString(et){this.orderedCode.writeUtf8Descending(et)}writeNumber(et){this.orderedCode.writeNumberDescending(et)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class ux{constructor(){this.orderedCode=new u_,this.ascending=new uI(this.orderedCode),this.descending=new uk(this.orderedCode)}seed(et){this.orderedCode.seed(et)}forKind(et){return 0===et?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(et,er,en,ei){this.indexId=et,this.documentKey=er,this.arrayValue=en,this.directionalValue=ei}successor(){let et=this.directionalValue.length,er=0===et||255===this.directionalValue[et-1]?et+1:et,en=new Uint8Array(er);return en.set(this.directionalValue,0),er!==et?en.set([0],this.directionalValue.length):++en[en.length-1],new uA(this.indexId,this.documentKey,this.arrayValue,en)}}function uR(et,er){let en=et.indexId-er.indexId;return 0!==en||0!==(en=uD(et.arrayValue,er.arrayValue))||0!==(en=uD(et.directionalValue,er.directionalValue))?en:e8.comparator(et.documentKey,er.documentKey)}function uD(et,er){for(let en=0;en<et.length&&en<er.length;++en){let ei=et[en]-er[en];if(0!==ei)return ei}return et.length-er.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(et){for(let er of(this.inequalityFilters=new no((et,er)=>e5.comparator(et.field,er.field)),this.collectionId=null!=et.collectionGroup?et.collectionGroup:et.path.lastSegment(),this.orderBys=et.orderBy,this.equalityFilters=[],et.filters)){let et=er;et.isInequality()?this.inequalityFilters=this.inequalityFilters.add(et):this.equalityFilters.push(et)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(et){if(eN(et.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let er=ti(et);if(void 0!==er&&!this.hasMatchingEqualityFilter(er))return!1;let en=ts(et),ei=new Set,es=0,ea=0;for(;es<en.length;++es)if(this.hasMatchingEqualityFilter(en[es]))ei=ei.add(en[es].fieldPath.canonicalString());else break;if(es===en.length)return!0;if(this.inequalityFilters.size>0){let et=this.inequalityFilters.getIterator().getNext();if(!ei.has(et.field.canonicalString())){let er=en[es];if(!this.matchesFilter(et,er)||!this.matchesOrderBy(this.orderBys[ea++],er))return!1}++es}for(;es<en.length;++es){let et=en[es];if(ea>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[ea++],et))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let et=new no(e5.comparator),er=[];for(let en of this.equalityFilters){if(en.field.isKeyField())continue;let ei="array-contains"===en.op||"array-contains-any"===en.op;if(ei)er.push(new tc(en.field,2));else{if(et.has(en.field))continue;et=et.add(en.field),er.push(new tc(en.field,0))}}for(let en of this.orderBys)en.field.isKeyField()||et.has(en.field)||(et=et.add(en.field),er.push(new tc(en.field,"asc"===en.dir?0:1)));return new tr(tr.UNKNOWN_ID,this.collectionId,er,td.empty())}hasMatchingEqualityFilter(et){for(let er of this.equalityFilters)if(this.matchesFilter(er,et))return!0;return!1}matchesFilter(et,er){if(void 0===et||!et.field.isEqual(er.fieldPath))return!1;let en="array-contains"===et.op||"array-contains-any"===et.op;return 2===er.kind===en}matchesOrderBy(et,er){return!!et.field.isEqual(er.fieldPath)&&(0===er.kind&&"asc"===et.dir||1===er.kind&&"desc"===et.dir)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(et){var er,en;if(eN(et instanceof iH||et instanceof iW),et instanceof iH){if(!(et instanceof sn))return et;{let ei=(null===(en=null===(er=et.value.arrayValue)||void 0===er?void 0:er.values)||void 0===en?void 0:en.map(er=>iH.create(et.field,"==",er)))||[];return iW.create(ei,"or")}}let ei=et.filters.map(et=>uN(et));return iW.create(ei,et.op)}function uM(et){if(0===et.getFilters().length)return[];let er=uj(uN(et));return(eN(uF(er)),uP(er)||uL(er))?[er]:er.getFilters()}function uP(et){return et instanceof iH}function uL(et){return et instanceof iW&&iJ(et)}function uF(et){return uP(et)||uL(et)||uB(et)}function uB(et){if(et instanceof iW&&iY(et)){for(let er of et.getFilters())if(!uP(er)&&!uL(er))return!1;return!0}return!1}function uj(et){if(eN(et instanceof iH||et instanceof iW),et instanceof iH)return et;if(1===et.filters.length)return uj(et.filters[0]);let er=et.filters.map(et=>uj(et)),en=iW.create(er,et.op);return uF(en=u$(en))?en:(eN(en instanceof iW),eN(iQ(en)),eN(en.filters.length>1),en.filters.reduce((et,er)=>uU(et,er)))}function uU(et,er){let en;return eN(et instanceof iH||et instanceof iW),eN(er instanceof iH||er instanceof iW),u$(en=et instanceof iH?er instanceof iH?uV(et,er):uq(et,er):er instanceof iH?uq(er,et):uz(et,er))}function uV(et,er){return iW.create([et,er],"and")}function uz(et,er){if(eN(et.filters.length>0&&er.filters.length>0),iQ(et)&&iQ(er))return i3(et,er.getFilters());let en=iY(et)?et:er,ei=iY(et)?er:et,es=en.filters.map(et=>uU(et,ei));return iW.create(es,"or")}function uq(et,er){if(iQ(er))return i3(er,et.getFilters());{let en=er.filters.map(er=>uU(et,er));return iW.create(en,"or")}}function u$(et){if(eN(et instanceof iH||et instanceof iW),et instanceof iH)return et;let er=et.getFilters();if(1===er.length)return u$(er[0]);if(iX(et))return et;let en=er.map(et=>u$(et)),ei=[];return(en.forEach(er=>{er instanceof iH?ei.push(er):er instanceof iW&&(er.op===et.op?ei.push(...er.filters):ei.push(er))}),1===ei.length)?ei[0]:iW.create(ei,et.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uG{constructor(){this.collectionParentIndex=new uK}addToCollectionParentIndex(et,er){return this.collectionParentIndex.add(er),tS.resolve()}getCollectionParents(et,er){return tS.resolve(this.collectionParentIndex.getEntries(er))}addFieldIndex(et,er){return tS.resolve()}deleteFieldIndex(et,er){return tS.resolve()}deleteAllFieldIndexes(et){return tS.resolve()}createTargetIndexes(et,er){return tS.resolve()}getDocumentsMatchingTarget(et,er){return tS.resolve(null)}getIndexType(et,er){return tS.resolve(0)}getFieldIndexes(et,er){return tS.resolve([])}getNextCollectionGroupToUpdate(et){return tS.resolve(null)}getMinOffset(et,er){return tS.resolve(tm.min())}getMinOffsetFromCollectionGroup(et,er){return tS.resolve(tm.min())}updateCollectionGroup(et,er,en){return tS.resolve()}updateIndexEntries(et,er){return tS.resolve()}}class uK{constructor(){this.index={}}add(et){let er=et.lastSegment(),en=et.popLast(),ei=this.index[er]||new no(e9.comparator),es=!ei.has(en);return this.index[er]=ei.add(en),es}has(et){let er=et.lastSegment(),en=et.popLast(),ei=this.index[er];return ei&&ei.has(en)}getEntries(et){let er=this.index[et]||new no(e9.comparator);return er.toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uH="IndexedDbIndexManager",uW=new Uint8Array(0);class uQ{constructor(et,er){this.databaseId=er,this.collectionParentsCache=new uK,this.targetToDnfSubTargets=new sQ(et=>sl(et),(et,er)=>sc(et,er)),this.uid=et.uid||""}addToCollectionParentIndex(et,er){if(!this.collectionParentsCache.has(er)){let en=er.lastSegment(),ei=er.popLast();et.addOnCommittedListener(()=>{this.collectionParentsCache.add(er)});let es={collectionId:en,parent:tG(ei)};return uY(et).put(es)}return tS.resolve()}getCollectionParents(et,er){let en=[],ei=IDBKeyRange.bound([er,""],[eX(er),""],!1,!0);return uY(et).loadAll(ei).next(et=>{for(let ei of et){if(ei.collectionId!==er)break;en.push(tW(ei.parent))}return en})}addFieldIndex(et,er){let en=uX(et),ei=lW(er);delete ei.indexId;let es=en.add(ei);if(!er.indexState)return es.next();{let en=uZ(et);return es.next(et=>{en.put(lY(et,this.uid,er.indexState.sequenceNumber,er.indexState.offset))})}}deleteFieldIndex(et,er){let en=uX(et),ei=uZ(et),es=uJ(et);return en.delete(er.indexId).next(()=>ei.delete(IDBKeyRange.bound([er.indexId],[er.indexId+1],!1,!0))).next(()=>es.delete(IDBKeyRange.bound([er.indexId],[er.indexId+1],!1,!0)))}deleteAllFieldIndexes(et){let er=uX(et),en=uJ(et),ei=uZ(et);return er.deleteAll().next(()=>en.deleteAll()).next(()=>ei.deleteAll())}createTargetIndexes(et,er){return tS.forEach(this.getSubTargets(er),er=>this.getIndexType(et,er).next(en=>{if(0===en||1===en){let en=new uO(er),ei=en.buildTargetIndex();if(null!=ei)return this.addFieldIndex(et,ei)}}))}getDocumentsMatchingTarget(et,er){let en=uJ(et),ei=!0,es=new Map;return tS.forEach(this.getSubTargets(er),er=>this.getFieldIndex(et,er).next(et=>{ei&&(ei=!!et),es.set(er,et)})).next(()=>{if(!ei)return tS.resolve(null);{let et=s8(),ei=[];return tS.forEach(es,(es,ea)=>{ex(uH,`Using index ${tu(es)} to execute ${sl(er)}`);let eo=sp(ea,es),eu=sf(ea,es),ec=sm(ea,es),eh=sg(ea,es),ed=this.encodeBound(es,ea,ec),ep=this.encodeBound(es,ea,eh),ef=this.encodeValues(es,ea,eu),em=this.generateIndexRanges(es.indexId,eo,ed,ec.inclusive,ep,eh.inclusive,ef);return tS.forEach(em,es=>en.loadFirst(es,er.limit).next(er=>{er.forEach(er=>{let en=e8.fromSegments(er.documentKey);et.has(en)||(et=et.add(en),ei.push(en))})}))}).next(()=>ei)}})}getSubTargets(et){let er=this.targetToDnfSubTargets.get(et);if(er)return er;if(0===et.filters.length)er=[et];else{let en=uM(iW.create(et.filters,"and"));er=en.map(er=>so(et.path,et.collectionGroup,et.orderBy,er.getFilters(),et.limit,et.startAt,et.endAt))}return this.targetToDnfSubTargets.set(et,er),er}generateIndexRanges(et,er,en,ei,es,ea,eo){let eu=(null!=er?er.length:1)*Math.max(en.length,es.length),ec=eu/(null!=er?er.length:1),eh=[];for(let ed=0;ed<eu;++ed){let eu=er?this.encodeSingleElement(er[ed/ec]):uW,ep=this.generateLowerBound(et,eu,en[ed%ec],ei),ef=this.generateUpperBound(et,eu,es[ed%ec],ea),em=eo.map(er=>this.generateLowerBound(et,eu,er,!0));eh.push(...this.createRange(ep,ef,em))}return eh}generateLowerBound(et,er,en,ei){let es=new uA(et,e8.empty(),er,en);return ei?es:es.successor()}generateUpperBound(et,er,en,ei){let es=new uA(et,e8.empty(),er,en);return ei?es.successor():es}getFieldIndex(et,er){let en=new uO(er),ei=null!=er.collectionGroup?er.collectionGroup:er.path.lastSegment();return this.getFieldIndexes(et,ei).next(et=>{let er=null;for(let ei of et){let et=en.servedByIndex(ei);et&&(!er||ei.fields.length>er.fields.length)&&(er=ei)}return er})}getIndexType(et,er){let en=2,ei=this.getSubTargets(er);return tS.forEach(ei,er=>this.getFieldIndex(et,er).next(et=>{et?0!==en&&et.fields.length<sb(er)&&(en=1):en=0})).next(()=>sS(er)&&ei.length>1&&2===en?1:en)}encodeDirectionalElements(et,er){let en=new ux;for(let ei of ts(et)){let et=er.data.field(ei.fieldPath);if(null==et)return null;let es=en.forKind(ei.kind);uu.INSTANCE.writeIndexValue(et,es)}return en.encodedBytes()}encodeSingleElement(et){let er=new ux;return uu.INSTANCE.writeIndexValue(et,er.forKind(0)),er.encodedBytes()}encodeDirectionalKey(et,er){let en=new ux;return uu.INSTANCE.writeIndexValue(iy(this.databaseId,er),en.forKind(ta(et))),en.encodedBytes()}encodeValues(et,er,en){if(null===en)return[];let ei=[];ei.push(new ux);let es=0;for(let ea of ts(et)){let et=en[es++];for(let en of ei)if(this.isInFilter(er,ea.fieldPath)&&iT(et))ei=this.expandIndexValues(ei,ea,et);else{let er=en.forKind(ea.kind);uu.INSTANCE.writeIndexValue(et,er)}}return this.getEncodedBytes(ei)}encodeBound(et,er,en){return this.encodeValues(et,er,en.position)}getEncodedBytes(et){let er=[];for(let en=0;en<et.length;++en)er[en]=et[en].encodedBytes();return er}expandIndexValues(et,er,en){let ei=[...et],es=[];for(let et of en.arrayValue.values||[])for(let en of ei){let ei=new ux;ei.seed(en.encodedBytes()),uu.INSTANCE.writeIndexValue(et,ei.forKind(er.kind)),es.push(ei)}return es}isInFilter(et,er){return!!et.filters.find(et=>et instanceof iH&&et.field.isEqual(er)&&("in"===et.op||"not-in"===et.op))}getFieldIndexes(et,er){let en=uX(et),ei=uZ(et);return(er?en.loadAll(rx,IDBKeyRange.bound(er,er)):en.loadAll()).next(et=>{let er=[];return tS.forEach(et,et=>ei.get([et.indexId,this.uid]).next(en=>{er.push(lQ(et,en))})).next(()=>er)})}getNextCollectionGroupToUpdate(et){return this.getFieldIndexes(et).next(et=>0===et.length?null:(et.sort((et,er)=>{let en=et.indexState.sequenceNumber-er.indexState.sequenceNumber;return 0!==en?en:eY(et.collectionGroup,er.collectionGroup)}),et[0].collectionGroup))}updateCollectionGroup(et,er,en){let ei=uX(et),es=uZ(et);return this.getNextSequenceNumber(et).next(et=>ei.loadAll(rx,IDBKeyRange.bound(er,er)).next(er=>tS.forEach(er,er=>es.put(lY(er.indexId,this.uid,et,en)))))}updateIndexEntries(et,er){let en=new Map;return tS.forEach(er,(er,ei)=>{let es=en.get(er.collectionGroup),ea=es?tS.resolve(es):this.getFieldIndexes(et,er.collectionGroup);return ea.next(es=>(en.set(er.collectionGroup,es),tS.forEach(es,en=>this.getExistingIndexEntries(et,er,en).next(er=>{let es=this.computeIndexEntries(ei,en);return er.isEqual(es)?tS.resolve():this.updateEntries(et,ei,en,er,es)}))))})}addIndexEntry(et,er,en,ei){let es=uJ(et);return es.put({indexId:ei.indexId,uid:this.uid,arrayValue:ei.arrayValue,directionalValue:ei.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(en,er.key),documentKey:er.key.path.toArray()})}deleteIndexEntry(et,er,en,ei){let es=uJ(et);return es.delete([ei.indexId,this.uid,ei.arrayValue,ei.directionalValue,this.encodeDirectionalKey(en,er.key),er.key.path.toArray()])}getExistingIndexEntries(et,er,en){let ei=uJ(et),es=new no(uR);return ei.iterate({index:rL,range:IDBKeyRange.only([en.indexId,this.uid,this.encodeDirectionalKey(en,er)])},(et,ei)=>{es=es.add(new uA(en.indexId,er,ei.arrayValue,ei.directionalValue))}).next(()=>es)}computeIndexEntries(et,er){let en=new no(uR),ei=this.encodeDirectionalElements(er,et);if(null==ei)return en;let es=ti(er);if(null!=es){let ea=et.data.field(es.fieldPath);if(iT(ea))for(let es of ea.arrayValue.values||[])en=en.add(new uA(er.indexId,et.key,this.encodeSingleElement(es),ei))}else en=en.add(new uA(er.indexId,et.key,uW,ei));return en}updateEntries(et,er,en,ei,es){ex(uH,"Updating index entries for document '%s'",er.key);let ea=[];return nc(ei,es,uR,ei=>{ea.push(this.addIndexEntry(et,er,en,ei))},ei=>{ea.push(this.deleteIndexEntry(et,er,en,ei))}),tS.waitFor(ea)}getNextSequenceNumber(et){let er=1,en=uZ(et);return en.iterate({index:rO,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(et,en,ei)=>{ei.done(),er=en.sequenceNumber+1}).next(()=>er)}createRange(et,er,en){en=en.sort((et,er)=>uR(et,er)).filter((et,er,en)=>!er||0!==uR(et,en[er-1]));let ei=[];for(let es of(ei.push(et),en)){let en=uR(es,et),ea=uR(es,er);if(0===en)ei[0]=et.successor();else if(en>0&&ea<0)ei.push(es),ei.push(es.successor());else if(ea>0)break}ei.push(er);let es=[];for(let et=0;et<ei.length;et+=2){if(this.isRangeMatchable(ei[et],ei[et+1]))return[];let er=[ei[et].indexId,this.uid,ei[et].arrayValue,ei[et].directionalValue,uW,[]],en=[ei[et+1].indexId,this.uid,ei[et+1].arrayValue,ei[et+1].directionalValue,uW,[]];es.push(IDBKeyRange.bound(er,en))}return es}isRangeMatchable(et,er){return uR(et,er)>0}getMinOffsetFromCollectionGroup(et,er){return this.getFieldIndexes(et,er).next(u0)}getMinOffset(et,er){return tS.mapArray(this.getSubTargets(er),er=>this.getFieldIndex(et,er).next(et=>et||eO())).next(u0)}}function uY(et){return r4(et,rv)}function uJ(et){return r4(et,rM)}function uX(et){return r4(et,rI)}function uZ(et){return r4(et,rR)}function u0(et){eN(0!==et.length);let er=et[0].indexState.offset,en=er.largestBatchId;for(let ei=1;ei<et.length;ei++){let es=et[ei].indexState.offset;0>tg(es,er)&&(er=es),en<es.largestBatchId&&(en=es.largestBatchId)}return new tm(er.readTime,er.documentKey,en)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(et,er,en){let ei=et.store(t0),es=et.store(t8),ea=[],eo=IDBKeyRange.only(en.batchId),eu=0,ec=ei.iterate({range:eo},(et,er,en)=>(eu++,en.delete()));ea.push(ec.next(()=>{eN(1===eu)}));let eh=[];for(let et of en.mutations){let ei=t4(er,et.key.path,en.batchId);ea.push(es.delete(ei)),eh.push(et.key)}return tS.waitFor(ea).next(()=>eh)}function u2(et){let er;if(!et)return 0;if(et.document)er=et.document;else if(et.unknownDocument)er=et.unknownDocument;else if(et.noDocument)er=et.noDocument;else throw eO();return JSON.stringify(er).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(et,er,en,ei){this.userId=et,this.serializer=er,this.indexManager=en,this.referenceDelegate=ei,this.documentKeysByBatchId={}}static forUser(et,er,en,ei){eN(""!==et.uid);let es=et.isAuthenticated()?et.uid:"";return new u3(es,er,en,ei)}checkEmpty(et){let er=!0,en=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return u4(et).iterate({index:t2,range:en},(et,en,ei)=>{er=!1,ei.done()}).next(()=>er)}addMutationBatch(et,er,en,ei){let es=u5(et),ea=u4(et);return ea.add({}).next(eo=>{eN("number"==typeof eo);let eu=new a$(eo,er,en,ei),ec=lN(this.serializer,this.userId,eu),eh=[],ed=new no((et,er)=>eY(et.canonicalString(),er.canonicalString()));for(let et of ei){let er=t4(this.userId,et.key.path,eo);ed=ed.add(et.key.path.popLast()),eh.push(ea.put(ec)),eh.push(es.put(er,t5))}return ed.forEach(er=>{eh.push(this.indexManager.addToCollectionParentIndex(et,er))}),et.addOnCommittedListener(()=>{this.documentKeysByBatchId[eo]=eu.keys()}),tS.waitFor(eh).next(()=>eu)})}lookupMutationBatch(et,er){return u4(et).get(er).next(et=>et?(eN(et.userId===this.userId),lM(this.serializer,et)):null)}lookupMutationKeys(et,er){return this.documentKeysByBatchId[er]?tS.resolve(this.documentKeysByBatchId[er]):this.lookupMutationBatch(et,er).next(et=>{if(!et)return null;{let en=et.keys();return this.documentKeysByBatchId[er]=en,en}})}getNextMutationBatchAfterBatchId(et,er){let en=er+1,ei=IDBKeyRange.lowerBound([this.userId,en]),es=null;return u4(et).iterate({index:t2,range:ei},(et,er,ei)=>{er.userId===this.userId&&(eN(er.batchId>=en),es=lM(this.serializer,er)),ei.done()}).next(()=>es)}getHighestUnacknowledgedBatchId(et){let er=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),en=nM;return u4(et).iterate({index:t2,range:er,reverse:!0},(et,er,ei)=>{en=er.batchId,ei.done()}).next(()=>en)}getAllMutationBatches(et){let er=IDBKeyRange.bound([this.userId,nM],[this.userId,Number.POSITIVE_INFINITY]);return u4(et).loadAll(t2,er).next(et=>et.map(et=>lM(this.serializer,et)))}getAllMutationBatchesAffectingDocumentKey(et,er){let en=t9(this.userId,er.path),ei=IDBKeyRange.lowerBound(en),es=[];return u5(et).iterate({range:ei},(en,ei,ea)=>{let[eo,eu,ec]=en,eh=tW(eu);if(eo!==this.userId||!er.path.isEqual(eh)){ea.done();return}return u4(et).get(ec).next(et=>{if(!et)throw eO();eN(et.userId===this.userId),es.push(lM(this.serializer,et))})}).next(()=>es)}getAllMutationBatchesAffectingDocumentKeys(et,er){let en=new no(eY),ei=[];return er.forEach(er=>{let es=t9(this.userId,er.path),ea=IDBKeyRange.lowerBound(es),eo=u5(et).iterate({range:ea},(et,ei,es)=>{let[ea,eo,eu]=et,ec=tW(eo);if(ea!==this.userId||!er.path.isEqual(ec)){es.done();return}en=en.add(eu)});ei.push(eo)}),tS.waitFor(ei).next(()=>this.lookupMutationBatches(et,en))}getAllMutationBatchesAffectingQuery(et,er){let en=er.path,ei=en.length+1,es=t9(this.userId,en),ea=IDBKeyRange.lowerBound(es),eo=new no(eY);return u5(et).iterate({range:ea},(et,er,es)=>{let[ea,eu,ec]=et,eh=tW(eu);if(ea!==this.userId||!en.isPrefixOf(eh)){es.done();return}eh.length===ei&&(eo=eo.add(ec))}).next(()=>this.lookupMutationBatches(et,eo))}lookupMutationBatches(et,er){let en=[],ei=[];return er.forEach(er=>{ei.push(u4(et).get(er).next(et=>{if(null===et)throw eO();eN(et.userId===this.userId),en.push(lM(this.serializer,et))}))}),tS.waitFor(ei).next(()=>en)}removeMutationBatch(et,er){return u1(et.simpleDbTransaction,this.userId,er).next(en=>(et.addOnCommittedListener(()=>{this.removeCachedMutationKeys(er.batchId)}),tS.forEach(en,er=>this.referenceDelegate.markPotentiallyOrphaned(et,er))))}removeCachedMutationKeys(et){delete this.documentKeysByBatchId[et]}performConsistencyCheck(et){return this.checkEmpty(et).next(er=>{if(!er)return tS.resolve();let en=IDBKeyRange.lowerBound(t6(this.userId)),ei=[];return u5(et).iterate({range:en},(et,er,en)=>{let es=et[0];if(es!==this.userId){en.done();return}{let er=tW(et[1]);ei.push(er)}}).next(()=>{eN(0===ei.length)})})}containsKey(et,er){return u6(et,this.userId,er)}getMutationQueueMetadata(et){return u8(et).get(this.userId).next(et=>et||{userId:this.userId,lastAcknowledgedBatchId:nM,lastStreamToken:""})}}function u6(et,er,en){let ei=t9(er,en.path),es=ei[1],ea=IDBKeyRange.lowerBound(ei),eo=!1;return u5(et).iterate({range:ea,keysOnly:!0},(et,en,ei)=>{let[ea,eu,ec]=et;ea===er&&eu===es&&(eo=!0),ei.done()}).next(()=>eo)}function u9(et,er){let en=!1;return u8(et).iterateSerial(ei=>u6(et,ei,er).next(et=>(et&&(en=!0),tS.resolve(!et)))).next(()=>en)}function u4(et){return r4(et,t0)}function u5(et){return r4(et,t8)}function u8(et){return r4(et,tX)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u7=2;class ct{constructor(et){this.lastId=et}next(){return this.lastId+=u7,this.lastId}static forTargetCache(){return new ct(2-u7)}static forSyncEngine(){return new ct(1-u7)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(et,er){this.referenceDelegate=et,this.serializer=er}allocateTargetId(et){return this.retrieveMetadata(et).next(er=>{let en=new ct(er.highestTargetId);return er.highestTargetId=en.next(),this.saveMetadata(et,er).next(()=>er.highestTargetId)})}getLastRemoteSnapshotVersion(et){return this.retrieveMetadata(et).next(et=>e2.fromTimestamp(new e1(et.lastRemoteSnapshotVersion.seconds,et.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(et){return this.retrieveMetadata(et).next(et=>et.highestListenSequenceNumber)}setTargetsMetadata(et,er,en){return this.retrieveMetadata(et).next(ei=>(ei.highestListenSequenceNumber=er,en&&(ei.lastRemoteSnapshotVersion=en.toTimestamp()),er>ei.highestListenSequenceNumber&&(ei.highestListenSequenceNumber=er),this.saveMetadata(et,ei)))}addTargetData(et,er){return this.saveTargetData(et,er).next(()=>this.retrieveMetadata(et).next(en=>(en.targetCount+=1,this.updateMetadataFromTargetData(er,en),this.saveMetadata(et,en))))}updateTargetData(et,er){return this.saveTargetData(et,er)}removeTargetData(et,er){return this.removeMatchingKeysForTargetId(et,er.targetId).next(()=>cn(et).delete(er.targetId)).next(()=>this.retrieveMetadata(et)).next(er=>(eN(er.targetCount>0),er.targetCount-=1,this.saveMetadata(et,er)))}removeTargets(et,er,en){let ei=0,es=[];return cn(et).iterate((ea,eo)=>{let eu=lP(eo);eu.sequenceNumber<=er&&null===en.get(eu.targetId)&&(ei++,es.push(this.removeTargetData(et,eu)))}).next(()=>tS.waitFor(es)).next(()=>ei)}forEachTarget(et,er){return cn(et).iterate((et,en)=>{let ei=lP(en);er(ei)})}retrieveMetadata(et){return ci(et).get(rg).next(et=>(eN(null!==et),et))}saveMetadata(et,er){return ci(et).put(rg,er)}saveTargetData(et,er){return cn(et).put(lL(this.serializer,er))}updateMetadataFromTargetData(et,er){let en=!1;return et.targetId>er.highestTargetId&&(er.highestTargetId=et.targetId,en=!0),et.sequenceNumber>er.highestListenSequenceNumber&&(er.highestListenSequenceNumber=et.sequenceNumber,en=!0),en}getTargetCount(et){return this.retrieveMetadata(et).next(et=>et.targetCount)}getTargetData(et,er){let en=sl(er),ei=IDBKeyRange.bound([en,Number.NEGATIVE_INFINITY],[en,Number.POSITIVE_INFINITY]),es=null;return cn(et).iterate({range:ei,index:rc},(et,en,ei)=>{let ea=lP(en);sc(er,ea.target)&&(es=ea,ei.done())}).next(()=>es)}addMatchingKeys(et,er,en){let ei=[],es=cs(et);return er.forEach(er=>{let ea=tG(er.path);ei.push(es.put({targetId:en,path:ea})),ei.push(this.referenceDelegate.addReference(et,en,er))}),tS.waitFor(ei)}removeMatchingKeys(et,er,en){let ei=cs(et);return tS.forEach(er,er=>{let es=tG(er.path);return tS.waitFor([ei.delete([en,es]),this.referenceDelegate.removeReference(et,en,er)])})}removeMatchingKeysForTargetId(et,er){let en=cs(et),ei=IDBKeyRange.bound([er],[er+1],!1,!0);return en.delete(ei)}getMatchingKeysForTargetId(et,er){let en=IDBKeyRange.bound([er],[er+1],!1,!0),ei=cs(et),es=s8();return ei.iterate({range:en,keysOnly:!0},(et,er,en)=>{let ei=tW(et[1]),ea=new e8(ei);es=es.add(ea)}).next(()=>es)}containsKey(et,er){let en=tG(er.path),ei=IDBKeyRange.bound([en],[eX(en)],!1,!0),es=0;return cs(et).iterate({index:rf,keysOnly:!0,range:ei},([et,er],en,ei)=>{0!==et&&(es++,ei.done())}).next(()=>es>0)}getTargetDataForTarget(et,er){return cn(et).get(er).next(et=>et?lP(et):null)}}function cn(et){return r4(et,rl)}function ci(et){return r4(et,ry)}function cs(et){return r4(et,rd)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ca={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},co=-1,cl=41943040;class cu{static withCacheSize(et){return new cu(et,cu.DEFAULT_COLLECTION_PERCENTILE,cu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(et,er,en){this.cacheSizeCollectionThreshold=et,this.percentileToCollect=er,this.maximumSequenceNumbersToCollect=en}}cu.DEFAULT_COLLECTION_PERCENTILE=10,cu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cu.DEFAULT=new cu(cl,cu.DEFAULT_COLLECTION_PERCENTILE,cu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cu.DISABLED=new cu(co,0,0);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cc="LruGarbageCollector",ch=1048576,cd=6e4,cp=3e5;function cf([et,er],[en,ei]){let es=eY(et,en);return 0===es?eY(er,ei):es}class cm{constructor(et){this.maxElements=et,this.buffer=new no(cf),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(et){let er=[et,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(er);else{let et=this.buffer.last();0>cf(er,et)&&(this.buffer=this.buffer.delete(et).add(er))}}get maxValue(){return this.buffer.last()[0]}}class cy{constructor(et,er,en){this.garbageCollector=et,this.asyncQueue=er,this.localStore=en,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==co&&this.scheduleGC(cd)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(et){ex(cc,`Garbage collection scheduled in ${et}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",et,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(et){tA(et)?ex(cc,"Ignoring IndexedDB error during garbage collection: ",et):await tb(et)}await this.scheduleGC(cp)})}}class cv{constructor(et,er){this.delegate=et,this.params=er}calculateTargetCount(et,er){return this.delegate.getSequenceNumberCount(et).next(et=>Math.floor(er/100*et))}nthSequenceNumber(et,er){if(0===er)return tS.resolve(tU.INVALID);let en=new cm(er);return this.delegate.forEachTarget(et,et=>en.addElement(et.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(et,et=>en.addElement(et))).next(()=>en.maxValue)}removeTargets(et,er,en){return this.delegate.removeTargets(et,er,en)}removeOrphanedDocuments(et,er){return this.delegate.removeOrphanedDocuments(et,er)}collect(et,er){return this.params.cacheSizeCollectionThreshold===co?(ex("LruGarbageCollector","Garbage collection skipped; disabled"),tS.resolve(ca)):this.getCacheSize(et).next(en=>en<this.params.cacheSizeCollectionThreshold?(ex("LruGarbageCollector",`Garbage collection skipped; Cache size ${en} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ca):this.runGarbageCollection(et,er))}getCacheSize(et){return this.delegate.getCacheSize(et)}runGarbageCollection(et,er){let en,ei,es,ea,eo,eu,ec;let ed=Date.now();return this.calculateTargetCount(et,this.params.percentileToCollect).next(er=>(er>this.params.maximumSequenceNumbersToCollect?(ex("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${er}`),ei=this.params.maximumSequenceNumbersToCollect):ei=er,ea=Date.now(),this.nthSequenceNumber(et,ei))).next(ei=>(en=ei,eo=Date.now(),this.removeTargets(et,en,er))).next(er=>(es=er,eu=Date.now(),this.removeOrphanedDocuments(et,en))).next(et=>{if(ec=Date.now(),ek()<=eh.in.DEBUG){let er=`LRU Garbage Collection
	Counted targets in ${ea-ed}ms
	Determined least recently used ${ei} in ${eo-ea}ms
	Removed ${es} targets in ${eu-eo}ms
	Removed ${et} documents in ${ec-eu}ms
Total Duration: ${ec-ed}ms`;ex("LruGarbageCollector",er)}return tS.resolve({didRun:!0,sequenceNumbersCollected:ei,targetsRemoved:es,documentsRemoved:et})})}}function cS(et,er){return new cv(et,er)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(et,er){this.db=et,this.garbageCollector=cS(this,er)}getSequenceNumberCount(et){let er=this.orphanedDocumentCount(et),en=this.db.getTargetCache().getTargetCount(et);return en.next(et=>er.next(er=>et+er))}orphanedDocumentCount(et){let er=0;return this.forEachOrphanedDocumentSequenceNumber(et,et=>{er++}).next(()=>er)}forEachTarget(et,er){return this.db.getTargetCache().forEachTarget(et,er)}forEachOrphanedDocumentSequenceNumber(et,er){return this.forEachOrphanedDocument(et,(et,en)=>er(en))}addReference(et,er,en){return cC(et,en)}removeReference(et,er,en){return cC(et,en)}removeTargets(et,er,en){return this.db.getTargetCache().removeTargets(et,er,en)}markPotentiallyOrphaned(et,er){return cC(et,er)}isPinned(et,er){return u9(et,er)}removeOrphanedDocuments(et,er){let en=this.db.getRemoteDocumentCache(),ei=en.newChangeBuffer(),es=[],ea=0,eo=this.forEachOrphanedDocument(et,(en,eo)=>{if(eo<=er){let er=this.isPinned(et,en).next(er=>{if(!er)return ea++,ei.getEntry(et,en).next(()=>(ei.removeEntry(en,e2.min()),cs(et).delete(cw(en))))});es.push(er)}});return eo.next(()=>tS.waitFor(es)).next(()=>ei.apply(et)).next(()=>ea)}removeTarget(et,er){let en=er.withSequenceNumber(et.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(et,en)}updateLimboDocument(et,er){return cC(et,er)}forEachOrphanedDocument(et,er){let en;let ei=cs(et),es=tU.INVALID;return ei.iterate({index:rf},([et,ei],{path:ea,sequenceNumber:eo})=>{0===et?(es!==tU.INVALID&&er(new e8(tW(en)),es),es=eo,en=ea):es=tU.INVALID}).next(()=>{es!==tU.INVALID&&er(new e8(tW(en)),es)})}getCacheSize(et){return this.db.getRemoteDocumentCache().getSize(et)}}function cw(et){return[0,tG(et.path)]}function cE(et,er){return{targetId:0,path:tG(et.path),sequenceNumber:er}}function cC(et,er){return cs(et).put(cE(er,et.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(){this.changes=new sQ(et=>et.toString(),(et,er)=>et.isEqual(er)),this.changesApplied=!1}addEntry(et){this.assertNotApplied(),this.changes.set(et.key,et)}removeEntry(et,er){this.assertNotApplied(),this.changes.set(et,iP.newInvalidDocument(et).setReadTime(er))}getEntry(et,er){this.assertNotApplied();let en=this.changes.get(er);return void 0!==en?tS.resolve(en):this.getFromCache(et,er)}getEntries(et,er){return this.getAllFromCache(et,er)}apply(et){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(et)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(et){this.serializer=et}setIndexManager(et){this.indexManager=et}addEntry(et,er,en){let ei=cR(et);return ei.put(en)}removeEntry(et,er,en){let ei=cR(et);return ei.delete(cO(er,en))}updateMetadata(et,er){return this.getMetadata(et).next(en=>(en.byteSize+=er,this.setMetadata(et,en)))}getEntry(et,er){let en=iP.newInvalidDocument(er);return cR(et).iterate({index:rr,range:IDBKeyRange.only(cD(er))},(et,ei)=>{en=this.maybeDecodeDocument(er,ei)}).next(()=>en)}getSizedEntry(et,er){let en={size:0,document:iP.newInvalidDocument(er)};return cR(et).iterate({index:rr,range:IDBKeyRange.only(cD(er))},(et,ei)=>{en={document:this.maybeDecodeDocument(er,ei),size:u2(ei)}}).next(()=>en)}getEntries(et,er){let en=sJ();return this.forEachDbEntry(et,er,(et,er)=>{let ei=this.maybeDecodeDocument(et,er);en=en.insert(et,ei)}).next(()=>en)}getSizedEntries(et,er){let en=sJ(),ei=new nt(e8.comparator);return this.forEachDbEntry(et,er,(et,er)=>{let es=this.maybeDecodeDocument(et,er);en=en.insert(et,es),ei=ei.insert(et,u2(er))}).next(()=>({documents:en,sizeMap:ei}))}forEachDbEntry(et,er,en){if(er.isEmpty())return tS.resolve();let ei=new no(cM);er.forEach(et=>ei=ei.add(et));let es=IDBKeyRange.bound(cD(ei.first()),cD(ei.last())),ea=ei.getIterator(),eo=ea.getNext();return cR(et).iterate({index:rr,range:es},(et,er,ei)=>{let es=e8.fromSegments([...er.prefixPath,er.collectionGroup,er.documentId]);for(;eo&&0>cM(eo,es);)en(eo,null),eo=ea.getNext();eo&&eo.isEqual(es)&&(en(eo,er),eo=ea.hasNext()?ea.getNext():null),eo?ei.skip(cD(eo)):ei.done()}).next(()=>{for(;eo;)en(eo,null),eo=ea.hasNext()?ea.getNext():null})}getDocumentsMatchingQuery(et,er,en,ei,es){let ea=er.path,eo=[ea.popLast().toArray(),ea.lastSegment(),lA(en.readTime),en.documentKey.path.isEmpty()?"":en.documentKey.path.lastSegment()],eu=[ea.popLast().toArray(),ea.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return cR(et).loadAll(IDBKeyRange.bound(eo,eu,!0)).next(et=>{null==es||es.incrementDocumentReadCount(et.length);let en=sJ();for(let es of et){let et=this.maybeDecodeDocument(e8.fromSegments(es.prefixPath.concat(es.collectionGroup,es.documentId)),es);et.isFoundDocument()&&(sV(er,et)||ei.has(et.key))&&(en=en.insert(et.key,et))}return en})}getAllFromCollectionGroup(et,er,en,ei){let es=sJ(),ea=cN(er,en),eo=cN(er,tm.max());return cR(et).iterate({index:ri,range:IDBKeyRange.bound(ea,eo,!0)},(et,er,en)=>{let ea=this.maybeDecodeDocument(e8.fromSegments(er.prefixPath.concat(er.collectionGroup,er.documentId)),er);(es=es.insert(ea.key,ea)).size===ei&&en.done()}).next(()=>es)}newChangeBuffer(et){return new cx(this,!!et&&et.trackRemovals)}getSize(et){return this.getMetadata(et).next(et=>et.byteSize)}getMetadata(et){return cA(et).get(ro).next(et=>(eN(!!et),et))}setMetadata(et,er){return cA(et).put(ro,er)}maybeDecodeDocument(et,er){if(er){let et=lk(this.serializer,er),en=et.isNoDocument()&&et.version.isEqual(e2.min());if(!en)return et}return iP.newInvalidDocument(et)}}function ck(et){return new cI(et)}class cx extends null{constructor(et,er){super(),this.documentCache=et,this.trackRemovals=er,this.documentStates=new sQ(et=>et.toString(),(et,er)=>et.isEqual(er))}applyChanges(et){let er=[],en=0,ei=new no((et,er)=>eY(et.canonicalString(),er.canonicalString()));return this.changes.forEach((es,ea)=>{let eo=this.documentStates.get(es);if(er.push(this.documentCache.removeEntry(et,es,eo.readTime)),ea.isValidDocument()){let eu=lx(this.documentCache.serializer,ea);ei=ei.add(es.path.popLast());let ec=u2(eu);en+=ec-eo.size,er.push(this.documentCache.addEntry(et,es,eu))}else if(en-=eo.size,this.trackRemovals){let en=lx(this.documentCache.serializer,ea.convertToNoDocument(e2.min()));er.push(this.documentCache.addEntry(et,es,en))}}),ei.forEach(en=>{er.push(this.documentCache.indexManager.addToCollectionParentIndex(et,en))}),er.push(this.documentCache.updateMetadata(et,en)),tS.waitFor(er)}getFromCache(et,er){return this.documentCache.getSizedEntry(et,er).next(et=>(this.documentStates.set(er,{size:et.size,readTime:et.document.readTime}),et.document))}getAllFromCache(et,er){return this.documentCache.getSizedEntries(et,er).next(({documents:et,sizeMap:er})=>(er.forEach((er,en)=>{this.documentStates.set(er,{size:en,readTime:et.get(er).readTime})}),et))}}function cA(et){return r4(et,ra)}function cR(et){return r4(et,t7)}function cD(et){let er=et.path.toArray();return[er.slice(0,er.length-2),er[er.length-2],er[er.length-1]]}function cO(et,er){let en=et.path.toArray();return[en.slice(0,en.length-2),en[en.length-2],lA(er),en[en.length-1]]}function cN(et,er){let en=er.documentKey.path.toArray();return[et,lA(er.readTime),en.slice(0,en.length-2),en.length>0?en[en.length-1]:""]}function cM(et,er){let en=et.path.toArray(),ei=er.path.toArray(),es=0;for(let et=0;et<en.length-2&&et<ei.length-2;++et)if(es=eY(en[et],ei[et]))return es;return(es=eY(en.length,ei.length))||(es=eY(en[en.length-2],ei[ei.length-2]))?es:eY(en[en.length-1],ei[ei.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cP=17;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(et,er){this.overlayedDocument=et,this.mutatedFields=er}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(et,er,en,ei){this.remoteDocumentCache=et,this.mutationQueue=er,this.documentOverlayCache=en,this.indexManager=ei}getDocument(et,er){let en=null;return this.documentOverlayCache.getOverlay(et,er).next(ei=>(en=ei,this.remoteDocumentCache.getEntry(et,er))).next(et=>(null!==en&&ax(en.mutation,et,nd.empty(),e1.now()),et))}getDocuments(et,er){return this.remoteDocumentCache.getEntries(et,er).next(er=>this.getLocalViewOfDocuments(et,er,s8()).next(()=>er))}getLocalViewOfDocuments(et,er,en=s8()){let ei=s2();return this.populateOverlays(et,ei,er).next(()=>this.computeViews(et,er,ei,en).next(et=>{let er=sZ();return et.forEach((et,en)=>{er=er.insert(et,en.overlayedDocument)}),er}))}getOverlayedDocuments(et,er){let en=s2();return this.populateOverlays(et,en,er).next(()=>this.computeViews(et,er,en,s8()))}populateOverlays(et,er,en){let ei=[];return en.forEach(et=>{er.has(et)||ei.push(et)}),this.documentOverlayCache.getOverlays(et,ei).next(et=>{et.forEach((et,en)=>{er.set(et,en)})})}computeViews(et,er,en,ei){let es=sJ(),ea=s6(),eo=s0();return er.forEach((et,er)=>{let eo=en.get(er.key);ei.has(er.key)&&(void 0===eo||eo.mutation instanceof aM)?es=es.insert(er.key,er):void 0!==eo?(ea.set(er.key,eo.mutation.getFieldMask()),ax(eo.mutation,er,eo.mutation.getFieldMask(),e1.now())):ea.set(er.key,nd.empty())}),this.recalculateAndSaveOverlays(et,es).next(et=>(et.forEach((et,er)=>ea.set(et,er)),er.forEach((et,er)=>{var en;return eo.set(et,new cL(er,null!==(en=ea.get(et))&&void 0!==en?en:null))}),eo))}recalculateAndSaveOverlays(et,er){let en=s6(),ei=new nt((et,er)=>et-er),es=s8();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(et,er).next(et=>{for(let es of et)es.keys().forEach(et=>{let ea=er.get(et);if(null===ea)return;let eo=en.get(et)||nd.empty();eo=es.applyToLocalView(ea,eo),en.set(et,eo);let eu=(ei.get(es.batchId)||s8()).add(et);ei=ei.insert(es.batchId,eu)})}).next(()=>{let ea=[],eo=ei.getReverseIterator();for(;eo.hasNext();){let ei=eo.getNext(),eu=ei.key,ec=ei.value,eh=s3();ec.forEach(et=>{if(!es.has(et)){let ei=aI(er.get(et),en.get(et));null!==ei&&eh.set(et,ei),es=es.add(et)}}),ea.push(this.documentOverlayCache.saveOverlays(et,eu,eh))}return tS.waitFor(ea)}).next(()=>en)}recalculateAndSaveOverlaysForDocumentKeys(et,er){return this.remoteDocumentCache.getEntries(et,er).next(er=>this.recalculateAndSaveOverlays(et,er))}getDocumentsMatchingQuery(et,er,en,ei){return sk(er)?this.getDocumentsMatchingDocumentQuery(et,er.path):sx(er)?this.getDocumentsMatchingCollectionGroupQuery(et,er,en,ei):this.getDocumentsMatchingCollectionQuery(et,er,en,ei)}getNextDocuments(et,er,en,ei){return this.remoteDocumentCache.getAllFromCollectionGroup(et,er,en,ei).next(es=>{let ea=ei-es.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(et,er,en.largestBatchId,ei-es.size):tS.resolve(s2()),eo=e7,eu=es;return ea.next(er=>tS.forEach(er,(er,en)=>(eo<en.largestBatchId&&(eo=en.largestBatchId),es.get(er))?tS.resolve():this.remoteDocumentCache.getEntry(et,er).next(et=>{eu=eu.insert(er,et)})).next(()=>this.populateOverlays(et,er,es)).next(()=>this.computeViews(et,eu,er,s8())).next(et=>({batchId:eo,changes:s1(et)})))})}getDocumentsMatchingDocumentQuery(et,er){return this.getDocument(et,new e8(er)).next(et=>{let er=sZ();return et.isFoundDocument()&&(er=er.insert(et.key,et)),er})}getDocumentsMatchingCollectionGroupQuery(et,er,en,ei){let es=er.collectionGroup,ea=sZ();return this.indexManager.getCollectionParents(et,es).next(eo=>tS.forEach(eo,eo=>{let eu=sC(er,eo.child(es));return this.getDocumentsMatchingCollectionQuery(et,eu,en,ei).next(et=>{et.forEach((et,er)=>{ea=ea.insert(et,er)})})}).next(()=>ea))}getDocumentsMatchingCollectionQuery(et,er,en,ei){let es;return this.documentOverlayCache.getOverlaysForCollection(et,er.path,en.largestBatchId).next(ea=>(es=ea,this.remoteDocumentCache.getDocumentsMatchingQuery(et,er,en,es,ei))).next(et=>{es.forEach((er,en)=>{let ei=en.getKey();null===et.get(ei)&&(et=et.insert(ei,iP.newInvalidDocument(ei)))});let en=sZ();return et.forEach((et,ei)=>{let ea=es.get(et);void 0!==ea&&ax(ea.mutation,ei,nd.empty(),e1.now()),sV(er,ei)&&(en=en.insert(et,ei))}),en})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(et){this.serializer=et,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(et,er){return tS.resolve(this.bundles.get(er))}saveBundleMetadata(et,er){return this.bundles.set(er.id,l$(er)),tS.resolve()}getNamedQuery(et,er){return tS.resolve(this.namedQueries.get(er))}saveNamedQuery(et,er){return this.namedQueries.set(er.name,lq(er)),tS.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(){this.overlays=new nt(e8.comparator),this.overlayByBatchId=new Map}getOverlay(et,er){return tS.resolve(this.overlays.get(er))}getOverlays(et,er){let en=s2();return tS.forEach(er,er=>this.getOverlay(et,er).next(et=>{null!==et&&en.set(er,et)})).next(()=>en)}saveOverlays(et,er,en){return en.forEach((en,ei)=>{this.saveOverlay(et,er,ei)}),tS.resolve()}removeOverlaysForBatchId(et,er,en){let ei=this.overlayByBatchId.get(en);return void 0!==ei&&(ei.forEach(et=>this.overlays=this.overlays.remove(et)),this.overlayByBatchId.delete(en)),tS.resolve()}getOverlaysForCollection(et,er,en){let ei=s2(),es=er.length+1,ea=new e8(er.child("")),eo=this.overlays.getIteratorFrom(ea);for(;eo.hasNext();){let et=eo.getNext(),ea=et.value,eu=ea.getKey();if(!er.isPrefixOf(eu.path))break;eu.path.length===es&&ea.largestBatchId>en&&ei.set(ea.getKey(),ea)}return tS.resolve(ei)}getOverlaysForCollectionGroup(et,er,en,ei){let es=new nt((et,er)=>et-er),ea=this.overlays.getIterator();for(;ea.hasNext();){let et=ea.getNext(),ei=et.value,eo=ei.getKey();if(eo.getCollectionGroup()===er&&ei.largestBatchId>en){let et=es.get(ei.largestBatchId);null===et&&(et=s2(),es=es.insert(ei.largestBatchId,et)),et.set(ei.getKey(),ei)}}let eo=s2(),eu=es.getIterator();for(;eu.hasNext();){let et=eu.getNext(),er=et.value;if(er.forEach((et,er)=>eo.set(et,er)),eo.size()>=ei)break}return tS.resolve(eo)}saveOverlay(et,er,en){let ei=this.overlays.get(en.key);if(null!==ei){let et=this.overlayByBatchId.get(ei.largestBatchId).delete(en.key);this.overlayByBatchId.set(ei.largestBatchId,et)}this.overlays=this.overlays.insert(en.key,new aK(er,en));let es=this.overlayByBatchId.get(er);void 0===es&&(es=s8(),this.overlayByBatchId.set(er,es)),this.overlayByBatchId.set(er,es.add(en.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(){this.sessionToken=nm.EMPTY_BYTE_STRING}getSessionToken(et){return tS.resolve(this.sessionToken)}setSessionToken(et,er){return this.sessionToken=er,tS.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this.refsByKey=new no(cz.compareByKey),this.refsByTarget=new no(cz.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(et,er){let en=new cz(et,er);this.refsByKey=this.refsByKey.add(en),this.refsByTarget=this.refsByTarget.add(en)}addReferences(et,er){et.forEach(et=>this.addReference(et,er))}removeReference(et,er){this.removeRef(new cz(et,er))}removeReferences(et,er){et.forEach(et=>this.removeReference(et,er))}removeReferencesForId(et){let er=new e8(new e9([])),en=new cz(er,et),ei=new cz(er,et+1),es=[];return this.refsByTarget.forEachInRange([en,ei],et=>{this.removeRef(et),es.push(et.key)}),es}removeAllReferences(){this.refsByKey.forEach(et=>this.removeRef(et))}removeRef(et){this.refsByKey=this.refsByKey.delete(et),this.refsByTarget=this.refsByTarget.delete(et)}referencesForId(et){let er=new e8(new e9([])),en=new cz(er,et),ei=new cz(er,et+1),es=s8();return this.refsByTarget.forEachInRange([en,ei],et=>{es=es.add(et.key)}),es}containsKey(et){let er=new cz(et,0),en=this.refsByKey.firstAfterOrEqual(er);return null!==en&&et.isEqual(en.key)}}class cz{constructor(et,er){this.key=et,this.targetOrBatchId=er}static compareByKey(et,er){return e8.comparator(et.key,er.key)||eY(et.targetOrBatchId,er.targetOrBatchId)}static compareByTargetId(et,er){return eY(et.targetOrBatchId,er.targetOrBatchId)||e8.comparator(et.key,er.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(et,er){this.indexManager=et,this.referenceDelegate=er,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new no(cz.compareByKey)}checkEmpty(et){return tS.resolve(0===this.mutationQueue.length)}addMutationBatch(et,er,en,ei){let es=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let ea=new a$(es,er,en,ei);for(let er of(this.mutationQueue.push(ea),ei))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new cz(er.key,es)),this.indexManager.addToCollectionParentIndex(et,er.key.path.popLast());return tS.resolve(ea)}lookupMutationBatch(et,er){return tS.resolve(this.findMutationBatch(er))}getNextMutationBatchAfterBatchId(et,er){let en=er+1,ei=this.indexOfBatchId(en),es=ei<0?0:ei;return tS.resolve(this.mutationQueue.length>es?this.mutationQueue[es]:null)}getHighestUnacknowledgedBatchId(){return tS.resolve(0===this.mutationQueue.length?nM:this.nextBatchId-1)}getAllMutationBatches(et){return tS.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(et,er){let en=new cz(er,0),ei=new cz(er,Number.POSITIVE_INFINITY),es=[];return this.batchesByDocumentKey.forEachInRange([en,ei],et=>{let er=this.findMutationBatch(et.targetOrBatchId);es.push(er)}),tS.resolve(es)}getAllMutationBatchesAffectingDocumentKeys(et,er){let en=new no(eY);return er.forEach(et=>{let er=new cz(et,0),ei=new cz(et,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([er,ei],et=>{en=en.add(et.targetOrBatchId)})}),tS.resolve(this.findMutationBatches(en))}getAllMutationBatchesAffectingQuery(et,er){let en=er.path,ei=en.length+1,es=en;e8.isDocumentKey(es)||(es=es.child(""));let ea=new cz(new e8(es),0),eo=new no(eY);return this.batchesByDocumentKey.forEachWhile(et=>{let er=et.key.path;return!!en.isPrefixOf(er)&&(er.length===ei&&(eo=eo.add(et.targetOrBatchId)),!0)},ea),tS.resolve(this.findMutationBatches(eo))}findMutationBatches(et){let er=[];return et.forEach(et=>{let en=this.findMutationBatch(et);null!==en&&er.push(en)}),er}removeMutationBatch(et,er){let en=this.indexOfExistingBatchId(er.batchId,"removed");eN(0===en),this.mutationQueue.shift();let ei=this.batchesByDocumentKey;return tS.forEach(er.mutations,en=>{let es=new cz(en.key,er.batchId);return ei=ei.delete(es),this.referenceDelegate.markPotentiallyOrphaned(et,en.key)}).next(()=>{this.batchesByDocumentKey=ei})}removeCachedMutationKeys(et){}containsKey(et,er){let en=new cz(er,0),ei=this.batchesByDocumentKey.firstAfterOrEqual(en);return tS.resolve(er.isEqual(ei&&ei.key))}performConsistencyCheck(et){return this.mutationQueue.length,tS.resolve()}indexOfExistingBatchId(et,er){let en=this.indexOfBatchId(et);return en}indexOfBatchId(et){if(0===this.mutationQueue.length)return 0;let er=this.mutationQueue[0].batchId;return et-er}findMutationBatch(et){let er=this.indexOfBatchId(et);if(er<0||er>=this.mutationQueue.length)return null;let en=this.mutationQueue[er];return en}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c$="-9223372036854775808";function cG(){return new nt(e8.comparator)}class cK{constructor(et){this.sizer=et,this.docs=cG(),this.size=0}setIndexManager(et){this.indexManager=et}addEntry(et,er){let en=er.key,ei=this.docs.get(en),es=ei?ei.size:0,ea=this.sizer(er);return this.docs=this.docs.insert(en,{document:er.mutableCopy(),size:ea}),this.size+=ea-es,this.indexManager.addToCollectionParentIndex(et,en.path.popLast())}removeEntry(et){let er=this.docs.get(et);er&&(this.docs=this.docs.remove(et),this.size-=er.size)}getEntry(et,er){let en=this.docs.get(er);return tS.resolve(en?en.document.mutableCopy():iP.newInvalidDocument(er))}getEntries(et,er){let en=sJ();return er.forEach(et=>{let er=this.docs.get(et);en=en.insert(et,er?er.document.mutableCopy():iP.newInvalidDocument(et))}),tS.resolve(en)}getDocumentsMatchingQuery(et,er,en,ei){let es=sJ(),ea=er.path,eo=new e8(ea.child("__id"+c$+"__")),eu=this.docs.getIteratorFrom(eo);for(;eu.hasNext();){let{key:et,value:{document:eo}}=eu.getNext();if(!ea.isPrefixOf(et.path))break;!(et.path.length>ea.length+1||0>=tg(tf(eo),en))&&(ei.has(eo.key)||sV(er,eo))&&(es=es.insert(eo.key,eo.mutableCopy()))}return tS.resolve(es)}getAllFromCollectionGroup(et,er,en,ei){eO()}forEachDocumentKey(et,er){return tS.forEach(this.docs,et=>er(et))}newChangeBuffer(et){return new cW(this)}getSize(et){return tS.resolve(this.size)}}function cH(et){return new cK(et)}class cW extends c_{constructor(et){super(),this.documentCache=et}applyChanges(et){let er=[];return this.changes.forEach((en,ei)=>{ei.isValidDocument()?er.push(this.documentCache.addEntry(et,ei)):this.documentCache.removeEntry(en)}),tS.waitFor(er)}getFromCache(et,er){return this.documentCache.getEntry(et,er)}getAllFromCache(et,er){return this.documentCache.getEntries(et,er)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(et){this.persistence=et,this.targets=new sQ(et=>sl(et),sc),this.lastRemoteSnapshotVersion=e2.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new cV,this.targetCount=0,this.targetIdGenerator=ct.forTargetCache()}forEachTarget(et,er){return this.targets.forEach((et,en)=>er(en)),tS.resolve()}getLastRemoteSnapshotVersion(et){return tS.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(et){return tS.resolve(this.highestSequenceNumber)}allocateTargetId(et){return this.highestTargetId=this.targetIdGenerator.next(),tS.resolve(this.highestTargetId)}setTargetsMetadata(et,er,en){return en&&(this.lastRemoteSnapshotVersion=en),er>this.highestSequenceNumber&&(this.highestSequenceNumber=er),tS.resolve()}saveTargetData(et){this.targets.set(et.target,et);let er=et.targetId;er>this.highestTargetId&&(this.targetIdGenerator=new ct(er),this.highestTargetId=er),et.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=et.sequenceNumber)}addTargetData(et,er){return this.saveTargetData(er),this.targetCount+=1,tS.resolve()}updateTargetData(et,er){return this.saveTargetData(er),tS.resolve()}removeTargetData(et,er){return this.targets.delete(er.target),this.references.removeReferencesForId(er.targetId),this.targetCount-=1,tS.resolve()}removeTargets(et,er,en){let ei=0,es=[];return this.targets.forEach((ea,eo)=>{eo.sequenceNumber<=er&&null===en.get(eo.targetId)&&(this.targets.delete(ea),es.push(this.removeMatchingKeysForTargetId(et,eo.targetId)),ei++)}),tS.waitFor(es).next(()=>ei)}getTargetCount(et){return tS.resolve(this.targetCount)}getTargetData(et,er){let en=this.targets.get(er)||null;return tS.resolve(en)}addMatchingKeys(et,er,en){return this.references.addReferences(er,en),tS.resolve()}removeMatchingKeys(et,er,en){this.references.removeReferences(er,en);let ei=this.persistence.referenceDelegate,es=[];return ei&&er.forEach(er=>{es.push(ei.markPotentiallyOrphaned(et,er))}),tS.waitFor(es)}removeMatchingKeysForTargetId(et,er){return this.references.removeReferencesForId(er),tS.resolve()}getMatchingKeysForTargetId(et,er){let en=this.references.referencesForId(er);return tS.resolve(en)}containsKey(et,er){return tS.resolve(this.references.containsKey(er))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cY="MemoryPersistence";class cJ{constructor(et,er){this.mutationQueues={},this.overlays={},this.listenSequence=new tU(0),this._started=!1,this._started=!0,this.globalsCache=new cU,this.referenceDelegate=et(this),this.targetCache=new cQ(this);let en=et=>this.referenceDelegate.documentSize(et);this.indexManager=new uG,this.remoteDocumentCache=cH(en),this.serializer=new lI(er),this.bundleCache=new cB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(et){return this.indexManager}getDocumentOverlayCache(et){let er=this.overlays[et.toKey()];return er||(er=new cj,this.overlays[et.toKey()]=er),er}getMutationQueue(et,er){let en=this.mutationQueues[et.toKey()];return en||(en=new cq(er,this.referenceDelegate),this.mutationQueues[et.toKey()]=en),en}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(et,er,en){ex(cY,"Starting transaction:",et);let ei=new cX(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),en(ei).next(et=>this.referenceDelegate.onTransactionCommitted(ei).next(()=>et)).toPromise().then(et=>(ei.raiseOnCommittedEvent(),et))}mutationQueuesContainKey(et,er){return tS.or(Object.values(this.mutationQueues).map(en=>()=>en.containsKey(et,er)))}}class cX extends tv{constructor(et){super(),this.currentSequenceNumber=et}}class cZ{constructor(et){this.persistence=et,this.localViewReferences=new cV,this._orphanedDocuments=null}static factory(et){return new cZ(et)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw eO()}addReference(et,er,en){return this.localViewReferences.addReference(en,er),this.orphanedDocuments.delete(en.toString()),tS.resolve()}removeReference(et,er,en){return this.localViewReferences.removeReference(en,er),this.orphanedDocuments.add(en.toString()),tS.resolve()}markPotentiallyOrphaned(et,er){return this.orphanedDocuments.add(er.toString()),tS.resolve()}removeTarget(et,er){let en=this.localViewReferences.removeReferencesForId(er.targetId);en.forEach(et=>this.orphanedDocuments.add(et.toString()));let ei=this.persistence.getTargetCache();return ei.getMatchingKeysForTargetId(et,er.targetId).next(et=>{et.forEach(et=>this.orphanedDocuments.add(et.toString()))}).next(()=>ei.removeTargetData(et,er))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(et){let er=this.persistence.getRemoteDocumentCache(),en=er.newChangeBuffer();return tS.forEach(this.orphanedDocuments,er=>{let ei=e8.fromPath(er);return this.isReferenced(et,ei).next(et=>{et||en.removeEntry(ei,e2.min())})}).next(()=>(this._orphanedDocuments=null,en.apply(et)))}updateLimboDocument(et,er){return this.isReferenced(et,er).next(et=>{et?this.orphanedDocuments.delete(er.toString()):this.orphanedDocuments.add(er.toString())})}documentSize(et){return 0}isReferenced(et,er){return tS.or([()=>tS.resolve(this.localViewReferences.containsKey(er)),()=>this.persistence.getTargetCache().containsKey(et,er),()=>this.persistence.mutationQueuesContainKey(et,er)])}}class c0{constructor(et,er){this.persistence=et,this.orphanedSequenceNumbers=new sQ(et=>tG(et.path),(et,er)=>et.isEqual(er)),this.garbageCollector=cS(this,er)}static factory(et,er){return new c0(et,er)}onTransactionStarted(){}onTransactionCommitted(et){return tS.resolve()}forEachTarget(et,er){return this.persistence.getTargetCache().forEachTarget(et,er)}getSequenceNumberCount(et){let er=this.orphanedDocumentCount(et),en=this.persistence.getTargetCache().getTargetCount(et);return en.next(et=>er.next(er=>et+er))}orphanedDocumentCount(et){let er=0;return this.forEachOrphanedDocumentSequenceNumber(et,et=>{er++}).next(()=>er)}forEachOrphanedDocumentSequenceNumber(et,er){return tS.forEach(this.orphanedSequenceNumbers,(en,ei)=>this.isPinned(et,en,ei).next(et=>et?tS.resolve():er(ei)))}removeTargets(et,er,en){return this.persistence.getTargetCache().removeTargets(et,er,en)}removeOrphanedDocuments(et,er){let en=0,ei=this.persistence.getRemoteDocumentCache(),es=ei.newChangeBuffer(),ea=ei.forEachDocumentKey(et,ei=>this.isPinned(et,ei,er).next(et=>{et||(en++,es.removeEntry(ei,e2.min()))}));return ea.next(()=>es.apply(et)).next(()=>en)}markPotentiallyOrphaned(et,er){return this.orphanedSequenceNumbers.set(er,et.currentSequenceNumber),tS.resolve()}removeTarget(et,er){let en=er.withSequenceNumber(et.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(et,en)}addReference(et,er,en){return this.orphanedSequenceNumbers.set(en,et.currentSequenceNumber),tS.resolve()}removeReference(et,er,en){return this.orphanedSequenceNumbers.set(en,et.currentSequenceNumber),tS.resolve()}updateLimboDocument(et,er){return this.orphanedSequenceNumbers.set(er,et.currentSequenceNumber),tS.resolve()}documentSize(et){let er=et.key.toString().length;return et.isFoundDocument()&&(er+=ip(et.data.value)),er}isPinned(et,er,en){return tS.or([()=>this.persistence.mutationQueuesContainKey(et,er),()=>this.persistence.getTargetCache().containsKey(et,er),()=>{let et=this.orphanedSequenceNumbers.get(er);return tS.resolve(void 0!==et&&et>en)}])}getCacheSize(et){return this.persistence.getRemoteDocumentCache().getSize(et)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(et){this.serializer=et}createOrUpgrade(et,er,en,ei){let es=new tE("createOrUpgrade",er);en<1&&ei>=1&&(c5(et),c8(et),hs(et),ht(et));let ea=tS.resolve();return en<3&&ei>=3&&(0!==en&&(ha(et),hs(et)),ea=ea.next(()=>hl(es))),en<4&&ei>=4&&(0!==en&&(ea=ea.next(()=>c7(et,es))),ea=ea.next(()=>{hu(et)})),en<5&&ei>=5&&(ea=ea.next(()=>this.removeAcknowledgedMutations(es))),en<6&&ei>=6&&(ea=ea.next(()=>(hn(et),this.addDocumentGlobal(es)))),en<7&&ei>=7&&(ea=ea.next(()=>this.ensureSequenceNumbers(es))),en<8&&ei>=8&&(ea=ea.next(()=>this.createCollectionParentIndex(et,es))),en<9&&ei>=9&&(ea=ea.next(()=>{ho(et)})),en<10&&ei>=10&&(ea=ea.next(()=>this.rewriteCanonicalIds(es))),en<11&&ei>=11&&(ea=ea.next(()=>{hc(et),hh(et)})),en<12&&ei>=12&&(ea=ea.next(()=>{hp(et)})),en<13&&ei>=13&&(ea=ea.next(()=>hr(et)).next(()=>this.rewriteRemoteDocumentCache(et,es)).next(()=>et.deleteObjectStore(tQ))),en<14&&ei>=14&&(ea=ea.next(()=>this.runOverlayMigration(et,es))),en<15&&ei>=15&&(ea=ea.next(()=>hd(et))),en<16&&ei>=16&&(ea=ea.next(()=>{let et=er.objectStore(rR);et.clear()}).next(()=>{let et=er.objectStore(rM);et.clear()})),en<17&&ei>=17&&(ea=ea.next(()=>{hf(et)})),ea}addDocumentGlobal(et){let er=0;return et.store(tQ).iterate((et,en)=>{er+=u2(en)}).next(()=>{let en={byteSize:er};return et.store(ra).put(ro,en)})}removeAcknowledgedMutations(et){let er=et.store(tX),en=et.store(t0);return er.loadAll().next(er=>tS.forEach(er,er=>{let ei=IDBKeyRange.bound([er.userId,nM],[er.userId,er.lastAcknowledgedBatchId]);return en.loadAll(t2,ei).next(en=>tS.forEach(en,en=>{eN(en.userId===er.userId);let ei=lM(this.serializer,en);return u1(et,er.userId,ei).next(()=>{})}))}))}ensureSequenceNumbers(et){let er=et.store(rd),en=et.store(tQ),ei=et.store(ry);return ei.get(rg).next(et=>{let ei=en=>er.put({targetId:0,path:tG(en),sequenceNumber:et.highestListenSequenceNumber}),es=[];return en.iterate((et,en)=>{let ea=new e9(et),eo=c9(ea);es.push(er.get(eo).next(et=>et?tS.resolve():ei(ea)))}).next(()=>tS.waitFor(es))})}createCollectionParentIndex(et,er){et.createObjectStore(rv,{keyPath:rb});let en=er.store(rv),ei=new uK,es=et=>{if(ei.add(et)){let er=et.lastSegment(),ei=et.popLast();return en.put({collectionId:er,parent:tG(ei)})}};return er.store(tQ).iterate({keysOnly:!0},(et,er)=>{let en=new e9(et);return es(en.popLast())}).next(()=>er.store(t8).iterate({keysOnly:!0},([et,er,en],ei)=>{let ea=tW(er);return es(ea.popLast())}))}rewriteCanonicalIds(et){let er=et.store(rl);return er.iterate((et,en)=>{let ei=lP(en),es=lL(this.serializer,ei);return er.put(es)})}rewriteRemoteDocumentCache(et,er){let en=er.store(tQ),ei=[];return en.iterate((et,en)=>{let es=er.store(t7),ea=hm(en).path.toArray(),eo={prefixPath:ea.slice(0,ea.length-2),collectionGroup:ea[ea.length-2],documentId:ea[ea.length-1],readTime:en.readTime||[0,0],unknownDocument:en.unknownDocument,noDocument:en.noDocument,document:en.document,hasCommittedMutations:!!en.hasCommittedMutations};ei.push(es.put(eo))}).next(()=>tS.waitFor(ei))}runOverlayMigration(et,er){let en=er.store(t0),ei=ck(this.serializer),es=new cJ(cZ.factory,this.serializer.remoteSerializer);return en.loadAll().next(et=>{let en=new Map;return et.forEach(et=>{var er;let ei=null!==(er=en.get(et.userId))&&void 0!==er?er:s8(),es=lM(this.serializer,et);es.keys().forEach(et=>ei=ei.add(et)),en.set(et.userId,ei)}),tS.forEach(en,(et,en)=>{let ea=new eT(en),eo=l0.forUser(this.serializer,ea),eu=es.getIndexManager(ea),ec=u3.forUser(ea,this.serializer,eu,es.referenceDelegate),eh=new cF(ei,ec,eo,eu);return eh.recalculateAndSaveOverlaysForDocumentKeys(new r9(er,tU.INVALID),et).next()})})}}function c9(et){return[0,tG(et)]}function c5(et){et.createObjectStore(tY)}function c8(et){et.createObjectStore(tX,{keyPath:tZ});let er=et.createObjectStore(t0,{keyPath:t1,autoIncrement:!0});er.createIndex(t2,t3,{unique:!0}),et.createObjectStore(t8)}function c7(et,er){let en=er.store(t0);return en.loadAll().next(en=>{et.deleteObjectStore(t0);let ei=et.createObjectStore(t0,{keyPath:t1,autoIncrement:!0});ei.createIndex(t2,t3,{unique:!0});let es=er.store(t0),ea=en.map(et=>es.put(et));return tS.waitFor(ea)})}function ht(et){et.createObjectStore(tQ)}function hr(et){let er=et.createObjectStore(t7,{keyPath:rt});er.createIndex(rr,rn),er.createIndex(ri,rs)}function hn(et){et.createObjectStore(ra)}function hs(et){let er=et.createObjectStore(rd,{keyPath:rp});er.createIndex(rf,rm,{unique:!0});let en=et.createObjectStore(rl,{keyPath:ru});en.createIndex(rc,rh,{unique:!0}),et.createObjectStore(ry)}function ha(et){et.deleteObjectStore(rd),et.deleteObjectStore(rl),et.deleteObjectStore(ry)}function ho(et){et.objectStoreNames.contains("remoteDocumentChanges")&&et.deleteObjectStore("remoteDocumentChanges")}function hl(et){let er=et.store(ry),en={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:e2.min().toTimestamp(),targetCount:0};return er.put(rg,en)}function hu(et){et.createObjectStore(rS,{keyPath:rT})}function hc(et){et.createObjectStore(rw,{keyPath:rE})}function hh(et){et.createObjectStore(rC,{keyPath:r_})}function hd(et){let er=et.createObjectStore(rI,{keyPath:rk,autoIncrement:!0});er.createIndex(rx,rA,{unique:!1});let en=et.createObjectStore(rR,{keyPath:rD});en.createIndex(rO,rN,{unique:!1});let ei=et.createObjectStore(rM,{keyPath:rP});ei.createIndex(rL,rF,{unique:!1})}function hp(et){let er=et.createObjectStore(rB,{keyPath:rj});er.createIndex(rU,rV,{unique:!1}),er.createIndex(rz,rq,{unique:!1})}function hf(et){et.createObjectStore(r$,{keyPath:rG})}function hm(et){return et.document?new e8(e9.fromString(et.document.name).popFirst(5)):et.noDocument?e8.fromSegments(et.noDocument.path):et.unknownDocument?e8.fromSegments(et.unknownDocument.path):eO()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hg="IndexedDbPersistence",hy=null,hv=5e3,hS=4e3,hT=null,hw=null,hE="firestore_zombie",hC="main";class h_{constructor(et,er,en,ei,es,ea,eo,eu,ec,eh,ed=cP){if(this.allowTabSynchronization=et,this.persistenceKey=er,this.clientId=en,this.queue=es,this.window=ea,this.document=eo,this.sequenceNumberSyncer=ec,this.forceOwningTab=eh,this.schemaVersion=ed,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=et=>Promise.resolve(),!h_.isAvailable())throw new eL(eP.UNIMPLEMENTED,hw);this.referenceDelegate=new cT(this,ei),this.dbName=er+hC,this.serializer=new lI(eu),this.simpleDb=new tC(this.dbName,this.schemaVersion,new c6(this.serializer)),this.globalsCache=new l2,this.targetCache=new cr(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ck(this.serializer),this.bundleCache=new lJ,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===eh&&eA(hg,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new eL(eP.FAILED_PRECONDITION,hT);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",et=>this.targetCache.getHighestSequenceNumber(et))}).then(et=>{this.listenSequence=new tU(et,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(et=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(et)))}setPrimaryStateListener(et){return this.primaryStateListener=async er=>{if(this.started)return et(er)},et(this.isPrimary)}setDatabaseDeletedListener(et){this.simpleDb.setVersionChangeListener(async er=>{null===er.newVersion&&await et()})}setNetworkEnabled(et){this.networkEnabled!==et&&(this.networkEnabled=et,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",et=>{let er=hk(et);return er.put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(et).next(et=>{et||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(et)).next(er=>this.isPrimary&&!er?this.releasePrimaryLeaseIfHeld(et).next(()=>!1):!!er&&this.acquireOrExtendPrimaryLease(et).next(()=>!0))}).catch(et=>{if(tA(et))return ex(hg,"Failed to extend owner lease: ",et),this.isPrimary;if(!this.allowTabSynchronization)throw et;return ex(hg,"Releasing owner lease after error during lease refresh",et),!1}).then(et=>{this.isPrimary!==et&&this.queue.enqueueRetryable(()=>this.primaryStateListener(et)),this.isPrimary=et})}verifyPrimaryLease(et){let er=hI(et);return er.get(tJ).next(et=>tS.resolve(this.isLocalClient(et)))}removeClientMetadata(et){let er=hk(et);return er.delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,hy)){this.lastGarbageCollectionTime=Date.now();let et=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",et=>{let er=r4(et,rS);return er.loadAll().next(et=>{let en=this.filterActiveClients(et,hy),ei=et.filter(et=>-1===en.indexOf(et));return tS.forEach(ei,et=>er.delete(et.clientId)).next(()=>ei)})}).catch(()=>[]);if(this.webStorage)for(let er of et)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(er.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",hS,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(et){return!!et&&et.ownerId===this.clientId}canActAsPrimary(et){if(this.forceOwningTab)return tS.resolve(!0);let er=hI(et);return er.get(tJ).next(er=>{let en=null!==er&&this.isWithinAge(er.leaseTimestampMs,hv)&&!this.isClientZombied(er.ownerId);if(en){if(this.isLocalClient(er)&&this.networkEnabled)return!0;if(!this.isLocalClient(er)){if(!er.allowTabSynchronization)throw new eL(eP.FAILED_PRECONDITION,hT);return!1}}return!!this.networkEnabled&&!!this.inForeground||hk(et).loadAll().next(et=>{let er=this.filterActiveClients(et,hv).find(et=>{if(this.clientId!==et.clientId){let er=!this.networkEnabled&&et.networkEnabled,en=!this.inForeground&&et.inForeground,ei=this.networkEnabled===et.networkEnabled;if(er||en&&ei)return!0}return!1});return void 0===er})}).next(et=>(this.isPrimary!==et&&ex(hg,`Client ${et?"is":"is not"} eligible for a primary lease.`),et))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[tY,rS],et=>{let er=new r9(et,tU.INVALID);return this.releasePrimaryLeaseIfHeld(er).next(()=>this.removeClientMetadata(er))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(et,er){return et.filter(et=>this.isWithinAge(et.updateTimeMs,er)&&!this.isClientZombied(et.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",et=>hk(et).loadAll().next(et=>this.filterActiveClients(et,hy).map(et=>et.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(et,er){return u3.forUser(et,this.serializer,er,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(et){return new uQ(et,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(et){return l0.forUser(this.serializer,et)}getBundleCache(){return this.bundleCache}runTransaction(et,er,en){let ei;ex(hg,"Starting transaction:",et);let es="readonly"===er?"readonly":"readwrite",ea=r6(this.schemaVersion);return this.simpleDb.runTransaction(et,es,ea,es=>(ei=new r9(es,this.listenSequence?this.listenSequence.next():tU.INVALID),"readwrite-primary"===er)?this.verifyPrimaryLease(ei).next(et=>!!et||this.canActAsPrimary(ei)).next(er=>{if(!er)throw eA(`Failed to obtain primary lease for action '${et}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new eL(eP.FAILED_PRECONDITION,ty);return en(ei)}).next(et=>this.acquireOrExtendPrimaryLease(ei).next(()=>et)):this.verifyAllowTabSynchronization(ei).next(()=>en(ei))).then(et=>(ei.raiseOnCommittedEvent(),et))}verifyAllowTabSynchronization(et){let er=hI(et);return er.get(tJ).next(et=>{let er=null!==et&&this.isWithinAge(et.leaseTimestampMs,hv)&&!this.isClientZombied(et.ownerId);if(er&&!this.isLocalClient(et)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!et.allowTabSynchronization))throw new eL(eP.FAILED_PRECONDITION,hT)})}acquireOrExtendPrimaryLease(et){let er={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return hI(et).put(tJ,er)}static isAvailable(){return tC.isAvailable()}releasePrimaryLeaseIfHeld(et){let er=hI(et);return er.get(tJ).next(et=>this.isLocalClient(et)?(ex(hg,"Releasing primary lease."),er.delete(tJ)):tS.resolve())}isWithinAge(et,er){let en=Date.now(),ei=en-er,es=en;return!(et<ei)&&(!(et>es)||(eA(`Detected an update time that is in the future: ${et} > ${es}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var et;"function"==typeof(null===(et=this.window)||void 0===et?void 0:et.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let et=/(?:Version|Mobile)\/1[456]/;isSafari()&&(navigator.appVersion.match(et)||navigator.userAgent.match(et))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(et){var er;try{let en=(null===(er=this.webStorage)||void 0===er?void 0:er.getItem(this.zombiedClientLocalStorageKey(et)))!==null;return ex(hg,`Client '${et}' ${en?"is":"is not"} zombied in LocalStorage`),en}catch(et){return eA(hg,"Failed to get zombied client id.",et),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(et){eA("Failed to set zombie client id.",et)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(et){}}zombiedClientLocalStorageKey(et){return`${hE}_${this.persistenceKey}_${et}`}}function hI(et){return r4(et,tY)}function hk(et){return r4(et,rS)}function hx(et,er){let en=et.projectId;return et.isDefaultDatabase||(en+="."+et.database),"firestore/"+er+"/"+en+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(et,er,en,ei,es){er=[...er],(et=[...et]).sort(en),er.sort(en);let ea=et.length,eo=er.length,eu=0,ec=0;for(;eu<eo&&ec<ea;){let ea=en(et[ec],er[eu]);ea<0?es(et[ec++]):ea>0?ei(er[eu++]):(eu++,ec++)}for(;eu<eo;)ei(er[eu++]);for(;ec<ea;)es(et[ec++])}function hR(et,er){if(et.length!==er.length)return!1;for(let en=0;en<et.length;++en)if(et[en]!==er[en])return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hD="LocalStore",hO=null;class hN{constructor(et,er,en,ei){this.persistence=et,this.queryEngine=er,this.serializer=ei,this.targetDataByTarget=new nt(eY),this.targetIdByTarget=new sQ(et=>sl(et),sc),this.collectionGroupReadTime=new Map,this.remoteDocuments=et.getRemoteDocumentCache(),this.targetCache=et.getTargetCache(),this.bundleCache=et.getBundleCache(),this.initializeUserComponents(en)}initializeUserComponents(et){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(et),this.indexManager=this.persistence.getIndexManager(et),this.mutationQueue=this.persistence.getMutationQueue(et,this.indexManager),this.localDocuments=new cF(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(et){return this.persistence.runTransaction("Collect garbage","readwrite-primary",er=>et.collect(er,this.targetDataByTarget))}}function hM(et,er,en,ei){return new hN(et,er,en,ei)}async function hP(et,er){let en=eM(et),ei=await en.persistence.runTransaction("Handle user change","readonly",et=>{let ei;return en.mutationQueue.getAllMutationBatches(et).next(es=>(ei=es,en.initializeUserComponents(er),en.mutationQueue.getAllMutationBatches(et))).next(er=>{let es=[],ea=[],eo=s8();for(let et of ei)for(let er of(es.push(et.batchId),et.mutations))eo=eo.add(er.key);for(let et of er)for(let er of(ea.push(et.batchId),et.mutations))eo=eo.add(er.key);return en.localDocuments.getDocuments(et,eo).next(et=>({affectedDocuments:et,removedBatchIds:es,addedBatchIds:ea}))})});return ei}function hL(et,er){let en,ei;let es=eM(et),ea=e1.now(),eo=er.reduce((et,er)=>et.add(er.key),s8());return es.persistence.runTransaction("Locally write mutations","readwrite",et=>{let eu=sJ(),ec=s8();return es.remoteDocuments.getEntries(et,eo).next(et=>{(eu=et).forEach((et,er)=>{er.isValidDocument()||(ec=ec.add(et))})}).next(()=>es.localDocuments.getOverlayedDocuments(et,eu)).next(ei=>{en=ei;let eo=[];for(let et of er){let er=aA(et,en.get(et.key).overlayedDocument);null!=er&&eo.push(new aM(et.key,er,iM(er.value.mapValue),aE.exists(!0)))}return es.mutationQueue.addMutationBatch(et,ea,eo,er)}).next(er=>{ei=er;let ea=er.applyToLocalDocumentSet(en,ec);return es.documentOverlayCache.saveOverlays(et,er.batchId,ea)})}).then(()=>({batchId:ei.batchId,changes:s1(en)}))}function hF(et,er){let en=eM(et);return en.persistence.runTransaction("Acknowledge batch","readwrite-primary",et=>{let ei=er.batch.keys(),es=en.remoteDocuments.newChangeBuffer({trackRemovals:!0});return hX(en,et,er,es).next(()=>es.apply(et)).next(()=>en.mutationQueue.performConsistencyCheck(et)).next(()=>en.documentOverlayCache.removeOverlaysForBatchId(et,ei,er.batch.batchId)).next(()=>en.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(et,hB(er))).next(()=>en.localDocuments.getDocuments(et,ei))})}function hB(et){let er=s8();for(let en=0;en<et.mutationResults.length;++en){let ei=et.mutationResults[en];ei.transformResults.length>0&&(er=er.add(et.batch.mutations[en].key))}return er}function hj(et,er){let en=eM(et);return en.persistence.runTransaction("Reject batch","readwrite-primary",et=>{let ei;return en.mutationQueue.lookupMutationBatch(et,er).next(er=>(eN(null!==er),ei=er.keys(),en.mutationQueue.removeMutationBatch(et,er))).next(()=>en.mutationQueue.performConsistencyCheck(et)).next(()=>en.documentOverlayCache.removeOverlaysForBatchId(et,ei,er)).next(()=>en.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(et,ei)).next(()=>en.localDocuments.getDocuments(et,ei))})}function hU(et){let er=eM(et);return er.persistence.runTransaction("Get highest unacknowledged batch id","readonly",et=>er.mutationQueue.getHighestUnacknowledgedBatchId(et))}function hV(et){let er=eM(et);return er.persistence.runTransaction("Get last remote snapshot version","readonly",et=>er.targetCache.getLastRemoteSnapshotVersion(et))}function hz(et,er){let en=eM(et),ei=er.snapshotVersion,es=en.targetDataByTarget;return en.persistence.runTransaction("Apply remote event","readwrite-primary",et=>{let ea=en.remoteDocuments.newChangeBuffer({trackRemovals:!0});es=en.targetDataByTarget;let eo=[];er.targetChanges.forEach((ea,eu)=>{let ec=es.get(eu);if(!ec)return;eo.push(en.targetCache.removeMatchingKeys(et,ea.removedDocuments,eu).next(()=>en.targetCache.addMatchingKeys(et,ea.addedDocuments,eu)));let eh=ec.withSequenceNumber(et.currentSequenceNumber);null!==er.targetMismatches.get(eu)?eh=eh.withResumeToken(nm.EMPTY_BYTE_STRING,e2.min()).withLastLimboFreeSnapshotVersion(e2.min()):ea.resumeToken.approximateByteSize()>0&&(eh=eh.withResumeToken(ea.resumeToken,ei)),es=es.insert(eu,eh),h$(ec,eh,ea)&&eo.push(en.targetCache.updateTargetData(et,eh))});let eu=sJ(),ec=s8();if(er.documentUpdates.forEach(ei=>{er.resolvedLimboDocuments.has(ei)&&eo.push(en.persistence.referenceDelegate.updateLimboDocument(et,ei))}),eo.push(hq(et,ea,er.documentUpdates).next(et=>{eu=et.changedDocuments,ec=et.existenceChangedKeys})),!ei.isEqual(e2.min())){let er=en.targetCache.getLastRemoteSnapshotVersion(et).next(er=>en.targetCache.setTargetsMetadata(et,et.currentSequenceNumber,ei));eo.push(er)}return tS.waitFor(eo).next(()=>ea.apply(et)).next(()=>en.localDocuments.getLocalViewOfDocuments(et,eu,ec)).next(()=>eu)}).then(et=>(en.targetDataByTarget=es,et))}function hq(et,er,en){let ei=s8(),es=s8();return en.forEach(et=>ei=ei.add(et)),er.getEntries(et,ei).next(et=>{let ei=sJ();return en.forEach((en,ea)=>{let eo=et.get(en);ea.isFoundDocument()!==eo.isFoundDocument()&&(es=es.add(en)),ea.isNoDocument()&&ea.version.isEqual(e2.min())?(er.removeEntry(en,ea.readTime),ei=ei.insert(en,ea)):!eo.isValidDocument()||ea.version.compareTo(eo.version)>0||0===ea.version.compareTo(eo.version)&&eo.hasPendingWrites?(er.addEntry(ea),ei=ei.insert(en,ea)):ex(hD,"Ignoring outdated watch update for ",en,". Current version:",eo.version," Watch version:",ea.version)}),{changedDocuments:ei,existenceChangedKeys:es}})}function h$(et,er,en){if(0===et.resumeToken.approximateByteSize())return!0;let ei=er.snapshotVersion.toMicroseconds()-et.snapshotVersion.toMicroseconds();if(ei>=hO)return!0;let es=en.addedDocuments.size+en.modifiedDocuments.size+en.removedDocuments.size;return es>0}async function hG(et,er){let en=eM(et);try{await en.persistence.runTransaction("notifyLocalViewChanges","readwrite",et=>tS.forEach(er,er=>tS.forEach(er.addedKeys,ei=>en.persistence.referenceDelegate.addReference(et,er.targetId,ei)).next(()=>tS.forEach(er.removedKeys,ei=>en.persistence.referenceDelegate.removeReference(et,er.targetId,ei)))))}catch(et){if(tA(et))ex(hD,"Failed to update sequence numbers: "+et);else throw et}for(let et of er){let er=et.targetId;if(!et.fromCache){let et=en.targetDataByTarget.get(er),ei=et.snapshotVersion,es=et.withLastLimboFreeSnapshotVersion(ei);en.targetDataByTarget=en.targetDataByTarget.insert(er,es)}}}function hK(et,er){let en=eM(et);return en.persistence.runTransaction("Get next mutation batch","readonly",et=>(void 0===er&&(er=nM),en.mutationQueue.getNextMutationBatchAfterBatchId(et,er)))}function hH(et,er){let en=eM(et);return en.persistence.runTransaction("read document","readonly",et=>en.localDocuments.getDocument(et,er))}function hW(et,er){let en=eM(et);return en.persistence.runTransaction("Allocate target","readwrite",et=>{let ei;return en.targetCache.getTargetData(et,er).next(es=>es?(ei=es,tS.resolve(ei)):en.targetCache.allocateTargetId(et).next(es=>(ei=new l_(er,es,"TargetPurposeListen",et.currentSequenceNumber),en.targetCache.addTargetData(et,ei).next(()=>ei))))}).then(et=>{let ei=en.targetDataByTarget.get(et.targetId);return(null===ei||et.snapshotVersion.compareTo(ei.snapshotVersion)>0)&&(en.targetDataByTarget=en.targetDataByTarget.insert(et.targetId,et),en.targetIdByTarget.set(er,et.targetId)),et})}function hQ(et,er,en){let ei=eM(et),es=ei.targetIdByTarget.get(en);return void 0!==es?tS.resolve(ei.targetDataByTarget.get(es)):ei.targetCache.getTargetData(er,en)}async function hY(et,er,en){let ei=eM(et),es=ei.targetDataByTarget.get(er),ea=en?"readwrite":"readwrite-primary";try{en||await ei.persistence.runTransaction("Release target",ea,et=>ei.persistence.referenceDelegate.removeTarget(et,es))}catch(et){if(tA(et))ex(hD,`Failed to update sequence numbers for target ${er}: ${et}`);else throw et}ei.targetDataByTarget=ei.targetDataByTarget.remove(er),ei.targetIdByTarget.delete(es.target)}function hJ(et,er,en){let ei=eM(et),es=e2.min(),ea=s8();return ei.persistence.runTransaction("Execute query","readwrite",et=>hQ(ei,et,sR(er)).next(er=>{if(er)return es=er.lastLimboFreeSnapshotVersion,ei.targetCache.getMatchingKeysForTargetId(et,er.targetId).next(et=>{ea=et})}).next(()=>ei.queryEngine.getDocumentsMatchingQuery(et,er,en?es:e2.min(),en?ea:s8())).next(et=>(h6(ei,sK(er),et),{documents:et,remoteKeys:ea})))}function hX(et,er,en,ei){let es=en.batch,ea=es.keys(),eo=tS.resolve();return ea.forEach(et=>{eo=eo.next(()=>ei.getEntry(er,et)).next(er=>{let ea=en.docVersions.get(et);eN(null!==ea),0>er.version.compareTo(ea)&&(es.applyToRemoteDocument(er,en),er.isValidDocument()&&(er.setReadTime(en.commitVersion),ei.addEntry(er)))})}),eo.next(()=>et.mutationQueue.removeMutationBatch(er,es))}function hZ(et,er){let en=eM(et),ei=eM(en.mutationQueue);return en.persistence.runTransaction("Lookup mutation documents","readonly",et=>ei.lookupMutationKeys(et,er).next(er=>er?en.localDocuments.getDocuments(et,er):tS.resolve(null)))}function h0(et,er){let en=eM(eM(et,hN).mutationQueue);en.removeCachedMutationKeys(er)}function h1(et){let er=eM(eM(et,hN).persistence);return er.getActiveClients()}function h2(et,er){let en=eM(et),ei=eM(en.targetCache),es=en.targetDataByTarget.get(er);return es?Promise.resolve(es.target):en.persistence.runTransaction("Get target data","readonly",et=>ei.getTargetDataForTarget(et,er).next(et=>et?et.target:null))}function h3(et,er){let en=eM(et),ei=en.collectionGroupReadTime.get(er)||e2.min();return en.persistence.runTransaction("Get new document changes","readonly",et=>en.remoteDocuments.getAllFromCollectionGroup(et,er,tp(ei,e7),Number.MAX_SAFE_INTEGER)).then(et=>(h6(en,er,et),et))}function h6(et,er,en){let ei=et.collectionGroupReadTime.get(er)||e2.min();en.forEach((et,er)=>{er.readTime.compareTo(ei)>0&&(ei=er.readTime)}),et.collectionGroupReadTime.set(er,ei)}function h9(et){return sR(sE(e9.fromString(`__bundle__/docs/${et}`)))}async function h4(et,er,en,ei){let es=eM(et),ea=s8(),eo=sJ();for(let et of en){let en=er.toDocumentKey(et.metadata.name);et.document&&(ea=ea.add(en));let ei=er.toMutableDocument(et);ei.setReadTime(er.toSnapshotVersion(et.metadata.readTime)),eo=eo.insert(en,ei)}let eu=es.remoteDocuments.newChangeBuffer({trackRemovals:!0}),ec=await hW(es,h9(ei));return es.persistence.runTransaction("Apply bundle documents","readwrite",et=>hq(et,eu,eo).next(er=>(eu.apply(et),er)).next(er=>es.targetCache.removeMatchingKeysForTargetId(et,ec.targetId).next(()=>es.targetCache.addMatchingKeys(et,ea,ec.targetId)).next(()=>es.localDocuments.getLocalViewOfDocuments(et,er.changedDocuments,er.existenceChangedKeys)).next(()=>er.changedDocuments)))}function h5(et,er){let en=eM(et),ei=ow(er.createTime);return en.persistence.runTransaction("hasNewerBundle","readonly",et=>en.bundleCache.getBundleMetadata(et,er.id)).then(et=>!!et&&et.createTime.compareTo(ei)>=0)}function h8(et,er){let en=eM(et);return en.persistence.runTransaction("Save bundle","readwrite",et=>en.bundleCache.saveBundleMetadata(et,er))}async function h7(et,er,en=s8()){let ei=await hW(et,sR(lz(er.bundledQuery))),es=eM(et);return es.persistence.runTransaction("Save named query","readwrite",et=>{let ea=ow(er.readTime);if(ei.snapshotVersion.compareTo(ea)>=0)return es.bundleCache.saveNamedQuery(et,er);let eo=ei.withResumeToken(nm.EMPTY_BYTE_STRING,ea);return es.targetDataByTarget=es.targetDataByTarget.insert(eo.targetId,eo),es.targetCache.updateTargetData(et,eo).next(()=>es.targetCache.removeMatchingKeysForTargetId(et,ei.targetId)).next(()=>es.targetCache.addMatchingKeys(et,en,ei.targetId)).next(()=>es.bundleCache.saveNamedQuery(et,er))})}function dt(et,er){let en=eM(et);en.queryEngine.indexAutoCreationEnabled=er}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(et){this._documentReadCount+=et}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dn=100;function di(){return(0,ep.G6)()?8:t_((0,ep.z$)())>0?6:4}class ds{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=dn,this.relativeIndexReadCostPerDocument=di()}initialize(et,er){this.localDocumentsView=et,this.indexManager=er,this.initialized=!0}getDocumentsMatchingQuery(et,er,en,ei){let es={result:null};return this.performQueryUsingIndex(et,er).next(et=>{es.result=et}).next(()=>{if(!es.result)return this.performQueryUsingRemoteKeys(et,er,ei,en).next(et=>{es.result=et})}).next(()=>{if(es.result)return;let en=new dr;return this.executeFullCollectionScan(et,er,en).next(ei=>{if(es.result=ei,this.indexAutoCreationEnabled)return this.createCacheIndexes(et,er,en,ei.size)})}).next(()=>es.result)}createCacheIndexes(et,er,en,ei){return en.documentReadCount<this.indexAutoCreationMinCollectionSize?(ek()<=eh.in.DEBUG&&ex("QueryEngine","SDK will not create cache indexes for query:",sU(er),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),tS.resolve()):(ek()<=eh.in.DEBUG&&ex("QueryEngine","Query:",sU(er),"scans",en.documentReadCount,"local documents and returns",ei,"documents as results."),en.documentReadCount>this.relativeIndexReadCostPerDocument*ei)?(ek()<=eh.in.DEBUG&&ex("QueryEngine","The SDK decides to create cache indexes for query:",sU(er),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(et,sR(er))):tS.resolve()}performQueryUsingIndex(et,er){if(s_(er))return tS.resolve(null);let en=sR(er);return this.indexManager.getIndexType(et,en).next(ei=>0===ei?null:(null!==er.limit&&1===ei&&(en=sR(er=sP(er,null,"F"))),this.indexManager.getDocumentsMatchingTarget(et,en).next(ei=>{let es=s8(...ei);return this.localDocumentsView.getDocuments(et,es).next(ei=>this.indexManager.getMinOffset(et,en).next(en=>{let ea=this.applyQuery(er,ei);return this.needsRefill(er,ea,es,en.readTime)?this.performQueryUsingIndex(et,sP(er,null,"F")):this.appendRemainingResults(et,ea,er,en)}))})))}performQueryUsingRemoteKeys(et,er,en,ei){return s_(er)||ei.isEqual(e2.min())?tS.resolve(null):this.localDocumentsView.getDocuments(et,en).next(es=>{let ea=this.applyQuery(er,es);return this.needsRefill(er,ea,en,ei)?tS.resolve(null):(ek()<=eh.in.DEBUG&&ex("QueryEngine","Re-using previous result from %s to execute query: %s",ei.toString(),sU(er)),this.appendRemainingResults(et,ea,er,tp(ei,e7)).next(et=>et))})}applyQuery(et,er){let en=new no(sH(et));return er.forEach((er,ei)=>{sV(et,ei)&&(en=en.add(ei))}),en}needsRefill(et,er,en,ei){if(null===et.limit)return!1;if(en.size!==er.size)return!0;let es="F"===et.limitType?er.last():er.first();return!!es&&(es.hasPendingWrites||es.version.compareTo(ei)>0)}executeFullCollectionScan(et,er,en){return ek()<=eh.in.DEBUG&&ex("QueryEngine","Using full collection scan to execute query:",sU(er)),this.localDocumentsView.getDocumentsMatchingQuery(et,er,tm.min(),en)}appendRemainingResults(et,er,en,ei){return this.localDocumentsView.getDocumentsMatchingQuery(et,en,ei).next(et=>(er.forEach(er=>{et=et.insert(er.key,er)}),et))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let da="firestore_clients";function dl(et,er){return`${da}_${et}_${er}`}let du="firestore_mutations";function dc(et,er,en){let ei=`${du}_${et}_${en}`;return er.isAuthenticated()&&(ei+=`_${er.uid}`),ei}let dh="firestore_targets";function dd(et,er){return`${dh}_${et}_${er}`}let dp="firestore_online_state";function df(et){return`${dp}_${et}`}let dm="firestore_bundle_loaded_v2";function dg(et){return`${dm}_${et}`}let dy="firestore_sequence_number";function dS(et){return`${dy}_${et}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dT="SharedClientState";class dw{constructor(et,er,en,ei){this.user=et,this.batchId=er,this.state=en,this.error=ei}static fromWebStorageEntry(et,er,en){let ei;let es=JSON.parse(en),ea="object"==typeof es&&-1!==["pending","acknowledged","rejected"].indexOf(es.state)&&(void 0===es.error||"object"==typeof es.error);return(ea&&es.error&&(ea="string"==typeof es.error.message&&"string"==typeof es.error.code)&&(ei=new eL(es.error.code,es.error.message)),ea)?new dw(et,er,es.state,ei):(eA(dT,`Failed to parse mutation state for ID '${er}': ${en}`),null)}toWebStorageJSON(){let et={state:this.state,updateTimeMs:Date.now()};return this.error&&(et.error={code:this.error.code,message:this.error.message}),JSON.stringify(et)}}class dE{constructor(et,er,en){this.targetId=et,this.state=er,this.error=en}static fromWebStorageEntry(et,er){let en;let ei=JSON.parse(er),es="object"==typeof ei&&-1!==["not-current","current","rejected"].indexOf(ei.state)&&(void 0===ei.error||"object"==typeof ei.error);return(es&&ei.error&&(es="string"==typeof ei.error.message&&"string"==typeof ei.error.code)&&(en=new eL(ei.error.code,ei.error.message)),es)?new dE(et,ei.state,en):(eA(dT,`Failed to parse target state for ID '${et}': ${er}`),null)}toWebStorageJSON(){let et={state:this.state,updateTimeMs:Date.now()};return this.error&&(et.error={code:this.error.code,message:this.error.message}),JSON.stringify(et)}}class dC{constructor(et,er){this.clientId=et,this.activeTargetIds=er}static fromWebStorageEntry(et,er){let en=JSON.parse(er),ei="object"==typeof en&&en.activeTargetIds instanceof Array,es=at();for(let et=0;ei&&et<en.activeTargetIds.length;++et)ei=nF(en.activeTargetIds[et]),es=es.add(en.activeTargetIds[et]);return ei?new dC(et,es):(eA(dT,`Failed to parse client data for instance '${et}': ${er}`),null)}}class d_{constructor(et,er){this.clientId=et,this.onlineState=er}static fromWebStorageEntry(et){let er=JSON.parse(et),en="object"==typeof er&&-1!==["Unknown","Online","Offline"].indexOf(er.onlineState)&&"string"==typeof er.clientId;return en?new d_(er.clientId,er.onlineState):(eA(dT,`Failed to parse online state: ${et}`),null)}}class dI{constructor(){this.activeTargetIds=at()}addQueryTarget(et){this.activeTargetIds=this.activeTargetIds.add(et)}removeQueryTarget(et){this.activeTargetIds=this.activeTargetIds.delete(et)}toWebStorageJSON(){let et={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(et)}}class dk{constructor(et,er,en,ei,es){this.window=et,this.queue=er,this.persistenceKey=en,this.localClientId=ei,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new nt(eY),this.started=!1,this.earlyEvents=[];let ea=en.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=es,this.localClientStorageKey=dl(this.persistenceKey,this.localClientId),this.sequenceNumberKey=dS(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new dI),this.clientStateKeyRe=RegExp(`^${da}_${ea}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${du}_${ea}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${dh}_${ea}_(\\d+)$`),this.onlineStateKey=df(this.persistenceKey),this.bundleLoadedKey=dg(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(et){return!!(et&&et.localStorage)}async start(){let et=await this.syncEngine.getActiveClients();for(let er of et){if(er===this.localClientId)continue;let et=this.getItem(dl(this.persistenceKey,er));if(et){let en=dC.fromWebStorageEntry(er,et);en&&(this.activeClients=this.activeClients.insert(en.clientId,en))}}this.persistClientState();let er=this.storage.getItem(this.onlineStateKey);if(er){let et=this.fromWebStorageOnlineState(er);et&&this.handleOnlineStateEvent(et)}for(let et of this.earlyEvents)this.handleWebStorageEvent(et);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(et){this.setItem(this.sequenceNumberKey,JSON.stringify(et))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(et){let er=!1;return this.activeClients.forEach((en,ei)=>{ei.activeTargetIds.has(et)&&(er=!0)}),er}addPendingMutation(et){this.persistMutationState(et,"pending")}updateMutationState(et,er,en){this.persistMutationState(et,er,en),this.removeMutationState(et)}addLocalQueryTarget(et,er=!0){let en="not-current";if(this.isActiveQueryTarget(et)){let er=this.storage.getItem(dd(this.persistenceKey,et));if(er){let ei=dE.fromWebStorageEntry(et,er);ei&&(en=ei.state)}}return er&&this.localClientState.addQueryTarget(et),this.persistClientState(),en}removeLocalQueryTarget(et){this.localClientState.removeQueryTarget(et),this.persistClientState()}isLocalQueryTarget(et){return this.localClientState.activeTargetIds.has(et)}clearQueryState(et){this.removeItem(dd(this.persistenceKey,et))}updateQueryState(et,er,en){this.persistQueryTargetState(et,er,en)}handleUserChange(et,er,en){er.forEach(et=>{this.removeMutationState(et)}),this.currentUser=et,en.forEach(et=>{this.addPendingMutation(et)})}setOnlineState(et){this.persistOnlineState(et)}notifyBundleLoaded(et){this.persistBundleLoadedState(et)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(et){let er=this.storage.getItem(et);return ex(dT,"READ",et,er),er}setItem(et,er){ex(dT,"SET",et,er),this.storage.setItem(et,er)}removeItem(et){ex(dT,"REMOVE",et),this.storage.removeItem(et)}handleWebStorageEvent(et){let er=et;if(er.storageArea===this.storage){if(ex(dT,"EVENT",er.key,er.newValue),er.key===this.localClientStorageKey){eA("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(async()=>{if(!this.started){this.earlyEvents.push(er);return}if(null!==er.key){if(this.clientStateKeyRe.test(er.key)){if(null!=er.newValue){let et=this.fromWebStorageClientState(er.key,er.newValue);if(et)return this.handleClientStateEvent(et.clientId,et)}else{let et=this.fromWebStorageClientStateKey(er.key);return this.handleClientStateEvent(et,null)}}else if(this.mutationBatchKeyRe.test(er.key)){if(null!==er.newValue){let et=this.fromWebStorageMutationMetadata(er.key,er.newValue);if(et)return this.handleMutationBatchEvent(et)}}else if(this.queryTargetKeyRe.test(er.key)){if(null!==er.newValue){let et=this.fromWebStorageQueryTargetMetadata(er.key,er.newValue);if(et)return this.handleQueryTargetEvent(et)}}else if(er.key===this.onlineStateKey){if(null!==er.newValue){let et=this.fromWebStorageOnlineState(er.newValue);if(et)return this.handleOnlineStateEvent(et)}}else if(er.key===this.sequenceNumberKey){let et=dx(er.newValue);et!==tU.INVALID&&this.sequenceNumberHandler(et)}else if(er.key===this.bundleLoadedKey){let et=this.fromWebStoreBundleLoadedState(er.newValue);await Promise.all(et.map(et=>this.syncEngine.synchronizeWithChangedDocuments(et)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(et,er,en){let ei=new dw(this.currentUser,et,er,en),es=dc(this.persistenceKey,this.currentUser,et);this.setItem(es,ei.toWebStorageJSON())}removeMutationState(et){let er=dc(this.persistenceKey,this.currentUser,et);this.removeItem(er)}persistOnlineState(et){let er={clientId:this.localClientId,onlineState:et};this.storage.setItem(this.onlineStateKey,JSON.stringify(er))}persistQueryTargetState(et,er,en){let ei=dd(this.persistenceKey,et),es=new dE(et,er,en);this.setItem(ei,es.toWebStorageJSON())}persistBundleLoadedState(et){let er=JSON.stringify(Array.from(et));this.setItem(this.bundleLoadedKey,er)}fromWebStorageClientStateKey(et){let er=this.clientStateKeyRe.exec(et);return er?er[1]:null}fromWebStorageClientState(et,er){let en=this.fromWebStorageClientStateKey(et);return dC.fromWebStorageEntry(en,er)}fromWebStorageMutationMetadata(et,er){let en=this.mutationBatchKeyRe.exec(et),ei=Number(en[1]),es=void 0!==en[2]?en[2]:null;return dw.fromWebStorageEntry(new eT(es),ei,er)}fromWebStorageQueryTargetMetadata(et,er){let en=this.queryTargetKeyRe.exec(et),ei=Number(en[1]);return dE.fromWebStorageEntry(ei,er)}fromWebStorageOnlineState(et){return d_.fromWebStorageEntry(et)}fromWebStoreBundleLoadedState(et){return JSON.parse(et)}async handleMutationBatchEvent(et){if(et.user.uid!==this.currentUser.uid){ex(dT,`Ignoring mutation for non-active user ${et.user.uid}`);return}return this.syncEngine.applyBatchState(et.batchId,et.state,et.error)}handleQueryTargetEvent(et){return this.syncEngine.applyTargetState(et.targetId,et.state,et.error)}handleClientStateEvent(et,er){let en=er?this.activeClients.insert(et,er):this.activeClients.remove(et),ei=this.extractActiveQueryTargets(this.activeClients),es=this.extractActiveQueryTargets(en),ea=[],eo=[];return es.forEach(et=>{ei.has(et)||ea.push(et)}),ei.forEach(et=>{es.has(et)||eo.push(et)}),this.syncEngine.applyActiveTargetsChange(ea,eo).then(()=>{this.activeClients=en})}handleOnlineStateEvent(et){this.activeClients.get(et.clientId)&&this.onlineStateHandler(et.onlineState)}extractActiveQueryTargets(et){let er=at();return et.forEach((et,en)=>{er=er.unionWith(en.activeTargetIds)}),er}}function dx(et){let er=tU.INVALID;if(null!=et)try{let en=JSON.parse(et);eN("number"==typeof en),er=en}catch(et){eA(dT,"Failed to read sequence number from WebStorage",et)}return er}class dA{constructor(){this.localState=new dI,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(et){}updateMutationState(et,er,en){}addLocalQueryTarget(et,er=!0){return er&&this.localState.addQueryTarget(et),this.queryState[et]||"not-current"}updateQueryState(et,er,en){this.queryState[et]=er}removeLocalQueryTarget(et){this.localState.removeQueryTarget(et)}isLocalQueryTarget(et){return this.localState.activeTargetIds.has(et)}clearQueryState(et){delete this.queryState[et]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(et){return this.localState.activeTargetIds.has(et)}start(){return this.localState=new dI,Promise.resolve()}handleUserChange(et,er,en){}setOnlineState(et){}shutdown(){}writeSequenceNumber(et){}notifyBundleLoaded(et){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{addCallback(et){}shutdown(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(et){this.sendFn=et.sendFn,this.closeFn=et.closeFn}onConnected(et){this.wrappedOnConnected=et}onOpen(et){this.wrappedOnOpen=et}onClose(et){this.wrappedOnClose=et}onMessage(et){this.wrappedOnMessage=et}close(){this.closeFn()}send(et){this.sendFn(et)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(et){this.wrappedOnClose(et)}callOnMessage(et){this.wrappedOnMessage(et)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dO=null;function dN(){let et=268435456,er=2415919104,en=er-et,ei=Math.round(en*Math.random());return et+ei}function dM(){return null===dO?dO=dN():dO++,"0x"+dO.toString(16)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dP(et){return new Promise((er,en)=>{et((et,ei)=>{et?en(et):er(ei)})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dL="1.9.1",dF="GrpcConnection",dB=`gl-node/${process.versions.node} fire/${eE} grpc/${dL}`;function dj(et,er,en,ei){eN(null===er||"OAuth"===er.type);let es=new ey.SF;return er&&er.headers.forEach((et,er)=>es.set(er,et)),en&&en.headers.forEach((et,er)=>es.set(er,et)),ei&&es.set("X-Firebase-GMPID",ei),es.set("X-Goog-Api-Client",dB),es.set("Google-Cloud-Resource-Prefix",et),es.set("x-goog-request-params",et),es}class dU{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(et,er){this.databaseInfo=er,this.cachedStub=null,this.firestore=et.google.firestore.v1,this.databasePath=`projects/${er.databaseId.projectId}/databases/${er.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){ex(dF,"Creating Firestore stub.");let et=this.databaseInfo.ssl?ey.K9.createSsl():ey.K9.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,et)}return this.cachedStub}invokeRPC(et,er,en,ei,es){let ea=dM(),eo=this.ensureActiveStub(),eu=dj(this.databasePath,ei,es,this.databaseInfo.appId),ec=Object.assign({database:this.databasePath},en);return dP(er=>(ex(dF,`RPC '${et}' ${ea} invoked with request:`,en),eo[et](ec,eu,(en,ei)=>{en?(ex(dF,`RPC '${et}' ${ea} failed with error:`,en),er(new eL(aY(en.code),en.message))):(ex(dF,`RPC '${et}' ${ea} completed with response:`,ei),er(void 0,ei))})))}invokeStreamingRPC(et,er,en,ei,es,ea){let eo=dM(),eu=[],ec=new eF;ex(dF,`RPC '${et}' ${eo} invoked (streaming) with request:`,en);let eh=this.ensureActiveStub(),ed=dj(this.databasePath,ei,es,this.databaseInfo.appId),ep=Object.assign(Object.assign({},en),{database:this.databasePath}),ef=eh[et](ep,ed),em=!1;return ef.on("data",er=>{ex(dF,`RPC ${et} ${eo} received result:`,er),eu.push(er),void 0!==ea&&eu.length===ea&&(em=!0,ec.resolve(eu))}),ef.on("end",()=>{ex(dF,`RPC '${et}' ${eo} completed.`),em||(em=!0,ec.resolve(eu))}),ef.on("error",er=>{ex(dF,`RPC '${et}' ${eo} failed with error:`,er);let en=aY(er.code);ec.reject(new eL(en,er.message))}),ec.promise}openStream(et,er,en){let ei=dM(),es=this.ensureActiveStub(),ea=dj(this.databasePath,er,en,this.databaseInfo.appId),eo=es[et](ea),eu=!1,ec=et=>{eu||(eu=!0,eh.callOnClose(et),eo.end())},eh=new dD({sendFn:er=>{if(eu)ex(dF,`RPC '${et}' stream ${ei} not sending because gRPC stream is closed:`,er);else{ex(dF,`RPC '${et}' stream ${ei} sending:`,er);try{eo.write(er)}catch(et){throw eA("Failure sending:",er),eA("Error:",et),et}}},closeFn:()=>{ex(dF,`RPC '${et}' stream ${ei} closed locally via close().`),ec()}}),ed=!1;return eo.on("data",er=>{eu||(ex(dF,`RPC '${et}' stream ${ei} received:`,er),ed||(eh.callOnConnected(),ed=!0),eh.callOnMessage(er))}),eo.on("end",()=>{ex(dF,`RPC '${et}' stream ${ei} ended.`),ec()}),eo.on("error",er=>{if(!eu){eR(dF,`RPC '${et}' stream ${ei} error. Code:`,er.code,"Message:",er.message);let en=aY(er.code);ec(new eL(en,er.message))}}),ex(dF,`Opening RPC '${et}' stream ${ei} to ${this.databaseInfo.host}`),setTimeout(()=>{eh.callOnOpen()},0),eh}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let dV={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var dz={nested:dV},dq=Object.freeze({__proto__:null,nested:dV,default:dz});/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d$={longs:String,enums:String,defaults:!0,oneofs:!1};function dG(){let et=ev.im(dq,d$);return ey.Rz(et)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dK(et){let er=dG();return new dU(er,et)}function dH(){return new dR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dW(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function dQ(){return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dY(et){return new od(et,!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dJ="ExponentialBackoff",dX=1e3,dZ=1.5,d0=6e4;class d3{constructor(et,er,en=dX,ei=dZ,es=d0){this.queue=et,this.timerId=er,this.initialDelayMs=en,this.backoffFactor=ei,this.maxDelayMs=es,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(et){this.cancel();let er=Math.floor(this.currentBaseMs+this.jitterDelayMs()),en=Math.max(0,Date.now()-this.lastAttemptTime),ei=Math.max(0,er-en);ei>0&&ex(dJ,`Backing off for ${ei} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${er} ms, last attempt: ${en} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,ei,()=>(this.lastAttemptTime=Date.now(),et())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d6="PersistentStream",d9=6e4,d4=1e4;class d5{constructor(et,er,en,ei,es,ea,eo,eu){this.queue=et,this.idleTimerId=en,this.healthTimerId=ei,this.connection=es,this.authCredentialsProvider=ea,this.appCheckCredentialsProvider=eo,this.listener=eu,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new d3(et,er)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,d9,()=>this.handleIdleCloseTimer()))}sendRequest(et){this.cancelIdleCheck(),this.stream.send(et)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(et,er){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==et?this.backoff.reset():er&&er.code===eP.RESOURCE_EXHAUSTED?(eA(er.toString()),eA("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):er&&er.code===eP.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=et,await this.listener.onClose(er)}tearDown(){}auth(){this.state=1;let et=this.getCloseGuardedDispatcher(this.closeCount),er=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([et,en])=>{this.closeCount===er&&this.startStream(et,en)},er=>{et(()=>{let et=new eL(eP.UNKNOWN,"Fetching auth token failed: "+er.message);return this.handleStreamClose(et)})})}startStream(et,er){let en=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(et,er),this.stream.onConnected(()=>{en(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{en(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,d4,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(et=>{en(()=>this.handleStreamClose(et))}),this.stream.onMessage(et=>{en(()=>1==++this.responseCount?this.onFirst(et):this.onNext(et))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(et){return ex(d6,`close with error: ${et}`),this.stream=null,this.close(4,et)}getCloseGuardedDispatcher(et){return er=>{this.queue.enqueueAndForget(()=>this.closeCount===et?er():(ex(d6,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class d8 extends null{constructor(et,er,en,ei,es,ea){super(et,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",er,en,ei,ea),this.serializer=es}startRpc(et,er){return this.connection.openStream("Listen",et,er)}onFirst(et){return this.onNext(et)}onNext(et){this.backoff.reset();let er=oj(this.serializer,et),en=oV(et);return this.listener.onWatchChange(er,en)}watch(et){let er={};er.database=oR(this.serializer),er.addTarget=o6(this.serializer,et);let en=o2(this.serializer,et);en&&(er.labels=en),this.sendRequest(er)}unwatch(et){let er={};er.database=oR(this.serializer),er.removeTarget=et,this.sendRequest(er)}}class d7 extends d5{constructor(et,er,en,ei,es,ea){super(et,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",er,en,ei,ea),this.serializer=es}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(et,er){return this.connection.openStream("Write",et,er)}onFirst(et){return eN(!!et.streamToken),this.lastStreamToken=et.streamToken,eN(!et.writeResults||0===et.writeResults.length),this.listener.onHandshakeComplete()}onNext(et){eN(!!et.streamToken),this.lastStreamToken=et.streamToken,this.backoff.reset();let er=oH(et.writeResults,et.commitTime),en=ow(et.commitTime);return this.listener.onMutationResult(en,er)}writeHandshake(){let et={};et.database=oR(this.serializer),this.sendRequest(et)}writeMutations(et){let er={streamToken:this.lastStreamToken,writes:et.map(et=>oz(this.serializer,et))};this.sendRequest(er)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{}class pr extends pt{constructor(et,er,en,ei){super(),this.authCredentials=et,this.appCheckCredentials=er,this.connection=en,this.serializer=ei,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new eL(eP.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(et,er,en,ei){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([es,ea])=>this.connection.invokeRPC(et,oC(er,en),ei,es,ea)).catch(et=>{if("FirebaseError"===et.name)throw et.code===eP.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),et;throw new eL(eP.UNKNOWN,et.toString())})}invokeStreamingRPC(et,er,en,ei,es){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([ea,eo])=>this.connection.invokeStreamingRPC(et,oC(er,en),ei,ea,eo,es)).catch(et=>{if("FirebaseError"===et.name)throw et.code===eP.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),et;throw new eL(eP.UNKNOWN,et.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function pn(et,er,en,ei){return new pr(et,er,en,ei)}async function pi(et,er){let en=eM(et),ei={writes:er.map(et=>oz(en.serializer,et))};await en.invokeRPC("Commit",en.serializer.databaseId,e9.emptyPath(),ei)}async function ps(et,er){let en=eM(et),ei={documents:er.map(et=>oI(en.serializer,et))},es=await en.invokeStreamingRPC("BatchGetDocuments",en.serializer.databaseId,e9.emptyPath(),ei,er.length),ea=new Map;es.forEach(et=>{let er=oB(en.serializer,et);ea.set(er.key.toString(),er)});let eo=[];return er.forEach(et=>{let er=ea.get(et.toString());eN(!!er),eo.push(er)}),eo}async function pa(et,er,en){var ei;let es=eM(et),{request:ea,aliasMap:eo,parent:eu}=oZ(es.serializer,sD(er),en);es.connection.shouldResourcePathBeIncludedInRequest||delete ea.parent;let ec=await es.invokeStreamingRPC("RunAggregationQuery",es.serializer.databaseId,eu,ea,1),eh=ec.filter(et=>!!et.result);eN(1===eh.length);let ed=null===(ei=eh[0].result)||void 0===ei?void 0:ei.aggregateFields,ep=Object.keys(ed).reduce((et,er)=>(et[eo[er]]=ed[er],et),{});return ep}function po(et,er,en){let ei=eM(et);return ei.verifyInitialized(),new d7(er,ei.connection,ei.authCredentials,ei.appCheckCredentials,ei.serializer,en)}function pl(et,er,en){let ei=eM(et);return ei.verifyInitialized(),new d8(er,ei.connection,ei.authCredentials,ei.appCheckCredentials,ei.serializer,en)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pu="OnlineStateTracker",pc=1,ph=1e4;class pd{constructor(et,er){this.asyncQueue=et,this.onlineStateHandler=er,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",ph,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${ph/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(et){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=pc&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${pc} times. Most recent error: ${et.toString()}`),this.setAndBroadcast("Offline")))}set(et){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===et&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(et)}setAndBroadcast(et){et!==this.state&&(this.state=et,this.onlineStateHandler(et))}logClientOfflineWarningIfNecessary(et){let er=`Could not reach Cloud Firestore backend. ${et}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(eA(er),this.shouldWarnClientIsOffline=!1):ex(pu,er)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pp="RemoteStore",pf=10;class pm{constructor(et,er,en,ei,es){this.localStore=et,this.datastore=er,this.asyncQueue=en,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=es,this.connectivityMonitor.addCallback(et=>{en.enqueueAndForget(async()=>{pI(this)&&(ex(pp,"Restarting streams for network reachability change."),await pK(this))})}),this.onlineStateTracker=new pd(en,ei)}}function pg(et,er,en,ei,es){return new pm(et,er,en,ei,es)}async function py(et){if(pI(et))for(let er of et.onNetworkStatusChange)await er(!0)}async function pv(et){for(let er of et.onNetworkStatusChange)await er(!1)}async function pb(et){let er=eM(et);ex(pp,"RemoteStore shutting down."),er.offlineCauses.add(5),await pv(er),er.connectivityMonitor.shutdown(),er.onlineStateTracker.set("Unknown")}function pS(et,er){let en=eM(et);!en.listenTargets.has(er.targetId)&&(en.listenTargets.set(er.targetId,er),p_(en)?pC(en):pQ(en).isOpen()&&pw(en,er))}function pT(et,er){let en=eM(et),ei=pQ(en);en.listenTargets.delete(er),ei.isOpen()&&pE(en,er),0===en.listenTargets.size&&(ei.isOpen()?ei.markIdle():pI(en)&&en.onlineStateTracker.set("Unknown"))}function pw(et,er){if(et.watchChangeAggregator.recordPendingTargetRequest(er.targetId),er.resumeToken.approximateByteSize()>0||er.snapshotVersion.compareTo(e2.min())>0){let en=et.remoteSyncer.getRemoteKeysForTarget(er.targetId).size;er=er.withExpectedCount(en)}pQ(et).watch(er)}function pE(et,er){et.watchChangeAggregator.recordPendingTargetRequest(er),pQ(et).unwatch(er)}function pC(et){et.watchChangeAggregator=new oi({getRemoteKeysForTarget:er=>et.remoteSyncer.getRemoteKeysForTarget(er),getTargetDataForTarget:er=>et.listenTargets.get(er)||null,getDatabaseId:()=>et.datastore.serializer.databaseId}),pQ(et).start(),et.onlineStateTracker.handleWatchStreamStart()}function p_(et){return pI(et)&&!pQ(et).isStarted()&&et.listenTargets.size>0}function pI(et){let er=eM(et);return 0===er.offlineCauses.size}function pk(et){et.watchChangeAggregator=void 0}async function px(et){et.onlineStateTracker.set("Online")}async function pA(et){et.listenTargets.forEach((er,en)=>{pw(et,er)})}async function pR(et,er){pk(et),p_(et)?(et.onlineStateTracker.handleWatchStreamFailure(er),pC(et)):et.onlineStateTracker.set("Unknown")}async function pD(et,er,en){if(et.onlineStateTracker.set("Online"),er instanceof ot&&2===er.state&&er.cause){try{await pP(et,er)}catch(en){ex(pp,"Failed to remove targets %s: %s ",er.targetIds.join(","),en),await pO(et,en)}return}if(er instanceof a8?et.watchChangeAggregator.handleDocumentChange(er):er instanceof a7?et.watchChangeAggregator.handleExistenceFilter(er):et.watchChangeAggregator.handleTargetChange(er),!en.isEqual(e2.min()))try{let er=await hV(et.localStore);en.compareTo(er)>=0&&await pM(et,en)}catch(er){ex(pp,"Failed to raise snapshot:",er),await pO(et,er)}}async function pO(et,er,en){if(tA(er))et.offlineCauses.add(1),await pv(et),et.onlineStateTracker.set("Offline"),en||(en=()=>hV(et.localStore)),et.asyncQueue.enqueueRetryable(async()=>{ex(pp,"Retrying IndexedDB access"),await en(),et.offlineCauses.delete(1),await py(et)});else throw er}function pN(et,er){return er().catch(en=>pO(et,en,er))}function pM(et,er){let en=et.watchChangeAggregator.createRemoteEvent(er);return en.targetChanges.forEach((en,ei)=>{if(en.resumeToken.approximateByteSize()>0){let es=et.listenTargets.get(ei);es&&et.listenTargets.set(ei,es.withResumeToken(en.resumeToken,er))}}),en.targetMismatches.forEach((er,en)=>{let ei=et.listenTargets.get(er);if(!ei)return;et.listenTargets.set(er,ei.withResumeToken(nm.EMPTY_BYTE_STRING,ei.snapshotVersion)),pE(et,er);let es=new l_(ei.target,er,en,ei.sequenceNumber);pw(et,es)}),et.remoteSyncer.applyRemoteEvent(en)}async function pP(et,er){let en=er.cause;for(let ei of er.targetIds)et.listenTargets.has(ei)&&(await et.remoteSyncer.rejectListen(ei,en),et.listenTargets.delete(ei),et.watchChangeAggregator.removeTarget(ei))}async function pL(et){let er=eM(et),en=pY(er),ei=er.writePipeline.length>0?er.writePipeline[er.writePipeline.length-1].batchId:nM;for(;pF(er);)try{let et=await hK(er.localStore,ei);if(null===et){0===er.writePipeline.length&&en.markIdle();break}ei=et.batchId,pB(er,et)}catch(et){await pO(er,et)}pj(er)&&pU(er)}function pF(et){return pI(et)&&et.writePipeline.length<pf}function pB(et,er){et.writePipeline.push(er);let en=pY(et);en.isOpen()&&en.handshakeComplete&&en.writeMutations(er.mutations)}function pj(et){return pI(et)&&!pY(et).isStarted()&&et.writePipeline.length>0}function pU(et){pY(et).start()}async function pV(et){pY(et).writeHandshake()}async function pz(et){let er=pY(et);for(let en of et.writePipeline)er.writeMutations(en.mutations)}async function pq(et,er,en){let ei=et.writePipeline.shift(),es=aG.from(ei,er,en);await pN(et,()=>et.remoteSyncer.applySuccessfulWrite(es)),await pL(et)}async function p$(et,er){er&&pY(et).handshakeComplete&&await pG(et,er),pj(et)&&pU(et)}async function pG(et,er){if(aQ(er.code)){let en=et.writePipeline.shift();pY(et).inhibitBackoff(),await pN(et,()=>et.remoteSyncer.rejectFailedWrite(en.batchId,er)),await pL(et)}}async function pK(et){let er=eM(et);er.offlineCauses.add(4),await pv(er),er.onlineStateTracker.set("Unknown"),er.offlineCauses.delete(4),await py(er)}async function pH(et,er){let en=eM(et);en.asyncQueue.verifyOperationInProgress(),ex(pp,"RemoteStore received new credentials");let ei=pI(en);en.offlineCauses.add(3),await pv(en),ei&&en.onlineStateTracker.set("Unknown"),await en.remoteSyncer.handleCredentialChange(er),en.offlineCauses.delete(3),await py(en)}async function pW(et,er){let en=eM(et);er?(en.offlineCauses.delete(2),await py(en)):er||(en.offlineCauses.add(2),await pv(en),en.onlineStateTracker.set("Unknown"))}function pQ(et){return et.watchStream||(et.watchStream=pl(et.datastore,et.asyncQueue,{onConnected:px.bind(null,et),onOpen:pA.bind(null,et),onClose:pR.bind(null,et),onWatchChange:pD.bind(null,et)}),et.onNetworkStatusChange.push(async er=>{er?(et.watchStream.inhibitBackoff(),p_(et)?pC(et):et.onlineStateTracker.set("Unknown")):(await et.watchStream.stop(),pk(et))})),et.watchStream}function pY(et){return et.writeStream||(et.writeStream=po(et.datastore,et.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:pV.bind(null,et),onClose:p$.bind(null,et),onHandshakeComplete:pz.bind(null,et),onMutationResult:pq.bind(null,et)}),et.onNetworkStatusChange.push(async er=>{er?(et.writeStream.inhibitBackoff(),await pL(et)):(await et.writeStream.stop(),et.writePipeline.length>0&&(ex(pp,`Stopping write stream with ${et.writePipeline.length} pending writes`),et.writePipeline=[]))})),et.writeStream}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pJ="AsyncQueue";class pX{constructor(et,er,en,ei,es){this.asyncQueue=et,this.timerId=er,this.targetTimeMs=en,this.op=ei,this.removalCallback=es,this.deferred=new eF,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(et=>{})}get promise(){return this.deferred.promise}static createAndSchedule(et,er,en,ei,es){let ea=Date.now()+en,eo=new pX(et,er,ea,ei,es);return eo.start(en),eo}start(et){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),et)}skipDelay(){return this.handleDelayElapsed()}cancel(et){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new eL(eP.CANCELLED,"Operation cancelled"+(et?": "+et:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(et=>this.deferred.resolve(et))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pZ(et,er){if(eA(pJ,`${er}: ${et}`),tA(et))return new eL(eP.UNAVAILABLE,`${er}: ${et}`);throw et}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{static emptySet(et){return new p0(et.comparator)}constructor(et){et?this.comparator=(er,en)=>et(er,en)||e8.comparator(er.key,en.key):this.comparator=(et,er)=>e8.comparator(et.key,er.key),this.keyedMap=sZ(),this.sortedSet=new nt(this.comparator)}has(et){return null!=this.keyedMap.get(et)}get(et){return this.keyedMap.get(et)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(et){let er=this.keyedMap.get(et);return er?this.sortedSet.indexOf(er):-1}get size(){return this.sortedSet.size}forEach(et){this.sortedSet.inorderTraversal((er,en)=>(et(er),!1))}add(et){let er=this.delete(et.key);return er.copy(er.keyedMap.insert(et.key,et),er.sortedSet.insert(et,null))}delete(et){let er=this.get(et);return er?this.copy(this.keyedMap.remove(et),this.sortedSet.remove(er)):this}isEqual(et){if(!(et instanceof p0)||this.size!==et.size)return!1;let er=this.sortedSet.getIterator(),en=et.sortedSet.getIterator();for(;er.hasNext();){let et=er.getNext().key,ei=en.getNext().key;if(!et.isEqual(ei))return!1}return!0}toString(){let et=[];return(this.forEach(er=>{et.push(er.toString())}),0===et.length)?"DocumentSet ()":"DocumentSet (\n  "+et.join("  \n")+"\n)"}copy(et,er){let en=new p0;return en.comparator=this.comparator,en.keyedMap=et,en.sortedSet=er,en}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(){this.changeMap=new nt(e8.comparator)}track(et){let er=et.doc.key,en=this.changeMap.get(er);if(!en){this.changeMap=this.changeMap.insert(er,et);return}0!==et.type&&3===en.type?this.changeMap=this.changeMap.insert(er,et):3===et.type&&1!==en.type?this.changeMap=this.changeMap.insert(er,{type:en.type,doc:et.doc}):2===et.type&&2===en.type?this.changeMap=this.changeMap.insert(er,{type:2,doc:et.doc}):2===et.type&&0===en.type?this.changeMap=this.changeMap.insert(er,{type:0,doc:et.doc}):1===et.type&&0===en.type?this.changeMap=this.changeMap.remove(er):1===et.type&&2===en.type?this.changeMap=this.changeMap.insert(er,{type:1,doc:en.doc}):0===et.type&&1===en.type?this.changeMap=this.changeMap.insert(er,{type:2,doc:et.doc}):eO()}getChanges(){let et=[];return this.changeMap.inorderTraversal((er,en)=>{et.push(en)}),et}}class p6{constructor(et,er,en,ei,es,ea,eo,eu,ec){this.query=et,this.docs=er,this.oldDocs=en,this.docChanges=ei,this.mutatedKeys=es,this.fromCache=ea,this.syncStateChanged=eo,this.excludesMetadataChanges=eu,this.hasCachedResults=ec}static fromInitialDocuments(et,er,en,ei,es){let ea=[];return er.forEach(et=>{ea.push({type:0,doc:et})}),new p6(et,er,p0.emptySet(er),ea,en,ei,!0,!1,es)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(et){if(this.fromCache!==et.fromCache||this.hasCachedResults!==et.hasCachedResults||this.syncStateChanged!==et.syncStateChanged||!this.mutatedKeys.isEqual(et.mutatedKeys)||!sB(this.query,et.query)||!this.docs.isEqual(et.docs)||!this.oldDocs.isEqual(et.oldDocs))return!1;let er=this.docChanges,en=et.docChanges;if(er.length!==en.length)return!1;for(let et=0;et<er.length;et++)if(er[et].type!==en[et].type||!er[et].doc.isEqual(en[et].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(et=>et.listensToRemoteStore())}}function p4(){return new p5}class p5{constructor(){this.queries=p8(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){fo(this,new eL(eP.ABORTED,"Firestore shutting down"))}}function p8(){return new sQ(et=>sj(et),sB)}async function p7(et,er){let en=eM(et),ei=3,es=er.query,ea=en.queries.get(es);ea?!ea.hasRemoteListeners()&&er.listensToRemoteStore()&&(ei=2):(ea=new p9,ei=er.listensToRemoteStore()?0:1);try{switch(ei){case 0:ea.viewSnap=await en.onListen(es,!0);break;case 1:ea.viewSnap=await en.onListen(es,!1);break;case 2:await en.onFirstRemoteStoreListen(es)}}catch(en){let et=pZ(en,`Initialization of query '${sU(er.query)}' failed`);er.onError(et);return}if(en.queries.set(es,ea),ea.listeners.push(er),er.applyOnlineStateChange(en.onlineState),ea.viewSnap){let et=er.onViewSnapshot(ea.viewSnap);et&&fl(en)}}async function ft(et,er){let en=eM(et),ei=er.query,es=3,ea=en.queries.get(ei);if(ea){let et=ea.listeners.indexOf(er);et>=0&&(ea.listeners.splice(et,1),0===ea.listeners.length?es=er.listensToRemoteStore()?0:1:!ea.hasRemoteListeners()&&er.listensToRemoteStore()&&(es=2))}switch(es){case 0:return en.queries.delete(ei),en.onUnlisten(ei,!0);case 1:return en.queries.delete(ei),en.onUnlisten(ei,!1);case 2:return en.onLastRemoteStoreUnlisten(ei);default:return}}function fr(et,er){let en=eM(et),ei=!1;for(let et of er){let er=et.query,es=en.queries.get(er);if(es){for(let er of es.listeners)er.onViewSnapshot(et)&&(ei=!0);es.viewSnap=et}}ei&&fl(en)}function fi(et,er,en){let ei=eM(et),es=ei.queries.get(er);if(es)for(let et of es.listeners)et.onError(en);ei.queries.delete(er)}function fa(et,er){let en=eM(et);en.onlineState=er;let ei=!1;en.queries.forEach((et,en)=>{for(let et of en.listeners)et.applyOnlineStateChange(er)&&(ei=!0)}),ei&&fl(en)}function fo(et,er){let en=eM(et),ei=en.queries;en.queries=p8(),ei.forEach((et,en)=>{for(let et of en.listeners)et.onError(er)})}function fl(et){et.snapshotsInSyncListeners.forEach(et=>{et.next()})}!function(et){et.Default="default",et.Cache="cache"}(eo||(eo={}));class fu{constructor(et,er,en){this.query=et,this.queryObserver=er,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=en||{}}onViewSnapshot(et){if(!this.options.includeMetadataChanges){let er=[];for(let en of et.docChanges)3!==en.type&&er.push(en);et=new p6(et.query,et.docs,et.oldDocs,er,et.mutatedKeys,et.fromCache,et.syncStateChanged,!0,et.hasCachedResults)}let er=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(et)&&(this.queryObserver.next(et),er=!0):this.shouldRaiseInitialEvent(et,this.onlineState)&&(this.raiseInitialEvent(et),er=!0),this.snap=et,er}onError(et){this.queryObserver.error(et)}applyOnlineStateChange(et){this.onlineState=et;let er=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,et)&&(this.raiseInitialEvent(this.snap),er=!0),er}shouldRaiseInitialEvent(et,er){if(!et.fromCache||!this.listensToRemoteStore())return!0;let en="Offline"!==er;return(!this.options.waitForSyncWhenOnline||!en)&&(!et.docs.isEmpty()||et.hasCachedResults||"Offline"===er)}shouldRaiseEvent(et){if(et.docChanges.length>0)return!0;let er=this.snap&&this.snap.hasPendingWrites!==et.hasPendingWrites;return(!!et.syncStateChanged||!!er)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(et){et=p6.fromInitialDocuments(et.query,et.docs,et.mutatedKeys,et.fromCache,et.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(et)}listensToRemoteStore(){return this.options.source!==eo.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(et,er,en,ei){this.targetId=et,this.fromCache=er,this.addedKeys=en,this.removedKeys=ei}static fromSnapshot(et,er){let en=s8(),ei=s8();for(let et of er.docChanges)switch(et.type){case 0:en=en.add(et.doc.key);break;case 1:ei=ei.add(et.doc.key)}return new fc(et,er.fromCache,en,ei)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(et){this.serializer=et}toDocumentKey(et){return ok(this.serializer,et)}toMutableDocument(et){return et.metadata.exists?oP(this.serializer,et.document,!1):iP.newNoDocument(this.toDocumentKey(et.metadata.name),this.toSnapshotVersion(et.metadata.readTime))}toSnapshotVersion(et){return ow(et)}}class fd{constructor(et,er,en){this.bundleMetadata=et,this.localStore=er,this.serializer=en,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=fp(et)}addSizedElement(et){this.progress.bytesLoaded+=et.byteLength;let er=this.progress.documentsLoaded;if(et.payload.namedQuery)this.queries.push(et.payload.namedQuery);else if(et.payload.documentMetadata){this.documents.push({metadata:et.payload.documentMetadata}),!et.payload.documentMetadata.exists&&++er;let en=e9.fromString(et.payload.documentMetadata.name);this.collectionGroups.add(en.get(en.length-2))}else et.payload.document&&(this.documents[this.documents.length-1].document=et.payload.document,++er);return er!==this.progress.documentsLoaded?(this.progress.documentsLoaded=er,Object.assign({},this.progress)):null}getQueryDocumentMapping(et){let er=new Map,en=new fh(this.serializer);for(let ei of et)if(ei.metadata.queries){let et=en.toDocumentKey(ei.metadata.name);for(let en of ei.metadata.queries){let ei=(er.get(en)||s8()).add(et);er.set(en,ei)}}return er}async complete(){let et=await h4(this.localStore,new fh(this.serializer),this.documents,this.bundleMetadata.id),er=this.getQueryDocumentMapping(this.documents);for(let et of this.queries)await h7(this.localStore,et,er.get(et.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:et}}}function fp(et){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:et.totalDocuments,totalBytes:et.totalBytes}}function ff(et){return{taskState:"Success",documentsLoaded:et.totalDocuments,bytesLoaded:et.totalBytes,totalDocuments:et.totalDocuments,totalBytes:et.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(et){this.key=et}}class fg{constructor(et){this.key=et}}class fy{constructor(et,er){this.query=et,this._syncedDocuments=er,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=s8(),this.mutatedKeys=s8(),this.docComparator=sH(et),this.documentSet=new p0(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(et,er){let en=er?er.changeSet:new p3,ei=er?er.documentSet:this.documentSet,es=er?er.mutatedKeys:this.mutatedKeys,ea=ei,eo=!1,eu="F"===this.query.limitType&&ei.size===this.query.limit?ei.last():null,ec="L"===this.query.limitType&&ei.size===this.query.limit?ei.first():null;if(et.inorderTraversal((et,er)=>{let eh=ei.get(et),ed=sV(this.query,er)?er:null,ep=!!eh&&this.mutatedKeys.has(eh.key),ef=!!ed&&(ed.hasLocalMutations||this.mutatedKeys.has(ed.key)&&ed.hasCommittedMutations),em=!1;if(eh&&ed){let et=eh.data.isEqual(ed.data);et?ep!==ef&&(en.track({type:3,doc:ed}),em=!0):!this.shouldWaitForSyncedDocument(eh,ed)&&(en.track({type:2,doc:ed}),em=!0,(eu&&this.docComparator(ed,eu)>0||ec&&0>this.docComparator(ed,ec))&&(eo=!0))}else!eh&&ed?(en.track({type:0,doc:ed}),em=!0):eh&&!ed&&(en.track({type:1,doc:eh}),em=!0,(eu||ec)&&(eo=!0));em&&(ed?(ea=ea.add(ed),es=ef?es.add(et):es.delete(et)):(ea=ea.delete(et),es=es.delete(et)))}),null!==this.query.limit)for(;ea.size>this.query.limit;){let et="F"===this.query.limitType?ea.last():ea.first();ea=ea.delete(et.key),es=es.delete(et.key),en.track({type:1,doc:et})}return{documentSet:ea,changeSet:en,needsRefill:eo,mutatedKeys:es}}shouldWaitForSyncedDocument(et,er){return et.hasLocalMutations&&er.hasCommittedMutations&&!er.hasLocalMutations}applyChanges(et,er,en,ei){let es=this.documentSet;this.documentSet=et.documentSet,this.mutatedKeys=et.mutatedKeys;let ea=et.changeSet.getChanges();ea.sort((et,er)=>fv(et.type,er.type)||this.docComparator(et.doc,er.doc)),this.applyTargetChange(en),ei=null!=ei&&ei;let eo=er&&!ei?this.updateLimboDocuments():[],eu=0===this.limboDocuments.size&&this.current&&!ei,ec=eu?1:0,eh=ec!==this.syncState;if(this.syncState=ec,0===ea.length&&!eh)return{limboChanges:eo};{let er=new p6(this.query,et.documentSet,es,ea,et.mutatedKeys,0===ec,eh,!1,!!en&&en.resumeToken.approximateByteSize()>0);return{snapshot:er,limboChanges:eo}}}applyOnlineStateChange(et){return this.current&&"Offline"===et?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new p3,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(et){return!this._syncedDocuments.has(et)&&!!this.documentSet.has(et)&&!this.documentSet.get(et).hasLocalMutations}applyTargetChange(et){et&&(et.addedDocuments.forEach(et=>this._syncedDocuments=this._syncedDocuments.add(et)),et.modifiedDocuments.forEach(et=>{}),et.removedDocuments.forEach(et=>this._syncedDocuments=this._syncedDocuments.delete(et)),this.current=et.current)}updateLimboDocuments(){if(!this.current)return[];let et=this.limboDocuments;this.limboDocuments=s8(),this.documentSet.forEach(et=>{this.shouldBeInLimbo(et.key)&&(this.limboDocuments=this.limboDocuments.add(et.key))});let er=[];return et.forEach(et=>{this.limboDocuments.has(et)||er.push(new fg(et))}),this.limboDocuments.forEach(en=>{et.has(en)||er.push(new fm(en))}),er}synchronizeWithPersistedState(et){this._syncedDocuments=et.remoteKeys,this.limboDocuments=s8();let er=this.computeDocChanges(et.documents);return this.applyChanges(er,!0)}computeInitialSnapshot(){return p6.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function fv(et,er){let en=et=>{switch(et){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return eO()}};return en(et)-en(er)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fb="SyncEngine";class fS{constructor(et,er,en){this.query=et,this.targetId=er,this.view=en}}class fT{constructor(et){this.key=et,this.receivedDocument=!1}}class fw{constructor(et,er,en,ei,es,ea){this.localStore=et,this.remoteStore=er,this.eventManager=en,this.sharedClientState=ei,this.currentUser=es,this.maxConcurrentLimboResolutions=ea,this.syncEngineListener={},this.queryViewsByQuery=new sQ(et=>sj(et),sB),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new nt(e8.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new cV,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ct.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function fE(et,er,en,ei,es,ea,eo){let eu=new fw(et,er,en,ei,es,ea);return eo&&(eu._isPrimaryClient=!0),eu}async function fC(et,er,en=!0){let ei;let es=f5(et),ea=es.queryViewsByQuery.get(er);return ea?(es.sharedClientState.addLocalQueryTarget(ea.targetId),ei=ea.view.computeInitialSnapshot()):ei=await fI(es,er,en,!0),ei}async function f_(et,er){let en=f5(et);await fI(en,er,!0,!1)}async function fI(et,er,en,ei){let es;let ea=await hW(et.localStore,sR(er)),eo=ea.targetId,eu=et.sharedClientState.addLocalQueryTarget(eo,en);return ei&&(es=await fk(et,er,eo,"current"===eu,ea.resumeToken)),et.isPrimaryClient&&en&&pS(et.remoteStore,ea),es}async function fk(et,er,en,ei,es){et.applyDocChanges=(er,en,ei)=>fK(et,er,en,ei);let ea=await hJ(et.localStore,er,!0),eo=new fy(er,ea.remoteKeys),eu=eo.computeDocChanges(ea.documents),ec=a5.createSynthesizedTargetChangeForCurrentChange(en,ei&&"Offline"!==et.onlineState,es),eh=eo.applyChanges(eu,et.isPrimaryClient,ec);fz(et,en,eh.limboChanges);let ed=new fS(er,en,eo);return et.queryViewsByQuery.set(er,ed),et.queriesByTarget.has(en)?et.queriesByTarget.get(en).push(er):et.queriesByTarget.set(en,[er]),eh.snapshot}async function fx(et,er,en){let ei=eM(et),es=ei.queryViewsByQuery.get(er),ea=ei.queriesByTarget.get(es.targetId);if(ea.length>1){ei.queriesByTarget.set(es.targetId,ea.filter(et=>!sB(et,er))),ei.queryViewsByQuery.delete(er);return}if(ei.isPrimaryClient){ei.sharedClientState.removeLocalQueryTarget(es.targetId);let et=ei.sharedClientState.isActiveQueryTarget(es.targetId);et||await hY(ei.localStore,es.targetId,!1).then(()=>{ei.sharedClientState.clearQueryState(es.targetId),en&&pT(ei.remoteStore,es.targetId),fU(ei,es.targetId)}).catch(tb)}else fU(ei,es.targetId),await hY(ei.localStore,es.targetId,!0)}async function fA(et,er){let en=eM(et),ei=en.queryViewsByQuery.get(er),es=en.queriesByTarget.get(ei.targetId);en.isPrimaryClient&&1===es.length&&(en.sharedClientState.removeLocalQueryTarget(ei.targetId),pT(en.remoteStore,ei.targetId))}async function fR(et,er,en){let ei=f8(et);try{let et=await hL(ei.localStore,er);ei.sharedClientState.addPendingMutation(et.batchId),fB(ei,et.batchId,en),await fG(ei,et.changes),await pL(ei.remoteStore)}catch(er){let et=pZ(er,"Failed to persist write");en.reject(et)}}async function fD(et,er){let en=eM(et);try{let et=await hz(en.localStore,er);er.targetChanges.forEach((et,er)=>{let ei=en.activeLimboResolutionsByTarget.get(er);ei&&(eN(et.addedDocuments.size+et.modifiedDocuments.size+et.removedDocuments.size<=1),et.addedDocuments.size>0?ei.receivedDocument=!0:et.modifiedDocuments.size>0?eN(ei.receivedDocument):et.removedDocuments.size>0&&(eN(ei.receivedDocument),ei.receivedDocument=!1))}),await fG(en,et,er)}catch(et){await tb(et)}}function fO(et,er,en){let ei=eM(et);if(ei.isPrimaryClient&&0===en||!ei.isPrimaryClient&&1===en){let et=[];ei.queryViewsByQuery.forEach((en,ei)=>{let es=ei.view.applyOnlineStateChange(er);es.snapshot&&et.push(es.snapshot)}),fa(ei.eventManager,er),et.length&&ei.syncEngineListener.onWatchChange(et),ei.onlineState=er,ei.isPrimaryClient&&ei.sharedClientState.setOnlineState(er)}}async function fN(et,er,en){let ei=eM(et);ei.sharedClientState.updateQueryState(er,"rejected",en);let es=ei.activeLimboResolutionsByTarget.get(er),ea=es&&es.key;if(ea){let et=new nt(e8.comparator);et=et.insert(ea,iP.newNoDocument(ea,e2.min()));let en=s8().add(ea),es=new a4(e2.min(),new Map,new nt(eY),et,en);await fD(ei,es),ei.activeLimboTargetsByKey=ei.activeLimboTargetsByKey.remove(ea),ei.activeLimboResolutionsByTarget.delete(er),f$(ei)}else await hY(ei.localStore,er,!1).then(()=>fU(ei,er,en)).catch(tb)}async function fM(et,er){let en=eM(et),ei=er.batch.batchId;try{let et=await hF(en.localStore,er);fj(en,ei,null),fL(en,ei),en.sharedClientState.updateMutationState(ei,"acknowledged"),await fG(en,et)}catch(et){await tb(et)}}async function fP(et,er,en){let ei=eM(et);try{let et=await hj(ei.localStore,er);fj(ei,er,en),fL(ei,er),ei.sharedClientState.updateMutationState(er,"rejected",en),await fG(ei,et)}catch(et){await tb(et)}}function fL(et,er){(et.pendingWritesCallbacks.get(er)||[]).forEach(et=>{et.resolve()}),et.pendingWritesCallbacks.delete(er)}function fF(et,er){et.pendingWritesCallbacks.forEach(et=>{et.forEach(et=>{et.reject(new eL(eP.CANCELLED,er))})}),et.pendingWritesCallbacks.clear()}function fB(et,er,en){let ei=et.mutationUserCallbacks[et.currentUser.toKey()];ei||(ei=new nt(eY)),ei=ei.insert(er,en),et.mutationUserCallbacks[et.currentUser.toKey()]=ei}function fj(et,er,en){let ei=eM(et),es=ei.mutationUserCallbacks[ei.currentUser.toKey()];if(es){let et=es.get(er);et&&(en?et.reject(en):et.resolve(),es=es.remove(er)),ei.mutationUserCallbacks[ei.currentUser.toKey()]=es}}function fU(et,er,en=null){for(let ei of(et.sharedClientState.removeLocalQueryTarget(er),et.queriesByTarget.get(er)))et.queryViewsByQuery.delete(ei),en&&et.syncEngineListener.onWatchError(ei,en);if(et.queriesByTarget.delete(er),et.isPrimaryClient){let en=et.limboDocumentRefs.removeReferencesForId(er);en.forEach(er=>{let en=et.limboDocumentRefs.containsKey(er);en||fV(et,er)})}}function fV(et,er){et.enqueuedLimboResolutions.delete(er.path.canonicalString());let en=et.activeLimboTargetsByKey.get(er);null!==en&&(pT(et.remoteStore,en),et.activeLimboTargetsByKey=et.activeLimboTargetsByKey.remove(er),et.activeLimboResolutionsByTarget.delete(en),f$(et))}function fz(et,er,en){for(let ei of en)if(ei instanceof fm)et.limboDocumentRefs.addReference(ei.key,er),fq(et,ei);else if(ei instanceof fg){ex(fb,"Document no longer in limbo: "+ei.key),et.limboDocumentRefs.removeReference(ei.key,er);let en=et.limboDocumentRefs.containsKey(ei.key);en||fV(et,ei.key)}else eO()}function fq(et,er){let en=er.key,ei=en.path.canonicalString();et.activeLimboTargetsByKey.get(en)||et.enqueuedLimboResolutions.has(ei)||(ex(fb,"New document in limbo: "+en),et.enqueuedLimboResolutions.add(ei),f$(et))}function f$(et){for(;et.enqueuedLimboResolutions.size>0&&et.activeLimboTargetsByKey.size<et.maxConcurrentLimboResolutions;){let er=et.enqueuedLimboResolutions.values().next().value;et.enqueuedLimboResolutions.delete(er);let en=new e8(e9.fromString(er)),ei=et.limboTargetIdGenerator.next();et.activeLimboResolutionsByTarget.set(ei,new fT(en)),et.activeLimboTargetsByKey=et.activeLimboTargetsByKey.insert(en,ei),pS(et.remoteStore,new l_(sR(sE(en.path)),ei,"TargetPurposeLimboResolution",tU.INVALID))}}async function fG(et,er,en){let ei=eM(et),es=[],ea=[],eo=[];ei.queryViewsByQuery.isEmpty()||(ei.queryViewsByQuery.forEach((et,eu)=>{eo.push(ei.applyDocChanges(eu,er,en).then(et=>{var er;if((et||en)&&ei.isPrimaryClient){let es=et?!et.fromCache:null===(er=null==en?void 0:en.targetChanges.get(eu.targetId))||void 0===er?void 0:er.current;ei.sharedClientState.updateQueryState(eu.targetId,es?"current":"not-current")}if(et){es.push(et);let er=fc.fromSnapshot(eu.targetId,et);ea.push(er)}}))}),await Promise.all(eo),ei.syncEngineListener.onWatchChange(es),await hG(ei.localStore,ea))}async function fK(et,er,en,ei){let es=er.view.computeDocChanges(en);es.needsRefill&&(es=await hJ(et.localStore,er.query,!1).then(({documents:et})=>er.view.computeDocChanges(et,es)));let ea=ei&&ei.targetChanges.get(er.targetId),eo=ei&&null!=ei.targetMismatches.get(er.targetId),eu=er.view.applyChanges(es,et.isPrimaryClient,ea,eo);return fz(et,er.targetId,eu.limboChanges),eu.snapshot}async function fH(et,er){let en=eM(et),ei=!en.currentUser.isEqual(er);if(ei){ex(fb,"User change. New user:",er.toKey());let et=await hP(en.localStore,er);en.currentUser=er,fF(en,"'waitForPendingWrites' promise is rejected due to a user change."),en.sharedClientState.handleUserChange(er,et.removedBatchIds,et.addedBatchIds),await fG(en,et.affectedDocuments)}}function fW(et,er){let en=eM(et),ei=en.activeLimboResolutionsByTarget.get(er);if(ei&&ei.receivedDocument)return s8().add(ei.key);{let et=s8(),ei=en.queriesByTarget.get(er);if(!ei)return et;for(let er of ei){let ei=en.queryViewsByQuery.get(er);et=et.unionWith(ei.view.syncedDocuments)}return et}}async function fQ(et,er){let en=eM(et),ei=await hJ(en.localStore,er.query,!0),es=er.view.synchronizeWithPersistedState(ei);return en.isPrimaryClient&&fz(en,er.targetId,es.limboChanges),es}async function fY(et,er){let en=eM(et);return h3(en.localStore,er).then(et=>fG(en,et))}async function fJ(et,er,en,ei){let es=eM(et),ea=await hZ(es.localStore,er);if(null===ea){ex(fb,"Cannot apply mutation batch with id: "+er);return}"pending"===en?await pL(es.remoteStore):"acknowledged"===en||"rejected"===en?(fj(es,er,ei||null),fL(es,er),h0(es.localStore,er)):eO(),await fG(es,ea)}async function fX(et,er){let en=eM(et);if(f5(en),f8(en),!0===er&&!0!==en._isPrimaryClient){let et=en.sharedClientState.getAllActiveQueryTargets(),er=await f0(en,et.toArray());for(let et of(en._isPrimaryClient=!0,await pW(en.remoteStore,!0),er))pS(en.remoteStore,et)}else if(!1===er&&!1!==en._isPrimaryClient){let et=[],er=Promise.resolve();en.queriesByTarget.forEach((ei,es)=>{en.sharedClientState.isLocalQueryTarget(es)?et.push(es):er=er.then(()=>(fU(en,es),hY(en.localStore,es,!0))),pT(en.remoteStore,es)}),await er,await f0(en,et),fZ(en),en._isPrimaryClient=!1,await pW(en.remoteStore,!1)}}function fZ(et){let er=eM(et);er.activeLimboResolutionsByTarget.forEach((et,en)=>{pT(er.remoteStore,en)}),er.limboDocumentRefs.removeAllReferences(),er.activeLimboResolutionsByTarget=new Map,er.activeLimboTargetsByKey=new nt(e8.comparator)}async function f0(et,er,en){let ei=eM(et),es=[],ea=[];for(let et of er){let er;let en=ei.queriesByTarget.get(et);if(en&&0!==en.length)for(let et of(er=await hW(ei.localStore,sR(en[0])),en)){let er=ei.queryViewsByQuery.get(et),en=await fQ(ei,er);en.snapshot&&ea.push(en.snapshot)}else{let en=await h2(ei.localStore,et);er=await hW(ei.localStore,en),await fk(ei,f3(en),et,!1,er.resumeToken)}es.push(er)}return ei.syncEngineListener.onWatchChange(ea),es}function f3(et){return sw(et.path,et.collectionGroup,et.orderBy,et.filters,et.limit,"F",et.startAt,et.endAt)}function f6(et){let er=eM(et);return h1(er.localStore)}async function f9(et,er,en,ei){let es=eM(et);if(es._isPrimaryClient){ex(fb,"Ignoring unexpected query state notification.");return}let ea=es.queriesByTarget.get(er);if(ea&&ea.length>0)switch(en){case"current":case"not-current":{let et=await h3(es.localStore,sK(ea[0])),ei=a4.createSynthesizedRemoteEventForCurrentChange(er,"current"===en,nm.EMPTY_BYTE_STRING);await fG(es,et,ei);break}case"rejected":await hY(es.localStore,er,!0),fU(es,er,ei);break;default:eO()}}async function f4(et,er,en){let ei=f5(et);if(ei._isPrimaryClient){for(let et of er){let er=ei.queriesByTarget.has(et)&&ei.sharedClientState.isActiveQueryTarget(et);if(er){ex(fb,"Adding an already active target "+et);continue}let en=await h2(ei.localStore,et),es=await hW(ei.localStore,en);await fk(ei,f3(en),es.targetId,!1,es.resumeToken),pS(ei.remoteStore,es)}for(let et of en)ei.queriesByTarget.has(et)&&await hY(ei.localStore,et,!1).then(()=>{pT(ei.remoteStore,et),fU(ei,et)}).catch(tb)}}function f5(et){let er=eM(et);return er.remoteStore.remoteSyncer.applyRemoteEvent=fD.bind(null,er),er.remoteStore.remoteSyncer.getRemoteKeysForTarget=fW.bind(null,er),er.remoteStore.remoteSyncer.rejectListen=fN.bind(null,er),er.syncEngineListener.onWatchChange=fr.bind(null,er.eventManager),er.syncEngineListener.onWatchError=fi.bind(null,er.eventManager),er}function f8(et){let er=eM(et);return er.remoteStore.remoteSyncer.applySuccessfulWrite=fM.bind(null,er),er.remoteStore.remoteSyncer.rejectFailedWrite=fP.bind(null,er),er}async function f7(et,er,en){try{let ei=await er.getMetadata(),es=await h5(et.localStore,ei);if(es)return await er.close(),en._completeWith(ff(ei)),Promise.resolve(new Set);en._updateProgress(fp(ei));let ea=new fd(ei,et.localStore,er.serializer),eo=await er.nextElement();for(;eo;){let et=await ea.addSizedElement(eo);et&&en._updateProgress(et),eo=await er.nextElement()}let eu=await ea.complete();return await fG(et,eu.changedDocs,void 0),await h8(et.localStore,ei),en._completeWith(eu.progress),Promise.resolve(eu.changedCollectionGroups)}catch(et){return eR(fb,`Loading bundle failed with ${et}`),en._failWith(et),Promise.resolve(new Set)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(et){this.serializer=dY(et.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(et),this.persistence=this.createPersistence(et),await this.persistence.start(),this.localStore=this.createLocalStore(et),this.gcScheduler=this.createGarbageCollectionScheduler(et,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(et,this.localStore)}createGarbageCollectionScheduler(et,er){return null}createIndexBackfillerScheduler(et,er){return null}createLocalStore(et){return hM(this.persistence,new ds,et.initialUser,this.serializer)}createPersistence(et){return new cJ(cZ.factory,this.serializer)}createSharedClientState(et){return new dA}async terminate(){var et,er;null===(et=this.gcScheduler)||void 0===et||et.stop(),null===(er=this.indexBackfillerScheduler)||void 0===er||er.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mt.provider={build:()=>new mt};class mr extends mt{constructor(et){super(),this.cacheSizeBytes=et}createGarbageCollectionScheduler(et,er){eN(this.persistence.referenceDelegate instanceof c0);let en=this.persistence.referenceDelegate.garbageCollector;return new cy(en,et.asyncQueue,er)}createPersistence(et){let er=void 0!==this.cacheSizeBytes?cu.withCacheSize(this.cacheSizeBytes):cu.DEFAULT;return new cJ(et=>c0.factory(et,er),this.serializer)}}class mn extends null{constructor(et,er,en){super(),this.onlineComponentProvider=et,this.cacheSizeBytes=er,this.forceOwnership=en,this.kind="persistent",this.synchronizeTabs=!1}async initialize(et){await super.initialize(et),await this.onlineComponentProvider.initialize(this,et),await f8(this.onlineComponentProvider.syncEngine),await pL(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(et){return hM(this.persistence,new ds,et.initialUser,this.serializer)}createGarbageCollectionScheduler(et,er){let en=this.persistence.referenceDelegate.garbageCollector;return new cy(en,et.asyncQueue,er)}createIndexBackfillerScheduler(et,er){let en=new tj(er,this.persistence);return new tB(et.asyncQueue,en)}createPersistence(et){let er=hx(et.databaseInfo.databaseId,et.databaseInfo.persistenceKey),en=void 0!==this.cacheSizeBytes?cu.withCacheSize(this.cacheSizeBytes):cu.DEFAULT;return new h_(this.synchronizeTabs,er,et.clientId,en,et.asyncQueue,dW(),dQ(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(et){return new dA}}class mi{async initialize(et,er){this.localStore||(this.localStore=et.localStore,this.sharedClientState=et.sharedClientState,this.datastore=this.createDatastore(er),this.remoteStore=this.createRemoteStore(er),this.eventManager=this.createEventManager(er),this.syncEngine=this.createSyncEngine(er,!et.synchronizeTabs),this.sharedClientState.onlineStateHandler=et=>fO(this.syncEngine,et,1),this.remoteStore.remoteSyncer.handleCredentialChange=fH.bind(null,this.syncEngine),await pW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(et){return p4()}createDatastore(et){let er=dY(et.databaseInfo.databaseId),en=dK(et.databaseInfo);return pn(et.authCredentials,et.appCheckCredentials,en,er)}createRemoteStore(et){return pg(this.localStore,this.datastore,et.asyncQueue,et=>fO(this.syncEngine,et,0),dH())}createSyncEngine(et,er){return fE(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,et.initialUser,et.maxConcurrentLimboResolutions,er)}async terminate(){var et,er;await pb(this.remoteStore),null===(et=this.datastore)||void 0===et||et.terminate(),null===(er=this.eventManager)||void 0===er||er.terminate()}}mi.provider={build:()=>new mi};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ms=10240;function ma(et,er=ms){let en=0,ei={async read(){if(en<et.byteLength){let ei={value:et.slice(en,en+er),done:!1};return en+=er,ei}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()};return ei}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(et,er,en){if(!en)throw new eL(eP.INVALID_ARGUMENT,`Function ${et}() cannot be called with an empty ${er}.`)}function ml(et,er,en,ei){if(!0===er&&!0===ei)throw new eL(eP.INVALID_ARGUMENT,`${et} and ${en} cannot be used together.`)}function mu(et){if(!e8.isDocumentKey(et))throw new eL(eP.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${et} has ${et.length}.`)}function mc(et){if(e8.isDocumentKey(et))throw new eL(eP.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${et} has ${et.length}.`)}function mh(et){return"object"==typeof et&&null!==et&&(Object.getPrototypeOf(et)===Object.prototype||null===Object.getPrototypeOf(et))}function mp(et){if(void 0===et)return"undefined";if(null===et)return"null";if("string"==typeof et)return et.length>20&&(et=`${et.substring(0,20)}...`),JSON.stringify(et);if("number"==typeof et||"boolean"==typeof et)return""+et;if("object"==typeof et){if(et instanceof Array)return"an array";{let er=mf(et);return er?`a custom ${er} object`:"an object"}}if("function"==typeof et)return"a function";return eO()}function mf(et){return et.constructor?et.constructor.name:null}function mm(et,er){if("_delegate"in et&&(et=et._delegate),!(et instanceof er)){if(er.name===et.constructor.name)throw new eL(eP.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let en=mp(et);throw new eL(eP.INVALID_ARGUMENT,`Expected type '${er.name}', but it was: ${en}`)}}return et}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mg(et,er){if(!(et instanceof Uint8Array))throw new eL(eP.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${mp(et)}`);return ma(et,er)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(et){this.observer=et,this.muted=!1}next(et){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,et)}error(et){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,et):eA("Uncaught Error in snapshot listener:",et.toString()))}mute(){this.muted=!0}scheduleEvent(et,er){setTimeout(()=>{this.muted||et(er)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(et,er){this.payload=et,this.byteLength=er}isBundleMetadata(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(et,er){this.reader=et,this.serializer=er,this.metadata=new eF,this.buffer=new Uint8Array,this.textDecoder=a0(),this.nextElementImpl().then(et=>{et&&et.isBundleMetadata()?this.metadata.resolve(et.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==et?void 0:et.payload)}`))},et=>this.metadata.reject(et))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let et=await this.readLength();if(null===et)return null;let er=this.textDecoder.decode(et),en=Number(er);isNaN(en)&&this.raiseError(`length string (${er}) is not valid number`);let ei=await this.readJsonString(en);return new mv(JSON.parse(ei),et.length+en)}indexOfOpenBracket(){return this.buffer.findIndex(et=>123===et)}async readLength(){for(;0>this.indexOfOpenBracket();){let et=await this.pullMoreDataToBuffer();if(et)break}if(0===this.buffer.length)return null;let et=this.indexOfOpenBracket();et<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let er=this.buffer.slice(0,et);return this.buffer=this.buffer.slice(et),er}async readJsonString(et){for(;this.buffer.length<et;){let et=await this.pullMoreDataToBuffer();et&&this.raiseError("Reached the end of bundle when more is expected.")}let er=this.textDecoder.decode(this.buffer.slice(0,et));return this.buffer=this.buffer.slice(et),er}raiseError(et){throw this.reader.cancel(),Error(`Invalid bundle format: ${et}`)}async pullMoreDataToBuffer(){let et=await this.reader.read();if(!et.done){let er=new Uint8Array(this.buffer.length+et.value.length);er.set(this.buffer),er.set(et.value,this.buffer.length),this.buffer=er}return et.done}}function mS(et,er){return new mb(et,er)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(et){this.datastore=et,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(et){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new eL(eP.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let er=await ps(this.datastore,et);return er.forEach(et=>this.recordVersion(et)),er}set(et,er){this.write(er.toMutation(et,this.precondition(et))),this.writtenDocs.add(et.toString())}update(et,er){try{this.write(er.toMutation(et,this.preconditionForUpdate(et)))}catch(et){this.lastTransactionError=et}this.writtenDocs.add(et.toString())}delete(et){this.write(new aU(et,this.precondition(et))),this.writtenDocs.add(et.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let et=this.readVersions;this.mutations.forEach(er=>{et.delete(er.key.toString())}),et.forEach((et,er)=>{let en=e8.fromPath(er);this.mutations.push(new aq(en,this.precondition(en)))}),await pi(this.datastore,this.mutations),this.committed=!0}recordVersion(et){let er;if(et.isFoundDocument())er=et.version;else if(et.isNoDocument())er=e2.min();else throw eO();let en=this.readVersions.get(et.key.toString());if(en){if(!er.isEqual(en))throw new eL(eP.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(et.key.toString(),er)}precondition(et){let er=this.readVersions.get(et.toString());return this.writtenDocs.has(et.toString())||!er?aE.none():er.isEqual(e2.min())?aE.exists(!1):aE.updateTime(er)}preconditionForUpdate(et){let er=this.readVersions.get(et.toString());if(this.writtenDocs.has(et.toString())||!er)return aE.exists(!0);if(er.isEqual(e2.min()))throw new eL(eP.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return aE.updateTime(er)}write(et){this.ensureCommitNotCalled(),this.mutations.push(et)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mw="FirestoreClient",mE=100,mC=11,m_=20,mI=22;class mk{constructor(et,er,en,ei,es){this.authCredentials=et,this.appCheckCredentials=er,this.asyncQueue=en,this.databaseInfo=ei,this.user=eT.UNAUTHENTICATED,this.clientId=eQ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=es,this.authCredentials.start(en,async et=>{ex(mw,"Received user=",et.uid),await this.authCredentialListener(et),this.user=et}),this.appCheckCredentials.start(en,et=>(ex(mw,"Received new app check token=",et),this.appCheckCredentialListener(et,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:mE}}setCredentialChangeListener(et){this.authCredentialListener=et}setAppCheckTokenChangeListener(et){this.appCheckCredentialListener=et}terminate(){this.asyncQueue.enterRestrictedMode();let et=new eF;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),et.resolve()}catch(en){let er=pZ(en,"Failed to shutdown persistence");et.reject(er)}}),et.promise}}async function mx(et,er){et.asyncQueue.verifyOperationInProgress(),ex(mw,"Initializing OfflineComponentProvider");let en=et.configuration;await er.initialize(en);let ei=en.initialUser;et.setCredentialChangeListener(async et=>{ei.isEqual(et)||(await hP(er.localStore,et),ei=et)}),er.persistence.setDatabaseDeletedListener(()=>et.terminate()),et._offlineComponents=er}async function mA(et,er){et.asyncQueue.verifyOperationInProgress();let en=await mD(et);ex(mw,"Initializing OnlineComponentProvider"),await er.initialize(en,et.configuration),et.setCredentialChangeListener(et=>pH(er.remoteStore,et)),et.setAppCheckTokenChangeListener((et,en)=>pH(er.remoteStore,en)),et._onlineComponents=er}function mR(et){return"FirebaseError"===et.name?et.code===eP.FAILED_PRECONDITION||et.code===eP.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&et instanceof DOMException)||et.code===mI||et.code===m_||et.code===mC}async function mD(et){if(!et._offlineComponents){if(et._uninitializedComponentsProvider){ex(mw,"Using user provided OfflineComponentProvider");try{await mx(et,et._uninitializedComponentsProvider._offline)}catch(en){let er=en;if(!mR(er))throw er;eR("Error using user provided cache. Falling back to memory cache: "+er),await mx(et,new mt)}}else ex(mw,"Using default OfflineComponentProvider"),await mx(et,new mr(void 0))}return et._offlineComponents}async function mO(et){return et._onlineComponents||(et._uninitializedComponentsProvider?(ex(mw,"Using user provided OnlineComponentProvider"),await mA(et,et._uninitializedComponentsProvider._online)):(ex(mw,"Using default OnlineComponentProvider"),await mA(et,new mi))),et._onlineComponents}function mN(et){return mD(et).then(et=>et.localStore)}function mM(et){return mO(et).then(et=>et.syncEngine)}function mP(et){return mO(et).then(et=>et.datastore)}function mL(et,er){let en=new eF;return et.asyncQueue.enqueueAndForget(async()=>{let ei=await mM(et);return fR(ei,er,en)}),en.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mF(et,er){return et.timeoutSeconds===er.timeoutSeconds}function mB(et){let er={};return void 0!==et.timeoutSeconds&&(er.timeoutSeconds=et.timeoutSeconds),er}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mj="ComponentProvider",mU=new Map;function mV(et){let er=mU.get(et);er&&(ex(mj,"Removing Datastore"),mU.delete(et),er.terminate())}function mz(et,er,en,ei){return new nR(et,er,en,ei.host,ei.ssl,ei.experimentalForceLongPolling,ei.experimentalAutoDetectLongPolling,mB(ei.experimentalLongPollingOptions),ei.useFetchStreams)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mq="firestore.googleapis.com",m$=!0,mG=5,mK=30,mH=!0;class mW{constructor(et){var er,en;if(void 0===et.host){if(void 0!==et.ssl)throw new eL(eP.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mq,this.ssl=m$}else this.host=et.host,this.ssl=null!==(er=et.ssl)&&void 0!==er?er:m$;if(this.credentials=et.credentials,this.ignoreUndefinedProperties=!!et.ignoreUndefinedProperties,this.localCache=et.localCache,void 0===et.cacheSizeBytes)this.cacheSizeBytes=cl;else{if(et.cacheSizeBytes!==co&&et.cacheSizeBytes<ch)throw new eL(eP.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${ch}`);this.cacheSizeBytes=et.cacheSizeBytes}ml("experimentalForceLongPolling",et.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",et.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!et.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===et.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=mH:this.experimentalAutoDetectLongPolling=!!et.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mB(null!==(en=et.experimentalLongPollingOptions)&&void 0!==en?en:{}),mQ(this.experimentalLongPollingOptions),this.useFetchStreams=!!et.useFetchStreams}isEqual(et){return this.host===et.host&&this.ssl===et.ssl&&this.credentials===et.credentials&&this.cacheSizeBytes===et.cacheSizeBytes&&this.experimentalForceLongPolling===et.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===et.experimentalAutoDetectLongPolling&&mF(this.experimentalLongPollingOptions,et.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===et.ignoreUndefinedProperties&&this.useFetchStreams===et.useFetchStreams}}function mQ(et){if(void 0!==et.timeoutSeconds){if(isNaN(et.timeoutSeconds))throw new eL(eP.INVALID_ARGUMENT,`invalid long polling timeout: ${et.timeoutSeconds} (must not be NaN)`);if(et.timeoutSeconds<mG)throw new eL(eP.INVALID_ARGUMENT,`invalid long polling timeout: ${et.timeoutSeconds} (minimum allowed value is ${mG})`);if(et.timeoutSeconds>mK)throw new eL(eP.INVALID_ARGUMENT,`invalid long polling timeout: ${et.timeoutSeconds} (maximum allowed value is ${mK})`)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mY{constructor(et,er,en,ei){this._authCredentials=et,this._appCheckCredentials=er,this._databaseId=en,this._app=ei,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mW({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new eL(eP.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(et){if(this._settingsFrozen)throw new eL(eP.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mW(et),void 0!==et.credentials&&(this._authCredentials=eH(et.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return mV(this),Promise.resolve()}}function mJ(et,er,en,ei={}){var es;et=mm(et,mY);let ea=et._getSettings(),eo=`${er}:${en}`;if(ea.host!==mq&&ea.host!==eo&&eR("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),et._setSettings(Object.assign(Object.assign({},ea),{host:eo,ssl:!1})),ei.mockUserToken){let er,en;if("string"==typeof ei.mockUserToken)er=ei.mockUserToken,en=eT.MOCK_USER;else{er=(0,ep.Sg)(ei.mockUserToken,null===(es=et._app)||void 0===es?void 0:es.options.projectId);let ea=ei.mockUserToken.sub||ei.mockUserToken.user_id;if(!ea)throw new eL(eP.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");en=new eT(ea)}et._authCredentials=new eU(new eB(er,en))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mX{constructor(et,er,en){this.converter=er,this._query=en,this.type="query",this.firestore=et}withConverter(et){return new mX(this.firestore,et,this._query)}}class mZ{constructor(et,er,en){this.converter=er,this._key=en,this.type="document",this.firestore=et}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new m0(this.firestore,this.converter,this._key.path.popLast())}withConverter(et){return new mZ(this.firestore,et,this._key)}}class m0 extends mX{constructor(et,er,en){super(et,er,sE(en)),this._path=en,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let et=this._path.popLast();return et.isEmpty()?null:new mZ(this.firestore,null,new e8(et))}withConverter(et){return new m0(this.firestore,et,this._path)}}function m1(et,er,...en){if(et=(0,ep.m9)(et),mo("collection","path",er),et instanceof mY){let ei=e9.fromString(er,...en);return mc(ei),new m0(et,null,ei)}{if(!(et instanceof mZ)&&!(et instanceof m0))throw new eL(eP.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let ei=et._path.child(e9.fromString(er,...en));return mc(ei),new m0(et.firestore,null,ei)}}function m2(et,er,...en){if(et=(0,ep.m9)(et),1==arguments.length&&(er=eQ.newId()),mo("doc","path",er),et instanceof mY){let ei=e9.fromString(er,...en);return mu(ei),new mZ(et,null,new e8(ei))}{if(!(et instanceof mZ)&&!(et instanceof m0))throw new eL(eP.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let ei=et._path.child(e9.fromString(er,...en));return mu(ei),new mZ(et.firestore,et instanceof m0?et.converter:null,new e8(ei))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m3="AsyncQueue";class m6{constructor(et=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new d3(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=et}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(et){this.enqueue(et)}enqueueAndForgetEvenWhileRestricted(et){this.verifyNotFailed(),this.enqueueInternal(et)}enterRestrictedMode(et){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=et||!1)}enqueue(et){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let er=new eF;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(et().then(er.resolve,er.reject),er.promise)).then(()=>er.promise)}enqueueRetryable(et){this.enqueueAndForget(()=>(this.retryableOps.push(et),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(et){if(tA(et))ex(m3,"Operation failed with retryable error: "+et);else throw et}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(et){let er=this.tail.then(()=>(this.operationInProgress=!0,et().catch(et=>{this.failure=et,this.operationInProgress=!1;let er=m9(et);throw eA("INTERNAL UNHANDLED ERROR: ",er),et}).then(et=>(this.operationInProgress=!1,et))));return this.tail=er,er}enqueueAfterDelay(et,er,en){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(et)>-1&&(er=0);let ei=pX.createAndSchedule(this,et,er,en,et=>this.removeDelayedOperation(et));return this.delayedOperations.push(ei),ei}verifyNotFailed(){this.failure&&eO()}verifyOperationInProgress(){}async drain(){let et;do et=this.tail,await et;while(et!==this.tail)}containsDelayedOperation(et){for(let er of this.delayedOperations)if(er.timerId===et)return!0;return!1}runAllDelayedOperationsUntil(et){return this.drain().then(()=>{for(let er of(this.delayedOperations.sort((et,er)=>et.targetTimeMs-er.targetTimeMs),this.delayedOperations))if(er.skipDelay(),"all"!==et&&er.timerId===et)break;return this.drain()})}skipDelaysForTimerId(et){this.timerIdsToSkip.push(et)}removeDelayedOperation(et){let er=this.delayedOperations.indexOf(et);this.delayedOperations.splice(er,1)}}function m9(et){let er=et.message||"";return et.stack&&(er=et.stack.includes(et.message)?et.stack:et.message+"\n"+et.stack),er}class m4 extends mY{constructor(et,er,en,ei){super(et,er,en,ei),this.type="firestore",this._queue=new m6,this._persistenceKey=(null==ei?void 0:ei.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let et=this._firestoreClient.terminate();this._queue=new m6(et),this._firestoreClient=void 0,await et}}}function m5(et,er){let en="object"==typeof et?et:(0,eu.Mq)(),ei="string"==typeof et?et:er||nD,es=(0,eu.qX)(en,"firestore").getImmediate({identifier:ei});if(!es._initialized){let et=(0,ep.P0)("firestore");et&&mJ(es,...et)}return es}function m8(et){if(et._terminated)throw new eL(eP.FAILED_PRECONDITION,"The client has already been terminated.");return et._firestoreClient||m7(et),et._firestoreClient}function m7(et){var er,en,ei;let es=et._freezeSettings(),ea=mz(et._databaseId,(null===(er=et._app)||void 0===er?void 0:er.options.appId)||"",et._persistenceKey,es);!et._componentsProvider&&(null===(en=es.localCache)||void 0===en?void 0:en._offlineComponentProvider)&&(null===(ei=es.localCache)||void 0===ei?void 0:ei._onlineComponentProvider)&&(et._componentsProvider={_offline:es.localCache._offlineComponentProvider,_online:es.localCache._onlineComponentProvider}),et._firestoreClient=new mk(et._authCredentials,et._appCheckCredentials,et._queue,ea,et._componentsProvider&&ge(et._componentsProvider))}function ge(et){let er=null==et?void 0:et._online.build();return{_offline:null==et?void 0:et._offline.build(er),_online:er}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(et,er=!0){eC(eu.Jn),(0,eu.Xd)(new ec.wA("firestore",(et,{instanceIdentifier:en,options:ei})=>{let es=et.getProvider("app").getImmediate(),ea=new m4(new eV(et.getProvider("auth-internal")),new eK(et.getProvider("app-check-internal")),nN(es,en),es);return ei=Object.assign({useFetchStreams:er},ei),ea._setSettings(ei),ea},"PUBLIC").setMultipleInstances(!0)),(0,eu.KN)(eb,eS,et),(0,eu.KN)(eb,eS,"esm2017")}class gr{constructor(et,er,en){this._userDataWriter=er,this._data=en,this.type="AggregateQuerySnapshot",this.query=et}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(et){this._byteString=et}static fromBase64String(et){try{return new gn(nm.fromBase64String(et))}catch(et){throw new eL(eP.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+et)}}static fromUint8Array(et){return new gn(nm.fromUint8Array(et))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(et){return this._byteString.isEqual(et._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(...et){for(let er=0;er<et.length;++er)if(0===et[er].length)throw new eL(eP.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new e5(et)}isEqual(et){return this._internalPath.isEqual(et._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(et){this._methodName=et}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(et,er){if(!isFinite(et)||et<-90||et>90)throw new eL(eP.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+et);if(!isFinite(er)||er<-180||er>180)throw new eL(eP.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+er);this._lat=et,this._long=er}get latitude(){return this._lat}get longitude(){return this._long}isEqual(et){return this._lat===et._lat&&this._long===et._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(et){return eY(this._lat,et._lat)||eY(this._long,et._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(et){this._values=(et||[]).map(et=>et)}toArray(){return this._values.map(et=>et)}isEqual(et){return hR(this._values,et._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gl=/^__.*__$/;class gu{constructor(et,er,en){this.data=et,this.fieldMask=er,this.fieldTransforms=en}toMutation(et,er){return null!==this.fieldMask?new aM(et,this.data,this.fieldMask,er,this.fieldTransforms):new aD(et,this.data,er,this.fieldTransforms)}}class gc{constructor(et,er,en){this.data=et,this.fieldMask=er,this.fieldTransforms=en}toMutation(et,er){return new aM(et,this.data,this.fieldMask,er,this.fieldTransforms)}}function gh(et){switch(et){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw eO()}}class gd{constructor(et,er,en,ei,es,ea){this.settings=et,this.databaseId=er,this.serializer=en,this.ignoreUndefinedProperties=ei,void 0===es&&this.validatePath(),this.fieldTransforms=es||[],this.fieldMask=ea||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(et){return new gd(Object.assign(Object.assign({},this.settings),et),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(et){var er;let en=null===(er=this.path)||void 0===er?void 0:er.child(et),ei=this.contextWith({path:en,arrayElement:!1});return ei.validatePathSegment(et),ei}childContextForFieldPath(et){var er;let en=null===(er=this.path)||void 0===er?void 0:er.child(et),ei=this.contextWith({path:en,arrayElement:!1});return ei.validatePath(),ei}childContextForArray(et){return this.contextWith({path:void 0,arrayElement:!0})}createError(et){return gM(et,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(et){return void 0!==this.fieldMask.find(er=>et.isPrefixOf(er))||void 0!==this.fieldTransforms.find(er=>et.isPrefixOf(er.field))}validatePath(){if(this.path)for(let et=0;et<this.path.length;et++)this.validatePathSegment(this.path.get(et))}validatePathSegment(et){if(0===et.length)throw this.createError("Document fields must not be empty");if(gh(this.dataSource)&&gl.test(et))throw this.createError('Document fields cannot begin and end with "__"')}}class gp{constructor(et,er,en){this.databaseId=et,this.ignoreUndefinedProperties=er,this.serializer=en||dY(et)}createContext(et,er,en,ei=!1){return new gd({dataSource:et,methodName:er,targetDoc:en,path:e5.emptyPath(),arrayElement:!1,hasConverter:ei},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gf(et){let er=et._freezeSettings(),en=dY(et._databaseId);return new gp(et._databaseId,!!er.ignoreUndefinedProperties,en)}function gm(et,er,en,ei,es,ea={}){let eo,eu;let ec=et.createContext(ea.merge||ea.mergeFields?2:0,er,en,es);gR("Data must be an object, but it was:",ec,ei);let eh=gC(ei,ec);if(ea.merge)eo=new nd(ec.fieldMask),eu=ec.fieldTransforms;else if(ea.mergeFields){let et=[];for(let ei of ea.mergeFields){let es=gD(er,ei,en);if(!ec.contains(es))throw new eL(eP.INVALID_ARGUMENT,`Field '${es}' is specified in your field mask but missing from your input data.`);gP(et,es)||et.push(es)}eo=new nd(et),eu=ec.fieldTransforms.filter(et=>eo.covers(et.field))}else eo=null,eu=ec.fieldTransforms;return new gu(new iN(eh),eo,eu)}class gg extends null{_toFieldTransform(et){if(2===et.dataSource)et.fieldMask.push(et.path);else if(1===et.dataSource)throw et.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw et.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(et){return et instanceof gg}}function gy(et,er,en){return new gd({dataSource:3,targetDoc:er.settings.targetDoc,methodName:et._methodName,arrayElement:en},er.databaseId,er.serializer,er.ignoreUndefinedProperties)}class gv extends null{_toFieldTransform(et){return new ab(et.path,new ac)}isEqual(et){return et instanceof gv}}class gb extends null{constructor(et,er){super(et),this._elements=er}_toFieldTransform(et){let er=gy(this,et,!0),en=this._elements.map(et=>gE(et,er)),ei=new ah(en);return new ab(et.path,ei)}isEqual(et){return et instanceof gb&&deepEqual(this._elements,et._elements)}}class gS extends null{constructor(et,er){super(et),this._elements=er}_toFieldTransform(et){let er=gy(this,et,!0),en=this._elements.map(et=>gE(et,er)),ei=new ap(en);return new ab(et.path,ei)}isEqual(et){return et instanceof gS&&deepEqual(this._elements,et._elements)}}class gT extends null{constructor(et,er){super(et),this._operand=er}_toFieldTransform(et){let er=new am(et.serializer,ai(et.serializer,this._operand));return new ab(et.path,er)}isEqual(et){return et instanceof gT&&this._operand===et._operand}}function gw(et,er,en,ei=!1){let es=et.createContext(ei?4:3,er),ea=gE(en,es);return ea}function gE(et,er){if(gA(et=(0,ep.m9)(et)))return gR("Unsupported field value:",er,et),gC(et,er);if(et instanceof gs)return gI(et,er),null;if(void 0===et&&er.ignoreUndefinedProperties)return null;if(er.path&&er.fieldMask.push(er.path),!(et instanceof Array))return gk(et,er);if(er.settings.arrayElement&&4!==er.dataSource)throw er.createError("Nested arrays are not supported");return g_(et,er)}function gC(et,er){let en={};return r7(et)?er.path&&er.path.length>0&&er.fieldMask.push(er.path):r8(et,(et,ei)=>{let es=gE(ei,er.childContextForField(et));null!=es&&(en[et]=es)}),{mapValue:{fields:en}}}function g_(et,er){let en=[],ei=0;for(let es of et){let et=gE(es,er.childContextForArray(ei));null==et&&(et={nullValue:"NULL_VALUE"}),en.push(et),ei++}return{arrayValue:{values:en}}}function gI(et,er){if(!gh(er.dataSource))throw er.createError(`${et._methodName}() can only be used with update() and set()`);if(!er.path)throw er.createError(`${et._methodName}() is not currently supported inside arrays`);let en=et._toFieldTransform(er);en&&er.fieldTransforms.push(en)}function gk(et,er){if(null===(et=(0,ep.m9)(et)))return{nullValue:"NULL_VALUE"};if("number"==typeof et)return ai(er.serializer,et);if("boolean"==typeof et)return{booleanValue:et};if("string"==typeof et)return{stringValue:et};if(et instanceof Date){let en=e1.fromDate(et);return{timestampValue:oy(er.serializer,en)}}if(et instanceof e1){let en=new e1(et.seconds,1e3*Math.floor(et.nanoseconds/1e3));return{timestampValue:oy(er.serializer,en)}}if(et instanceof ga)return{geoPointValue:{latitude:et.latitude,longitude:et.longitude}};else if(et instanceof gn)return{bytesValue:ob(er.serializer,et._byteString)};else if(et instanceof mZ){let en=er.databaseId,ei=et.firestore._databaseId;if(!ei.isEqual(en))throw er.createError(`Document reference is for database ${ei.projectId}/${ei.database} but should be for database ${en.projectId}/${en.database}`);return{referenceValue:oE(et.firestore._databaseId||er.databaseId,et._key.path)}}else if(et instanceof go)return gx(et,er);else throw er.createError(`Unsupported field value: ${mp(et)}`)}function gx(et,er){let en={fields:{[nB]:{stringValue:nV},[nz]:{arrayValue:{values:et.toArray().map(et=>{if("number"!=typeof et)throw er.createError("VectorValues must only contain numeric values.");return ar(er.serializer,et)})}}}};return{mapValue:en}}function gA(et){return"object"==typeof et&&null!==et&&!(et instanceof Array)&&!(et instanceof Date)&&!(et instanceof e1)&&!(et instanceof ga)&&!(et instanceof gn)&&!(et instanceof mZ)&&!(et instanceof gs)&&!(et instanceof go)}function gR(et,er,en){if(!gA(en)||!mh(en)){let ei=mp(en);if("an object"===ei)throw er.createError(et+" a custom object");throw er.createError(et+" "+ei)}}function gD(et,er,en){if((er=(0,ep.m9)(er))instanceof gi)return er._internalPath;if("string"==typeof er)return gN(et,er);{let er="Field path arguments must be of type string or ";throw gM(er,et,!1,void 0,en)}}let gO=RegExp("[~\\*/\\[\\]]");function gN(et,er,en){let ei=er.search(gO);if(ei>=0)throw gM(`Invalid field path (${er}). Paths must not contain '~', '*', '/', '[', or ']'`,et,!1,void 0,en);try{return new gi(...er.split("."))._internalPath}catch(ei){throw gM(`Invalid field path (${er}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,et,!1,void 0,en)}}function gM(et,er,en,ei,es){let ea=ei&&!ei.isEmpty(),eo=void 0!==es,eu=`Function ${er}() called with invalid data`;en&&(eu+=" (via `toFirestore()`)"),eu+=". ";let ec="";return(ea||eo)&&(ec+=" (found",ea&&(ec+=` in field ${ei}`),eo&&(ec+=` in document ${es}`),ec+=")"),new eL(eP.INVALID_ARGUMENT,eu+et+ec)}function gP(et,er){return et.some(et=>et.isEqual(er))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(et,er,en,ei,es){this._firestore=et,this._userDataWriter=er,this._key=en,this._document=ei,this._converter=es}get id(){return this._key.path.lastSegment()}get ref(){return new mZ(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let et=new gF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(et)}}}get(et){if(this._document){let er=this._document.data.field(gB("DocumentSnapshot.get",et));if(null!==er)return this._userDataWriter.convertValue(er)}}}class gF extends null{data(){return super.data()}}function gB(et,er){return"string"==typeof er?gN(et,er):er instanceof gi?er._internalPath:er._delegate._internalPath}class gj extends null{constructor(et,er,en){super(),this._field=et,this._op=er,this._value=en,this.type="where"}static _create(et,er,en){return new gj(et,er,en)}_apply(et){let er=this._parse(et);return gZ(et._query,er),new mX(et.firestore,et.converter,sN(et._query,er))}_parse(et){let er=gf(et.firestore),en=gK(et._query,"where",er,et.firestore._databaseId,this._field,this._op,this._value);return en}}class gU extends null{constructor(et,er){super(),this.type=et,this._queryConstraints=er}static _create(et,er){return new gU(et,er)}_parse(et){let er=this._queryConstraints.map(er=>er._parse(et)).filter(et=>et.getFilters().length>0);return 1===er.length?er[0]:iW.create(er,this._getOperator())}_apply(et){let er=this._parse(et);return 0===er.getFilters().length?et:(g0(et._query,er),new mX(et.firestore,et.converter,sN(et._query,er)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class gV extends null{constructor(et,er){super(),this._field=et,this._direction=er,this.type="orderBy"}static _create(et,er){return new gV(et,er)}_apply(et){let er=gH(et._query,this._field,this._direction);return new mX(et.firestore,et.converter,sM(et._query,er))}}class gz extends null{constructor(et,er,en){super(),this.type=et,this._limit=er,this._limitType=en}static _create(et,er,en){return new gz(et,er,en)}_apply(et){return new mX(et.firestore,et.converter,sP(et._query,this._limit,this._limitType))}}class gq extends null{constructor(et,er,en){super(),this.type=et,this._docOrFields=er,this._inclusive=en}static _create(et,er,en){return new gq(et,er,en)}_apply(et){let er=gG(et,this.type,this._docOrFields,this._inclusive);return new mX(et.firestore,et.converter,sL(et._query,er))}}class g$ extends null{constructor(et,er,en){super(),this.type=et,this._docOrFields=er,this._inclusive=en}static _create(et,er,en){return new g$(et,er,en)}_apply(et){let er=gG(et,this.type,this._docOrFields,this._inclusive);return new mX(et.firestore,et.converter,sF(et._query,er))}}function gG(et,er,en,ei){if(en[0]=getModularInstance(en[0]),en[0]instanceof gL)return gW(et._query,et.firestore._databaseId,er,en[0]._document,ei);{let es=gf(et.firestore);return gQ(et._query,et.firestore._databaseId,es,er,en,ei)}}function gK(et,er,en,ei,es,ea,eo){let eu;if(es.isKeyField()){if("array-contains"===ea||"array-contains-any"===ea)throw new eL(eP.INVALID_ARGUMENT,`Invalid Query. You can't perform '${ea}' queries on documentId().`);if("in"===ea||"not-in"===ea){gJ(eo,ea);let er=[];for(let en of eo)er.push(gY(ei,et,en));eu={arrayValue:{values:er}}}else eu=gY(ei,et,eo)}else("in"===ea||"not-in"===ea||"array-contains-any"===ea)&&gJ(eo,ea),eu=gw(en,er,eo,"in"===ea||"not-in"===ea);let ec=iH.create(es,ea,eu);return ec}function gH(et,er,en){if(null!==et.startAt)throw new eL(eP.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==et.endAt)throw new eL(eP.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let ei=new iz(er,en);return ei}function gW(et,er,en,ei,es){if(!ei)throw new eL(eP.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${en}().`);let ea=[];for(let en of sA(et))if(en.field.isKeyField())ea.push(iy(er,ei.key));else{let et=ei.data.field(en.field);if(nI(et))throw new eL(eP.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+en.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==et)ea.push(et);else{let et=en.field.canonicalString();throw new eL(eP.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${et}' (used as the orderBy) does not exist.`)}}return new iF(ea,es)}function gQ(et,er,en,ei,es,ea){let eo=et.explicitOrderBy;if(es.length>eo.length)throw new eL(eP.INVALID_ARGUMENT,`Too many arguments provided to ${ei}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let eu=[];for(let ea=0;ea<es.length;ea++){let ec=es[ea],eh=eo[ea];if(eh.field.isKeyField()){if("string"!=typeof ec)throw new eL(eP.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${ei}(), but got a ${typeof ec}`);if(!sx(et)&&-1!==ec.indexOf("/"))throw new eL(eP.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${ei}() must be a plain document ID, but '${ec}' contains a slash.`);let en=et.path.child(e9.fromString(ec));if(!e8.isDocumentKey(en))throw new eL(eP.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${ei}() must result in a valid document path, but '${en}' is not because it contains an odd number of segments.`);let es=new e8(en);eu.push(iy(er,es))}else{let et=gw(en,ei,ec);eu.push(et)}}return new iF(eu,ea)}function gY(et,er,en){if("string"==typeof(en=getModularInstance(en))){if(""===en)throw new eL(eP.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sx(er)&&-1!==en.indexOf("/"))throw new eL(eP.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${en}' contains a '/' character.`);let ei=er.path.child(e9.fromString(en));if(!e8.isDocumentKey(ei))throw new eL(eP.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${ei}' is not because it has an odd number of segments (${ei.length}).`);return iy(et,new e8(ei))}if(en instanceof mZ)return iy(et,en._key);throw new eL(eP.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mp(en)}.`)}function gJ(et,er){if(!Array.isArray(et)||0===et.length)throw new eL(eP.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${er.toString()}' filters.`)}function gX(et){switch(et){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function gZ(et,er){let en=g1(et.filters,gX(er.op));if(null!==en){if(en===er.op)throw new eL(eP.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${er.op.toString()}' filter.`);throw new eL(eP.INVALID_ARGUMENT,`Invalid query. You cannot use '${er.op.toString()}' filters with '${en.toString()}' filters.`)}}function g0(et,er){let en=et,ei=er.getFlattenedFilters();for(let et of ei)gZ(en,et),en=sN(en,et)}function g1(et,er){for(let en of et)for(let et of en.getFlattenedFilters())if(er.indexOf(et.op)>=0)return et.op;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(et,er,en){return et?en&&(en.merge||en.mergeFields)?et.toFirestore(er,en):et.toFirestore(er):er}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(et,er){this.hasPendingWrites=et,this.fromCache=er}isEqual(et){return this.hasPendingWrites===et.hasPendingWrites&&this.fromCache===et.fromCache}}class g6 extends null{data(et={}){return super.data(et)}}function g9(et){switch(et){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return eO()}}class g4 extends null{constructor(et){super(),this.firestore=et}convertBytes(et){return new gn(et)}convertReference(et){let er=this.convertDocumentKey(et,this.firestore._databaseId);return new mZ(this.firestore,null,er)}}function g5(et,er){let en=mm(et.firestore,m4),ei=m2(et),es=g2(et.converter,er),ea=gf(et.firestore),eo=gm(ea,"addDoc",ei._key,es,null!==et.converter,{}),eu=eo.toMutation(ei._key,aE.exists(!1));return g8(en,[eu]).then(()=>ei)}function g8(et,er){let en=m8(et);return mL(en,er)}class g7{constructor(et){this.forceOwnership=et,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(et){this._onlineComponentProvider=mi.provider,this._offlineComponentProvider={build:er=>new mn(er,null==et?void 0:et.cacheSizeBytes,this.forceOwnership)}}}new WeakMap,/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gt("node")},81513:et=>{"use strict";et.exports={i8:"1.9.15"}},56541:et=>{"use strict";et.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},89987:et=>{"use strict";et.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},57674:et=>{"use strict";et.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},73795:et=>{"use strict";et.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};